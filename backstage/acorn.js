/**
 * Created by lichi on 2017/12/15.
 */
function ConfirmationOfEnrolmentCtrl(e, t, n, r, a) {
    function i(e) {
        var t = e && e.message ? e.message : "Something went wrong on our end. If this error persists, please contact your registrar to request a Confirmation of Enrolment letter.";
        r.showToast({
            message: t,
            type: a.TYPE_DANGER
        })
    }
    function o() {
        c.enrolmentLetter = {},
            e.load(function(e) {
                e && (c.enrolmentLetter = e,
                c.enrolmentLetter.degrees && 1 === c.enrolmentLetter.degrees.length && (c.selectedDegree = c.enrolmentLetter.degrees[0],
                    c.enrolmentLetter.postCode = c.selectedDegree.postCode,
                    c.enrolmentLetter.sessionCode = c.selectedDegree.sessionCode))
            }, function(e) {
                i(e)
            })
    }
    function s(e) {
        var n = c.enrolmentLetter.currentSession;
        return c.enrolmentLetter.sessionRequirement === t.CURRENT_SESSION ? e.sessionCode === n : c.enrolmentLetter.sessionRequirement === t.UPCOMING_SESSION ? e.sessionCode > n : void 0
    }
    var c = this;
    c.downloadEnrolmentLetter = function() {
        c.enrolmentLetter.expectedGraduationDate = c.enrolmentLetter.closestExpectedGradMonth + ", " + c.enrolmentLetter.closestExpectedGradYear,
            e.downloadEnrolmentLetter(c.enrolmentLetter, function(e) {
                var t = new Blob([e.data],{
                    type: "application/pdf"
                });
                n.saveBlobAsFile(t, "Confirmation of Enrolment.pdf")
            }, function(e) {
                i(e)
            })
    }
        ,
        c.selectDegree = function() {
            var e = c.getFilteredDegrees()
                , t = e[event.target.selectedIndex - 1];
            t && (c.selectedDegree = t,
                c.enrolmentLetter.sessionCode = t.sessionCode,
                c.enrolmentLetter.postCode = t.postCode)
        }
        ,
        c.selectSession = function() {
            var e = c.getFilteredDegrees();
            e && 0 === e.length ? (c.selectedDegree = e[0],
                c.enrolmentLetter.sessionCode = e[0].sessionCode,
                c.enrolmentLetter.postCode = e[0].postCode) : (c.selectedDegree = void 0,
                c.enrolmentLetter.sessionCode = void 0,
                c.enrolmentLetter.postCode = void 0)
        }
        ,
        c.getFilteredDegrees = function() {
            if (c.enrolmentLetter.degrees) {
                var e = c.enrolmentLetter.degrees.filter(s);
                return 1 === e.length && (c.selectedDegree = e[0],
                    c.enrolmentLetter.postCode = e[0].postCode,
                    c.enrolmentLetter.sessionCode = e[0].sessionCode),
                    e
            }
        }
        ,
        c.isGradDateAvailable = function() {
            return c.selectedDegree && c.selectedDegree.expectedGraduationYears && c.selectedDegree.expectedGraduationYears.length
        }
        ,
        c.getSingleDegreeDescription = function() {
            var e = 1 === c.enrolmentLetter.degrees.length ? c.enrolmentLetter.degrees[0] : c.getFilteredDegrees()[0];
            if (e) {
                return "<p><strong>Note:</strong> This letter will be generated for the " + e.sessionDescription + " session.</p>"
            }
        }
        ,
        c.getSelectedDegreeSessionDescription = function(e) {
            var n = c.enrolmentLetter.currentSession
                , r = c.enrolmentLetter.degrees.filter(function(r) {
                return e === t.CURRENT_SESSION ? r.sessionCode === n : r.sessionCode > n
            });
            if (r.length)
                return "(" + r[0].sessionDescription + ")"
        }
        ,
        c.canShowSessionRequiredField = function() {
            return c.enrolmentLetter.degrees && c.enrolmentLetter.degrees.length > 1
        }
        ,
        this.$onInit = function() {
            c.confirmationOfEnrolmentConstants = t
        }
        ,
        this.$onChanges = function() {
            o()
        }
}
function HelpAndFeedbackCtrl(e, t, n, r, a, i) {
    function o() {
        var t = [];
        n.load().then(function(e) {
            d.studentEmailAddress = e.studentEmailAddress,
                d.data.acceptedFileTypes = e.acceptedFileTypes,
                e.orgs.forEach(function(e) {
                    u(d.data.registrars, e),
                        c(e.primaryOrgCode)
                }),
                d.data.registrars = s(d.data.registrars),
                d.data.officeAndTopicChoices = d.data.registrars,
                e.offices.forEach(function(e) {
                    t.push(l(e))
                }),
                d.data.officeAndTopicChoices = d.data.officeAndTopicChoices.concat(t)
        }, function() {
            e.log("Failed to load student registration data.")
        })
    }
    function s(e) {
        return e.filter(function(e, t, n) {
            return t === n.map(function(e) {
                    return e.key
                }).indexOf(e.key)
        })
    }
    function c(e) {
        i.SCREEN_SHARE_ORG_AVAILABILITY.some(function(t) {
            t === e && d.data.tabs.splice(1, 0, {
                heading: i.TAB_HEADING_LIVE_SCREEN,
                subHeading: i.TAB_SUB_HEADING_LIVE_SCREEN,
                content: "partials/helpAndFeedback/getScreenShare.html"
            })
        })
    }
    function l(e) {
        var t = {};
        return t.optionGroup = p.topicGroup,
            t.external = !0,
            t.key = e.name,
            t.value = e.properties.name,
            t.link = e.properties.link,
            t.email = e.properties.email,
            t
    }
    function u(e, t, n) {
        var r = {};
        r.optionGroup = p.officeGroup,
            r.external = !0,
            n ? (r.key = t.properties.secondaryEmail,
                r.value = "SGS" === t.primaryOrgCode ? t.properties.secondaryName : t.properties.secondaryName + " Registrar",
                r.email = t.properties.secondaryEmail) : (r.key = t.properties.email,
                r.value = "SGS" === t.primaryOrgCode ? t.properties.name : t.properties.name + " Registrar",
                r.email = t.properties.email),
            r.link = t.properties.registrarLink,
            r.primaryOrgCode = t.properties.primaryOrgCode,
            e.push(r),
        !n && ("TST" === t.primaryOrgCode && "TST" === t.adminOrgCode && "TST" !== t.secondaryOrgCode || "SGS" === t.primaryOrgCode) && u(e, t, !0)
    }
    var d = this
        , p = {
        officeGroup: "Academics, Enrolment & Fee Payments",
        topicGroup: "Other Inquiries"
    };
    d.setSelectedOfficeOrTopic = function(e) {
        d.help.email = e.email,
            d.help.office = e.value
    }
        ,
        d.$onInit = function() {
            d.data = {
                registrars: [],
                tabs: [{
                    heading: i.TAB_HEADING_EMAIL_HELP,
                    subHeading: i.TAB_SUB_HEADING_EMAIL_HELP,
                    content: "partials/helpAndFeedback/getHelp.html"
                }, {
                    heading: i.TAB_HEADING_SEND_FEEDBACK,
                    subHeading: i.TAB_SUB_HEADING_SEND_FEEDBACK,
                    content: "partials/helpAndFeedback/sendFeedback.html"
                }]
            },
                d.help = {},
                d.feedback = {
                    email: "rosi.help@utoronto.ca",
                    office: "ACORN team"
                },
                d.maxTotalFileSize = "15MB"
        }
        ,
        d.submit = function(e, i) {
            var o = new FormData;
            o.append("form", JSON.stringify(e)),
            i.length && i.forEach(function(e) {
                o.append("files", e)
            }),
                n.submit(o).then(function(e) {
                    r.showToast({
                        message: e.data,
                        type: a.TYPE_SUCCESS
                    }),
                        d.help = {},
                        d.feedback.description = "",
                        d.data.choice = [],
                        t.$broadcast(a.REMOVE_UPLOADED_FILES, {})
                }, function(e) {
                    r.showToast({
                        message: e.data,
                        type: a.TYPE_DANGER
                    })
                })
        }
        ,
        d.$onChanges = function() {
            d.data = {},
                d.help = {},
                d.feedback = {
                    email: "rosi.help@utoronto.ca",
                    office: "ACORN team"
                },
                d.data.officeAndTopicChoices = d.getOfficeAndTopicChoices(),
                o()
        }
        ,
        d.getOfficeAndTopicChoices = function() {
            return d.officeAndTopicChoices
        }
}
ConfirmationOfEnrolmentCtrl.$inject = ["enrolmentLetterServerResources", "confirmationOfEnrolmentConstants", "acornCoreLib", "acornToast", "acornToastConstants"],
    HelpAndFeedbackCtrl.$inject = ["$log", "$rootScope", "helpAndFeedbackService", "acornToast", "acornToastConstants", "helpAndFeedbackConstants"],
Array.prototype.find || Object.defineProperty(Array.prototype, "find", {
    value: function(e) {
        if (null === this)
            throw new TypeError("Array.prototype.find called on null or undefined");
        if ("function" != typeof e)
            throw new TypeError("predicate must be a function");
        for (var t, n = Object(this), r = n.length >>> 0, a = arguments[1], i = 0; i < r; i++)
            if (t = n[i],
                    e.call(a, t, i, n))
                return t
    }
}),
    function() {
        "use strict";
        var e = $.ajax;
        $.ajax = function(t) {
            return t.async = !0,
                e(t)
        }
            ,
            angular.module("acornApp", ["ngResource", "ngCookies", "ngTouch", "ngRoute", "ngSanitize", "strformat", "ui.bootstrap", "ui.date"]).config(["$routeProvider", "$httpProvider", "$compileProvider", "$provide", "$sceDelegateProvider", function(e, t, n, r, a) {
                r.decorator("uibTabDirective", ["$delegate", function(e) {
                    var t = e[0];
                    t.scope.id = "&";
                    var n = t.compile;
                    return t.compile = function() {
                        var e = n.apply(this, arguments);
                        return function(t) {
                            e.apply(this, arguments),
                                t.id = t.$parent.tab.id
                        }
                    }
                        ,
                        e
                }
                ]),
                    r.decorator("uibTabContentTranscludeDirective", ["$delegate", function(e) {
                        var t = e[0]
                            , n = t.link;
                        return t.compile = function() {
                            return function(e, t) {
                                n.apply(this, arguments),
                                    function(e) {
                                        var t = e.parent().parent()
                                            , n = $(t).find("ul:first");
                                        $(n).on("keydown", "a", function(e) {
                                            switch (e.which) {
                                                case 37:
                                                case 38:
                                                    0 !== $(this).parent().prev().length ? $(this).parent().prev().find(">a").focus() : $(n).find("li:last>a").focus();
                                                    break;
                                                case 39:
                                                case 40:
                                                    0 !== $(this).parent().next().length ? $(this).parent().next().find(">a").focus() : $(n).find("li:first>a").focus();
                                                    break;
                                                case 13:
                                                    $(this).click()
                                            }
                                        })
                                    }(t)
                            }
                        }
                            ,
                            e
                    }
                    ]),
                    t.useApplyAsync(!0),
                    t.defaults.headers.common["Content-Type"] = t.defaults.headers.post["Content-Type"],
                    t.interceptors.push("httpTimeoutResponseInterceptor"),
                angular.isObject(t.defaults.headers.get) || (t.defaults.headers.get = {}),
                    t.defaults.headers.get["If-Modified-Since"] = "1",
                    t.defaults.headers.get["Cache-Control"] = "no-cache",
                    t.defaults.headers.get.Pragma = "no-cache",
                    t.useLegacyPromiseExtensions(!1),
                    n.aHrefSanitizationWhitelist(/^\s*(https?|mailto|javascript):/),
                    n.debugInfoEnabled(!1);
                var i = function(e) {
                    return (/\/timetable\/(main|scheduleView)\.do/.test(window.location.href) ? "/sws/" : "") + e
                };
                e.when("/", {
                    templateUrl: "views/dashboard.html",
                    controller: "DashboardCtrl"
                }).when("/plan", {
                    templateUrl: "views/planAndExplore.html",
                    controller: "planningToolsCtrl"
                }).when("/health_and_wellness", {
                    templateUrl: "views/healthAndWellness.html",
                    controller: "LifeContentCtrl"
                }).when("/involvement", {
                    templateUrl: "views/involvement.html",
                    controller: "LifeContentCtrl"
                }).when("/career_planning", {
                    templateUrl: "views/careerPlanning.html",
                    controller: "LifeContentCtrl"
                }).when("/accessibility", {
                    templateUrl: "views/accessibility.html",
                    controller: "LifeContentCtrl"
                }).when("/international_opp", {
                    templateUrl: "views/internationalOpp.html",
                    controller: "LifeContentCtrl"
                }).when("/housing", {
                    templateUrl: "views/housing.html",
                    controller: "LifeContentCtrl"
                }).when("/family_care", {
                    templateUrl: "views/familyCare.html",
                    controller: "LifeContentCtrl"
                }).when("/notifications_and_activity", {
                    templateUrl: "views/notificationsAndActivity.html",
                    controller: "NotificationsAndActivityCtrl"
                }).when("/enrol_and_manage", {
                    templateUrl: "views/enrolAndManage.html",
                    controller: "enrolAndManageLandingCtrl"
                }).when("/financial_account", {
                    templateUrl: "views/financialAccount.html",
                    controller: "FinancialAccountLandingCtrl"
                }).when("/make_payment", {
                    templateUrl: "views/makePayment.html",
                    controller: "MakePaymentCtrl"
                }).when("/fee_payment", {
                    templateUrl: "views/feePayment.html",
                    controller: "FeePaymentCtrl"
                }).when("/grants", {
                    templateUrl: "views/grantApp.html",
                    controller: "GrantAppCtrl"
                }).when("/grants_next_steps", {
                    templateUrl: "views/grantAppNextSteps.html",
                    controller: "GrantAppCacheCtrl"
                }).when("/awards", {
                    redirectTo: "/awards/findAwards"
                }).when("/awards/:tab", {
                    templateUrl: "views/awards.html",
                    controller: "AwardsCtrl"
                }).when("/transaction_history", {
                    templateUrl: "views/paymentHistory.html",
                    controller: "PaymentHistoryCtrl"
                }).when("/account_details", {
                    templateUrl: "views/accountDetails.html",
                    controller: "AccountDetailsCtrl"
                }).when("/courses", {
                    redirectTo: "/courses/0"
                }).when("/courses/:sessionID", {
                    templateUrl: "views/courses.html",
                    controller: "EnrolmentCtrl",
                    resolve: {
                        serviceDependencies: ["TimetableConflict", function(e) {
                            return e
                        }
                        ]
                    }
                }).when("/programs", {
                    templateUrl: "views/programs.html",
                    controller: "ProgramEnrolmentCtrl"
                }).when("/graduation", {
                    templateUrl: "views/graduation.html",
                    controller: "GraduationCtrl"
                }).when("/transcript", {
                    templateUrl: "views/transcript.html",
                    controller: "TranscriptCtrl"
                }).when("/transcript/dashboard", {
                    templateUrl: "views/transcript.html",
                    controller: "TranscriptCtrl"
                }).when("/transcript/confirmation_of_enrolment", {
                    template: "<confirmation-of-enrolment></confirmation-of-enrolment>"
                }).when("/transcript/select_recipients", {
                    templateUrl: "views/transcriptSelectRecipients.html",
                    controller: "SelectRecipientsCtrl"
                }).when("/transcript/review_order_and_payment", {
                    templateUrl: "views/transcriptReviewOrderAndPayment.html",
                    controller: "ReviewOrderAndPaymentCtrl"
                }).when("/transcript/receipt", {
                    templateUrl: "views/transcriptReceipt.html",
                    controller: "ReceiptCtrl"
                }).when("/transcript/history", {
                    templateUrl: "views/transcriptHistory.html",
                    controller: "HistoryCtrl"
                }).when("/transcript/history/:orderId", {
                    templateUrl: "views/transcriptHistory.html",
                    controller: "HistoryCtrl"
                }).when("/transcript/manage_orders", {
                    templateUrl: "views/transcriptManageOrders.html",
                    controller: "ManageOrdersCtrl"
                }).when("/transcript/manage_orders/:orderId", {
                    templateUrl: "views/transcriptManageOrders.html",
                    controller: "ManageOrdersCtrl"
                }).when("/about", {
                    templateUrl: "views/about.html"
                }).when("/hours", {
                    templateUrl: "views/hours.html"
                }).when("/security", {
                    templateUrl: "views/security.html"
                }).when("/calendar", {
                    templateUrl: i("views/calendarMain.html"),
                    controller: "CalendarMainCtrl",
                    resolve: {
                        Calendars: ["CalendarManager", function(e) {
                            return e.init()
                        }
                        ]
                    }
                }).when("/calendar/view/:viewSelector/:filterCalendarID/:requestedDate", {
                    templateUrl: i("views/calendarMain.html"),
                    controller: "CalendarMainCtrl",
                    resolve: {
                        Calendars: ["CalendarManager", function(e) {
                            return e.init()
                        }
                        ]
                    }
                }).when("/calendar/view/:viewSelector/alias/:filterCalendarAlias/:requestedDate", {
                    templateUrl: i("views/calendarMain.html"),
                    controller: "CalendarMainCtrl",
                    resolve: {
                        Calendars: ["CalendarManager", function(e) {
                            return e.init()
                        }
                        ]
                    }
                }).when("/calendar/event/:calendarID/:eventID", {
                    templateUrl: i("views/calendarEvent.html"),
                    controller: "EventCtrl"
                }).when("/helpAndFeedback", {
                    template: "<help-and-feedback></help-and-feedback>"
                }).when("/captcha", {
                    templateUrl: "views/captcha.html",
                    controller: "CaptchaCtrl"
                }),
                    a.resourceUrlWhitelist(["self", "https://www3.moneris.com/HPPDP/index.php**", "https://esqa.moneris.com/HPPDP/index.php**"])
            }
            ])
    }(),
    angular.module("acornApp").constant("PageSlideConstants", {
        NOTIFICATION_STATUS_UPDATE_EVENT: "event.notification.sidepanel.status.updated",
        NOTIFICATION_READ_STATUS_WILL_UPDATE_EVENT: "event.notification.sidepanel.status.updating.read",
        NOTIFICATION_READ_STATUS_UPDATED_EVENT: "event.notification.sidepanel.readStatus.updated.read",
        NOTIFICATION_DELAY_TO_IGNORE_NOTIFICATION_READ_STATUS_UPDATE: 1500
    }).constant("acornCorePropertyConstants", {
        COOKIE_PROPERTIES: {
            SESSION_COOKIE_NAME: "acornSettings"
        }
    }).constant("acornInterceptorConstants", {
        IDP_REDIRECT_REG_EX: /<form[^<>]+action="\/idp\/Authn\/UserPassword"/gi,
        UNAUTHORIZED_HTTP_STATUS: 401,
        API_LIMIT_REACHED_STATUS: 429,
        EVENT_INACTIVITY_TIMEOUT: "event:inactivity-timeout",
        INACTIVITY_TIMEOUT_INTERVAL: 12e5,
        INACTIVITY_DELTA: 5e3
    }).constant("notificationConstants", {
        MARKED_AS_READ: "notificationMarkedAsRead",
        HIGH_PRIORITY_NOTIFICATIONS_READ_EVENT: "highPriorityNotificationsReadEvent",
        NOTIFICATIONS_LOADED_EVENT: "notificationLoadedEvent",
        PRIORITY: {
            SEVERE: "SEVERE",
            HIGH: "HIGH",
            MEDIUM: "MEDIUM",
            LOW: "LOW"
        },
        TYPE: {
            SUCCESS: 1,
            ERROR: 2,
            INFO: 3
        },
        TRUNCATE_CHARACTER_LENGTH: 300,
        COLLAPSE_MINIMUM_NOTIFICATIONS: 1
    }).constant("NotificationViewConstants", {
        NOTIFICATION_VIEW_STATUS_UPDATE_EVENT: "event.notification.view.status.updated",
        NOTIFICATION_VIEW_READ_STATUS_WILL_UPDATE_EVENT: "event.notification.view.status.updating.read",
        NOTIFICATION_VIEW_READ_STATUS_UPDATED_EVENT: "event.notification.view.readStatus.updated.read",
        NOTIFICATION_VIEW_DELAY_TO_IGNORE_NOTIFICATION_READ_STATUS_UPDATE: 1500
    }).constant("dashboardAppConstants", {
        REDIRECT: "/sws",
        TIMEOUT_MSG: "Session Time Out. You are going to be redirected to the login page.",
        UNAUTHORIZED_HTTP_STATUS: 401,
        WIDGETS: {
            IDS: {
                CALENDAR_TODAY: 1,
                CALENDAR_UPCOMING: 2,
                ENROL_AND_MANAGE: 3,
                PLAN_AND_EXPLORE: 4,
                ACADEMIC: 5,
                FINANCE: 6,
                STUDENT_LIFE: 7
            },
            STUDENT_LIFE: {
                CAROUSEL_IDS: {
                    EVENTS: "events",
                    CCR: "ccr",
                    OMBUD: "ombud",
                    CLN: "cln",
                    ACCESS: "access"
                }
            }
        }
    }).constant("utConfirmationConstants", {
        TYPE: {
            DEFAULT: 0,
            INFO: 1,
            WARN: 2
        }
    }).constant("accessibilityConstants", {
        TABKEY: 9,
        FOCUSABLE_ELEMENTS: "a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"
    }).constant("uiCalendarConfig", {}).constant("uiCalendarConstants", {
        CALENDAR_PARENT_DOM_CONTAINER_ID: "#calendar-main-content",
        CALENDAR_PARENT_DOM_CONTAINER_HEIGHT: 884,
        CALENDAR_PARENT_DOM_CONTAINER_WIDTH: 100,
        CALENDAR_FULLCAL_HEIGHT: 765,
        CALENDAR_FULLCAL_WIDTH: 765,
        CALENDAR_FULLCAL_CONTAINER_Z_INDEX: 8,
        CALENDAR_HEADER_DOM_CLASS: ".fc-header",
        CALENDAR_BODY_CONTAINER_ID: "#calendar-body",
        CALENDAR_LIST_BODY_CONTAINER_ID: "#calendar-list-body",
        CALENDAR_LIST_OVERFLOW_CONTAINER_ID: "#list-event-view",
        CALENDAR_LIST_OVERFLOW_CONTAINER_HEIGHT: 734,
        CALENDAR_DEFAULT_EVENT_CLASSES: ["ngsis-event", "animated", "bounceIn"],
        CALENDAR_DEFAULT_EVENT_COURSES_CLASSES: ["courses1", "courses2", "courses3", "courses4", "courses5", "courses6"],
        CALENDAR_LIST_CIRC_POSTFIX_CLASS: "-circ-calendar-list",
        CALENDAR_EVENT_CLASS: ".fc-event",
        NODE_COMPILED_CLASS: "event-compiled",
        CALENDAR_DATE_PICKER_ID: "#cal-date-picker",
        CALENDAR_HEADER_LEFT: "td.fc-header-left",
        HEADER_MY_EVENTS: "My Events",
        CALENDAR_MIN_TIME: 7,
        CALENDAR_MAX_TIME: 23
    }).constant("appCalendarDefines", {
        CALENDAR_USER_INFO_URL: "/sws/p/ajax/get-user-id.action",
        CALENDAR_GET_LIST_URL: "/sws/rest/calendar/users/:userID/calendarList",
        CALENDAR_EVENT_LIST_URL: "/sws/rest/calendars/:calendarID/events",
        CALENDAR_ICAL_FILE_DOWNLOAD_URL: "/sws/rest/calendars/:calendarID/iCalEvents.ics",
        COURSES_ICAL_FILE_DOWNLOAD_URL: "/sws/rest/calendars/1/export-iCalEvents",
        JSON_STRING_DELIMITER_REG_EX: /\s*-\s*Room:\s*/i,
        REQUEST_DATE_REG_EX: /\d{4}-\d{1,2}-\d{1,2}/,
        CALENDAR_VIEW_WILL_CHANGE_EVENT: "calendar.event.willchange",
        CALENDAR_VIEW_CHANGED_EVENT: "calendar.event.didchange",
        CALENDAR_VIEW_EVENT_POPOVER_CLOSED: "calendar.event.popover.closed",
        CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL: "calendar.event.popover.closeall",
        CALENDAR_VIEW_EVENT_POPOVER_OPENED: "calendar.event.popover.opened",
        CALENDAR_VIEW_EVENT_CALENDAR_EVENT_REFRESH: "calendar.event.refresh.events",
        CALENDAR_CURRENT_DATE_CHANGE_EVENT: "calendar.event.currentdate.changed",
        CALENDAR_LOADED_EVENT: "calendar.event.initialized",
        CALENDAR_ONLOAD_FILTERED_EVENT: "calendar.event.initialized.filtered",
        CALENDAR_ERROR_EVENT: "calendar.event.error_occurred",
        CALENDAR_AGENDA_DAY_VIEW: "agendaDay",
        CALENDAR_AGENDA_WEEK_VIEW: "agendaWeek",
        CALENDAR_AGENDA_MONTH_VIEW: "month",
        CALENDAR_LIST_VIEW: "list",
        CALENDAR_DEFAULT_VIEW: "agendaWeek",
        CALENDAR_ENGLISH_VIEW_MAP: {
            agendaDay: "Day",
            agendaWeek: "Week",
            month: "Month",
            list: "List"
        },
        CALENDAR_DEFAULT_MINUTES_PER_SLOT: 30,
        CALENDAR_DEFAULT_CALENDAR_HEIGHT_SCALE: 3.45,
        CALENDAR_DEFAULT_KEEP_ALIVE_PING_INTERVAL: 3,
        CALENDAR_DEFAULT_KEEP_ALIVE_PING_RETRIES: 10,
        CALENDAR_DEFAULT_KEEP_ALIVE_PING_URL: "/sws/p/ajax/get-user-id.action",
        CALENDAR_SAFE_APPLY: function(e, t) {
            e.$$phase || e.$root.$$phase ? t() : e.$apply(t)
        },
        IE_BROWSER: function() {
            var e = {
                isIE: !1,
                version: 0
            };
            return /MSIE\s*(\d+\.\d+);/i.test(navigator.userAgent) && (e.isIE = !0,
                e.version = RegExp.$1),
                e
        }(),
        CALENDAR_EVENT_PRIORITY_DEFAULT: "default_priority",
        CALENDAR_EVENT_PRIORITY_CRITICAL: "critical_priority"
    }).constant("transcriptConfig", {
        price: 12,
        dateFrom10to12: "2014-05-01",
        priceBeforeMay1st2014: 10
    }).constant("transcriptConstants", {
        SERVER_POSTAL_ERROR: "Destination Postal-State Mismatch.",
        POSTAL_ERROR_REVISED: "The Postal/Zip code you entered does not match the Province/State you selected."
    }).constant("enrolmentInfoConstant", {
        BEFORE_MA_DATE: 1,
        AFTER_MA_DATE: 2,
        BEFORE_M07_DATE: 3,
        AFTER_M07_DATE: 4,
        DATE_NOT_FOUND: 6380,
        NOT_ALLOWED: 6703,
        MA_ERROR: 6708,
        M07_ERROR: 6709,
        PLAN_MAX_COUNT: 30
    }).constant("enrolmentManagerConstants", {
        SESSION_MAPPER: {
            1: "Winter",
            5: "Summer",
            9: "Fall"
        }
    }).constant("internationalStudentsConstants", {
        UTSC_PRIMARY_ORG_CD: "ERIN",
        SCAR_PRIMARY_ORG_CD: "SCAR",
        UTSC: {
            text: "International Education Centre",
            url: "http://www.utm.utoronto.ca/international/"
        },
        SCAR: {
            text: "International Student Centre",
            url: "http://www.utsc.utoronto.ca/studentlife/international-student-centre/"
        },
        NON_UTSC_OR_SCAR: {
            text: "Centre for International Experience",
            url: "https://www.studentlife.utoronto.ca/cie/"
        }
    }).constant("accountBalanceConstants", {
        INDICATOR_NO_CREDIT: 0,
        INDICATOR_CREDIT: 1
    }).constant("scrollToConstants", {
        MAIN: "main",
        SIDE_NAVIGATION: "side-navigation",
        TYPE_AHEAD: "typeahead",
        ELEMENT: "element",
        CUSTOM: "custom"
    }).constant("keyCodes", {
        ENTER: 13,
        ESCAPE: 27,
        UP: 38,
        DOWN: 40
    }).constant("viewportConstants", {
        INVISIBLE: 0,
        PARTIALLY_VISIBLE: 1,
        VISIBLE: 2
    }).constant("feePaymentConstants", {
        MIN_CC_FEE_PAYMENT: .01,
        SERVICE_FEE_PERCENTAGE: 1.75,
        COUNTRY: {
            CANADA: "80021",
            USA: "66721"
        },
        CC_FEE_PAYMENT_TRANSACTION_CODE: "30400400",
        TRANSACTION_STATUS: {
            APPROVED: 1,
            DECLINED: 0,
            CANCELED: 3,
            INCOMPLETE: 4
        },
        MERCHANT_NAME: "University of Toronto",
        MAX_MONERIS_RESPONSE_SERVER_CHECKS: 60,
        MONERIS_PARAMS_NAMES: {
            BILL_FIRST_NAME: "bill_first_name",
            BILL_LAST_NAME: "bill_last_name",
            BILL_ADDRESS_ONE: "bill_address_one",
            BILL_CITY: "bill_city",
            BILL_STATE_OR_PROVINCE: "bill_state_or_province",
            BILL_POSTAL_CODE: "bill_postal_code",
            BILL_COUNTRY: "bill_country",
            BILL_EMAIL: "email",
            TOTAL_CHARGE: "charge_total"
        },
        CANNOT_MAKE_PAYMENT: "You cannot make a payment",
        TOAST_PAYMENT_SUCCESS: "Your credit card charge of ${0} was processed successfully by Moneris.",
        TOAST_PAYMENT_FAILURE: "Your credit card charge of ${0} was declined by Moneris. See the transaction receipt on this page for more details.",
        TOAST_NO_RECEIPT_DATA: "There is no receipt information available for this transaction.  Please contact Student Accounts for more information.",
        TOAST_RESPONSE_PROCESSING_ERROR: "An error has occurred while processing your credit card payment response.",
        TOAST_GENERAL_ERROR: "An error has occurred.",
        TOAST_PAYMENT_CANCELLED: "You cancelled your credit card fee payment.",
        TOAST_PAYMENT_INCOMPLETE: "An error has occurred while processing your credit card payment response.",
        TOOLTIP_MAXIMUM_PAYMENT: "You cannot make a payment that exceeds the sum of Current Balance and your Deposit for the upcoming Session.",
        TOOLTIP_SERVICE_FEE: "The Convenience Fee covers the costs associated with processing online credit card payments.",
        REGEX_EMAIL: "^.+@(utoronto.ca|.+\\.utoronto.ca|toronto.edu|utoronto.edu)$",
        SERVICE_FEE_INITIAL_MSG: "Enter payment amount to calculate convenience fee",
        TOTAL_CHARGE_INITIAL_MSG: "Enter payment amount to calculate total charge",
        VALIDATION_EMAIL_MSG: "Please enter a valid Email",
        VALIDATION_PAYMENT_AMOUNT_MSG: "Please enter a number with maximum 2 decimal points greater than $0.00 and less than or equal to your maximum payment amount of  ${0}",
        VALIDATION_PAYMENT_MIN_AMOUNT_MSG: "You have to pay at least the minumum amount {0}",
        VALIDATION_PAYMENT_MAX_AMOUNT_MSG: "You cannot pay more than the max amount {0}",
        VALIDATION_REQUIRED_MSG: "Please enter {0}",
        VALIDATION_POSTAL_ZIP_CODE_MSG: "{0} is invalid",
        CLOSURE_NUMBER_OF_DAYS_BEFORE: 6,
        CLOSURE_NUMBER_OF_DAYS_AFTER: 3
    }).constant("screenSizeConstants", {
        EXTRA_SMALL: 479,
        SMALL: 767,
        MEDIUM: 991,
        LARGE: 1199,
        EXTRA_LARGE: 1200
    }).constant("eventConstants", {
        TOGGLE_NAVIGATION: "toggleNavigation",
        TOOLTIP_INIT: "utTooltipInit",
        RESPONSIVE_RESIZE_EVENT: "responsiveResizeEvent"
    }).constant("navClassConstants", {
        NAV_TABS: "nav-tabs",
        NAV_HORIZONTAL: "nav-horizontal",
        NAV_VERTICAL: "nav-vertical"
    }).constant("repeatNotificationEvents", {
        REPEAT_DAYS: "repeat.days",
        REPEAT_LOCATIONS: "repeat.locations"
    }).constant("programTooltipConstants", {
        INV: "The department has offered you admission (or given you an invitation) to the program.",
        REF: "The department has refused your admission to the program.",
        REQ: "You have applied for admission to the program."
    }).constant("tooltipDomConstants", {
        UT_TOOLTIP_DIRECTIVE: "ut-tooltip",
        UT_TOOLTIP_TAB_DIRECTIVE: "data-ut-no-tooltip-tab-index",
        UT_TOOLTIP_CSS_CLASS: "ut-tooltip"
    }).constant("timeConstants", {
        MS_IN_A_DAY: 864e5
    }).constant("enrolmentSpaceConstants", {
        ENROLLED_FULL: "Currently Enrolled (Full)",
        ENROLLED_SPACE_AVAILABLE: "Currently Enrolled <br/>({0} of {1} available)",
        AVAILABLE: "{0} of {1} available.",
        CANCELLED: "Section Cancelled",
        SECTION_FULL_NO_WAIT: "Section Full (Not Waitlistable)",
        SECTION_FULL: "Section Full",
        BLOCKED: "Enrolment Blocked",
        INDICATOR: "Enrolment Indicator: {0}"
    }).constant("grantAppConstants", {
        TOOLTIP_MARRIED_OR_COMMON_LAW: "Living together in a conjugal relationship for three years or more, or one year with a child",
        TOOLTIP_DEPENDANTS: "Reliant on your financial support",
        TOOLTIP_FIRST_IN_FAMILY_ONT_RESIDENTS: "You or your parent(s) have lived in Ontario for at least the last 12 months in a row, or all the following are true: You now live in Ontario, you've lived in Canada for less than 12 months in a row, your parent(s) have lived in Canada for less than 12 months in a row.",
        TOOLTIP_FIRST_IN_FAMILY: "Your parent(s) have never attended university on either a full-time or part-time basis anywhere in the world.",
        TOOLTIP_FAMILY_INCOME: "Annual income after taxes and deductions (line 236 of the T1 tax form)",
        TOOLTIP_OTHER_DEPENDANTS: "Reliant on the financial support of others in your family",
        TOOLTIP_GOVERNMENT_FIN_ASSISTANCE: "E.g. OSAP for Ontario residents, SABC for British Columbia residents, AFE for Quebec residents, etc.",
        TOOLTIP_NET_MONTHLY_INCOME: "Income after taxes and deductions",
        TOOLTIP_AWARDS: "E.g. UTAPS, scholarships, bursaries, grants, fellowships, supervisory stipend",
        TOOLTIP_FAMILY_FINANCIAL_SUPPORT: "E.g. cash, Registered Education Savings Plan (RESP)",
        TOOLTIP_OTHER_INCOME: "E.g. orphan's benefits, ODSP",
        TOOLTIP_TEXTBOOKS: "E.g. lab fees, art material, etc.",
        TOOLTIP_COURSE_SUPPLIES: "E.g. hydro-electric, gas, cable, internet, telephone",
        TOOLTIP_DINING_OUT: "E.g. buying meals on/around campus",
        TOOLTIP_OTHER_TRANSP_ASSOCIATED_FEES: "E.g. parking, maintenance, etc.",
        GENERAL_FINANCAIL_COUNSELLING_LINK: "http://www.future.utoronto.ca/finances/financial-aid/financial-counsel",
        GENERAL_REGISTRARS_LINK: "http://future.utoronto.ca/current-students/registrars/",
        ORG_NO_ONLINE_SUBMISSION: "(not applicable for online submission)",
        TOAST_SAVE_AND_CONTINUE_MSG: 'System error; unable to save application: Please try again or contact your registrar to submit a paper-based <abbr title="University of Toronto">U of T</abbr> Grant application.',
        PARENTAL_AGE_LIMIT: 22,
        SELECT_AN_OPTION: "Please select an option.",
        SELECT_AMOUNT: "Please enter a dollar amount.",
        MIN_INCOME: 3e3,
        TRANSIT_EXPENSES: 1e3,
        TRANSIT_OPTION_INDEX: 3,
        SGS_ORG: "SGS",
        STEP_1: 1,
        STEP_2: 2,
        STEP_3: 3,
        STEP_4: 4,
        STEP_5: 5,
        STEP_6: 6,
        STEP_7: 7
    }).constant("awardsConstants", {
        NO_UPCOMING_AWARD: 'You currently have no upcoming award payments. Visit the <a href="#/awards/findAwards">Find Awards page</a> to find awards you may be eligible for.',
        NO_AWARDS: 'You have not received any awards yet. Visit the <a href="#/awards/findAwards">Find Awards page</a> to find awards you may be eligible for.',
        UPCOMING_AWARDS_LIMIT: 3,
        NOT_AVAILABLE: "N.A.",
        MY_AWARDS_TAB: "myAwards",
        FIND_AWARDS_TAB: "findAwards",
        AWARD_TYPE_UPCOMING: "Upcoming",
        AWARD_TYPE_RECEIVED: "Received",
        AWARD_TYPE_CANCELLED: "Cancelled",
        PAYMENT_BY_CHEQUE: "Cheque",
        PAYMENT_BY_DIRECT_DEPOSIT: "Direct Deposit",
        PAYMENT_TO_STUDENT_ACCOUNT: "Student Account",
        YES: "Y",
        NO: "N",
        MINIMUM_PAYABLE_AMOUNT: 10,
        PART_TIME: "PT",
        FULL_TIME: "FT",
        UT_WIDE_AWARDS_FILE_NAME_PREFIX: "utWideAwards",
        ERIN: "ERIN",
        ARTSC: "ARTSC",
        ARCLA: "ARCLA",
        SCAR: "SCAR",
        SGS: "SGS",
        UTM: "UTM",
        UTSG: "UTSG",
        UTSC: "UTSC",
        TYP: "TYP",
        FINANCIAL_AID_ADVISING: "Financial Aid Advising",
        FINANCIAL_COUNSELLING: "Financial Counselling"
    }).constant("timetableGraphicConstants", {
        NUMBER_OF_COLUMNS: 5,
        TIME_OF_DAY_COLUMN_WIDTH: 50,
        ALTERNATING_WEEK_TEXT: "* This section occurs on alternating weeks",
        TIME_OF_DAY: "timeOfDay",
        EMPTY_SLOT: "emptySlot",
        DAY_OF_WEEK: "dayOfWeek",
        MAX_COURSE_TITLE_CHARACTERS: 7
    }).constant("graduationConstants", {
        GRADUATION_REQUEST_NOT_REQUIRED: 7003,
        GRADUATION_RECORD_NOT_CREATED: 6804,
        GRADUATION_REQUEST_REQUIRED: 8026,
        GRADUATION_REQUEST_NOT_REQUIRED_STR: "Graduation request not required",
        GRADUATION_RECORD_NOT_CREATED_STR: "Graduation request not created",
        GRADUATION_REQUEST_REQUIRED_STR: "Graduation request Required",
        GRADUATION_REQUEST_NOT_REQUIRED_MSG: "7003: Graduation request is not required.",
        GRADUATION_RECORD_NOT_CREATED_MSG: "6804: Faculty has not created the graduation.",
        GRADUATION_REQUEST_REQUIRED_MSG: "8026 : Graduation requests displayed successfully.",
        GRADUATION_DATE_PASSED: "P",
        GRADUATION_DATE_FUTURE: "F",
        GRADUATION_DATE_CURRENT: "C",
        TICKET_GALLERIE_SEATING: "B",
        TICKET_GALLERIE_SEATING_STR: "Gallery",
        TICKET_RESERVED_SEATING: "F",
        TICKET_RESERVED_SEATING_STR: "Reserved Accessible",
        RESPONSE_YES: "Y",
        RESPONSE_NO: "N",
        RESPONSE_UNDECIDED: ""
    }).constant("acornToastConstants", {
        POSITION_TOP: "top",
        POSITION_BOTTOM: "bottom",
        POSITION_LEFT: "left",
        POSITION_RIGHT: "right",
        TYPE_WARNING: "warning",
        TYPE_INFO: "info",
        TYPE_SUCCESS: "success",
        TYPE_DANGER: "danger",
        REMOVE_UPLOADED_FILES: "remove-files"
    }).constant("utPeakLoadModeConstants", {
        ACTION_REMOVE_ELEMENT: "remove-element",
        ACTION_REMOVE_ACTIONS: "remove-actions",
        ACTION_REPLACE_ELEMENT: "replace-element",
        ACTION_REPLACE_CONTENT: "replace-content",
        ACTION_REPLACE_WRAPPER: "replace-wrapper"
    }).constant("confirmationOfEnrolmentConstants", {
        CURRENT_SESSION: "current",
        UPCOMING_SESSION: "upcoming",
        ARTSC_CONTENT: 'One or more faculties you are associated with do not provide a Confirmation of Enrolment letter via ACORN. Please <a href="http://www.future.utoronto.ca/current-students/registrars" target="_blank">contact your registrar<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> to get a letter for degrees earned through other faculties.',
        NON_ARTSC_CONTENT: 'Your faculty does not provide a Confirmation of Enrolment letter via ACORN. Please <a href="http://www.future.utoronto.ca/current-students/registrars" target="_blank">contact your registrar<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> to get a Confirmation of Enrolment letter.'
    }).constant("registrarLinkConstants", {
        GENERIC: "http://www.future.utoronto.ca/current-students/registrars",
        ARTSC: {
            INNIS: "http://innis.utoronto.ca/current-students/academic/innis/registrar/",
            NEW: "http://www.newcollege.utoronto.ca/current-students/scholarships-and-financial-aid/financial-planning-and-counselling/",
            SMC: "https://stmikes.utoronto.ca/students/registrar/",
            TRIN: "http://www.trinity.utoronto.ca/student-services/offices/registrars-office.html",
            UC: "http://www.uc.utoronto.ca/advising",
            VIC: "http://www.vic.utoronto.ca/students/Office_of_the_Registrar/Academic_Advising.htm",
            WDW: "http://www.wdw.utoronto.ca/index.php/current_students/registrar"
        },
        APSC: "http://www.undergrad.engineering.utoronto.ca/Advising_Support/Financial_Aid.htm",
        ARCLA: "https://daniels.utoronto.ca/students/undergraduate-students/support-and-services/office-registrar-and-student-services",
        DENT: "https://www.dentistry.utoronto.ca/departments/student-services",
        ERIN: "https://www.utm.utoronto.ca/registrar/financial-aid-resources/financial-aid-advising",
        FOR: "http://forestry.utoronto.ca/contact-us/",
        FPEH: "http://www.physical.utoronto.ca/Undergraduate/ContactUs.aspx",
        MED: "http://www.md.utoronto.ca/finances-awards",
        MGT: "http://rotmancommerce.utoronto.ca/contact/",
        MUSIC: "https://music.utoronto.ca/student-services-resources.php",
        NURS: "https://bloomberg.nursing.utoronto.ca/current-students/academic-contact",
        OISUT: "http://www.oise.utoronto.ca/oise/Contacts/",
        SCAR: "http://www.utsc.utoronto.ca/registrar/financial-aid-advisors",
        SGS: "https://www.sgs.utoronto.ca/currentstudents/Pages/Financial-Aid-and-Counselling.aspx",
        PHM: "http://www.pharmacy.utoronto.ca/pharmd/office-registrar",
        LAW: "http://www.law.utoronto.ca/academic-programs/jd-program/financial-aid-and-fees",
        TST: "http://www.tst.edu/contact/directory/college-registrars-admissions-staff",
        WDW: "http://wdw.utoronto.ca/index.php/current_students/registrar",
        TYP: "http://sites.utoronto.ca/typ/contact.html"
    }).constant("helpAndFeedbackConstants", {
        TAB_HEADING_EMAIL_HELP: "Email Help",
        TAB_SUB_HEADING_EMAIL_HELP: "Academic &amp; Financial Issues",
        TAB_HEADING_LIVE_SCREEN: "Live Screen Share Help",
        TAB_SUB_HEADING_LIVE_SCREEN: "Academic &amp; Financial Issues",
        TAB_HEADING_SEND_FEEDBACK: "ACORN Feedback",
        TAB_SUB_HEADING_SEND_FEEDBACK: "Feature Requests &amp; Comments",
        SCREEN_SHARE_ORG_AVAILABILITY: []
    }),
    angular.module("acornApp").filter("acornCurrency", ["$filter", function(e) {
        return function(t, n) {
            if (angular.isUndefined(t))
                return "$0.00";
            if (angular.isNumber(t)) {
                return e("currency")(t, n).replace("(", "-").replace(")", "")
            }
            throw new Error(t + " amount is not a number")
        }
    }
    ]).filter("rounding", ["rounding", function(e) {
        return function(t) {
            if (t) {
                return e.round(t, 2).toFixed(2)
            }
            return "0.00"
        }
    }
    ]).filter("capitalize", ["screenSizeQuery", function(e) {
        return function(t, n) {
            return n = "true" === n || n === !0,
                !n || e.isSmall() ? t ? t.replace(/([^\W_]+[^\s-]*) */g, function(e) {
                    return e.charAt(0).toUpperCase() + e.substr(1).toLowerCase()
                }) : "" : t
        }
    }
    ]).filter("currencyAppendCRtoPositive", ["$filter", function(e) {
        return function(t) {
            var n = t <= 0 ? " " : " CR";
            return e("acornCurrency")(Math.abs(t)) + n
        }
    }
    ]).filter("currencyAppendCRtoNegative", ["$filter", function(e) {
        return function(t) {
            var n = t < 0 ? " CR" : " ";
            return e("acornCurrency")(Math.abs(t)) + n
        }
    }
    ]).filter("utTimeAgo", function() {
        return function(e) {
            var t = function(e, t) {
                return e.replace(/%d/i, t)
            }
                , n = {
                seconds: "Less than a minute",
                minute: "About a minute",
                minutes: "%d minutes",
                hour: "About an hour",
                hours: "About %d hours",
                day: "A day",
                days: "%d days",
                month: "About a month",
                months: "%d months",
                year: "About a year",
                years: "%d years"
            }
                , r = (new Date).getTime()
                , a = new Date(e).getTime()
                , i = r - a
                , o = Math.abs(i) / 1e3
                , s = o / 60
                , c = s / 60
                , l = c / 24
                , u = l / 365;
            return (o < 45 && n.seconds || o < 90 && n.minute || s < 45 && t(n.minutes, Math.round(s)) || s < 90 && n.hour || c < 24 && t(n.hours, Math.round(c)) || c < 42 && n.day || l < 30 && t(n.days, Math.round(l)) || l < 45 && n.month || l < 365 && t(n.months, Math.round(l / 30)) || u < 1.5 && n.year || t(n.years, Math.round(u))) + " ago"
        }
    }).filter("utResponsiveLimitTo", ["screenSizeQuery", function(e) {
        return function(t, n) {
            var r = t;
            return t && t.length > n && e.isSmall() && (r = t.substring(0, n)),
                r
        }
    }
    ]).filter("unique", function() {
        return function(e, t) {
            var n = []
                , r = [];
            return angular.forEach(e, function(e) {
                var a = e[t];
                r.indexOf(a) === -1 && (r.push(a),
                    n.push(e))
            }),
                n
        }
    }),
    function(e) {
        "function" == typeof define && define.amd ? define(["jquery"], e) : e(jQuery)
    }(function(e) {
        function t(t, r) {
            var a, i, o, s = t.nodeName.toLowerCase();
            return "area" === s ? (a = t.parentNode,
                i = a.name,
            !(!t.href || !i || "map" !== a.nodeName.toLowerCase()) && (!!(o = e("img[usemap='#" + i + "']")[0]) && n(o))) : (/input|select|textarea|button|object/.test(s) ? !t.disabled : "a" === s ? t.href || r : r) && n(t)
        }
        function n(t) {
            return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
                    return "hidden" === e.css(this, "visibility")
                }).length
        }
        function r(e) {
            for (var t, n; e.length && e[0] !== document; ) {
                if (("absolute" === (t = e.css("position")) || "relative" === t || "fixed" === t) && (n = parseInt(e.css("zIndex"), 10),
                    !isNaN(n) && 0 !== n))
                    return n;
                e = e.parent()
            }
            return 0
        }
        function a() {
            this._curInst = null,
                this._keyEvent = !1,
                this._disabledInputs = [],
                this._datepickerShowing = !1,
                this._inDialog = !1,
                this._mainDivId = "ui-datepicker-div",
                this._inlineClass = "ui-datepicker-inline",
                this._appendClass = "ui-datepicker-append",
                this._triggerClass = "ui-datepicker-trigger",
                this._dialogClass = "ui-datepicker-dialog",
                this._disableClass = "ui-datepicker-disabled",
                this._unselectableClass = "ui-datepicker-unselectable",
                this._currentClass = "ui-datepicker-current-day",
                this._dayOverClass = "ui-datepicker-days-cell-over",
                this.regional = [],
                this.regional[""] = {
                    closeText: "Done",
                    prevText: "Prev",
                    nextText: "Next",
                    currentText: "Today",
                    monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                    monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                    dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                    dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                    dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
                    weekHeader: "Wk",
                    dateFormat: "mm/dd/yy",
                    firstDay: 0,
                    isRTL: !1,
                    showMonthAfterYear: !1,
                    yearSuffix: ""
                },
                this._defaults = {
                    showOn: "focus",
                    showAnim: "fadeIn",
                    showOptions: {},
                    defaultDate: null,
                    appendText: "",
                    buttonText: "...",
                    buttonImage: "",
                    buttonImageOnly: !1,
                    hideIfNoPrevNext: !1,
                    navigationAsDateFormat: !1,
                    gotoCurrent: !1,
                    changeMonth: !1,
                    changeYear: !1,
                    yearRange: "c-10:c+10",
                    showOtherMonths: !1,
                    selectOtherMonths: !1,
                    showWeek: !1,
                    calculateWeek: this.iso8601Week,
                    shortYearCutoff: "+10",
                    minDate: null,
                    maxDate: null,
                    duration: "fast",
                    beforeShowDay: null,
                    beforeShow: null,
                    onSelect: null,
                    onChangeMonthYear: null,
                    onClose: null,
                    numberOfMonths: 1,
                    showCurrentAtPos: 0,
                    stepMonths: 1,
                    stepBigMonths: 12,
                    altField: "",
                    altFormat: "",
                    constrainInput: !0,
                    showButtonPanel: !1,
                    autoSize: !1,
                    disabled: !1
                },
                e.extend(this._defaults, this.regional[""]),
                this.regional.en = e.extend(!0, {}, this.regional[""]),
                this.regional["en-US"] = e.extend(!0, {}, this.regional.en),
                this.dpDiv = i(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
        }
        function i(t) {
            var n = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
            return t.delegate(n, "mouseout", function() {
                e(this).removeClass("ui-state-hover"),
                this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).removeClass("ui-datepicker-prev-hover"),
                this.className.indexOf("ui-datepicker-next") !== -1 && e(this).removeClass("ui-datepicker-next-hover")
            }).delegate(n, "mouseover", o)
        }
        function o() {
            e.datepicker._isDisabledDatepicker(c.inline ? c.dpDiv.parent()[0] : c.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
                e(this).addClass("ui-state-hover"),
            this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).addClass("ui-datepicker-prev-hover"),
            this.className.indexOf("ui-datepicker-next") !== -1 && e(this).addClass("ui-datepicker-next-hover"))
        }
        function s(t, n) {
            e.extend(t, n);
            for (var r in n)
                null == n[r] && (t[r] = n[r]);
            return t
        }
        e.ui = e.ui || {},
            e.extend(e.ui, {
                version: "1.11.2",
                keyCode: {
                    BACKSPACE: 8,
                    COMMA: 188,
                    DELETE: 46,
                    DOWN: 40,
                    END: 35,
                    ENTER: 13,
                    ESCAPE: 27,
                    HOME: 36,
                    LEFT: 37,
                    PAGE_DOWN: 34,
                    PAGE_UP: 33,
                    PERIOD: 190,
                    RIGHT: 39,
                    SPACE: 32,
                    TAB: 9,
                    UP: 38
                }
            }),
            e.fn.extend({
                scrollParent: function(t) {
                    var n = this.css("position")
                        , r = "absolute" === n
                        , a = t ? /(auto|scroll|hidden)/ : /(auto|scroll)/
                        , i = this.parents().filter(function() {
                        var t = e(this);
                        return (!r || "static" !== t.css("position")) && a.test(t.css("overflow") + t.css("overflow-y") + t.css("overflow-x"))
                    }).eq(0);
                    return "fixed" !== n && i.length ? i : e(this[0].ownerDocument || document)
                },
                uniqueId: function() {
                    var e = 0;
                    return function() {
                        return this.each(function() {
                            this.id || (this.id = "ui-id-" + ++e)
                        })
                    }
                }(),
                removeUniqueId: function() {
                    return this.each(function() {
                        /^ui-id-\d+$/.test(this.id) && e(this).removeAttr("id")
                    })
                }
            }),
            e.extend(e.expr[":"], {
                data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
                    return function(n) {
                        return !!e.data(n, t)
                    }
                }) : function(t, n, r) {
                    return !!e.data(t, r[3])
                }
                ,
                focusable: function(n) {
                    return t(n, !isNaN(e.attr(n, "tabindex")))
                },
                tabbable: function(n) {
                    var r = e.attr(n, "tabindex")
                        , a = isNaN(r);
                    return (a || r >= 0) && t(n, !a)
                }
            }),
        e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(t, n) {
            function r(t, n, r, i) {
                return e.each(a, function() {
                    n -= parseFloat(e.css(t, "padding" + this)) || 0,
                    r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0),
                    i && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
                }),
                    n
            }
            var a = "Width" === n ? ["Left", "Right"] : ["Top", "Bottom"]
                , i = n.toLowerCase()
                , o = {
                innerWidth: e.fn.innerWidth,
                innerHeight: e.fn.innerHeight,
                outerWidth: e.fn.outerWidth,
                outerHeight: e.fn.outerHeight
            };
            e.fn["inner" + n] = function(t) {
                return void 0 === t ? o["inner" + n].call(this) : this.each(function() {
                    e(this).css(i, r(this, t) + "px")
                })
            }
                ,
                e.fn["outer" + n] = function(t, a) {
                    return "number" != typeof t ? o["outer" + n].call(this, t) : this.each(function() {
                        e(this).css(i, r(this, t, !0, a) + "px")
                    })
                }
        }),
        e.fn.addBack || (e.fn.addBack = function(e) {
                return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
            }
        ),
        e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
            return function(n) {
                return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
            }
        }(e.fn.removeData)),
            e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),
            e.fn.extend({
                focus: function(t) {
                    return function(n, r) {
                        return "number" == typeof n ? this.each(function() {
                            var t = this;
                            setTimeout(function() {
                                e(t).focus(),
                                r && r.call(t)
                            }, n)
                        }) : t.apply(this, arguments)
                    }
                }(e.fn.focus),
                disableSelection: function() {
                    var e = "onselectstart"in document.createElement("div") ? "selectstart" : "mousedown";
                    return function() {
                        return this.bind(e + ".ui-disableSelection", function(e) {
                            e.preventDefault()
                        })
                    }
                }(),
                enableSelection: function() {
                    return this.unbind(".ui-disableSelection")
                },
                zIndex: function(t) {
                    if (void 0 !== t)
                        return this.css("zIndex", t);
                    if (this.length)
                        for (var n, r, a = e(this[0]); a.length && a[0] !== document; ) {
                            if (("absolute" === (n = a.css("position")) || "relative" === n || "fixed" === n) && (r = parseInt(a.css("zIndex"), 10),
                                !isNaN(r) && 0 !== r))
                                return r;
                            a = a.parent()
                        }
                    return 0
                }
            }),
            e.ui.plugin = {
                add: function(t, n, r) {
                    var a, i = e.ui[t].prototype;
                    for (a in r)
                        i.plugins[a] = i.plugins[a] || [],
                            i.plugins[a].push([n, r[a]])
                },
                call: function(e, t, n, r) {
                    var a, i = e.plugins[t];
                    if (i && (r || e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType))
                        for (a = 0; a < i.length; a++)
                            e.options[i[a][0]] && i[a][1].apply(e.element, n)
                }
            },
            e.extend(e.ui, {
                datepicker: {
                    version: "1.11.2"
                }
            });
        var c;
        e.extend(a.prototype, {
            markerClassName: "hasDatepicker",
            maxRows: 4,
            _widgetDatepicker: function() {
                return this.dpDiv
            },
            setDefaults: function(e) {
                return s(this._defaults, e || {}),
                    this
            },
            _attachDatepicker: function(t, n) {
                var r, a, i;
                r = t.nodeName.toLowerCase(),
                    a = "div" === r || "span" === r,
                t.id || (this.uuid += 1,
                    t.id = "dp" + this.uuid),
                    i = this._newInst(e(t), a),
                    i.settings = e.extend({}, n || {}),
                    "input" === r ? this._connectDatepicker(t, i) : a && this._inlineDatepicker(t, i)
            },
            _newInst: function(t, n) {
                return {
                    id: t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1"),
                    input: t,
                    selectedDay: 0,
                    selectedMonth: 0,
                    selectedYear: 0,
                    drawMonth: 0,
                    drawYear: 0,
                    inline: n,
                    dpDiv: n ? i(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
                }
            },
            _connectDatepicker: function(t, n) {
                var r = e(t);
                n.append = e([]),
                    n.trigger = e([]),
                r.hasClass(this.markerClassName) || (this._attachments(r, n),
                    r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),
                    this._autoSize(n),
                    e.data(t, "datepicker", n),
                n.settings.disabled && this._disableDatepicker(t))
            },
            _attachments: function(t, n) {
                var r, a, i, o = this._get(n, "appendText"), s = this._get(n, "isRTL");
                n.append && n.append.remove(),
                o && (n.append = e("<span class='" + this._appendClass + "'>" + o + "</span>"),
                    t[s ? "before" : "after"](n.append)),
                    t.unbind("focus", this._showDatepicker),
                n.trigger && n.trigger.remove(),
                    r = this._get(n, "showOn"),
                "focus" !== r && "both" !== r || t.focus(this._showDatepicker),
                "button" !== r && "both" !== r || (a = this._get(n, "buttonText"),
                    i = this._get(n, "buttonImage"),
                    n.trigger = e(this._get(n, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({
                        src: i,
                        alt: a,
                        title: a
                    }) : e("<button type='button'></button>").addClass(this._triggerClass).html(i ? e("<img/>").attr({
                        src: i,
                        alt: a,
                        title: a
                    }) : a)),
                    t[s ? "before" : "after"](n.trigger),
                    n.trigger.click(function() {
                        return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(),
                            e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]),
                            !1
                    }))
            },
            _autoSize: function(e) {
                if (this._get(e, "autoSize") && !e.inline) {
                    var t, n, r, a, i = new Date(2009,11,20), o = this._get(e, "dateFormat");
                    o.match(/[DM]/) && (t = function(e) {
                        for (n = 0,
                                 r = 0,
                                 a = 0; a < e.length; a++)
                            e[a].length > n && (n = e[a].length,
                                r = a);
                        return r
                    }
                        ,
                        i.setMonth(t(this._get(e, o.match(/MM/) ? "monthNames" : "monthNamesShort"))),
                        i.setDate(t(this._get(e, o.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - i.getDay())),
                        e.input.attr("size", this._formatDate(e, i).length)
                }
            },
            _inlineDatepicker: function(t, n) {
                var r = e(t);
                r.hasClass(this.markerClassName) || (r.addClass(this.markerClassName).append(n.dpDiv),
                    e.data(t, "datepicker", n),
                    this._setDate(n, this._getDefaultDate(n), !0),
                    this._updateDatepicker(n),
                    this._updateAlternate(n),
                n.settings.disabled && this._disableDatepicker(t),
                    n.dpDiv.css("display", "block"))
            },
            _dialogDatepicker: function(t, n, r, a, i) {
                var o, c, l, u, d, p = this._dialogInst;
                return p || (this.uuid += 1,
                    o = "dp" + this.uuid,
                    this._dialogInput = e("<input type='text' id='" + o + "' style='position: absolute; top: -100px; width: 0px;'/>"),
                    this._dialogInput.keydown(this._doKeyDown),
                    e("body").append(this._dialogInput),
                    p = this._dialogInst = this._newInst(this._dialogInput, !1),
                    p.settings = {},
                    e.data(this._dialogInput[0], "datepicker", p)),
                    s(p.settings, a || {}),
                    n = n && n.constructor === Date ? this._formatDate(p, n) : n,
                    this._dialogInput.val(n),
                    this._pos = i ? i.length ? i : [i.pageX, i.pageY] : null,
                this._pos || (c = document.documentElement.clientWidth,
                    l = document.documentElement.clientHeight,
                    u = document.documentElement.scrollLeft || document.body.scrollLeft,
                    d = document.documentElement.scrollTop || document.body.scrollTop,
                    this._pos = [c / 2 - 100 + u, l / 2 - 150 + d]),
                    this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"),
                    p.settings.onSelect = r,
                    this._inDialog = !0,
                    this.dpDiv.addClass(this._dialogClass),
                    this._showDatepicker(this._dialogInput[0]),
                e.blockUI && e.blockUI(this.dpDiv),
                    e.data(this._dialogInput[0], "datepicker", p),
                    this
            },
            _destroyDatepicker: function(t) {
                var n, r = e(t), a = e.data(t, "datepicker");
                r.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(),
                    e.removeData(t, "datepicker"),
                    "input" === n ? (a.append.remove(),
                        a.trigger.remove(),
                        r.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : "div" !== n && "span" !== n || r.removeClass(this.markerClassName).empty())
            },
            _enableDatepicker: function(t) {
                var n, r, a = e(t), i = e.data(t, "datepicker");
                a.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(),
                    "input" === n ? (t.disabled = !1,
                        i.trigger.filter("button").each(function() {
                            this.disabled = !1
                        }).end().filter("img").css({
                            opacity: "1.0",
                            cursor: ""
                        })) : "div" !== n && "span" !== n || (r = a.children("." + this._inlineClass),
                        r.children().removeClass("ui-state-disabled"),
                        r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)),
                    this._disabledInputs = e.map(this._disabledInputs, function(e) {
                        return e === t ? null : e
                    }))
            },
            _disableDatepicker: function(t) {
                var n, r, a = e(t), i = e.data(t, "datepicker");
                a.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(),
                    "input" === n ? (t.disabled = !0,
                        i.trigger.filter("button").each(function() {
                            this.disabled = !0
                        }).end().filter("img").css({
                            opacity: "0.5",
                            cursor: "default"
                        })) : "div" !== n && "span" !== n || (r = a.children("." + this._inlineClass),
                        r.children().addClass("ui-state-disabled"),
                        r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)),
                    this._disabledInputs = e.map(this._disabledInputs, function(e) {
                        return e === t ? null : e
                    }),
                    this._disabledInputs[this._disabledInputs.length] = t)
            },
            _isDisabledDatepicker: function(e) {
                if (!e)
                    return !1;
                for (var t = 0; t < this._disabledInputs.length; t++)
                    if (this._disabledInputs[t] === e)
                        return !0;
                return !1
            },
            _getInst: function(t) {
                try {
                    return e.data(t, "datepicker")
                } catch (e) {
                    throw "Missing instance data for this datepicker"
                }
            },
            _optionDatepicker: function(t, n, r) {
                var a, i, o, c, l = this._getInst(t);
                if (2 === arguments.length && "string" == typeof n)
                    return "defaults" === n ? e.extend({}, e.datepicker._defaults) : l ? "all" === n ? e.extend({}, l.settings) : this._get(l, n) : null;
                a = n || {},
                "string" == typeof n && (a = {},
                    a[n] = r),
                l && (this._curInst === l && this._hideDatepicker(),
                    i = this._getDateDatepicker(t, !0),
                    o = this._getMinMaxDate(l, "min"),
                    c = this._getMinMaxDate(l, "max"),
                    s(l.settings, a),
                null !== o && void 0 !== a.dateFormat && void 0 === a.minDate && (l.settings.minDate = this._formatDate(l, o)),
                null !== c && void 0 !== a.dateFormat && void 0 === a.maxDate && (l.settings.maxDate = this._formatDate(l, c)),
                "disabled"in a && (a.disabled ? this._disableDatepicker(t) : this._enableDatepicker(t)),
                    this._attachments(e(t), l),
                    this._autoSize(l),
                    this._setDate(l, i),
                    this._updateAlternate(l),
                    this._updateDatepicker(l))
            },
            _changeDatepicker: function(e, t, n) {
                this._optionDatepicker(e, t, n)
            },
            _refreshDatepicker: function(e) {
                var t = this._getInst(e);
                t && this._updateDatepicker(t)
            },
            _setDateDatepicker: function(e, t) {
                var n = this._getInst(e);
                n && (this._setDate(n, t),
                    this._updateDatepicker(n),
                    this._updateAlternate(n))
            },
            _getDateDatepicker: function(e, t) {
                var n = this._getInst(e);
                return n && !n.inline && this._setDateFromField(n, t),
                    n ? this._getDate(n) : null
            },
            _doKeyDown: function(t) {
                var n, r, a, i = e.datepicker._getInst(t.target), o = !0, s = i.dpDiv.is(".ui-datepicker-rtl");
                if (i._keyEvent = !0,
                        e.datepicker._datepickerShowing)
                    switch (t.keyCode) {
                        case 9:
                            e.datepicker._hideDatepicker(),
                                o = !1;
                            break;
                        case 13:
                            return a = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", i.dpDiv),
                            a[0] && e.datepicker._selectDay(t.target, i.selectedMonth, i.selectedYear, a[0]),
                                n = e.datepicker._get(i, "onSelect"),
                                n ? (r = e.datepicker._formatDate(i),
                                    n.apply(i.input ? i.input[0] : null, [r, i])) : e.datepicker._hideDatepicker(),
                                !1;
                        case 27:
                            e.datepicker._hideDatepicker();
                            break;
                        case 33:
                            e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(i, "stepBigMonths") : -e.datepicker._get(i, "stepMonths"), "M");
                            break;
                        case 34:
                            e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(i, "stepBigMonths") : +e.datepicker._get(i, "stepMonths"), "M");
                            break;
                        case 35:
                            (t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target),
                                o = t.ctrlKey || t.metaKey;
                            break;
                        case 36:
                            (t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target),
                                o = t.ctrlKey || t.metaKey;
                            break;
                        case 37:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, s ? 1 : -1, "D"),
                                o = t.ctrlKey || t.metaKey,
                            t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(i, "stepBigMonths") : -e.datepicker._get(i, "stepMonths"), "M");
                            break;
                        case 38:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"),
                                o = t.ctrlKey || t.metaKey;
                            break;
                        case 39:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, s ? -1 : 1, "D"),
                                o = t.ctrlKey || t.metaKey,
                            t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(i, "stepBigMonths") : +e.datepicker._get(i, "stepMonths"), "M");
                            break;
                        case 40:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"),
                                o = t.ctrlKey || t.metaKey;
                            break;
                        default:
                            o = !1
                    }
                else
                    36 === t.keyCode && t.ctrlKey ? e.datepicker._showDatepicker(this) : o = !1;
                o && (t.preventDefault(),
                    t.stopPropagation())
            },
            _doKeyPress: function(t) {
                var n, r, a = e.datepicker._getInst(t.target);
                if (e.datepicker._get(a, "constrainInput"))
                    return n = e.datepicker._possibleChars(e.datepicker._get(a, "dateFormat")),
                        r = String.fromCharCode(null == t.charCode ? t.keyCode : t.charCode),
                    t.ctrlKey || t.metaKey || r < " " || !n || n.indexOf(r) > -1
            },
            _doKeyUp: function(t) {
                var n, r = e.datepicker._getInst(t.target);
                if (r.input.val() !== r.lastVal)
                    try {
                        n = e.datepicker.parseDate(e.datepicker._get(r, "dateFormat"), r.input ? r.input.val() : null, e.datepicker._getFormatConfig(r)),
                        n && (e.datepicker._setDateFromField(r),
                            e.datepicker._updateAlternate(r),
                            e.datepicker._updateDatepicker(r))
                    } catch (e) {}
                return !0
            },
            _showDatepicker: function(t) {
                if (t = t.target || t,
                    "input" !== t.nodeName.toLowerCase() && (t = e("input", t.parentNode)[0]),
                    !e.datepicker._isDisabledDatepicker(t) && e.datepicker._lastInput !== t) {
                    var n, a, i, o, c, l, u;
                    n = e.datepicker._getInst(t),
                    e.datepicker._curInst && e.datepicker._curInst !== n && (e.datepicker._curInst.dpDiv.stop(!0, !0),
                    n && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),
                        a = e.datepicker._get(n, "beforeShow"),
                        i = a ? a.apply(t, [t, n]) : {},
                    i !== !1 && (s(n.settings, i),
                        n.lastVal = null,
                        e.datepicker._lastInput = t,
                        e.datepicker._setDateFromField(n),
                    e.datepicker._inDialog && (t.value = ""),
                    e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t),
                        e.datepicker._pos[1] += t.offsetHeight),
                        o = !1,
                        e(t).parents().each(function() {
                            return !(o |= "fixed" === e(this).css("position"))
                        }),
                        c = {
                            left: e.datepicker._pos[0],
                            top: e.datepicker._pos[1]
                        },
                        e.datepicker._pos = null,
                        n.dpDiv.empty(),
                        n.dpDiv.css({
                            position: "absolute",
                            display: "block",
                            top: "-1000px"
                        }),
                        e.datepicker._updateDatepicker(n),
                        c = e.datepicker._checkOffset(n, c, o),
                        n.dpDiv.css({
                            position: e.datepicker._inDialog && e.blockUI ? "static" : o ? "fixed" : "absolute",
                            display: "none",
                            left: c.left + "px",
                            top: c.top + "px"
                        }),
                    n.inline || (l = e.datepicker._get(n, "showAnim"),
                        u = e.datepicker._get(n, "duration"),
                        n.dpDiv.css("z-index", r(e(t)) + 1),
                        e.datepicker._datepickerShowing = !0,
                        e.effects && e.effects.effect[l] ? n.dpDiv.show(l, e.datepicker._get(n, "showOptions"), u) : n.dpDiv[l || "show"](l ? u : null),
                    e.datepicker._shouldFocusInput(n) && n.input.focus(),
                        e.datepicker._curInst = n))
                }
            },
            _updateDatepicker: function(t) {
                this.maxRows = 4,
                    c = t,
                    t.dpDiv.empty().append(this._generateHTML(t)),
                    this._attachHandlers(t);
                var n, r = this._getNumberOfMonths(t), a = r[1], i = t.dpDiv.find("." + this._dayOverClass + " a");
                i.length > 0 && o.apply(i.get(0)),
                    t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),
                a > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + a).css("width", 17 * a + "em"),
                    t.dpDiv[(1 !== r[0] || 1 !== r[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"),
                    t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"),
                t === e.datepicker._curInst && e.datepicker._datepickerShowing && e.datepicker._shouldFocusInput(t) && t.input.focus(),
                t.yearshtml && (n = t.yearshtml,
                    setTimeout(function() {
                        n === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),
                            n = t.yearshtml = null
                    }, 0))
            },
            _shouldFocusInput: function(e) {
                return e.input && e.input.is(":visible") && !e.input.is(":disabled") && !e.input.is(":focus")
            },
            _checkOffset: function(t, n, r) {
                var a = t.dpDiv.outerWidth()
                    , i = t.dpDiv.outerHeight()
                    , o = t.input ? t.input.outerWidth() : 0
                    , s = t.input ? t.input.outerHeight() : 0
                    , c = document.documentElement.clientWidth + (r ? 0 : e(document).scrollLeft())
                    , l = document.documentElement.clientHeight + (r ? 0 : e(document).scrollTop());
                return n.left -= this._get(t, "isRTL") ? a - o : 0,
                    n.left -= r && n.left === t.input.offset().left ? e(document).scrollLeft() : 0,
                    n.top -= r && n.top === t.input.offset().top + s ? e(document).scrollTop() : 0,
                    n.left -= Math.min(n.left, n.left + a > c && c > a ? Math.abs(n.left + a - c) : 0),
                    n.top -= Math.min(n.top, n.top + i > l && l > i ? Math.abs(i + s) : 0),
                    n
            },
            _findPos: function(t) {
                for (var n, r = this._getInst(t), a = this._get(r, "isRTL"); t && ("hidden" === t.type || 1 !== t.nodeType || e.expr.filters.hidden(t)); )
                    t = t[a ? "previousSibling" : "nextSibling"];
                return n = e(t).offset(),
                    [n.left, n.top]
            },
            _hideDatepicker: function(t) {
                var n, r, a, i, o = this._curInst;
                !o || t && o !== e.data(t, "datepicker") || this._datepickerShowing && (n = this._get(o, "showAnim"),
                    r = this._get(o, "duration"),
                    a = function() {
                        e.datepicker._tidyDialog(o)
                    }
                    ,
                    e.effects && (e.effects.effect[n] || e.effects[n]) ? o.dpDiv.hide(n, e.datepicker._get(o, "showOptions"), r, a) : o.dpDiv["slideDown" === n ? "slideUp" : "fadeIn" === n ? "fadeOut" : "hide"](n ? r : null, a),
                n || a(),
                    this._datepickerShowing = !1,
                    i = this._get(o, "onClose"),
                i && i.apply(o.input ? o.input[0] : null, [o.input ? o.input.val() : "", o]),
                    this._lastInput = null,
                this._inDialog && (this._dialogInput.css({
                    position: "absolute",
                    left: "0",
                    top: "-100px"
                }),
                e.blockUI && (e.unblockUI(),
                    e("body").append(this.dpDiv))),
                    this._inDialog = !1)
            },
            _tidyDialog: function(e) {
                e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
            },
            _checkExternalClick: function(t) {
                if (e.datepicker._curInst) {
                    var n = e(t.target)
                        , r = e.datepicker._getInst(n[0]);
                    (n[0].id === e.datepicker._mainDivId || 0 !== n.parents("#" + e.datepicker._mainDivId).length || n.hasClass(e.datepicker.markerClassName) || n.closest("." + e.datepicker._triggerClass).length || !e.datepicker._datepickerShowing || e.datepicker._inDialog && e.blockUI) && (!n.hasClass(e.datepicker.markerClassName) || e.datepicker._curInst === r) || e.datepicker._hideDatepicker()
                }
            },
            _adjustDate: function(t, n, r) {
                var a = e(t)
                    , i = this._getInst(a[0]);
                this._isDisabledDatepicker(a[0]) || (this._adjustInstDate(i, n + ("M" === r ? this._get(i, "showCurrentAtPos") : 0), r),
                    this._updateDatepicker(i))
            },
            _gotoToday: function(t) {
                var n, r = e(t), a = this._getInst(r[0]);
                this._get(a, "gotoCurrent") && a.currentDay ? (a.selectedDay = a.currentDay,
                    a.drawMonth = a.selectedMonth = a.currentMonth,
                    a.drawYear = a.selectedYear = a.currentYear) : (n = new Date,
                    a.selectedDay = n.getDate(),
                    a.drawMonth = a.selectedMonth = n.getMonth(),
                    a.drawYear = a.selectedYear = n.getFullYear()),
                    this._notifyChange(a),
                    this._adjustDate(r),
                    this._setDateDatepicker(r, new Date),
                    this._selectDate(t, this._getDateDatepicker(r))
            },
            _selectMonthYear: function(t, n, r) {
                var a = e(t)
                    , i = this._getInst(a[0]);
                i["selected" + ("M" === r ? "Month" : "Year")] = i["draw" + ("M" === r ? "Month" : "Year")] = parseInt(n.options[n.selectedIndex].value, 10),
                    this._notifyChange(i),
                    this._adjustDate(a)
            },
            _selectDay: function(t, n, r, a) {
                var i, o = e(t);
                e(a).hasClass(this._unselectableClass) || this._isDisabledDatepicker(o[0]) || (i = this._getInst(o[0]),
                    i.selectedDay = i.currentDay = e("a", a).html(),
                    i.selectedMonth = i.currentMonth = n,
                    i.selectedYear = i.currentYear = r,
                    this._selectDate(t, this._formatDate(i, i.currentDay, i.currentMonth, i.currentYear)))
            },
            _clearDate: function(t) {
                var n = e(t);
                this._selectDate(n, "")
            },
            _selectDate: function(t, n) {
                var r, a = e(t), i = this._getInst(a[0]);
                n = null != n ? n : this._formatDate(i),
                i.input && i.input.val(n),
                    this._updateAlternate(i),
                    r = this._get(i, "onSelect"),
                    r ? r.apply(i.input ? i.input[0] : null, [n, i]) : i.input && i.input.trigger("change"),
                    i.inline ? this._updateDatepicker(i) : (this._hideDatepicker(),
                        this._lastInput = i.input[0],
                    "object" != typeof i.input[0] && i.input.focus(),
                        this._lastInput = null)
            },
            _updateAlternate: function(t) {
                var n, r, a, i = this._get(t, "altField");
                i && (n = this._get(t, "altFormat") || this._get(t, "dateFormat"),
                    r = this._getDate(t),
                    a = this.formatDate(n, r, this._getFormatConfig(t)),
                    e(i).each(function() {
                        e(this).val(a)
                    }))
            },
            noWeekends: function(e) {
                var t = e.getDay();
                return [t > 0 && t < 6, ""]
            },
            iso8601Week: function(e) {
                var t, n = new Date(e.getTime());
                return n.setDate(n.getDate() + 4 - (n.getDay() || 7)),
                    t = n.getTime(),
                    n.setMonth(0),
                    n.setDate(1),
                Math.floor(Math.round((t - n) / 864e5) / 7) + 1
            },
            parseDate: function(t, n, r) {
                if (null == t || null == n)
                    throw "Invalid arguments";
                if ("" === (n = "object" == typeof n ? n.toString() : n + ""))
                    return null;
                var a, i, o, s, c = 0, l = (r ? r.shortYearCutoff : null) || this._defaults.shortYearCutoff, u = "string" != typeof l ? l : (new Date).getFullYear() % 100 + parseInt(l, 10), d = (r ? r.dayNamesShort : null) || this._defaults.dayNamesShort, p = (r ? r.dayNames : null) || this._defaults.dayNames, f = (r ? r.monthNamesShort : null) || this._defaults.monthNamesShort, g = (r ? r.monthNames : null) || this._defaults.monthNames, m = -1, h = -1, v = -1, C = -1, y = !1, A = function(e) {
                    var n = a + 1 < t.length && t.charAt(a + 1) === e;
                    return n && a++,
                        n
                }, E = function(e) {
                    var t = A(e)
                        , r = "@" === e ? 14 : "!" === e ? 20 : "y" === e && t ? 4 : "o" === e ? 3 : 2
                        , a = "y" === e ? r : 1
                        , i = new RegExp("^\\d{" + a + "," + r + "}")
                        , o = n.substring(c).match(i);
                    if (!o)
                        throw "Missing number at position " + c;
                    return c += o[0].length,
                        parseInt(o[0], 10)
                }, T = function(t, r, a) {
                    var i = -1
                        , o = e.map(A(t) ? a : r, function(e, t) {
                        return [[t, e]]
                    }).sort(function(e, t) {
                        return -(e[1].length - t[1].length)
                    });
                    if (e.each(o, function(e, t) {
                            var r = t[1];
                            if (n.substr(c, r.length).toLowerCase() === r.toLowerCase())
                                return i = t[0],
                                    c += r.length,
                                    !1
                        }),
                        i !== -1)
                        return i + 1;
                    throw "Unknown name at position " + c
                }, S = function() {
                    if (n.charAt(c) !== t.charAt(a))
                        throw "Unexpected literal at position " + c;
                    c++
                };
                for (a = 0; a < t.length; a++)
                    if (y)
                        "'" !== t.charAt(a) || A("'") ? S() : y = !1;
                    else
                        switch (t.charAt(a)) {
                            case "d":
                                v = E("d");
                                break;
                            case "D":
                                T("D", d, p);
                                break;
                            case "o":
                                C = E("o");
                                break;
                            case "m":
                                h = E("m");
                                break;
                            case "M":
                                h = T("M", f, g);
                                break;
                            case "y":
                                m = E("y");
                                break;
                            case "@":
                                s = new Date(E("@")),
                                    m = s.getFullYear(),
                                    h = s.getMonth() + 1,
                                    v = s.getDate();
                                break;
                            case "!":
                                s = new Date((E("!") - this._ticksTo1970) / 1e4),
                                    m = s.getFullYear(),
                                    h = s.getMonth() + 1,
                                    v = s.getDate();
                                break;
                            case "'":
                                A("'") ? S() : y = !0;
                                break;
                            default:
                                S()
                        }
                if (c < n.length && (o = n.substr(c),
                        !/^\s+/.test(o)))
                    throw "Extra/unparsed characters found in date: " + o;
                if (m === -1 ? m = (new Date).getFullYear() : m < 100 && (m += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (m <= u ? 0 : -100)),
                    C > -1)
                    for (h = 1,
                             v = C; ; ) {
                        if (i = this._getDaysInMonth(m, h - 1),
                            v <= i)
                            break;
                        h++,
                            v -= i
                    }
                if (s = this._daylightSavingAdjust(new Date(m,h - 1,v)),
                    s.getFullYear() !== m || s.getMonth() + 1 !== h || s.getDate() !== v)
                    throw "Invalid date";
                return s
            },
            ATOM: "yy-mm-dd",
            COOKIE: "D, dd M yy",
            ISO_8601: "yy-mm-dd",
            RFC_822: "D, d M y",
            RFC_850: "DD, dd-M-y",
            RFC_1036: "D, d M y",
            RFC_1123: "D, d M yy",
            RFC_2822: "D, d M yy",
            RSS: "D, d M y",
            TICKS: "!",
            TIMESTAMP: "@",
            W3C: "yy-mm-dd",
            _ticksTo1970: 24 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)) * 60 * 60 * 1e7,
            formatDate: function(e, t, n) {
                if (!t)
                    return "";
                var r, a = (n ? n.dayNamesShort : null) || this._defaults.dayNamesShort, i = (n ? n.dayNames : null) || this._defaults.dayNames, o = (n ? n.monthNamesShort : null) || this._defaults.monthNamesShort, s = (n ? n.monthNames : null) || this._defaults.monthNames, c = function(t) {
                    var n = r + 1 < e.length && e.charAt(r + 1) === t;
                    return n && r++,
                        n
                }, l = function(e, t, n) {
                    var r = "" + t;
                    if (c(e))
                        for (; r.length < n; )
                            r = "0" + r;
                    return r
                }, u = function(e, t, n, r) {
                    return c(e) ? r[t] : n[t]
                }, d = "", p = !1;
                if (t)
                    for (r = 0; r < e.length; r++)
                        if (p)
                            "'" !== e.charAt(r) || c("'") ? d += e.charAt(r) : p = !1;
                        else
                            switch (e.charAt(r)) {
                                case "d":
                                    d += l("d", t.getDate(), 2);
                                    break;
                                case "D":
                                    d += u("D", t.getDay(), a, i);
                                    break;
                                case "o":
                                    d += l("o", Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime() - new Date(t.getFullYear(),0,0).getTime()) / 864e5), 3);
                                    break;
                                case "m":
                                    d += l("m", t.getMonth() + 1, 2);
                                    break;
                                case "M":
                                    d += u("M", t.getMonth(), o, s);
                                    break;
                                case "y":
                                    d += c("y") ? t.getFullYear() : (t.getYear() % 100 < 10 ? "0" : "") + t.getYear() % 100;
                                    break;
                                case "@":
                                    d += t.getTime();
                                    break;
                                case "!":
                                    d += 1e4 * t.getTime() + this._ticksTo1970;
                                    break;
                                case "'":
                                    c("'") ? d += "'" : p = !0;
                                    break;
                                default:
                                    d += e.charAt(r)
                            }
                return d
            },
            _possibleChars: function(e) {
                var t, n = "", r = !1, a = function(n) {
                    var r = t + 1 < e.length && e.charAt(t + 1) === n;
                    return r && t++,
                        r
                };
                for (t = 0; t < e.length; t++)
                    if (r)
                        "'" !== e.charAt(t) || a("'") ? n += e.charAt(t) : r = !1;
                    else
                        switch (e.charAt(t)) {
                            case "d":
                            case "m":
                            case "y":
                            case "@":
                                n += "0123456789";
                                break;
                            case "D":
                            case "M":
                                return null;
                            case "'":
                                a("'") ? n += "'" : r = !0;
                                break;
                            default:
                                n += e.charAt(t)
                        }
                return n
            },
            _get: function(e, t) {
                return void 0 !== e.settings[t] ? e.settings[t] : this._defaults[t]
            },
            _setDateFromField: function(e, t) {
                if (e.input.val() !== e.lastVal) {
                    var n = this._get(e, "dateFormat")
                        , r = e.lastVal = e.input ? e.input.val() : null
                        , a = this._getDefaultDate(e)
                        , i = a
                        , o = this._getFormatConfig(e);
                    try {
                        i = this.parseDate(n, r, o) || a
                    } catch (e) {
                        r = t ? "" : r
                    }
                    e.selectedDay = i.getDate(),
                        e.drawMonth = e.selectedMonth = i.getMonth(),
                        e.drawYear = e.selectedYear = i.getFullYear(),
                        e.currentDay = r ? i.getDate() : 0,
                        e.currentMonth = r ? i.getMonth() : 0,
                        e.currentYear = r ? i.getFullYear() : 0,
                        this._adjustInstDate(e)
                }
            },
            _getDefaultDate: function(e) {
                return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date))
            },
            _determineDate: function(t, n, r) {
                var a = null == n || "" === n ? r : "string" == typeof n ? function(n) {
                    try {
                        return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), n, e.datepicker._getFormatConfig(t))
                    } catch (e) {}
                    for (var r = (n.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date, a = r.getFullYear(), i = r.getMonth(), o = r.getDate(), s = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, c = s.exec(n); c; ) {
                        switch (c[2] || "d") {
                            case "d":
                            case "D":
                                o += parseInt(c[1], 10);
                                break;
                            case "w":
                            case "W":
                                o += 7 * parseInt(c[1], 10);
                                break;
                            case "m":
                            case "M":
                                i += parseInt(c[1], 10),
                                    o = Math.min(o, e.datepicker._getDaysInMonth(a, i));
                                break;
                            case "y":
                            case "Y":
                                a += parseInt(c[1], 10),
                                    o = Math.min(o, e.datepicker._getDaysInMonth(a, i))
                        }
                        c = s.exec(n)
                    }
                    return new Date(a,i,o)
                }(n) : "number" == typeof n ? isNaN(n) ? r : function(e) {
                    var t = new Date;
                    return t.setDate(t.getDate() + e),
                        t
                }(n) : new Date(n.getTime());
                return a = a && "Invalid Date" === a.toString() ? r : a,
                a && (a.setHours(0),
                    a.setMinutes(0),
                    a.setSeconds(0),
                    a.setMilliseconds(0)),
                    this._daylightSavingAdjust(a)
            },
            _daylightSavingAdjust: function(e) {
                return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0),
                    e) : null
            },
            _setDate: function(e, t, n) {
                var r = !t
                    , a = e.selectedMonth
                    , i = e.selectedYear
                    , o = this._restrictMinMax(e, this._determineDate(e, t, new Date));
                e.selectedDay = e.currentDay = o.getDate(),
                    e.drawMonth = e.selectedMonth = e.currentMonth = o.getMonth(),
                    e.drawYear = e.selectedYear = e.currentYear = o.getFullYear(),
                a === e.selectedMonth && i === e.selectedYear || n || this._notifyChange(e),
                    this._adjustInstDate(e),
                e.input && e.input.val(r ? "" : this._formatDate(e))
            },
            _getDate: function(e) {
                return !e.currentYear || e.input && "" === e.input.val() ? null : this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))
            },
            _attachHandlers: function(t) {
                var n = this._get(t, "stepMonths")
                    , r = "#" + t.id.replace(/\\\\/g, "\\");
                t.dpDiv.find("[data-handler]").map(function() {
                    var t = {
                        prev: function() {
                            e.datepicker._adjustDate(r, -n, "M")
                        },
                        next: function() {
                            e.datepicker._adjustDate(r, +n, "M")
                        },
                        hide: function() {
                            e.datepicker._hideDatepicker()
                        },
                        today: function() {
                            e.datepicker._gotoToday(r)
                        },
                        selectDay: function() {
                            return e.datepicker._selectDay(r, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this),
                                !1
                        },
                        selectMonth: function() {
                            return e.datepicker._selectMonthYear(r, this, "M"),
                                !1
                        },
                        selectYear: function() {
                            return e.datepicker._selectMonthYear(r, this, "Y"),
                                !1
                        }
                    };
                    e(this).bind(this.getAttribute("data-event"), t[this.getAttribute("data-handler")])
                })
            },
            _generateHTML: function(e) {
                var t, n, r, a, i, o, s, c, l, u, d, p, f, g, m, h, v, C, y, A, E, T, S, w, b, _, D, I, N, O, R, P, L, M, k, F, x, U, $, G = new Date, j = this._daylightSavingAdjust(new Date(G.getFullYear(),G.getMonth(),G.getDate())), V = this._get(e, "isRTL"), H = this._get(e, "showButtonPanel"), W = this._get(e, "hideIfNoPrevNext"), B = this._get(e, "navigationAsDateFormat"), Y = this._getNumberOfMonths(e), q = this._get(e, "showCurrentAtPos"), z = this._get(e, "stepMonths"), K = 1 !== Y[0] || 1 !== Y[1], X = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear,e.currentMonth,e.currentDay) : new Date(9999,9,9)), Q = this._getMinMaxDate(e, "min"), J = this._getMinMaxDate(e, "max"), Z = e.drawMonth - q, ee = e.drawYear;
                if (Z < 0 && (Z += 12,
                        ee--),
                        J)
                    for (t = this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth() - Y[0] * Y[1] + 1,J.getDate())),
                             t = Q && t < Q ? Q : t; this._daylightSavingAdjust(new Date(ee,Z,1)) > t; )
                        --Z < 0 && (Z = 11,
                            ee--);
                for (e.drawMonth = Z,
                         e.drawYear = ee,
                         n = this._get(e, "prevText"),
                         n = B ? this.formatDate(n, this._daylightSavingAdjust(new Date(ee,Z - z,1)), this._getFormatConfig(e)) : n,
                         r = this._canAdjustMonth(e, -1, ee, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + n + "'><span class='icon-left-open'></span></a>" : W ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + n + "'><span class='icon-left-open'></span></a>",
                         a = this._get(e, "nextText"),
                         a = B ? this.formatDate(a, this._daylightSavingAdjust(new Date(ee,Z + z,1)), this._getFormatConfig(e)) : a,
                         i = this._canAdjustMonth(e, 1, ee, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + a + "'><span class='icon-right-open'></span></a>" : W ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + a + "'><span class='icon-right-open'></span></a>",
                         o = this._get(e, "currentText"),
                         s = this._get(e, "gotoCurrent") && e.currentDay ? X : j,
                         o = B ? this.formatDate(o, s, this._getFormatConfig(e)) : o,
                         c = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>",
                         l = H ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (V ? c : "") + (this._isInRange(e, s) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + o + "</button>" : "") + (V ? "" : c) + "</div>" : "",
                         u = parseInt(this._get(e, "firstDay"), 10),
                         u = isNaN(u) ? 0 : u,
                         d = this._get(e, "showWeek"),
                         p = this._get(e, "dayNames"),
                         f = this._get(e, "dayNamesMin"),
                         g = this._get(e, "monthNames"),
                         m = this._get(e, "monthNamesShort"),
                         h = this._get(e, "beforeShowDay"),
                         v = this._get(e, "showOtherMonths"),
                         C = this._get(e, "selectOtherMonths"),
                         y = this._getDefaultDate(e),
                         A = "",
                         T = 0; T < Y[0]; T++) {
                    for (S = "",
                             this.maxRows = 4,
                             w = 0; w < Y[1]; w++) {
                        if (b = this._daylightSavingAdjust(new Date(ee,Z,e.selectedDay)),
                                _ = " ui-corner-all",
                                D = "",
                                K) {
                            if (D += "<div class='ui-datepicker-group",
                                Y[1] > 1)
                                switch (w) {
                                    case 0:
                                        D += " ui-datepicker-group-first",
                                            _ = " ui-corner-" + (V ? "right" : "left");
                                        break;
                                    case Y[1] - 1:
                                        D += " ui-datepicker-group-last",
                                            _ = " ui-corner-" + (V ? "left" : "right");
                                        break;
                                    default:
                                        D += " ui-datepicker-group-middle",
                                            _ = ""
                                }
                            D += "'>"
                        }
                        for (D += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + _ + "'>" + (/all|left/.test(_) && 0 === T ? V ? i : r : "") + (/all|right/.test(_) && 0 === T ? V ? r : i : "") + this._generateMonthYearHeader(e, Z, ee, Q, J, T > 0 || w > 0, g, m) + "</div><table class='ui-datepicker-calendar'><thead><tr>",
                                 I = d ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "",
                                 E = 0; E < 7; E++)
                            N = (E + u) % 7,
                                I += "<th scope='col'" + ((E + u + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + "><span title='" + p[N] + "'>" + f[N] + "</span></th>";
                        for (D += I + "</tr></thead><tbody>",
                                 O = this._getDaysInMonth(ee, Z),
                             ee === e.selectedYear && Z === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, O)),
                                 R = (this._getFirstDayOfMonth(ee, Z) - u + 7) % 7,
                                 P = Math.ceil((R + O) / 7),
                                 L = K && this.maxRows > P ? this.maxRows : P,
                                 this.maxRows = L,
                                 M = this._daylightSavingAdjust(new Date(ee,Z,1 - R)),
                                 k = 0; k < L; k++) {
                            for (D += "<tr>",
                                     F = d ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(M) + "</td>" : "",
                                     E = 0; E < 7; E++)
                                x = h ? h.apply(e.input ? e.input[0] : null, [M]) : [!0, ""],
                                    U = M.getMonth() !== Z,
                                    $ = U && !C || !x[0] || Q && M < Q || J && M > J,
                                    F += "<td class='" + ((E + u + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (U ? " ui-datepicker-other-month" : "") + (M.getTime() === b.getTime() && Z === e.selectedMonth && e._keyEvent || y.getTime() === M.getTime() && y.getTime() === b.getTime() ? " " + this._dayOverClass : "") + ($ ? " " + this._unselectableClass + " ui-state-disabled" : "") + (U && !v ? "" : " " + x[1] + (M.getTime() === X.getTime() ? " " + this._currentClass : "") + (M.getTime() === j.getTime() ? " ui-datepicker-today" : "")) + "'" + (U && !v || !x[2] ? "" : " title='" + x[2].replace(/'/g, "&#39;") + "'") + ($ ? "" : " data-handler='selectDay' data-event='click' data-month='" + M.getMonth() + "' data-year='" + M.getFullYear() + "'") + ">" + (U && !v ? "&#xa0;" : $ ? "<span class='ui-state-default'>" + M.getDate() + "</span>" : "<a class='ui-state-default" + (M.getTime() === j.getTime() ? " ui-state-highlight" : "") + (M.getTime() === X.getTime() ? " ui-state-active" : "") + (U ? " ui-priority-secondary" : "") + "' href='#'>" + M.getDate() + "</a>") + "</td>",
                                    M.setDate(M.getDate() + 1),
                                    M = this._daylightSavingAdjust(M);
                            D += F + "</tr>"
                        }
                        Z++,
                        Z > 11 && (Z = 0,
                            ee++),
                            D += "</tbody></table>" + (K ? "</div>" + (Y[0] > 0 && w === Y[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""),
                            S += D
                    }
                    A += S
                }
                return A += l,
                    e._keyEvent = !1,
                    A
            },
            _generateMonthYearHeader: function(e, t, n, r, a, i, o, s) {
                var c, l, u, d, p, f, g, m, h = this._get(e, "changeMonth"), v = this._get(e, "changeYear"), C = this._get(e, "showMonthAfterYear"), y = "<div class='ui-datepicker-title'>", A = "";
                if (i || !h)
                    A += "<span class='ui-datepicker-month'>" + o[t] + "</span>";
                else {
                    for (c = r && r.getFullYear() === n,
                             l = a && a.getFullYear() === n,
                             A += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",
                             u = 0; u < 12; u++)
                        (!c || u >= r.getMonth()) && (!l || u <= a.getMonth()) && (A += "<option value='" + u + "'" + (u === t ? " selected='selected'" : "") + ">" + s[u] + "</option>");
                    A += "</select>"
                }
                if (C || (y += A + (!i && h && v ? "" : "&#xa0;")),
                        !e.yearshtml)
                    if (e.yearshtml = "",
                        i || !v)
                        y += "<span class='ui-datepicker-year'>" + n + "</span>";
                    else {
                        for (d = this._get(e, "yearRange").split(":"),
                                 p = (new Date).getFullYear(),
                                 f = function(e) {
                                     var t = e.match(/c[+\-].*/) ? n + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? p + parseInt(e, 10) : parseInt(e, 10);
                                     return isNaN(t) ? p : t
                                 }
                                 ,
                                 g = f(d[0]),
                                 m = Math.max(g, f(d[1] || "")),
                                 g = r ? Math.max(g, r.getFullYear()) : g,
                                 m = a ? Math.min(m, a.getFullYear()) : m,
                                 e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>"; g <= m; g++)
                            e.yearshtml += "<option value='" + g + "'" + (g === n ? " selected='selected'" : "") + ">" + g + "</option>";
                        e.yearshtml += "</select>",
                            y += e.yearshtml,
                            e.yearshtml = null
                    }
                return y += this._get(e, "yearSuffix"),
                C && (y += (!i && h && v ? "" : "&#xa0;") + A),
                    y += "</div>"
            },
            _adjustInstDate: function(e, t, n) {
                var r = e.drawYear + ("Y" === n ? t : 0)
                    , a = e.drawMonth + ("M" === n ? t : 0)
                    , i = Math.min(e.selectedDay, this._getDaysInMonth(r, a)) + ("D" === n ? t : 0)
                    , o = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(r,a,i)));
                e.selectedDay = o.getDate(),
                    e.drawMonth = e.selectedMonth = o.getMonth(),
                    e.drawYear = e.selectedYear = o.getFullYear(),
                "M" !== n && "Y" !== n || this._notifyChange(e)
            },
            _restrictMinMax: function(e, t) {
                var n = this._getMinMaxDate(e, "min")
                    , r = this._getMinMaxDate(e, "max")
                    , a = n && t < n ? n : t;
                return r && a > r ? r : a
            },
            _notifyChange: function(e) {
                var t = this._get(e, "onChangeMonthYear");
                t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e])
            },
            _getNumberOfMonths: function(e) {
                var t = this._get(e, "numberOfMonths");
                return null == t ? [1, 1] : "number" == typeof t ? [1, t] : t
            },
            _getMinMaxDate: function(e, t) {
                return this._determineDate(e, this._get(e, t + "Date"), null)
            },
            _getDaysInMonth: function(e, t) {
                return 32 - this._daylightSavingAdjust(new Date(e,t,32)).getDate()
            },
            _getFirstDayOfMonth: function(e, t) {
                return new Date(e,t,1).getDay()
            },
            _canAdjustMonth: function(e, t, n, r) {
                var a = this._getNumberOfMonths(e)
                    , i = this._daylightSavingAdjust(new Date(n,r + (t < 0 ? t : a[0] * a[1]),1));
                return t < 0 && i.setDate(this._getDaysInMonth(i.getFullYear(), i.getMonth())),
                    this._isInRange(e, i)
            },
            _isInRange: function(e, t) {
                var n, r, a = this._getMinMaxDate(e, "min"), i = this._getMinMaxDate(e, "max"), o = null, s = null, c = this._get(e, "yearRange");
                return c && (n = c.split(":"),
                    r = (new Date).getFullYear(),
                    o = parseInt(n[0], 10),
                    s = parseInt(n[1], 10),
                n[0].match(/[+\-].*/) && (o += r),
                n[1].match(/[+\-].*/) && (s += r)),
                (!a || t.getTime() >= a.getTime()) && (!i || t.getTime() <= i.getTime()) && (!o || t.getFullYear() >= o) && (!s || t.getFullYear() <= s)
            },
            _getFormatConfig: function(e) {
                var t = this._get(e, "shortYearCutoff");
                return t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10),
                {
                    shortYearCutoff: t,
                    dayNamesShort: this._get(e, "dayNamesShort"),
                    dayNames: this._get(e, "dayNames"),
                    monthNamesShort: this._get(e, "monthNamesShort"),
                    monthNames: this._get(e, "monthNames")
                }
            },
            _formatDate: function(e, t, n, r) {
                t || (e.currentDay = e.selectedDay,
                    e.currentMonth = e.selectedMonth,
                    e.currentYear = e.selectedYear);
                var a = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(r,n,t)) : this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));
                return this.formatDate(this._get(e, "dateFormat"), a, this._getFormatConfig(e))
            }
        }),
            e.fn.datepicker = function(t) {
                if (!this.length)
                    return this;
                e.datepicker.initialized || (e(document).mousedown(e.datepicker._checkExternalClick),
                    e.datepicker.initialized = !0),
                0 === e("#" + e.datepicker._mainDivId).length && e("body").append(e.datepicker.dpDiv);
                var n = Array.prototype.slice.call(arguments, 1);
                return "string" != typeof t || "isDisabled" !== t && "getDate" !== t && "widget" !== t ? "option" === t && 2 === arguments.length && "string" == typeof arguments[1] ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n)) : this.each(function() {
                    "string" == typeof t ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(n)) : e.datepicker._attachDatepicker(this, t)
                }) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n))
            }
            ,
            e.datepicker = new a,
            e.datepicker.initialized = !1,
            e.datepicker.uuid = (new Date).getTime(),
            e.datepicker.version = "1.11.2";
        e.datepicker
    }),
    angular.module("acornApp").controller("AwardsCtrl", ["$scope", "$routeParams", "$filter", "$log", "awardsManager", "studentBasicInfoSvc", "awardsConstants", "acornCoreLib", function(e, t, n, r, a, i, o, s) {
        var c = s.getUtilityLib().getCurrentSession().getSessionCode();
        e.numberOfCardsPerDeck = 2,
            e.selectedTab = t.tab,
            e.awardsConstants = o,
            e.studentAwards = [],
            e.receivedStudentAwards = [],
            e.upcomingStudentAwards = [],
            e.cancelledStudentAwards = [],
            e.dashboardUpcomingStudentAwards = [],
            e.methodOfPayment = o.PAYMENT_BY_CHEQUE,
            e.utWideAwardsLinks = [],
            e.today = Date.now(),
            e.user = {},
            e.collegeAwardLinks = [],
            e.studentAccountTooltipText = {
                messages: "Award disbursements will be applied directly to your Financial Account balance on ACORN."
            },
            e.getStudentAwards = function() {
                a.getStudentAwards(c).then(function(t) {
                    e.studentAwards = t.awards,
                        a.calculateAndSetRefundAmount(t.hasBankAccount, e.studentAwards);
                    var n = a.processAwards(e.studentAwards);
                    e.upcomingStudentAwards = n.upcoming,
                        e.receivedStudentAwards = n.received,
                        e.cancelledStudentAwards = n.cancelled,
                        e.dashboardUpcomingStudentAwards = a.setDashboardUpcomingStudentAwards(e.upcomingStudentAwards)
                }, function() {
                    r.log("Failed to retrieve the student awards")
                })
            }
            ,
            e.getStudentAttendanceInfo = function() {
                a.getStudentAttendanceInfo(c).then(function(t) {
                    e.studentAttendanceList = t.studentAttendanceInfos,
                        e.isStudentDomestic = t.studentDomestic,
                        e.cardTemplates = a.getCardTemplates(e.studentAttendanceList),
                        e.utWideAwardsLinks = a.getUtWideAwardsLinks(e.studentAttendanceList),
                        e.studentAttendanceList.forEach(function(t) {
                            e.collegeAwardLinks.push(a.getCollegeAwardLink(t.associatedOrgCode))
                        })
                }, function() {
                    r.log("Failed to retrieve the student attendance info")
                })
            }
            ,
            e.getStudentBasicInfo = function() {
                i.getStudentBasicInfo().then(function(t) {
                    e.user = t
                })
            }
            ,
            e.getTotalAmount = function(t) {
                return a.getTotalAmount(e.upcomingStudentAwards, e.receivedStudentAwards, t)
            }
            ,
            e.getAwardTotalAmount = a.getAwardTotalAmount,
            e.doesAttendanceContainPrimaryOrgCode = function(t) {
                if (e.studentAttendanceList)
                    return e.studentAttendanceList.some(function(e) {
                        return e.primaryOrgCode === t
                    })
            }
            ,
            e.getFinancialCounsellingAwardsLinks = a.getFinancialCounsellingAwardsLinks,
            e.getCampusName = a.getCampusName,
            e.isObjectEmpty = a.isObjectEmpty,
            e.getAwardsPayDate = a.getAwardsPayDate,
            e.getUpcomingOrReceivedDescription = a.getUpcomingOrReceivedDescription,
            e.getFacultyAwardsTitle = a.getFacultyAwardsTitle,
            e.getFinancialCounsellingAwardsTitle = a.getFinancialCounsellingAwardsTitle,
            e.getFinancialCounsellingAwardsButtonName = a.getFinancialCounsellingAwardsButtonName,
            e.getFinancialCounsellingAwardsBodyText = a.getFinancialCounsellingAwardsBodyText,
            e.hasNonUtmPrimaryOrg = a.hasNonUtmPrimaryOrg,
            e.removeDuplicateAttendanceObjects = a.removeDuplicateAttendanceObjects,
            e.awardNameIgnoreCase = function(e) {
                return e.name.toLowerCase()
            }
            ,
            e.getAmountForDisplay = function(e) {
                return e.calculateRefund === o.YES ? n("currency")(e.actualRefund, "$", 2) + " / " + n("currency")(e.amount, "$", 2) : e.amount
            }
            ,
            function() {
                e.selectedTab && e.selectedTab != o.MY_AWARDS_TAB ? e.getStudentAttendanceInfo() : (e.getStudentAwards(),
                    e.getStudentBasicInfo())
            }()
    }
    ]),
    angular.module("acornApp").service("awardsManager", ["$q", "$filter", "$log", "acornCoreLib", "awardsServerResources", "awardsConstants", "strformat", "utMoment", function(e, t, n, r, a, i, o, s) {
        function c(e) {
            return e === i.ERIN ? i.UTM : e === i.SCAR ? i.UTSC : e === i.SGS ? i.SGS : i.UTSG
        }
        function l(e) {
            var t = [];
            return e && e.forEach(function(e) {
                e.installments.find(function(e) {
                    return e.journalDate
                }) && t.push(e)
            }),
                t
        }
        function u(e, t, n) {
            var r = b(e, n.longName)
                , a = b(t, n.longName);
            a || (a = {
                name: n.longName,
                installments: []
            },
                t.push(a)),
                a.installments = a.installments.concat(r.installments),
                a.installments.push(n);
            for (var i = 0; i < e.length; i++)
                if (e[i].name === n.longName) {
                    e.splice(i, 1);
                    break
                }
        }
        function d(e, t, n) {
            var r = angular.copy(t);
            r.actualRefund = t.cancelAmount,
                r.cancelled = !0,
                r.type = n,
                r.methodOfPayment = {
                    tooltipLabel: "",
                    label: i.NOT_AVAILABLE
                },
                e.splice(e.length, 0, r)
        }
        function p(e, t, n) {
            if (angular.isUndefined(t) && angular.isUndefined(n))
                return !0;
            var a, i = r.getUtilityLib().createSession(t);
            a = t && angular.isUndefined(n) ? i : r.getUtilityLib().createSession(n);
            var o = m(e, !1);
            return o.getTime() >= i.getDate().getTime() && o.getTime() < a.getNextSession().getDate().getTime()
        }
        function f(e) {
            var t = [];
            return e.forEach(function(e) {
                t = t.concat(e.installments)
            }),
                t
        }
        function g(e) {
            var t = 0;
            return e.cancelled ? e.cancelAmount <= e.amount && (t = -e.cancelAmount) : t = e.actualRefund,
                t
        }
        function m(e, t) {
            var n;
            if ((angular.isUndefined(t) || 1 == t) && e.rescinded)
                n = new Date(e.cancelDate);
            else if (e.journalDate)
                n = new Date(e.journalDate);
            else {
                if (e.paySessionCode)
                    return r.getUtilityLib().createSession(e.paySessionCode).getDate();
                n = new Date(e.payMonth)
            }
            return new Date(n.getTime() + 6e4 * n.getTimezoneOffset())
        }
        function h(e) {
            return !isNaN(e)
        }
        function v(e) {
            var t;
            if (e.paySessionCode) {
                var n = e.paySessionCode.substring(0, 4) + "-0" + e.paySessionCode.substring(4, 5);
                t = new Date(n)
            } else
                t = new Date(e.payMonth);
            return t
        }
        function C(e) {
            return e.primaryOrgCode === i.SGS
        }
        function y(e) {
            return e.primaryOrgCode === i.ERIN || e.primaryOrgCode === i.ARCLA
        }
        function A(e) {
            return !e || angular.equals({}, e)
        }
        function E(e, t) {
            var n = e ? i.PAYMENT_BY_DIRECT_DEPOSIT : i.PAYMENT_BY_CHEQUE
                , r = "";
            return t === i.YES && (n += " / ",
                r = i.PAYMENT_TO_STUDENT_ACCOUNT),
            {
                tooltipLabel: r,
                label: n
            }
        }
        function T(e) {
            e.forEach(function(e) {
                var t = e.installments;
                t.length && t.sort(function(e, t) {
                    var n = S(e)
                        , r = S(t);
                    return e.type != t.type ? e.type - t.type : n - r
                })
            })
        }
        function S(e) {
            return e.combinedCancelled ? -v(e).getTime() : e.cancelled ? -new Date(e.cancelDate).getTime() : e.journalDate ? -new Date(e.journalDate).getTime() : v(e).getTime()
        }
        function w(e, t, n) {
            return t.some(function(t) {
                return t[n] === e[n]
            })
        }
        function b(e, t) {
            return e.find(function(e) {
                return e.name === t
            })
        }
        function _(e, t) {
            var n = b(e, t.longName);
            n || (n = {
                name: t.longName,
                installments: []
            },
                e.push(n)),
                n.installments.push(t)
        }
        var D = [0, 1, 2, 3, 4, 5]
            , I = {};
        I[0] = "partials/awards/facultyAwards/facultyAwardsCard.html",
            I[1] = "partials/awards/utWideAwardsCard.html",
            I[2] = "partials/awards/externalAwardsCard.html",
            I[3] = "partials/awards/financialCounsellingAwardsCard.html",
            I[4] = "partials/awards/financialAidAwardsCard.html",
            I[5] = "partials/awards/utmGrantAndBursariesCard.html",
            this.getCardTemplates = function(e) {
                if (!e || !e.length)
                    return [I[2]];
                var t = angular.copy(I);
                e.every(function(e) {
                    return e.primaryOrgCode === i.SGS
                }) && delete t[1],
                e.some(function(e) {
                    return e.primaryOrgCode === i.ERIN
                }) || delete t[5],
                e.every(function(e) {
                    return e.primaryOrgCode === i.TYP
                }) && delete t[0];
                var n = [];
                return D.forEach(function(e) {
                    var r = t[e];
                    r && n.push(r)
                }),
                    n
            }
            ,
            this.getStudentAwards = function(t) {
                var n = e.defer();
                return a.getStudentAwards({
                    sessionCode: t
                }, function(e) {
                    n.resolve(e)
                }, function(e) {
                    n.reject(e)
                }),
                    n.promise
            }
            ,
            this.getStudentAttendanceInfo = function(t) {
                var n = e.defer();
                return a.getStudentAttendanceInfo({
                    sessionCode: t
                }, function(e) {
                    n.resolve(e)
                }, function() {
                    n.reject("Failed to get the student attendance info")
                }),
                    n.promise
            }
            ,
            this.getCollegeAwardLink = function(e) {
                return O[e]
            }
            ,
            this.getUtWideAwardsLinks = function(e) {
                var t, n = [];
                return e.forEach(function(e) {
                    if (e.primaryOrgCode !== i.SGS) {
                        var r = "";
                        t || (t = N.COMMON) && n.push(t),
                            r = e.primaryOrgCode === i.ERIN || e.primaryOrgCode === i.SCAR ? "UTM_UTSC" : "UTSG";
                        var a = N[r];
                        if (a) {
                            var o = a[e.attendanceClass];
                            o && !w(o, n, "text") && n.push(o)
                        }
                    }
                }),
                    n
            }
            ,
            this.getFinancialCounsellingAwardsLinks = function(e) {
                var t = e.primaryOrgCode;
                return "ARTSC" === t ? R[t][e.associatedOrgCode] : R[t]
            }
            ,
            this.getFinancialCounsellingLink = function(e) {
                if (!e)
                    return "";
                if (e === i.ERIN)
                    return "https://www.utm.utoronto.ca/registrar/financial-aid-awards/grants-bursaries/";
                var t = R[e];
                return t || (t = R.ARTSC[e]),
                    t
            }
            ,
            this.removeDuplicateAttendanceObjects = function(e) {
                var t = [];
                return e.forEach(function(e) {
                    t.find(function(t) {
                        var n = e.primaryOrgCode === t.primaryOrgCode;
                        return e.primaryOrgCode === i.ARTSC && (n = n && e.associatedOrgCode === t.associatedOrgCode),
                            n
                    }) || t.push(e)
                }),
                    t
            }
            ,
            this.processAwards = function(e) {
                var t = {
                    upcoming: [],
                    received: [],
                    cancelled: []
                };
                return A(e) || e.forEach(function(e) {
                    var n = b(t.upcoming, e.longName)
                        , r = b(t.received, e.longName)
                        , a = b(t.cancelled, e.longName);
                    e.cancelled ? n ? n.installments.push(e) : r ? r.installments.push(e) : _(t.cancelled, e) : e.journalDate ? n ? n.installments.push(e) : a ? u(t.cancelled, t.received, e) : _(t.received, e) : r ? u(t.received, t.upcoming, e) : a ? u(t.cancelled, t.upcoming, e) : _(t.upcoming, e)
                }),
                    t.upcoming = l(t.upcoming),
                    T(t.upcoming),
                    T(t.received),
                    t.cancelled = [],
                    t
            }
            ,
            this.calculateAndSetRefundAmount = function(e, t) {
                t && t.forEach(function(n) {
                    n.cancelled = !1;
                    var r;
                    n.cancelDate && (n.journalDate || n.cancelAmount > 0 && n.cancelAmount < n.amount ? d(t, n, 2) : n.cancelAmount >= n.amount && (n.type = 2,
                        n.cancelAmount = 0,
                        n.combinedCancelled = !0,
                        n.actualRefund = n.amount,
                        n.methodOfPayment = {
                            tooltipLabel: "",
                            label: i.NOT_AVAILABLE
                        },
                        n.cancelled = !0)),
                        n.journalDate ? (n.type = 2,
                            n.actualRefund = n.refundAmount,
                            n.refundAmount <= i.MINIMUM_PAYABLE_AMOUNT ? (n.actualRefund = n.amount,
                                n.methodOfPayment = {
                                    tooltipLabel: i.PAYMENT_TO_STUDENT_ACCOUNT,
                                    label: ""
                                }) : n.refundAmount >= n.amount ? n.methodOfPayment = {
                                tooltipLabel: "",
                                label: n.numberOfValidAccounts > 0 ? i.PAYMENT_BY_DIRECT_DEPOSIT : i.PAYMENT_BY_CHEQUE
                            } : (n.methodOfPayment = {
                                tooltipLabel: "",
                                label: n.numberOfValidAccounts > 0 ? i.PAYMENT_BY_DIRECT_DEPOSIT : i.PAYMENT_BY_CHEQUE
                            },
                                r = angular.copy(n),
                                r.actualRefund = r.amount - r.refundAmount,
                                r.methodOfPayment = {
                                    tooltipLabel: i.PAYMENT_TO_STUDENT_ACCOUNT,
                                    label: ""
                                },
                                t.splice(t.length, 0, r))) : (n.actualRefund = n.amount,
                        n.cancelled || (n.methodOfPayment = E(e, n.calculateRefund),
                            n.type = 1))
                })
            }
            ,
            this.isInstallmentDefinedBetween = p,
            this.getTotalAmount = function(e, t, n, r, a) {
                var o = f(e);
                return o = o.concat(f(t)),
                    o ? o.reduce(function(e, t) {
                        var o = 0;
                        return p(t, r, a) && (n === i.AWARD_TYPE_RECEIVED && t.journalDate ? o = g(t) : n !== i.AWARD_TYPE_UPCOMING || t.journalDate || (o = g(t))),
                        e + parseFloat(o)
                    }, 0) : 0
            }
            ,
            this.setDashboardUpcomingStudentAwards = function(e) {
                for (var t = [], n = 0, r = 0, a = i.UPCOMING_AWARDS_LIMIT; n < a && e[r]; ) {
                    if (e[r].installments.length) {
                        var o = e[r].installments.find(function(e) {
                            return !e.journalDate && e.actualRefund > i.MINIMUM_PAYABLE_AMOUNT
                        });
                        o && (n++,
                            t.push(o))
                    }
                    r++
                }
                return t
            }
            ,
            this.getAwardTotalAmount = function(e) {
                return e.reduce(function(e, t) {
                    var n = t.cancelled ? -t.cancelAmount : t.actualRefund;
                    return e + parseFloat(n)
                }, 0)
            }
            ,
            this.getAmount = g,
            this.getAwardsPayDate = function(e) {
                var t, r, a = "YYYY-MM", i = "MMMM yyyy";
                return e.combinedCancelled ? (t = v(e),
                    r = e.combinedCancelled) : e.cancelled ? (t = new Date(parseInt(e.cancelDate)),
                    i = "yyyy-MM-dd",
                    a = "YYYY-MM-DD",
                    r = e.cancelDate) : e.journalDate ? (t = new Date(parseInt(e.journalDate)),
                    i = "yyyy-MM-dd",
                    a = "YYYY-MM-DD",
                    r = e.journalDate) : (t = v(e),
                    r = e.paySessionCode ? e.paySessionCode.substring(0, 4) + "-0" + e.paySessionCode.substring(4, 5) : e.payMonth),
                    h(r) || s(r, a, !0).isValid() ? s(new Date(t.getTime() + 6e4 * t.getTimezoneOffset())).format(i.toUpperCase()) : (n.log(r + ", " + a),
                        n.log(s(r, a, !0).invalidAt()),
                        "Invald Date")
            }
            ,
            this.hasNonUtmPrimaryOrg = function(e) {
                return e.find(function(e) {
                    return e.primaryOrgCode != i.ERIN
                })
            }
            ,
            this.getFacultyAwardsTitle = function(e) {
                return e.find(C) ? "Awards from Your Division" : "Awards from Your Faculty"
            }
            ,
            this.getFinancialCounsellingAwardsTitle = function(e) {
                return e.every(y) ? i.FINANCIAL_AID_ADVISING : i.FINANCIAL_COUNSELLING
            }
            ,
            this.getFinancialCounsellingAwardsButtonName = function(e) {
                var t = c(e);
                return e === i.ARCLA || e === i.ERIN ? t + " " + i.FINANCIAL_AID_ADVISING : t + " " + i.FINANCIAL_COUNSELLING
            }
            ,
            this.getFinancialCounsellingAwardsBodyText = function(e, t) {
                if (e.find(C))
                    return "Financial counselling is available to assist you with managing educational expenses, budgeting and planning. SGS's financial counsellor will provide you with direction on student loans, <abbr title='University of Toronto'>U of T</abbr> grants and other opportunities.";
                var n = e.every(y)
                    , r = " and grants"
                    , a = n ? "Aid Advisors" : "Counsellors"
                    , s = e.find(function(e) {
                    return e.attendanceClass === i.FULL_TIME
                });
                return t && s && (r = ", grants and UTAPS"),
                    o("Financial {0} can assist you with budgeting and debt management, government assistance programs, scholarships{1}.", a, r)
            }
            ,
            this.getUpcomingOrReceivedDescription = function(e) {
                return e.cancelled ? i.AWARD_TYPE_CANCELLED : e.journalDate ? i.AWARD_TYPE_RECEIVED : i.AWARD_TYPE_UPCOMING
            }
            ,
            this.isObjectEmpty = A,
            this.getCampusName = c,
            this.lookup = b;
        var N = {
            UTSG: {
                FT: {
                    text: "UTSU Financial Assistance",
                    link: "http://www.utsu.ca/financial-assitance/"
                },
                PT: {
                    text: "APUS Awards",
                    link: "http://apus.ca/scholarships-bursaries/"
                }
            },
            UTM_UTSC: {
                PT: {
                    text: "APUS Awards",
                    link: "http://apus.ca/scholarships-bursaries/"
                }
            },
            COMMON: {
                text: "U of T-Wide Awards",
                link: "http://www.future.utoronto.ca/finances/scholarships/"
            }
        }
            , O = {
            INNIS: {
                text: "Innis College Awards",
                link: "http://innis.utoronto.ca/current-students/scholarships-awards/"
            },
            NEW: {
                text: "New College Awards",
                link: "http://www.newcollege.utoronto.ca/current-students/scholarships-and-financial-aid/"
            },
            SMC: {
                text: "St. Michael's College Awards",
                link: "https://stmikes.utoronto.ca/students/awards/"
            },
            TRIN: {
                text: "Trinity College Awards",
                link: "http://www.trinity.utoronto.ca/prospective/scholarships-financial-aid/in-course-scholarships.html"
            },
            UC: {
                text: "University College Awards",
                link: "http://www.uc.utoronto.ca/scholarships"
            },
            VIC: {
                text: "Victoria College Awards",
                link: "http://www.vic.utoronto.ca/students/Financial_Matters.htm"
            },
            WDW: {
                text: "Woodsworth College Awards",
                link: "http://www.wdw.utoronto.ca/index.php/current_students/scholarships_and_awards"
            }
        }
            , R = {
            ARTSC: {
                INNIS: "http://innis.utoronto.ca/current-students/academic/innis/registrar/",
                NEW: "http://www.newcollege.utoronto.ca/current-students/scholarships-and-financial-aid/financial-planning-and-counselling/",
                SMC: "https://stmikes.utoronto.ca/students/registrar/",
                TRIN: "http://www.trinity.utoronto.ca/student-services/offices/registrars-office.html",
                UC: "http://www.uc.utoronto.ca/advising",
                VIC: "http://www.vic.utoronto.ca/students/Office_of_the_Registrar/Academic_Advising.htm",
                WDW: "http://www.wdw.utoronto.ca/index.php/current_students/registrar"
            },
            APSC: "http://www.undergrad.engineering.utoronto.ca/Advising_Support/Financial_Aid.htm",
            ARCLA: "https://daniels.utoronto.ca/students/undergraduate-students/support-and-services/office-registrar-and-student-services",
            DENT: "https://www.dentistry.utoronto.ca/departments/student-services",
            ERIN: "https://www.utm.utoronto.ca/registrar/financial-aid-resources/financial-aid-advising",
            FOR: "http://forestry.utoronto.ca/contact-us/",
            FPEH: "http://www.physical.utoronto.ca/Undergraduate/ContactUs.aspx",
            MED: "http://www.md.utoronto.ca/finances-awards",
            MGT: "http://rotmancommerce.utoronto.ca/contact/",
            MUSIC: "https://music.utoronto.ca/student-services-resources.php",
            NURS: "https://bloomberg.nursing.utoronto.ca/current-students/academic-contact",
            OISUT: "http://www.oise.utoronto.ca/oise/Contacts/",
            SCAR: "http://www.utsc.utoronto.ca/registrar/financial-aid-advisors",
            SGS: "https://www.sgs.utoronto.ca/currentstudents/Pages/Financial-Aid-and-Counselling.aspx",
            PHM: "http://www.pharmacy.utoronto.ca/pharmd/office-registrar",
            LAW: "http://www.law.utoronto.ca/academic-programs/jd-program/financial-aid-and-fees",
            TST: "http://www.tst.edu/contact/directory/college-registrars-admissions-staff",
            WDW: "http://wdw.utoronto.ca/index.php/current_students/registrar",
            TYP: "http://sites.utoronto.ca/typ/contact.html"
        }
    }
    ]),
    angular.module("acornApp").factory("awardsServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
            getStudentAwards: {
                method: "GET",
                params: {
                    kind: "awards",
                    sessionCode: "@sessionCode"
                }
            },
            getStudentAttendanceInfo: {
                method: "GET",
                params: {
                    kind: "awards",
                    type: "attendance",
                    sessionCode: "@sessionCode"
                }
            }
        })
    }
    ]),
    angular.module("acornApp").controller("CalendarMainCtrl", ["$scope", "$routeParams", "$timeout", "CalendarUI", "Calendars", "CalendarManager", "KeepAlive", "uiCalendarConstants", "appCalendarDefines", "DevConfig", function(e, t, n, r, a, i, o, s, c, l) {
        e.eventSources = [],
            e.events = [],
            e.appInitialized = !1,
            e.shouldShowCalendarFilter = !1,
            e.errorMessage = null,
            e.styleUrl = l.translateCalendarUrl("partials/calendar/includes.html"),
            o.start();
        (function(t) {
                var n = !1;
                e.events.length = 0,
                    e.eventSources.length = 0;
                for (var r in t) {
                    null !== t[r] ? e.events = e.events.concat.apply(e.events, t[r]) : n = !0
                }
                return e.eventSources.push(e.events),
                    !n
            }
        )(a) || (e.errorMessage = "An error occurred while retrieving your events. Please refresh your browser to try again...");
        var u = function(t) {
            var n = $(".ngsis-event-hover");
            e.currentCalendar.view === c.CALENDAR_AGENDA_MONTH_VIEW && 0 === n.length && (r.setCurrentCalendarDate(t),
                r.goToCalendarView(c.CALENDAR_AGENDA_DAY_VIEW))
        }
            , d = r.getCurrentCalendarDate();
        e.uiConfig = {
            calendar: {
                height: r.getCalendarHeight(),
                width: s.CALENDAR_FULLCAL_WIDTH,
                editable: !1,
                header: {
                    left: "",
                    center: "prev title next",
                    right: ""
                },
                contentHeight: 1900,
                allDayText: "All Day",
                allDaySlot: !0,
                buttonText: {
                    prev: "<span class='icon-left-open'></span>",
                    next: "<span class='icon-right-open'></span>"
                },
                minTime: s.CALENDAR_MIN_TIME,
                maxTime: s.CALENDAR_MAX_TIME,
                year: d.getFullYear(),
                month: d.getMonth(),
                date: d.getDate(),
                slotEventOverlap: !0,
                titleFormat: {
                    month: "MMMM yyyy",
                    week: "'Week of' MMMM d, yyyy",
                    day: "dddd, MMMM d, yyyy"
                },
                axisFormat: "HH:mm",
                timeFormat: {
                    "": "H:mm{-H:mm}",
                    month: "H:mm",
                    agenda: "H:mm{-H:mm}"
                },
                columnFormat: {
                    month: "ddd",
                    week: "d ddd",
                    day: "dddd M/d"
                },
                defaultView: function() {
                    var e = r.getCurrentView();
                    return e === c.CALENDAR_LIST_VIEW ? c.CALENDAR_DEFAULT_VIEW : e
                }(),
                slotMinutes: c.CALENDAR_DEFAULT_MINUTES_PER_SLOT,
                dayClick: u,
                eventDrop: e.alertOnDrop,
                eventResize: e.alertOnResize
            }
        },
            e.currentCalendar = {},
            e.$watch(function() {
                return r.getCurrentView()
            }, function(t) {
                e.currentCalendar.view = t
            }),
            e.$watch(function() {
                return e.calendar.fullCalendar("getDate").toString()
            }, function() {
                var t = r.getCurrentView()
                    , n = e.calendar.fullCalendar("getDate");
                r.setCurrentCalendarDate(n),
                    r.goToCalendarView(t)
            }),
            e.$on(c.CALENDAR_VIEW_CHANGED_EVENT, function(t, n) {
                c.CALENDAR_SAFE_APPLY(e, function() {
                    e.currentCalendar.view = n
                })
            }),
            e.$on(c.CALENDAR_LOADED_EVENT, function() {
                if (e.appInitialized = !0,
                    void 0 !== t.viewSelector) {
                    var n = i.getCalendars()
                        , a = t.viewSelector
                        , o = null;
                    if (void 0 !== t.filterCalendarID ? o = t.filterCalendarID : void 0 !== t.filterCalendarAlias && (o = i.getCalendarForAlias(t.filterCalendarAlias)),
                        null === o)
                        return;
                    var s = t.requestedDate
                        , l = new Date;
                    if (void 0 !== s && s.match(c.REQUEST_DATE_REG_EX)) {
                        var u = s.split("-");
                        l.setYear(u[0]),
                            l.setMonth(u[1] - 1),
                            l.setDate(u[2])
                    }
                    for (var d in n) {
                        var p = n[d];
                        p.active = d === o
                    }
                    e.shouldShowCalendarFilter = !0,
                        r.setCurrentCalendarDate(l),
                        r.goToCalendarView(a, !1)
                }
            }),
            document.title = "Timetable & Exams",
            r.goToCalendarView(r.getCurrentView(), !1)
    }
    ]),
    angular.module("acornApp").controller("EventCtrl", ["$scope", "$routeParams", "CalendarUI", "CalendarManager", "KeepAlive", "appCalendarDefines", "DevConfig", function(e, t, n, r, a, i, o) {
        e.goBack = n.goBackFromEventView;
        var s = t.eventID
            , c = t.calendarID
            , l = !1;
        e.event = null,
            e.pageInvokedDirectly = !1,
            e.eventNotFound = !1,
            e.styleUrl = o.translateCalendarUrl("partials/calendar/includes.html"),
            a.start();
        !function() {
            var t = function() {
                e.event = r.getEventForEventIDAndCalendarID(s, c),
                    void 0 !== e.event ? e.calendar = e.event.calendarRef : l && (e.eventNotFound = !0)
            };
            t(),
            null !== e.event && void 0 !== e.event || i.CALENDAR_SAFE_APPLY(e, function() {
                l = !0,
                    r.init().then(t)
            })
        }()
    }
    ]),
    angular.module("acornApp").controller("TimetableGraphicCtrl", ["$scope", "timetableGraphicService", function(e, t) {
        e.download = function() {
            var e = angular.element("#timetableSVG");
            t.svgToImage(e)
        }
    }
    ]),
    angular.module("acornApp").directive("calendarEventInfoForId", ["CalendarManager", "CalendarUI", "appCalendarDefines", "DevConfig", function(e, t, n, r) {
        return {
            restrict: "A",
            scope: {
                event: "=calendarEventInfoForId"
            },
            templateUrl: r.translateCalendarUrl("templates/eventInfo.tpl.html"),
            link: function(e) {
                e.calendar = e.event.calendarRef;
                var r = e.calendar.id;
                e.goToEvent = function(a) {
                    e.$emit(n.CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL, {}),
                        t.goToEventViewForID(r, a)
                }
                    ,
                    e.dismissEventPopUp = function(t) {
                        var r = $(t.delegateTarget).parent().parent().parent();
                        t.stopPropagation(),
                            e.$emit(n.CALENDAR_VIEW_EVENT_POPOVER_CLOSED, r)
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("calendarEventListContainer", ["CalendarManager", "CalendarUI", "appCalendarDefines", "DevConfig", function(e, t, n, r) {
        return {
            templateUrl: r.translateCalendarUrl("templates/calendar.event.list.container.tpl.html"),
            restrict: "A",
            scope: {
                eventsOnDay: "=calendarEventListContainer",
                currentDate: "=currentDate",
                currentDay: "=eventsDay"
            },
            link: function(e, t) {
                e.currentEventDate = new Date(e.currentDate.getFullYear(),e.currentDate.getMonth(),e.currentDay),
                    e.numberOfChildEvents = e.eventsOnDay.length;
                var r = {};
                t.hide();
                var a = function() {
                    for (var e in r)
                        if (r[e] === !0)
                            return !1;
                    return !0
                };
                !function() {
                    var n = {}
                        , i = e.eventsOnDay;
                    for (var o in i) {
                        var s = i[o]
                            , c = s.calendarRef;
                        void 0 !== c && void 0 !== c.id && (n[c.id] = c,
                        void 0 === r[c.id] && (r[c.id] = c.active))
                    }
                    for (var l in n)
                        !function(n) {
                            e.$watch(function() {
                                return n.active
                            }, function(e) {
                                r[n.id] = e,
                                    a() ? t.hide() : t.show()
                            })
                        }(n[l])
                }(),
                    e.$watch(function() {
                        e.currentEventDate.getMonth(),
                            e.currentDate.getMonth()
                    }, function() {
                        e.currentDate.getMonth() !== e.currentEventDate.getMonth() || a() ? t.hide() : t.show()
                    }),
                    e.$on(n.CALENDAR_CURRENT_DATE_CHANGE_EVENT, function(n, r) {
                        r.newDate.getMonth() !== e.currentEventDate.getMonth() || a() ? t.hide() : t.show()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("calendarEventListItem", ["CalendarUI", "DevConfig", function(e, t) {
        return {
            templateUrl: t.translateCalendarUrl("templates/calendar.event.list.item.tpl.html"),
            restrict: "A",
            scope: {
                event: "=calendarEventListItem"
            },
            link: function(t, n) {
                var r = t.event
                    , a = r.calendarRef;
                t.calendar = a,
                    t.$watch(function() {
                        return a.active
                    }, function(e) {
                        e === !0 ? n.removeClass("rollOut").show().addClass("rollIn") : (n.removeClass("rollIn").addClass("rollOut"),
                            setTimeout(function() {
                                n.hide()
                            }, 200))
                    }),
                    t.goToEvent = function() {
                        e.goToEventViewForID(a.id, r.id)
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("calendarExporter", ["CalendarManager", "appCalendarDefines", "DevConfig", function(e, t, n) {
        return {
            templateUrl: n.translateCalendarUrl("templates/calendar.exporter.tpl.html"),
            restrict: "A",
            link: function(n, r) {
                var a = e.getNonEmptyCalendars();
                n.calendarList = [];
                for (var i in a) {
                    var o = a[i];
                    i && "string" == typeof o.name && "courses" === o.name.toLowerCase() && n.calendarList.push(o)
                }
                n.getCalendarURLForID = function(e) {
                    var n = "";
                    return void 0 === e ? n : n = t.CALENDAR_ICAL_FILE_DOWNLOAD_URL.replace(":calendarID", e)
                }
                    ,
                    n.getCourseICalDownloadUrl = function() {
                        return t.COURSES_ICAL_FILE_DOWNLOAD_URL
                    }
                    ,
                    n.toggleCalendarExportList = function(e) {
                        e.stopPropagation();
                        var t = r.find(".calendar-list-export-container");
                        t.is(":visible") ? t.hide() : (t.show(),
                            $("body").bind("click.calendarExport", function() {
                                t.hide(),
                                    $("body").unbind("click.calendarExport")
                            }))
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("calendarListView", ["$rootScope", "CalendarUI", "CalendarManager", "appCalendarDefines", "DevConfig", function(e, t, n, r, a) {
        return {
            templateUrl: a.translateCalendarUrl("templates/calendar.list.tpl.html"),
            restrict: "A",
            scope: {
                events: "="
            },
            link: function(a, i) {
                function o() {
                    var e = n.sortedEventsByYearMonthAndDay()
                        , t = e[a.currentDate.getFullYear()]
                        , r = null;
                    void 0 !== t && (r = t[a.currentDate.getMonth()]);
                    var i, o = [];
                    for (i in r)
                        o.push({
                            dayNumber: i,
                            events: r[i]
                        });
                    a.sortedEventsByMonth = o
                }
                a.$watch(function() {
                    return a.events
                }, function() {
                    o()
                }),
                    a.currentDate = t.getCurrentCalendarDate(),
                    a.calendarUI = t,
                    a.sortedEventsByMonth = {},
                    a.toggleMonthPickerFlag = !1,
                    a.switchToTodaysView = function() {
                        t.switchToTodayView(),
                            a.currentDate = t.getCurrentCalendarDate()
                    }
                    ,
                    t.addTodayViewToggleToCalendar(a, i),
                    o(),
                    a.$watch(function() {
                        return a.currentDate.toString()
                    }, function(n, i) {
                        var o = new Date(i);
                        a.currentDate = t.getCurrentCalendarDate(),
                            e.$broadcast(r.CALENDAR_CURRENT_DATE_CHANGE_EVENT, {
                                prevDate: o,
                                newDate: a.currentDate
                            })
                    }),
                    a.$on(r.CALENDAR_CURRENT_DATE_CHANGE_EVENT, function(e, t) {
                        t.prevDate.toString() !== t.newDate.toString() && o()
                    }),
                    a.toggleMonthPicker = function(e) {
                        e.stopPropagation(),
                            r.CALENDAR_SAFE_APPLY(a, function() {
                                a.toggleMonthPickerFlag = !a.toggleMonthPickerFlag
                            })
                    }
                    ,
                    a.incOrDecDateByMonth = function(n) {
                        r.CALENDAR_SAFE_APPLY(a, function() {
                            var i = t.getCurrentCalendarDate();
                            t.incOrDecDateByMonth(n),
                                a.currentDate = t.getCurrentCalendarDate(),
                                e.$broadcast(r.CALENDAR_CURRENT_DATE_CHANGE_EVENT, {
                                    prevDate: i,
                                    newDate: a.currentDate
                                })
                        })
                    }
                    ,
                    a.$watch(function() {
                        return t.getCurrentView()
                    }, function(e, t) {
                        e === r.CALENDAR_LIST_VIEW ? i.show() : (t === r.CALENDAR_LIST_VIEW || i.is(":visible")) && i.hide()
                    }),
                    a.$on(r.CALENDAR_VIEW_WILL_CHANGE_EVENT, function(e, t) {
                        t.newView === r.CALENDAR_LIST_VIEW ? i.show() : (t.oldView === r.CALENDAR_LIST_VIEW || i.is(":visible")) && i.hide()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("uiCalendar", ["$locale", "$compile", "$location", "uiCalendarConfig", "CalendarUI", "EventUI", "uiCalendarConstants", "appCalendarDefines", "$timeout", function(e, t, n, r, a, i, o, s, c) {
        var l = function(e) {
            var t, n;
            t = [];
            for (n in e)
                t[n] = e[n];
            return t
        }
            , u = e.DATETIME_FORMATS;
        r = angular.extend({
            monthNames: l(u.MONTH),
            monthNamesShort: l(u.SHORTMONTH),
            dayNames: l(u.DAY),
            dayNamesShort: l(u.SHORTDAY)
        }, r || {});
        var d = 1
            , p = 1;
        return {
            require: "ngModel",
            scope: {
                ngModel: "=",
                config: "=",
                events: "="
            },
            restrict: "A",
            link: function(e, n, l) {
                var u = e.ngModel;
                e.calendarHeaderDate = new Date,
                    e.destroy = function() {
                        l.calendar ? e.calendar = e.$parent[l.calendar] = n.html("") : e.calendar = n.html("")
                    }
                    ,
                    e.init = function() {
                        var t = {
                            eventSources: u
                        };
                        angular.extend(t, r, l.uiCalendar ? e.$parent.$eval(l.uiCalendar) : {}),
                            e.calendar.fullCalendar(t),
                            a.init(e.calendar, o.CALENDAR_BODY_CONTAINER_ID),
                            e.$emit(s.CALENDAR_LOADED_EVENT, {}),
                            e.calendar.fullCalendar("gotoDate", a.getCurrentCalendarDate()),
                            e.$on(s.CALENDAR_VIEW_CHANGED_EVENT, function(e, t) {
                                f(t),
                                    g.hideAllEventPopovers()
                            }),
                            e.$on(s.CALENDAR_VIEW_EVENT_POPOVER_CLOSED, function(e, t) {
                                g.hideEventPopover(t)
                            }),
                            c(function() {
                                e.calendar.fullCalendar("render")
                            }, 300)
                    }
                    ,
                    e.switchCalViewToCalendarSelection = function() {
                        e.calendarHeaderDate instanceof Date && e.calendar.fullCalendar("gotoDate", e.calendarHeaderDate)
                    }
                    ,
                    e.toggleDatePicker = function(e) {
                        e.stopPropagation(),
                            e.preventDefault();
                        var t = $(o.CALENDAR_DATE_PICKER_ID);
                        t.datepicker("widget").is(":visible") ? t.datepicker("hide") : t.datepicker("show")
                    }
                    ,
                    e.switchToTodaysView = function() {
                        a.switchToTodayView()
                    }
                    ,
                    e.destroy();
                var f = function(r) {
                    var i = function() {
                        return $(".fc-agenda-slots").find("tr:first").find("th").outerHeight(!0)
                    };
                    switch (r) {
                        case s.CALENDAR_AGENDA_DAY_VIEW:
                            !function() {
                                var e = $(".fc-agenda-slots")
                                    , t = i()
                                    , n = o.CALENDAR_MIN_TIME
                                    , r = 60 / s.CALENDAR_DEFAULT_MINUTES_PER_SLOT
                                    , a = function(e, t, r) {
                                    var a = 0
                                        , i = e;
                                    if (!(i instanceof Date) || "number" != typeof t || "number" != typeof r)
                                        return a;
                                    var o = i.getHours()
                                        , s = i.getMinutes();
                                    return a = Math.ceil(r * t * (o + s / 60)) - n * t * r
                                }
                                    , c = null
                                    , l = 0
                                    , u = function(e) {
                                    var t = new Date
                                        , n = e
                                        , r = t.getHours()
                                        , a = t.getMinutes()
                                        , i = t.getSeconds()
                                        , o = "am";
                                    r >= 12 && (o = "pm",
                                    r > 12 && (r -= 12)),
                                    a < 10 && (a = "0" + a),
                                    i < 10 && (i = "0" + i),
                                        n.html("now: " + r + ":" + a + ":" + i + " " + o)
                                }
                                    , d = a(new Date, t, r)
                                    , p = $("#timeline-container .timeline-caption")
                                    , f = $("#timeline-container");
                                e.length && !f.length && (e.before('<div id="timeline-container"><div class="left-indicator"></div><hr class="timeline" /><div class="timeline-caption"></div></div>'),
                                    p = $("#timeline-container .timeline-caption"),
                                    f = $("#timeline-container"),
                                    f.css({
                                        width: $(".fc-header").width() + "px",
                                        top: d + "px"
                                    })),
                                    u(p),
                                    f.unbind("mouseenter mouseleave").hover(function() {
                                        u(p),
                                            $(p).show();
                                        var e = a(new Date, t, r);
                                        f.animate({
                                            top: e + "px"
                                        }, "fast")
                                    }, function() {
                                        setTimeout(function() {
                                            $(p).hide()
                                        }, 150)
                                    }),
                                    c = window.setInterval(function() {
                                        if ($("#timeline-container .timeline-caption").length) {
                                            t = i();
                                            var e = a(new Date, t, r);
                                            u(p),
                                            e !== l && (l = e,
                                                f.animate({
                                                    top: l + "px"
                                                }, "fast"))
                                        } else
                                            window.clearInterval(c)
                                    }, 1e3)
                            }();
                            break;
                        case s.CALENDAR_AGENDA_WEEK_VIEW:
                            break;
                        case s.CALENDAR_AGENDA_MONTH_VIEW:
                            !function() {
                                var e = $(".fc-day-number");
                                e.parent().addClass("date-banner");
                                var t = $(".fc-day", o.CALENDAR_PARENT_DOM_CONTAINER_ID)
                                    , n = 0
                                    , r = 0
                                    , a = 0
                                    , i = $(".day-hover-overlay");
                                null !== i && i.length || ($.each(t, function() {
                                    var e = $(this)
                                        , t = e.position();
                                    a++,
                                    0 !== n && a % 7 != 0 && n === e.width() || (n = e.width(),
                                        a = 0),
                                    0 !== r && a % 7 != 0 || (r = e.height()),
                                        e.append('<div style="width: ' + n + "px; top: " + t.top + "px; left: " + t.left + "px; height:" + r + 'px; display:none;" class="day-hover-overlay"></div>')
                                }),
                                    t.hover(function() {
                                        0 === $(".ngsis-event-hover").length && $(this).find(".day-hover-overlay").show()
                                    }, function() {
                                        $(this).find(".day-hover-overlay").hide()
                                    }),
                                    e.parent().addClass("date-banner"))
                            }()
                    }
                    !function() {
                        var r = $(".fc-header .fc-header-title", o.CALENDAR_PARENT_DOM_CONTAINER_ID)
                            , i = $(o.CALENDAR_DATE_PICKER_ID);
                        if (0 === i.length) {
                            r.addClass(o.NODE_COMPILED_CLASS),
                                r.attr("data-ng-click", "toggleDatePicker($event)");
                            var c = '<input id="' + o.CALENDAR_DATE_PICKER_ID.substr(1) + '" class="date-calendar-picker" data-ui-date="dateOptions" data-ng-change="switchCalViewToCalendarSelection(\'' + s.CALENDAR_AGENDA_DAY_VIEW + '\')" data-ng-model="calendarHeaderDate">';
                            a.addTodayViewToggleToCalendar(e, n),
                                e.dateOptions = {
                                    showOtherMonths: !0,
                                    selectOtherMonths: !0,
                                    showOptions: {
                                        direction: "up"
                                    },
                                    weekHeader: "W",
                                    showButtonPanel: !0,
                                    showOn: "focus",
                                    currentText: "Select Today",
                                    onChangeMonthYearType: function() {},
                                    beforeShow: function() {
                                        setTimeout(function() {
                                            var t = new Date
                                                , n = e.calendar.fullCalendar("getDate")
                                                , r = i.datepicker("widget");
                                            t.getFullYear() !== n.getFullYear() || t.getMonth() !== n.getMonth() ? r.find(".ui-datepicker-current-day").addClass("no-today-highlight") : r.find(".ui-datepicker-current-day").removeClass("no-today-highlight")
                                        }, 100)
                                    }
                                },
                                r.append(c),
                                t(r.get(0))(e),
                                i = $(o.CALENDAR_DATE_PICKER_ID)
                        }
                        i.css({
                            left: (r.width() - 222) / 2 + "px"
                        })
                    }()
                }
                    , g = i.getPopoverUIWidget(e);
                $(document).click(g.hideAllPopovers);
                var m = function(n, r) {
                    var a = $(r);
                    a.hasClass(o.NODE_COMPILED_CLASS) || (a.addClass(o.NODE_COMPILED_CLASS),
                        a.attr("data-ui-calendar-event", n.id),
                        a.attr("data-ui-calendar-event-calendar", n.calendarRef.id),
                        t(r)(e))
                };
                r.eventAfterAllRender = function(t) {
                    s.CALENDAR_SAFE_APPLY(e, function() {
                        a.setCurrentView(t.name),
                            f(t.name)
                    })
                }
                    ,
                    r.eventAfterRender = m,
                    e.$watch(function() {
                        return e.calendar.fullCalendar("getDate").toString()
                    }, function() {
                        var t = e.calendar.fullCalendar("getDate")
                            , n = $(o.CALENDAR_DATE_PICKER_ID)
                            , r = new Date;
                        if (t instanceof Date) {
                            var i = a.getCurrentView();
                            r.getFullYear() === t.getFullYear() && r.getMonth() === t.getMonth() && "agendaWeek" != i && "agendaMonth" != i ? e.calendarHeaderDate = r : e.calendarHeaderDate = t,
                                n.datepicker("setDate", e.calendarHeaderDate),
                                n.datepicker("refresh")
                        }
                    }),
                    e.init(),
                    f(a.getCurrentView());
                var h = function(e, t) {
                    var n, r = function() {
                        var n = angular.isFunction(e) ? e() : e;
                        return angular.isArray(n) ? n.map(function(e) {
                            var n = t(e);
                            return i[n] = e,
                                n
                        }) : null
                    }, a = function(e, t) {
                        var n, r, a = [], i = {};
                        for (n = 0,
                                 r = t.length; n < r; n++)
                            i[t[n]] = !0;
                        for (n = 0,
                                 r = e.length; n < r; n++)
                            i[e[n]] || a.push(e[n]);
                        return a
                    }, i = {}, o = function(e, r) {
                        var o, s, c, l, u = {};
                        if (angular.isArray(e)) {
                            var d = a(r, e);
                            for (o = 0,
                                     s = d.length; o < s; o++) {
                                var p = d[o];
                                c = i[p],
                                    delete i[p];
                                var f = t(c);
                                f === p ? n.onRemoved(c) : (u[f] = p,
                                    n.onChanged(c))
                            }
                            var g = a(e, r);
                            for (o = 0,
                                     s = g.length; o < s; o++)
                                l = g[o],
                                    c = i[l],
                                u[l] || n.onAdded(c)
                        }
                    };
                    return n = {
                        subscribe: function(e, t) {
                            e.$watch(r, function(e, n) {
                                t && t(e, n) === !1 || o(e, n)
                            }, !0)
                        },
                        onAdded: angular.noop,
                        onChanged: angular.noop,
                        onRemoved: angular.noop
                    }
                }
                    , v = !1
                    , C = h(u, function(e) {
                    return e.__id || (e.__id = d++)
                });
                C.subscribe(e),
                    C.onAdded = function(t) {
                        e.calendar.fullCalendar("addEventSource", t),
                            v = !0
                    }
                    ,
                    C.onRemoved = function(t) {
                        e.calendar.fullCalendar("removeEventSource", t),
                            v = !0
                    }
                ;
                var y = function() {
                    for (var e = [], t = 0, n = u.length; t < n; t++) {
                        var r = u[t];
                        angular.isArray(r) && e.push(r)
                    }
                    return Array.prototype.concat.apply([], e)
                }
                    , A = h(y, function(e) {
                    return e.__uiCalId || (e.__uiCalId = p++),
                    "" + e.__uiCalId + (e.id || "") + (e.title || "") + (e.url || "") + (+e.start || "") + (+e.end || "") + (e.allDay || !1) + (e.className || "")
                });
                A.subscribe(e, function() {
                    if (v)
                        return v = !1,
                            !1
                }),
                    A.onAdded = function(t) {
                        e.calendar.fullCalendar("renderEvent", t)
                    }
                    ,
                    A.onRemoved = function(t) {
                        e.calendar.fullCalendar("removeEvents", function(e) {
                            return e === t
                        })
                    }
                    ,
                    A.onChanged = function(t) {
                        e.calendar.fullCalendar("updateEvent", t)
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("uiCalendarEvent", ["$rootScope", "$compile", "CalendarManager", "appCalendarDefines", function(e, t, n, r) {
        return {
            restrict: "A",
            scope: !0,
            link: function(a, i, o) {
                var s = o.uiCalendarEvent
                    , c = o.uiCalendarEventCalendar;
                a.event = n.getEventForEventIDAndCalendarID(s, c);
                var l = a.event.calendarRef
                    , u = null
                    , d = !1
                    , p = "";
                "string" == typeof a.event.title && (p = ("string" == typeof l.getParsedCalendarName() ? l.getParsedCalendarName() + ": " : "") + a.event.title,
                    i.attr("title", p),
                    i.attr("tabindex", 0));
                var f = function(e) {
                    var t = e.getFullYear()
                        , n = e.getMonth() + 1
                        , r = e.getDate();
                    n < 10 && (n = "0" + n),
                    r < 10 && (r = "0" + r);
                    var a = t + "-" + n + "-" + r;
                    return $('td[data-date="' + a + '"]', "div.fc-content")
                }
                    , g = function(e, t) {
                    var n = f(e.start);
                    n.length && n.children(":first").animate(t, 250, function() {
                        $(this).css(t)
                    })
                };
                i.append(t('<div class="calendar-event" tabindex="0" aria-hidden="true" role="dialog" data-calendar-event-info-for-id="event"></div>')(a)),
                    u = i.find(".calendar-event"),
                    i.hover(function() {
                        i.addClass("ngsis-event-hover")
                    }, function() {
                        i.removeClass("ngsis-event-hover")
                    }),
                    i.click(function(t) {
                        t.stopPropagation(),
                            e.$broadcast(r.CALENDAR_VIEW_EVENT_POPOVER_OPENED, {
                                jQNode: i,
                                eventID: s
                            })
                    }),
                    i.addClass(l.defaultClassName),
                    a.$watch(function() {
                        return l.active
                    }, function(e) {
                        if (i.hasClass("fc-event-vert") && !d) {
                            d = !0;
                            var t = parseFloat(i.css("border-top"))
                                , n = 2 * (parseFloat(i.css("padding-top")) || 5) + 1
                                , o = 2 * (parseFloat(i.css("padding-right")) || 5)
                                , s = 2 * (t || 1)
                                , c = 2 * (parseFloat(i.css("border-right")) || 1);
                            i.height(Math.round(i.height() + s + n)),
                                i.width(Math.round(i.width() + c + o))
                        }
                        e === !0 ? (a.event.priority === r.CALENDAR_EVENT_PRIORITY_CRITICAL && g(a.event, a.event.renderPriorityObj),
                            i.show()) : (a.event.priority === r.CALENDAR_EVENT_PRIORITY_CRITICAL && g(a.event, {
                            backgroundColor: "",
                            color: ""
                        }),
                            u.attr("aria-hidden", !0),
                            i.hide())
                    });
                var m = function() {
                    i.removeClass("ngsis-event-hover").css({
                        zIndex: ""
                    }),
                        u.attr("aria-hidden", !0),
                        !r.IE_BROWSER.isIE || r.IE_BROWSER.version >= 9 ? u.removeClass("open").css({
                            opacity: 0,
                            zIndex: ""
                        }) : u.show(function() {
                            u.removeClass("open").css({
                                zIndex: "",
                                left: "-9000px"
                            })
                        })
                };
                a.$on(r.CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL, function() {
                    m()
                }),
                    a.$on(r.CALENDAR_VIEW_EVENT_POPOVER_OPENED, function(e, t) {
                        t.eventID !== s && m()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("uiCalendarViewControl", ["CalendarUI", "CalendarManager", "appCalendarDefines", "uiCalendarConstants", "DevConfig", function(e, t, n, r, a) {
        return {
            templateUrl: a.translateCalendarUrl("templates/uiCalendarViewControl.tpl.html"),
            restrict: "A",
            scope: {
                shouldShowSelf: "=uiCalendarViewControl"
            },
            link: function(a) {
                var i = !1
                    , o = function(e) {
                    n.CALENDAR_SAFE_APPLY(a, function() {
                        var t, n = a.controls.length;
                        for (t = 0; t < n; t++)
                            a.controls[t].selected = !1;
                        a.controls[e].selected = !0
                    })
                };
                a.getCalendarViewDescription = function() {
                    return n.CALENDAR_ENGLISH_VIEW_MAP[e.getCurrentView()]
                }
                ;
                var s = function(t) {
                    o(t),
                        e.goToCalendarView(n.CALENDAR_AGENDA_DAY_VIEW, !0)
                }
                    , c = function(t) {
                    o(t),
                        e.goToCalendarView(n.CALENDAR_AGENDA_WEEK_VIEW, !0)
                }
                    , l = function(t) {
                    o(t),
                        e.goToCalendarView(n.CALENDAR_AGENDA_MONTH_VIEW, !0)
                }
                    , u = function(t) {
                    o(t),
                        e.goToCalendarView(n.CALENDAR_LIST_VIEW, !0)
                };
                a.toggleCalendarSourceFilter = function(e, t) {
                    e.stopPropagation(),
                        n.CALENDAR_SAFE_APPLY(a, function() {
                            t.active = !t.active
                        })
                }
                    ,
                    a.$on(n.CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL, function() {
                        a.toggleFilter(null, !0)
                    }),
                    a.toggleFilter = function(e, t) {
                        void 0 !== e && null !== e && e.stopPropagation();
                        var n = $("#filter-dialog")
                            , r = "boolean" == typeof t ? t : null;
                        i = null === r && !n.hasClass("open"),
                        i && n.addClass("open"),
                        i === !1 && n.removeClass("open")
                    }
                    ,
                    a.controls = [{
                        name: "Day",
                        exec: function(e) {
                            s(e)
                        },
                        selected: !1
                    }, {
                        name: "Week",
                        exec: function(e) {
                            c(e)
                        },
                        selected: !1
                    }, {
                        name: "Month",
                        exec: function(e) {
                            l(e)
                        },
                        selected: !0
                    }, {
                        name: "List",
                        exec: function(e) {
                            u(e)
                        },
                        selected: !1
                    }],
                    a.calendarListHeader = r.HEADER_MY_EVENTS,
                    a.calendarList = t.getNonEmptyCalendars();
                var d = function(e, t) {
                    switch (t) {
                        case n.CALENDAR_AGENDA_DAY_VIEW:
                            o(0);
                            break;
                        case n.CALENDAR_AGENDA_WEEK_VIEW:
                            o(1);
                            break;
                        case n.CALENDAR_AGENDA_MONTH_VIEW:
                            o(2);
                            break;
                        case n.CALENDAR_LIST_VIEW:
                            o(3)
                    }
                };
                a.$watch(function() {
                    return e.getCurrentView()
                }, function(e) {
                    d(0, e)
                }),
                    a.$watch(function() {
                        return a.shouldShowSelf
                    }, function(e) {
                        e && a.toggleFilter()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("uiErrorMessage", ["$timeout", "appCalendarDefines", function(e, t) {
        return {
            scope: {
                errorMessage: "=uiErrorMessage"
            },
            template: '<div class="error-msg-body" data-ng-bind="errorMessage"></div><div class="error-close-dialog" data-ng-click="toggleMessage()">&nbsp;&nbsp;&nbsp;&nbsp;</div>',
            restrict: "A",
            link: function(n, r) {
                var a = function() {
                    r.removeClass("bounceIn").addClass("bounceOut").animate({
                        height: "10px",
                        "font-size": "12px"
                    }, "fast", function() {
                        e(function() {
                            r.hide(function() {
                                n.$emit(t.CALENDAR_ERROR_EVENT, {
                                    errorMessage: null
                                }),
                                    r.removeClass("bounceOut").css({
                                        height: "",
                                        "font-size": ""
                                    })
                            })
                        }, 10)
                    })
                };
                n.$watch(function() {
                    return n.errorMessage
                }, function(e) {
                    "string" == typeof e && e.length > 0 ? i() : a()
                });
                var i = function() {
                    r.removeClass("invisible").addClass("bounceIn")
                };
                n.toggleMessage = function() {
                    r.is(":visible") ? a() : i()
                }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("uiMonthPicker", ["CalendarUI", "appCalendarDefines", "DevConfig", function(e, t, n) {
        return {
            templateUrl: n.translateCalendarUrl("templates/ui.month.picker.tpl.html"),
            restrict: "A",
            replace: !0,
            scope: {
                currentDate: "=uiMonthPicker",
                showSelf: "=uiMonthPickerShowToggle"
            },
            link: function(n, r) {
                function a() {
                    n.currentYear = n.currentDate.getFullYear(),
                        n.currentMonth = n.currentDate.getMonth()
                }
                n.calendarMonths = [[{
                    name: "Jan",
                    numMonth: 0
                }, {
                    name: "Feb",
                    numMonth: 1
                }, {
                    name: "Mar",
                    numMonth: 2
                }, {
                    name: "Apr",
                    numMonth: 3
                }], [{
                    name: "May",
                    numMonth: 4
                }, {
                    name: "Jun",
                    numMonth: 5
                }, {
                    name: "Jul",
                    numMonth: 6
                }, {
                    name: "Aug",
                    numMonth: 7
                }], [{
                    name: "Sep",
                    numMonth: 8
                }, {
                    name: "Oct",
                    numMonth: 9
                }, {
                    name: "Nov",
                    numMonth: 10
                }, {
                    name: "Dec",
                    numMonth: 11
                }]],
                    a(),
                    n.$watch(function() {
                        return n.showSelf
                    }, function(e) {
                        e === !0 ? r.show(function() {
                            $("body").bind("click.monthpicker", function() {
                                r.is(":visible") && r.hide(function() {
                                    t.CALENDAR_SAFE_APPLY(n, function() {
                                        n.showSelf = !1
                                    })
                                })
                            })
                        }) : ($("body").unbind("click.monthpicker"),
                            r.hide())
                    }),
                    n.$watch(function() {
                        return n.currentDate.toString()
                    }, function() {
                        a()
                    }),
                    n.incOrDecCurrentYear = function(r, a) {
                        r.stopPropagation(),
                            t.CALENDAR_SAFE_APPLY(n, function() {
                                e.incOrDecDateByYear(a)
                            })
                    }
                    ,
                    n.setMonth = function(e) {
                        t.CALENDAR_SAFE_APPLY(n, function() {
                            n.currentDate.setMonth(e)
                        })
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utX", function() {
        return function(e, t, n) {
            n.$observe("utX", function(e) {
                t.attr("x", e)
            })
        }
    }).directive("utY", function() {
        return function(e, t, n) {
            n.$observe("utY", function(e) {
                t.attr("y", e)
            })
        }
    }).directive("utWidth", function() {
        return function(e, t, n) {
            n.$observe("utWidth", function(e) {
                t.attr("width", e)
            })
        }
    }).directive("utHeight", function() {
        return function(e, t, n) {
            n.$observe("utHeight", function(e) {
                t.attr("height", e)
            })
        }
    }).directive("utClass", function() {
        return function(e, t, n) {
            n.$observe("utClass", function(e) {
                t.attr("class", e)
            })
        }
    }).directive("utTimetableGraphic", ["$window", "$log", "timetableGraphicConstants", function(e, t, n) {
        return {
            template: '<div id="drawingArea" class="time-table-container">    <svg version="1.1"        id="timetableSVG" data-ut-width="{{width}}" data-ut-height="{{height}}" style="display:none">        <g>            <foreignObject data-ut-x="{{timetableHeaderPanel.x}}" data-ut-y="{{timetableHeaderPanel.y}}"                data-ut-width="{{timetableHeaderPanel.width}}" data-ut-height="{{timetableHeaderPanelHeight}}">                <div data-ng-class="timetableHeaderPanel.class">                    <p style="font-size:14px; font-weight:700; margin: auto; vertical-align: middle;"                        data-padding-left="5"                        data-ng-class="timetableHeaderPanel.class">                            {{timetableHeaderPanel.label}}                   </p>                </div>           </foreignObject>        </g>       <g data-ng-repeat="h in headers">            <rect data-ut-x="{{h.x}}" data-ut-y="{{h.y}}" data-ut-width="{{h.width}}"                data-ut-height="{{headerHeight}}" data-ut-class="{{h.class}}">           </rect>            <foreignObject data-ut-x="{{h.x}}" data-ut-y="{{h.y}}" data-ut-width="{{h.width}}"                data-ut-height="{{headerHeight}}">                <div style="height: {{h.height}}px;">                    <p style="font-size:10px; font-weight:700; margin: auto; text-align: center; vertical-align: middle;"                        data-ng-class="h.class">                            {{h.label}}                   </p>                </div>           </foreignObject>        </g>        <g data-ng-repeat="r in grid">            <g data-ng-repeat="cell in r">                <rect data-ut-x="{{cell.x}}" data-ut-y="{{cell.y}}" data-ut-width="{{cell.width}}"                    data-ut-height="{{cell.height}}" data-ut-class="{{cell.class}}">               </rect>                <foreignObject data-ut-x="{{cell.x}}" data-ut-y="{{cell.y}}" data-ut-width="{{cell.width}}"                    data-ut-height="{{cell.height}}">                    <div style="height: {{cell.height}}px; font-size:10px;">                        <p style="font-weight:700; margin: auto; text-align: center;" class="{{cell.class}}"                            data-padding-top="3">                            {{cell.label}}                       </p>                    </div>                </foreignObject>            </g>       </g>        <g data-ng-repeat="slot in courseTimeSlots">                <rect data-ut-x="{{slot.x}}" data-ut-y="{{slot.y}}" data-ut-width="{{slot.width}}"                    data-ut-height="{{slot.height}}" data-ut-class="{{slot.class}}">               </rect>                <foreignObject data-ut-x="{{slot.x}}" data-ut-y="{{slot.y}}" data-ut-width="{{slot.width}}"                    data-ut-height="{{slot.height}}">                    <div style="height: {{slot.height}}px; font-size:10px;">                        <p style="word-break: break-all; color:#ffffff; margin-top: 0; text-align: center;"                            data-use-short-text="true" data-padding-top="3" class="{{slot.class}}">                               {{slot.label}}                       </p>                    </div>                </foreignObject>        </g>        <g data-ng-repeat="h in meetingInfoHeaders" class="meeting-info-header">            <foreignObject data-ut-x="{{h.position.x}}" data-ut-y="{{h.position.y}}" data-ut-width="{{h.width}}"                data-ut-height="{{meetingInfoHeight}}">                <div style="height: {{meetingInfoHeight}}px;">                    <p style="font-size:12px; font-weight:700; margin-top: auto; margin-bottom: auto"                        data-padding-top="5" data-padding-left="5" data-ng-class="h.class">                       {{h.label}}                   </p>                </div>           </foreignObject>       </g>        <g data-ng-repeat="meeting in meetingInfo" class="meeting-info">            <g>                <foreignObject data-ut-x="{{meeting.course.position.x}}" data-ut-y="{{meeting.course.position.y}}"                    data-ut-width="{{meeting.course.width}}" data-ut-height="{{meetingInfoHeight}}">                    <div style="height: {{meetingInfoHeight}}px;">                        <p style="font-size:10px; font-weight:normal; margin-top: auto; margin-bottom: auto"                            data-padding-top="5" data-padding-left="5" data-ng-class="meeting.class">                               {{meeting.course.label}}                       </p>                    </div>               </foreignObject>            </g>            <g>            <foreignObject data-ut-x="{{meeting.time.position.x}}" data-ut-y="{{meeting.time.position.y}}"                data-ut-width="{{meeting.time.width}}" data-ut-height="{{meetingInfoHeight}}">                <div style="height: {{meetingInfoHeight}}px;">                    <p style="font-size:10px; font-weight:normal; margin-top: auto; margin-bottom: auto"                        data-padding-top="5" data-padding-left="5" data-ng-class="meeting.class">                           {{meeting.time.label}}                   </p>                </div>           </foreignObject>            </g>            <g>            <foreignObject data-ut-x="{{meeting.location.position.x}}" data-ut-y="{{meeting.location.position.y}}"                data-ut-width="{{meeting.time.width}}" data-ut-height="{{meetingInfoHeight}}">                <div style="height: {{meetingInfoHeight}}px;">                    <p style="font-size:10px; font-weight:normal; margin-top: auto; margin-bottom: auto"                        data-padding-top="5" data-padding-left="5" data-ng-class="meeting.class">                           {{meeting.location.label}}                   </p>                </div>           </foreignObject>            </g>        </g>        <g data-ng-show="alternatingCourseExists">            <foreignObject data-ut-x="{{alternatingWeek.x}}" data-ut-y="{{alternatingWeek.y}}"                data-ut-width="{{alternatingWeek.width}}" data-ut-height="{{alternatingWeekHeight}}">                <div style="height: {{meetingInfoHeight}}px;>                    <p style="font-size:10px; font-weight:normal; margin-top: auto; margin-bottom: auto"                        data-padding-top="5" data-padding-left="5" class="{{meeting.course.class}}">                           {{alternatingWeek.label}}                   </p>                </div>           </foreignObject>       </g>    </svg>   <div data-ng-transclude></div> </div>',
            restrict: "A",
            transclude: !0,
            scope: {},
            link: function(t, r) {
                function a() {
                    var e = angular.element(".timetable-header-panel>h2").text();
                    return {
                        x: 0,
                        y: 0,
                        width: t.width,
                        label: e
                    }
                }
                function i(e) {
                    t.meetingInfo = [],
                        _ = 0,
                        e.each(function(e, n) {
                            angular.element(n).find("td").each(function(e, n) {
                                var r = c(n);
                                r && (u(r, _),
                                    t.meetingInfo.push(r),
                                    _++)
                            })
                        })
                }
                function o() {
                    return {
                        x: 0,
                        y: t.gridHeight + t.meetingInfoHeight + _ * t.meetingInfoHeight + t.timetableHeaderPanelHeight + t.headerHeight,
                        width: t.width,
                        label: n.ALTERNATING_WEEK_TEXT
                    }
                }
                function s() {
                    var e = []
                        , n = t.gridHeight + t.headerHeight + t.timetableHeaderPanelHeight;
                    return e.push({
                        label: "Course",
                        position: {
                            x: 0,
                            y: n
                        },
                        width: 2 * t.meetingInfoWidth
                    }),
                        e.push({
                            label: "Time",
                            position: {
                                x: 2 * t.meetingInfoWidth,
                                y: n
                            },
                            width: t.meetingInfoWidth
                        }),
                        e.push({
                            label: "Location",
                            position: {
                                x: 3 * t.meetingInfoWidth,
                                y: n
                            },
                            width: t.meetingInfoWidth
                        }),
                        e
                }
                function c(e) {
                    var t;
                    if (angular.element(e).find("div.meetingInfo").length) {
                        t = {},
                            t.class = angular.element(e).attr("class");
                        var n = angular.element(e).find("div.meetingInfo div.courseCodeInfo").text().trim()
                            , r = angular.element(e).find("div.meetingInfo div.courseSection").text().split(" ")[0].trim();
                        t.course = l(),
                            t.course.label = n + " " + r,
                            t.time = l(),
                            t.time.label = angular.element(e).find("div.meetingInfo div.meetInfo").text().trim() || "TBA",
                            t.location = l(),
                            t.location.label = angular.element(e).find("div.meetingInfo div.roomInfo").text().trim() || "TBA"
                    }
                    return t
                }
                function l() {
                    return {
                        label: "",
                        class: "",
                        position: {
                            x: "",
                            y: ""
                        }
                    }
                }
                function u(e, n) {
                    var r = t.gridHeight + t.meetingInfoHeight
                        , a = r + n * t.meetingInfoHeight + t.headerHeight + t.timetableHeaderPanelHeight;
                    e.course.position.x = 0,
                        e.course.position.y = a,
                        e.course.width = 2 * t.meetingInfoWidth,
                        e.time.position.x = 2 * t.meetingInfoWidth,
                        e.time.position.y = a,
                        e.time.width = t.meetingInfoWidth,
                        e.location.position.x = 3 * t.meetingInfoWidth,
                        e.location.position.y = a,
                        e.location.width = t.meetingInfoWidth
                }
                function d(e) {
                    var t = angular.element(e[1]).find("td.timeOfDay")
                        , n = 1;
                    if (t.length) {
                        var r = t.text().split(":")
                            , a = parseInt(r[r.length - 1]);
                        a && (n = 60 / a)
                    }
                    return n
                }
                function p() {
                    g(),
                        m()
                }
                function f(e) {
                    var t = angular.element(e).attr("colspan");
                    return t ? parseInt(t) : 1
                }
                function g() {
                    t.grid = [[]];
                    for (var e = T.length / S, r = b * S, a = t.headerHeight + t.timetableHeaderPanelHeight, i = 9, o = 0; o < e; o++) {
                        t.grid[o] = [];
                        var s = 0
                            , c = n.TIME_OF_DAY_COLUMN_WIDTH;
                        i > 12 && (i = 1);
                        for (var l = 0; l < 6; l++) {
                            var u = v(s, a, c, r);
                            0 === l && (u.class = n.TIME_OF_DAY,
                                u.label = i + ":00"),
                                t.grid[o].push(u),
                                s += c,
                                c = w
                        }
                        i++,
                            a += r
                    }
                }
                function m() {
                    t.courseTimeSlots = [];
                    for (var e = t.headerHeight + t.timetableHeaderPanelHeight, r = 0; r < T.length; r++) {
                        for (var a = angular.element(T[r]).contents().filter(function() {
                            return this.nodeType == Node.COMMENT_NODE || this.nodeType == Node.ELEMENT_NODE
                        }), i = n.TIME_OF_DAY_COLUMN_WIDTH, o = 0, s = 1; s < E.length; s++) {
                            for (var c = f(E[s]), l = parseInt(w / c), u = s + o; u < s + c + o; u++) {
                                var d = angular.element(a[u]);
                                if (h(d) !== n.EMPTY_SLOT) {
                                    var p = v(i, e, 0, 0, d);
                                    p.width = l * p.colSpan,
                                        p.height = b * p.rowSpan,
                                        t.courseTimeSlots.push(p)
                                }
                                i += l
                            }
                            o += c - 1
                        }
                        e += b
                    }
                }
                function h(e) {
                    var t = n.EMPTY_SLOT;
                    return e[0].nodeType !== Node.COMMENT_NODE && (t = e.attr("class")),
                        t
                }
                function v(e, r, a, i, o) {
                    var s = ""
                        , c = n.EMPTY_SLOT
                        , l = 1
                        , u = 1;
                    if (o) {
                        o[0].nodeType !== Node.COMMENT_NODE && (s = C(o),
                        s && s.indexOf("*") > -1 && (t.alternatingCourseExists = !0),
                            c = o.attr("class"),
                            l = o.attr("rowspan") ? parseInt(o.attr("rowspan")) : l,
                            u = o.attr("colspan") ? parseInt(o.attr("colspan")) : 1)
                    }
                    var d = {};
                    return d.x = e,
                        d.y = r,
                        d.class = c,
                        d.width = a,
                        d.height = i,
                        d.label = s,
                        d.rowSpan = l,
                        d.colSpan = u,
                        d
                }
                function C(e) {
                    var t = angular.element(e).attr("class");
                    if (t === n.TIME_OF_DAY || t === n.DAY_OF_WEEK)
                        return angular.element(e).text();
                    var r = angular.element(e).find(".meetingInfo").text()
                        , a = [];
                    return r.split("\n").forEach(function(e) {
                        "" !== e.trim() && a.push(e.trim())
                    }),
                        a[0]
                }
                function y() {
                    t.headers = [];
                    var e = 0
                        , r = t.timetableHeaderPanelHeight;
                    E.each(function(a, i) {
                        var o = 0 === a ? n.TIME_OF_DAY_COLUMN_WIDTH : w
                            , s = v(e, r, o, t.headerHeight, angular.element(i));
                        t.headers.push(s),
                            e += o
                    })
                }
                function A() {
                    E = angular.element(r).find("table.timetableSchedule th"),
                        T = angular.element(r).find("table.timetableSchedule tbody tr"),
                        S = d(T),
                        t.width = r[0].getBoundingClientRect().width,
                        t.height = angular.element(e).height(),
                        t.headerHeight = 24,
                        t.meetingInfoHeight = 14,
                        t.alternatingWeekHeight = 22,
                        t.timetableHeaderPanelHeight = 22,
                        t.gridHeight = parseInt(t.height * (5 / 9)),
                        w = parseInt((t.width - n.TIME_OF_DAY_COLUMN_WIDTH) / n.NUMBER_OF_COLUMNS),
                        b = parseInt(t.gridHeight / T.length),
                        t.meetingInfoWidth = parseInt(1.5 * w),
                        t.timetableHeaderPanel = a(),
                        y(),
                        p(),
                        t.meetingInfoHeaders = s(),
                        i(T),
                        t.alternatingWeek = o()
                }
                var E, T, S, w, b, _ = 0;
                A(),
                    t.$watch(function() {
                        return r[0].getBoundingClientRect().width
                    }, function(n, r) {
                        n !== r && (t.width = n,
                            t.height = angular.element(e).height(),
                            A())
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").service("CalendarList", ["$http", "$q", "DevConfig", "appCalendarDefines", "uiCalendarConstants", function(e, t, n, r, a) {
        var i = {}
            , o = this
            , s = function(e) {
            var t = e.name.toLowerCase();
            this.getCircleClass = function() {
                return t + a.CALENDAR_LIST_CIRC_POSTFIX_CLASS
            }
                ,
                this.getDefaultClass = function() {
                    return t
                }
        }
            , c = function(e) {
            if (void 0 === e.items || !angular.isArray(e.items))
                throw new Error("Calendar List appears to have no calendars!");
            var t, n = e.items;
            for (i = {},
                     t = 0; t < n.length; t++) {
                var r = n[t];
                r.selected = !0,
                    o.addCalendar(r.id, r.summary, r.selected === !0 && r.selected)
            }
            return i
        };
        return this.refresh = function(a) {
            var i = t.defer();
            return e({
                method: "GET",
                url: n.translateURL(r.CALENDAR_GET_LIST_URL.replace(":userID", a))
            }).then(function(e) {
                var t = c(e.data);
                i.resolve(t)
            }, function() {
                i.resolve({})
            }),
                i.promise
        }
            ,
            this.addCalendar = function(e, t, n) {
                i[e] = {
                    id: e,
                    name: t,
                    active: n === !0,
                    getParsedCalendarName: function() {
                        return t.toUpperCase().replace("_", " ").toLowerCase().replace(/\b(\w{1})(\w*\b)/g, function(e, t, n) {
                            return t.toUpperCase() + n
                        })
                    }
                },
                    i[e].UI = new s(i[e])
            }
            ,
            this.removeCalendar = function(e) {
                delete i[e]
            }
            ,
            this.getCalendars = function() {
                return i
            }
            ,
            this.getCalendarWithID = function(e) {
                return i[e]
            }
            ,
            this
    }
    ]),
    angular.module("acornApp").service("CalendarManager", ["$q", "$timeout", "GetUserInfo", "CalendarList", "EventList", function(e, t, n, r, a) {
        var i = {}
            , o = {}
            , s = []
            , c = null
            , l = null
            , u = function(e) {
            var t = [];
            if (null === e || "object" != typeof e)
                return t;
            for (var n in e)
                t = t.concat.apply(t, o[n]);
            return t = t.sort(function(e, t) {
                var n = e.start.getTime()
                    , r = t.start.getTime();
                return n > r ? 1 : n < r ? -1 : 0
            })
        }
            , d = function(t) {
            var n = e.defer()
                , r = 0
                , s = 0;
            i = t;
            var c = function(e) {
                r++,
                null !== e && (o[e.calendarID] = e.events,
                    t[e.calendarID].eventLength = e.events.length),
                r === s && n.resolve(o)
            };
            for (var l in t)
                s++,
                    t[l].eventLength = 0,
                    a.refresh(t[l]).then(c);
            return 0 === s && n.resolve({}),
                n.promise
        }
            , p = function(e) {
            return r.refresh(e.userId)
        }
            , f = function() {
            return n.refresh()
        };
        return this.init = function(n) {
            function r() {
                l = null,
                    u.resolve(o)
            }
            function a() {
                u.resolve({})
            }
            var u = e.defer();
            if (n !== !0 && s.length && (l = u.promise,
                    t(r, 0)),
                    l)
                return l;
            i = {},
                o = {},
                s.length = 0,
                c = null,
                l = u.promise;
            var g = f();
            return "function" == typeof g.then ? g.then(p).then(d).then(r, a) : p(g).then(d).then(r, a),
                l
        }
            ,
            this.getCalendars = function() {
                return i
            }
            ,
            this.getNonEmptyCalendars = function() {
                var e = {};
                for (var t in i) {
                    var n = i[t];
                    n.eventLength > 0 && (e[t] = n)
                }
                return e
            }
            ,
            this.getCalendarForID = function(e) {
                return i[e]
            }
            ,
            this.getCalendarForAlias = function(e) {
                var t = null
                    , n = e.toLowerCase();
                for (var r in i)
                    if (i[r].name.toLowerCase() === n) {
                        t = r;
                        break
                    }
                return t
            }
            ,
            this.getAllEventsSortedByMonth = function() {
                return 0 === s.length && (s = u(o)),
                    s
            }
            ,
            this.getEventsForCalendar = function(e) {
                return o[e]
            }
            ,
            this.sortedEventsByYearMonthAndDay = function e() {
                if (null !== c)
                    return c;
                for (var t = this.getAllEventsSortedByMonth(), e = {}, n = t.length, r = 0; r < n; r++) {
                    var a = t[r]
                        , i = a.start.getMonth()
                        , o = a.start.getDate()
                        , s = a.start.getFullYear();
                    void 0 === e[s] && (e[s] = {}),
                    void 0 === e[s][i] && (e[s][i] = {}),
                    void 0 === e[s][i][o] && (e[s][i][o] = []),
                        e[s][i][o].push(a)
                }
                return c = e
            }
            ,
            this.getEventForEventIDAndCalendarID = function(e, t) {
                var n = o[t];
                if (void 0 === n)
                    return n;
                var r, a = n.length;
                for (r = 0; r < a; r++) {
                    var i = n[r];
                    if (i.id === e)
                        return i
                }
            }
            ,
            this
    }
    ]),
    angular.module("acornApp").service("CalendarUI", ["$rootScope", "$location", "$compile", "$log", "CalendarManager", "uiCalendarConstants", "appCalendarDefines", function(e, t, n, r, a, i, o) {
        var s, c = null, l = null, u = o.CALENDAR_DEFAULT_VIEW, d = new Date, p = function(t, n) {
            return u === t || (void 0 === l || null === l ? (r.error("calendarBodyDOM is not valid!"),
                    !1) : (e.$broadcast(o.CALENDAR_VIEW_WILL_CHANGE_EVENT, {
                    oldView: u,
                    newView: t
                }),
                    u === o.CALENDAR_LIST_VIEW ? ($("#calendar-list-widget").hide(),
                        $("#calendar-cal-widget").show(),
                        c.fullCalendar("changeView", t),
                        c.fullCalendar("gotoDate", d),
                        e.$broadcast(o.CALENDAR_VIEW_CHANGED_EVENT, t),
                        !0) : (u = t,
                        s = n === !0 || void 0 === n ? function() {
                            l.show(function() {
                                c.fullCalendar("changeView", t),
                                    c.fullCalendar("gotoDate", d),
                                    l.show(),
                                    e.$broadcast(o.CALENDAR_VIEW_CHANGED_EVENT, t)
                            })
                        }
                            : function() {
                            c.fullCalendar("changeView", t),
                                c.fullCalendar("gotoDate", d),
                                e.$broadcast(o.CALENDAR_VIEW_CHANGED_EVENT, t)
                        }
                        ,
                        s(),
                        !0)))
        };
        this.init = function(e, t) {
            c = e,
                l = $(t)
        }
            ,
            this.setDayView = function(e) {
                var t = o.CALENDAR_AGENDA_DAY_VIEW;
                p(t, e)
            }
            ,
            this.setWeekView = function(e) {
                var t = o.CALENDAR_AGENDA_WEEK_VIEW;
                p(t, e)
            }
            ,
            this.setMonthView = function(e) {
                var t = o.CALENDAR_AGENDA_MONTH_VIEW;
                p(t, e)
            }
            ,
            this.setListView = function() {
                e.$broadcast(o.CALENDAR_VIEW_WILL_CHANGE_EVENT, {
                    oldView: u,
                    newView: o.CALENDAR_LIST_VIEW
                }),
                    u = o.CALENDAR_LIST_VIEW,
                    $("#calendar-cal-widget").hide(),
                    $("#calendar-list-widget").show(),
                    e.$broadcast(o.CALENDAR_VIEW_CHANGED_EVENT, u)
            }
            ,
            this.getCurrentView = function() {
                return u
            }
            ,
            this.setCurrentView = function(e) {
                u = e
            }
            ,
            this.goToEventViewForID = function(n, r) {
                o.CALENDAR_SAFE_APPLY(e, function() {
                    t.path("/calendar/event/" + n + "/" + r)
                })
            }
            ,
            this.goToCalendarView = function(e, t) {
                switch (e) {
                    case o.CALENDAR_AGENDA_WEEK_VIEW:
                        this.setWeekView(t);
                        break;
                    case o.CALENDAR_AGENDA_DAY_VIEW:
                        this.setDayView(t);
                        break;
                    case o.CALENDAR_LIST_VIEW:
                        this.setListView(t);
                        break;
                    case o.CALENDAR_AGENDA_MONTH_VIEW:
                    default:
                        this.setMonthView(t)
                }
            }
            ,
            this.goBackFromEventView = function() {
                o.CALENDAR_SAFE_APPLY(e, function() {
                    t.path("/calendar")
                })
            }
            ,
            this.setCurrentCalendarDate = function(e) {
                var t;
                t = void 0 !== e && null !== e && e instanceof Date ? e : "string" == typeof e ? new Date(e) : new Date,
                    d.setFullYear(t.getFullYear()),
                    d.setMonth(t.getMonth()),
                    d.setDate(t.getDate())
            }
            ,
            this.incOrDecDateByMonth = function(e) {
                var t = d.getMonth()
                    , n = d.getFullYear()
                    , r = d.getDate();
                "+" === e ? 11 === t ? (t = 0,
                    n++) : t++ : 0 === t ? (t = 11,
                    n--) : t--,
                r > 28 && (r = 1),
                    d.setDate(r),
                    d.setMonth(t),
                    d.setYear(n)
            }
            ,
            this.incOrDecDateByYear = function(e) {
                var t = d.getFullYear()
                    , n = d.getDay();
                "+" === e ? t++ : t--,
                n > 28 && d.setDate(1),
                    d.setYear(t)
            }
            ,
            this.getCurrentCalendarDate = function() {
                return d
            }
            ,
            this.switchToTodayView = function(e) {
                var t = this.getCurrentView()
                    , n = new Date;
                "string" == typeof e && (t = e),
                    this.setCurrentCalendarDate(n),
                t !== o.CALENDAR_LIST_VIEW && c.fullCalendar("gotoDate", n),
                    this.refreshFullCalendarWithDate(n),
                    this.goToCalendarView(t)
            }
            ,
            this.refreshFullCalendarWithDate = function(e) {
                if (null === c)
                    return void r.warn("Full Calendar Object not initialized!", c);
                e instanceof Date || (e = this.getCurrentCalendarDate()),
                    c.fullCalendar("gotoView", this.getCurrentView()),
                    c.fullCalendar("gotoDate", e)
            }
            ,
            this.addTodayViewToggleToCalendar = function(e, t) {
                if (void 0 !== e && "object" == typeof t) {
                    var r = $(".todayViewToggle", t);
                    0 === r.length && ($(i.CALENDAR_HEADER_LEFT, t).append('<a class="todayViewToggle" title="Go to today\'s date in this calendar\'s view." data-ng-click="switchToTodaysView()">Today</a>'),
                        r = $(".todayViewToggle", t),
                        n(r.get(0))(e))
                }
            }
        ;
        var f = function(e) {
            function t(e) {
                for (var t in e) {
                    var n = e[t];
                    s = 0;
                    for (var a in n) {
                        var c = n[a];
                        "string" == typeof c.title && (s += Math.ceil(c.title.length / o) * i)
                    }
                    s > r && (r = s)
                }
            }
            var n = a.sortedEventsByYearMonthAndDay()
                , r = 119
                , i = 17
                , o = 6
                , s = 0;
            if (null === n || void 0 === n)
                return r;
            if ("object" == typeof e && e instanceof Date) {
                if (void 0 !== n[e.getFullYear()] && void 0 !== n[e.getFullYear()][e.getMonth()]) {
                    var c = n[e.getFullYear()][e.getMonth()];
                    t(c)
                }
                return r
            }
            for (var l in n) {
                var u = n[l];
                for (var d in u)
                    c = u[d],
                        t(c)
            }
            return r
        };
        return this.getCalendarHeight = function(e) {
            if (t > 0)
                return t;
            var t = i.CALENDAR_FULLCAL_HEIGHT
                , n = o.CALENDAR_DEFAULT_CALENDAR_HEIGHT_SCALE
                , r = Math.ceil(f(e) * n);
            return t = t > r ? t : r
        }
            ,
            this
    }
    ]),
    angular.module("acornApp").service("eventArrayMapper", function() {
        var e = {}
            , t = []
            , n = function() {
            e = {};
            var n;
            for (n = 0; n < t.length; n++) {
                var r = t[n].id;
                void 0 !== r && (e[r] = n)
            }
        };
        return this.getEventForEventID = function(n) {
            var r = e[n];
            return void 0 === r ? null : t[r]
        }
            ,
            this.setEventCache = function(e) {
                return !!angular.isArray(e) && (t = e,
                        n(),
                        !0)
            }
            ,
            this.getEventCache = function() {
                return t
            }
            ,
            this
    }),
    Date.prototype.getWeek = function() {
        return $.datepicker.iso8601Week(this)
    }
    ,
    angular.module("acornApp").factory("EventList", ["$http", "$q", "$log", "DevConfig", "eventArrayMapper", "appCalendarDefines", "uiCalendarConstants", function(e, t, n, r, a, i, o) {
        var s = function(e, t, n, r, a) {
            var i = new Date(e,0,10,12,0,0)
                , o = new Date(e,0,4,12,0,0)
                , s = o.getTime() - 864e5 * i.getDay()
                , c = new Date(s + 864e5 * (7 * (t - 1) + n));
            return c.setHours(r),
                c.setMinutes(a),
                c
        }
            , c = function(e) {
            if ("string" != typeof e)
                return e;
            var t = e.match(/^(\d+)\-(\d+)\-(\d+)T(\d+):(\d+):(\d+)\.(\d+)([+\-]\d+:\d+)/i);
            return new Date(t[1],parseInt(t[2], 10) - 1,t[3],t[4],t[5])
        }
            , l = function(e, t) {
            var r = e.recurrence
                , a = []
                , i = {
                SU: 0,
                MO: 1,
                TU: 2,
                WE: 3,
                TH: 4,
                FR: 5,
                SA: 6
            };
            if (null !== e && (e.calendarRef = t),
                null === e || void 0 === r || !angular.isArray(r))
                return e;
            for (var o = 0; o < r.length; o++) {
                var c = r[o].match(/^rrule:(.*)/i);
                if (angular.isArray(c) && 2 == c.length) {
                    var l = c[1].match(/([\w]+=[\w,\s]+);?/g);
                    if (angular.isArray(l) && 4 == l.length) {
                        var u = l[0]
                            , d = l[1]
                            , p = l[2]
                            , f = l[3];
                        if (u.match(/yearly/i) && d.match(/byweekno=\d/i) && p.match(/WKST=mo/i) && f.match(/byday=[\w]+/i))
                            for (var g = d.match(/(\d+),?/g), m = f.match(/\w+=(\w+)/), h = m[1].toUpperCase(), v = 0; v < g.length; v++) {
                                var C = g[v].replace(/,/, "")
                                    , y = angular.copy(e);
                                y.id = y.id + "_" + C,
                                    y.start = s(e.start.getFullYear(), C, i[h] - 1, e.start.getHours(), e.start.getMinutes()),
                                    y.end = s(e.end.getFullYear(), C, i[h] - 1, e.end.getHours(), e.end.getMinutes()),
                                    y.calendarRef = t,
                                    a.push(y)
                            }
                        else
                            n.warn("recurrence rule is not valid for event ", e, " ignoring...", l)
                    } else
                        n.warn("recurrence rule is not valid for event ", e, " ignoring...", l)
                } else
                    n.warn("recurrence rule is not valid for event ", e, " ignoring...")
            }
            return a
        }
            , u = function(e, t) {
            var r = [];
            if (void 0 === t.items || !angular.isArray(t.items))
                return r;
            var a, s, u = t.items, d = {}, p = null, f = u.length, g = 0, m = [];
            for (a = 0; a < f; a++) {
                if (p = u[a],
                        d = {},
                    void 0 === p.start || void 0 === p.end || "object" != typeof p.start || "object" != typeof p.end)
                    throw new Error("Event does not have a start and/or end date!");
                if ("string" != typeof p.status || !p.status.match(/cancel/i))
                    if (d.id = p.id,
                            d.title = p.summary,
                        void 0 !== p.start && null !== p.start && void 0 !== p.end && null !== p.end) {
                        if (d.start = c(p.start.dateTime),
                                d.end = c(p.end.dateTime),
                                d.created = c(p.created),
                                d.updated = c(p.updated),
                                d.recurrence = p.recurrence,
                                d.timeZone = "EST/EDT",
                                d.isAllDay = !1,
                            d.end instanceof Date && d.start instanceof Date && (d.isAllDay = Math.abs(d.end.getTime() - d.start.getTime()) / 1e3 >= 86400),
                                d.allDay = d.isAllDay,
                                d.location = {},
                                d.location.buildingName = "",
                                d.location.roomNumber = "",
                                d.description = "No description entered...",
                            void 0 !== p.description && /\w+/.test(p.description) && (d.description = p.description),
                                d.author = {},
                                d.author.name = "",
                                d.author.email = "",
                            void 0 !== p.creator && null !== p.creator && (d.author.name = p.creator.displayName,
                                d.author.email = p.creator.email),
                                d.organizer = {},
                                d.organizer.name = "",
                                d.organizer.email = "",
                            void 0 !== p.organizer && null !== p.organizer && "COURSES" === e.name.toUpperCase() && (d.organizer.name = null === p.organizer.displayName || "null" === p.organizer.displayName || "" === p.organizer.displayName ? "Not listed" : p.organizer.displayName,
                                d.organizer.email = p.organizer.email),
                            "COURSES" === e.name.toUpperCase() && (d.organizer.name = "Instructor: " + d.organizer.name),
                            void 0 !== p.location && null !== p.location && "null" !== p.location)
                            if (i.JSON_STRING_DELIMITER_REG_EX.test(p.location)) {
                                var h = p.location.split(i.JSON_STRING_DELIMITER_REG_EX);
                                d.location.buildingName = "null" !== h[0] ? h[0] : "",
                                    d.location.roomNumber = "null" !== h[1] ? h[1] : ""
                            } else
                                d.location.roomNumber = "" + p.location;
                        d.className = [],
                            d.className = d.className.concat.apply(d.className, o.CALENDAR_DEFAULT_EVENT_CLASSES),
                            "courses" === e.UI.getDefaultClass() ? void 0 === d.title || "null" === d.title ? d.className.push(o.CALENDAR_DEFAULT_EVENT_COURSES_CLASSES[0]) : void 0 === m[d.title] ? (g >= o.CALENDAR_DEFAULT_EVENT_COURSES_CLASSES.length && (g = 0),
                                d.className.push(o.CALENDAR_DEFAULT_EVENT_COURSES_CLASSES[g]),
                                m[d.title] = o.CALENDAR_DEFAULT_EVENT_COURSES_CLASSES[g],
                                g++) : d.className.push(m[d.title]) : d.className.push(e.UI.getDefaultClass()),
                            "EXAMS" === e.name.toUpperCase() ? (d.priority = i.CALENDAR_EVENT_PRIORITY_CRITICAL,
                                d.renderPriorityObj = {
                                    backgroundColor: "#076a0c",
                                    color: "#fff"
                                }) : (d.priority = i.CALENDAR_EVENT_PRIORITY_DEFAULT,
                                d.renderPriorityObj = {
                                    backgroundColor: "",
                                    color: "#000"
                                }),
                            s = l(d, e),
                            angular.isArray(s) ? r = r.concat(s) : r.push(s)
                    } else
                        n.warn("Corrupt event: ", p)
            }
            return r
        };
        return {
            refresh: function(n) {
                var a = n.id;
                if (null === a || void 0 === a)
                    throw new Error("calendar ID does not exist!");
                var o = t.defer();
                return e({
                    method: "GET",
                    url: r.translateURL(i.CALENDAR_EVENT_LIST_URL.replace(":calendarID", a))
                }).then(function(e) {
                    var t = u(n, e.data);
                    o.resolve({
                        calendarID: a,
                        events: t
                    })
                }).error(function() {
                    o.resolve(null)
                }),
                    o.promise
            }
        }
    }
    ]),
    angular.module("acornApp").service("EventUI", ["$rootScope", "CalendarUI", "uiCalendarConstants", "appCalendarDefines", function(e, t, n, r) {
        var a = function(n) {
            var a = this;
            n.$on(r.CALENDAR_VIEW_EVENT_POPOVER_OPENED, function(e, t) {
                a.showEventPopover(t.jQNode, t.eventID)
            });
            var i = function(e) {
                if (t.getCurrentView() === r.CALENDAR_AGENDA_WEEK_VIEW) {
                    var n = $(".fc-agenda-slots")
                        , a = n.parent();
                    a.css({
                        "overflow-x": "auto",
                        "-webkit-overflow-scrolling": "auto"
                    }).parent().css({
                        "overflow-x": "auto",
                        "-webkit-overflow-scrolling": "auto"
                    }),
                    e.hasClass("right") || (n.addClass("overflow-trigger").width(a.width() + 200 + "px"),
                        a.animate({
                            left: "-100px",
                            width: "+=100px"
                        }, "fast"))
                }
            }
                , o = function() {
                var e = $(".fc-agenda-slots.overflow-trigger");
                e.length && e.removeClass("overflow-trigger").parent().animate({
                    left: "0px",
                    width: "-=100px"
                }, "fast")
            };
            a.showEventPopover = function(e, t) {
                var n = a.eventInfoPopoverExists(e, t);
                r.IE_BROWSER.isIE && r.IE_BROWSER.version < 9 && n.css({
                    left: ""
                }),
                    n.attr("aria-hidden", !1);
                var o = n.offset()
                    , s = o.left
                    , l = $(".fc-view")
                    , u = l.width() / 2;
                c(n, l),
                s >= l.width() - u && i(n),
                    e.css({
                        zIndex: "10000"
                    }),
                    $(".fc-event-container").css({
                        zIndex: ""
                    }),
                    !r.IE_BROWSER.isIE || r.IE_BROWSER.version >= 9 ? n.addClass("open").css({
                        zIndex: "10000",
                        opacity: 1
                    }) : n.fadeIn("fast", function() {
                        n.addClass("open").css({
                            zIndex: "10000",
                            opacity: 1
                        })
                    })
            }
                ,
                a.hideEventPopover = function() {
                    o(),
                        e.$broadcast(r.CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL, {})
                }
                ,
                a.hideAllEventPopovers = function() {
                    e.$broadcast(r.CALENDAR_VIEW_EVENT_POPOVER_CLOSE_ALL, {}),
                        o()
                }
                ,
                a.hideAllPopovers = function() {
                    a.hideAllEventPopovers()
                }
                ,
                a.toggleEventInfoPopover = function() {
                    var e = $(this);
                    a.eventInfoPopoverExists(e).toggleClass("open")
                }
                ,
                a.eventInfoPopoverExists = function(e) {
                    return e.find(".calendar-event")
                }
            ;
            var s = function(e) {
                return angular.extend(e.offset(), {
                    height: e.height(),
                    width: e.width()
                })
            }
                , c = function(e, t) {
                e.removeClass("top").removeClass("bottom").removeClass("left").removeClass("right").css({
                    top: "",
                    left: "",
                    background: ""
                });
                var n, a = s(t), i = s(e), o = [{
                    class: "bottom",
                    top: 24,
                    left: -30
                }, {
                    class: "top",
                    top: -280,
                    left: -30
                }, {
                    class: "right",
                    top: -55,
                    left: -390
                }], c = !1, l = 0, u = 0;
                for (n = 0; n < o.length; n++) {
                    var d = o[n]
                        , p = {
                        top: d.top + i.top,
                        left: d.left + i.left,
                        height: i.height,
                        width: i.width
                    };
                    if (function(e, t) {
                            var n = e.left
                                , r = e.top
                                , a = e.width
                                , i = e.height
                                , o = t.left
                                , s = t.top
                                , c = t.width
                                , l = t.height;
                            return n >= o && n + a <= o + c && r >= s && r + i <= s + l
                        }(p, a)) {
                        c = n;
                        break
                    }
                    (u = function(e, t) {
                        var n = e.left
                            , r = e.top
                            , a = n + e.width
                            , i = r + e.height
                            , o = t.left
                            , s = t.top
                            , c = o + t.width
                            , l = s + t.height;
                        return Math.max(0, Math.min(a, c) - Math.max(n, o)) * Math.max(0, Math.min(i, l) - Math.max(r, s))
                    }(p, a)) > l && (c = n,
                        l = u)
                }
                var f = e.find(".event-content")
                    , g = e.find(".event-content-arrow");
                "number" == typeof c ? (d = o[c],
                    e.addClass(d.class).css({
                        top: d.top + "px",
                        left: d.left + "px",
                        background: d.background
                    }),
                "top" === d.class && g.css({
                    top: f.outerHeight() + "px",
                    position: "relative"
                })) : c === !1 && (e.addClass(o[1].class).css({
                    top: o[1].top + "px",
                    left: o[1].left + "px",
                    background: o[1].background
                }),
                "top" === d.class && g.css({
                    top: f.outerHeight() + "px",
                    position: "relative"
                })),
                r.IE_BROWSER.isIE && r.IE_BROWSER.version < 10 && e.show("fast")
            };
            return this
        };
        return {
            getPopoverUIWidget: function(e) {
                return new a(e)
            }
        }
    }
    ]),
    angular.module("acornApp").service("GetUserInfo", ["$http", "$q", "DevConfig", "appCalendarDefines", function(e, t, n, r) {
        var a = null;
        this.refresh = function() {
            if (null !== a)
                return a;
            var i = t.defer();
            return e({
                method: "GET",
                url: n.translateURL(r.CALENDAR_USER_INFO_URL, !0)
            }).then(function(e) {
                a = e.data,
                    i.resolve(e.data)
            }, function(e) {
                i.reject("Unable to get user info from the server due to " + e.statusText)
            }),
                i.promise
        }
    }
    ]),
    angular.module("acornApp").service("KeepAlive", ["$http", "DevConfig", "appCalendarDefines", function(e, t, n) {
        var r = null
            , a = 0
            , i = function() {
            if (++a >= n.CALENDAR_DEFAULT_KEEP_ALIVE_PING_RETRIES)
                return void this.stop();
            e({
                method: "GET",
                url: t.translateURL(n.CALENDAR_DEFAULT_KEEP_ALIVE_PING_URL)
            })
        }
            , o = function() {
            null !== r && clearInterval(r)
        };
        this.start = function() {
            o(),
                a = 0;
            setTimeout(function() {
                r = setInterval(i, 6e4 * n.CALENDAR_DEFAULT_KEEP_ALIVE_PING_INTERVAL)
            }, 6e4 * n.CALENDAR_DEFAULT_KEEP_ALIVE_PING_INTERVAL)
        }
            ,
            this.stop = function() {
                o()
            }
    }
    ]),
    angular.module("acornApp").service("timetableGraphicService", ["timetableGraphicConstants", function(e) {
        function t(e) {
            return $.parseJSON(JSON.stringify(e.data()))
        }
        function n(e, t, n) {
            if (angular.isDefined(t[0])) {
                var r = n.utX
                    , a = n.utY
                    , i = n.utWidth
                    , o = n.utHeight
                    , s = t.css("stroke")
                    , c = t.css("fill");
                e.strokeStyle = s,
                    e.strokeRect(r, a, i, o),
                    e.fillStyle = c,
                    e.fillRect(r, a, i, o)
            }
        }
        function r(t, n, r, o) {
            if (angular.isDefined(n[0]) && r) {
                var s = parseInt(o.paddingTop)
                    , c = parseInt(o.paddingLeft)
                    , l = !!o.useShortText
                    , u = c ? r.utX + c : r.utX
                    , d = s ? r.utY + s : r.utY
                    , p = r.utWidth
                    , f = r.utHeight
                    , g = n.css("text-align") || "start"
                    , m = n.css("vertical-align") || "hanging"
                    , h = n.css("color")
                    , v = n.css("font-size")
                    , C = n.css("font")
                    , y = n.text();
                m = "baseline" === m ? "hanging" : m,
                    y = l && y.trim().length > e.MAX_COURSE_TITLE_CHARACTERS ? y.trim().substring(0, e.MAX_COURSE_TITLE_CHARACTERS) : y.trim(),
                    t.textBaseline = m,
                    t.textAlign = g,
                    u = "center" === g ? u + p / 2 : u,
                    d = "middle" === m ? d + f / 2 : d,
                    t.fillStyle = h,
                    t.font = C,
                    y = a(n, y),
                    i(t, y, u, d, p, v)
            }
        }
        function a(t, n) {
            return t.hasClass(e.DAY_OF_WEEK) ? n.substring(0, 3) : n
        }
        function i(e, t, n, r, a, i) {
            i.indexOf("px") > -1 && (i = i.substring(0, i.indexOf("px")),
                i = Math.ceil(parseFloat(i)));
            var o = e.measureText(t);
            if (o.width <= a)
                e.fillText(t, n, r);
            else {
                for (var s = "", c = 0; c < t.length; c++) {
                    var l = s + t[c];
                    o = e.measureText(l);
                    o.width > a ? (e.fillText(s, n, r),
                        s = t[c],
                        r += i) : s = l
                }
                e.fillText(s, n, r)
            }
        }
        this.svgToImage = function(e) {
            var a = document.createElement("canvas");
            if (a.getContext) {
                var i = a.getContext("2d")
                    , o = t(e)
                    , s = o.utX || 0
                    , c = o.utY || 0
                    , l = o.utWidth
                    , u = o.utHeight;
                a.width = l,
                    a.height = u,
                    i.fillStyle = "#FFFFFF",
                    i.fillRect(s, c, l, u),
                    e.find("g").each(function(e, a) {
                        var o = angular.element(a).find(">rect")
                            , s = t(o);
                        n(i, o, s);
                        var c = angular.element(a).find(">foreignObject");
                        s = t(c);
                        var l = angular.element(c).find("p")
                            , u = t(l);
                        r(i, l, s, u)
                    }),
                    window.open(i.canvas.toDataURL("image/png"), "_blank")
            } else
                alert("Sorry. Your browser does not support HTML5 Canvas")
        }
    }
    ]),
    angular.module("acornApp").controller("CaptchaCtrl", ["$scope", "$log", "$window", "captchaServerResources", function(e, t, n, r) {
        e.captchaResponseKey = "",
            e.callback = function(t) {
                e.captchaResponseKey = t
            }
            ,
            e.verify = function() {
                e.captchaResponseKey && r.verifyCaptcha(e.captchaResponseKey, function() {
                    window.location.href = document.location.protocol + "//" + document.location.hostname + "/sws/welcome.do?welcome.dispatch#"
                }, function(e) {
                    t.info(e)
                })
            }
            ,
            n.recaptchaCallback = e.callback
    }
    ]),
    angular.module("acornApp").factory("captchaServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:param", {}, {
            verifyCaptcha: {
                method: "POST",
                params: {
                    kind: "captcha",
                    type: "verify"
                }
            }
        })
    }
    ]),
    angular.module("acornApp").controller("PageFooterCtrl", ["$scope", "utPeakLoadModeConstants", function(e, t) {
        e.utPeakLoadModeConstants = t,
            e.currentCopyrightYear = (new Date).getFullYear()
    }
    ]),
    angular.module("acornApp").directive("acornCardGrid", ["cardService", function(e) {
        return {
            restrict: "C",
            controller: ["$scope", function(t) {
                function n() {
                    e.applyEqualPosition(r)
                }
                var r = [];
                this.name = "acornCardGrid",
                    this.addCardFooter = function(t) {
                        e.addCardFooter(r, t)
                    }
                    ,
                    this.applyEqualPosition = n,
                    angular.element(window).resize(n),
                    t.$on("$destroy", function() {
                        angular.element(window).off("resize", n)
                    })
            }
            ]
        }
    }
    ]).directive("acornCardDeck", ["cardService", function(e) {
        return {
            restrict: "A",
            controller: ["$scope", function(t) {
                function n() {
                    if (window.matchMedia("screen and (max-width: 767px)").matches)
                        for (var t = 0; t < r.length; t++) {
                            var n = angular.element(r[t]);
                            n.removeAttr("style")
                        }
                    else
                        e.applyEqualPosition(r)
                }
                var r = [];
                this.name = "acornCardDeck",
                    this.addCardFooter = function(t) {
                        e.addCardFooter(r, t)
                    }
                    ,
                    this.applyEqualPosition = n,
                    angular.element(window).resize(n),
                    t.$on("$destroy", function() {
                        angular.element(window).off("resize", n)
                    })
            }
            ],
            link: {
                pre: function(e, t) {
                    function n() {
                        window.matchMedia("screen and (min-width: 768px)").matches ? r.addClass("acorn-card-deck") : r.removeClass("acorn-card-deck")
                    }
                    var r = $(t);
                    e.$watch(function() {
                        return $("#main-content")[0].getBoundingClientRect().width
                    }, function(e, t) {
                        e !== t && n()
                    }),
                        angular.element(window).resize(n),
                        e.$on("$destroy", function() {
                            angular.element(window).off("resize", n)
                        }),
                        n()
                }
            }
        }
    }
    ]).directive("acornCardGroup", ["cardService", function(e) {
        return {
            restrict: "C",
            controller: ["$scope", function(t) {
                function n() {
                    e.applyEqualPosition(r)
                }
                var r = [];
                this.name = "acornCardGroup",
                    this.addCardFooter = function(t) {
                        e.addCardFooter(r, t)
                    }
                    ,
                    this.applyEqualPosition = n,
                    angular.element(window).resize(n),
                    t.$on("$destroy", function() {
                        angular.element(window).off("resize", n)
                    })
            }
            ]
        }
    }
    ]).directive("acornCard", ["$log", function(e) {
        return {
            restrict: "C",
            require: ["?^^acornCardGroup", "?^^acornCardGrid", "?^^acornCardDeck"],
            link: {
                pre: function(t, n, r, a) {
                    var i = {
                        currentHeight: 0,
                        currentTop: 0
                    }
                        , o = function() {
                        for (var e = 0; e < a.length; e++)
                            if (a[e])
                                return a[e]
                    }();
                    if (o) {
                        var s, c = n.find(".acorn-card-footer");
                        c.length > 0 && (s = angular.element(c[0])),
                        s && (o.addCardFooter(s),
                            o.applyEqualPosition(),
                            t.$watch(function() {
                                var e = s.height()
                                    , t = s.position().top;
                                i.currentTop === t && i.currentHeight === e || (i.currentHeight = e,
                                    i.currentTop = t,
                                    o.applyEqualPosition())
                            }))
                    } else
                        e.log("acorn-card detected but not inside of an acorn-card-deck or acorn-card-group or acorn-card-grid.")
                }
            }
        }
    }
    ]).service("cardService", ["$timeout", function(e) {
        this.addCardFooter = function(e, t) {
            e.push(t)
        }
            ,
            this.applyEqualPosition = function(t) {
                e(function() {
                    for (var e = 0, n = 0, r = 0; r < t.length; r++)
                        t[r].css({
                            position: "static"
                        }),
                            t[r].height("auto"),
                            e = t[r].offset().top > e ? t[r].offset().top : e,
                            n = t[r].height() > n ? t[r].height() : n;
                    for (var a = 0; a < t.length; a++)
                        t[a].css({
                            position: "relative"
                        }),
                            t[a].offset({
                                top: e
                            }),
                            t[a].height(n)
                }, 0)
            }
    }
    ]),
    angular.module("acornApp").directive("acornIconDanger", function() {
        return {
            restrict: "C",
            transclude: !0,
            template: '<div class="acorn-icon alert-danger">   <span class="bg"></span>   <i class="icon-danger"></i>   <div class="message" data-ng-transclude=""></div></div>'
        }
    }),
    angular.module("acornApp").component("iconExtLink", {
        template: '<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span>'
    }).component("iconCalendar", {
        template: '<span class="acorn-fa fa fa-calendar" aria-hidden="true"></span><span class="sr-only">Select a date</span>'
    }).component("iconPencil", {
        template: '<span class="acorn-fa fa fa-pencil" aria-hidden="true"></span><span class="sr-only">Edit or modify section</span>'
    }),
    angular.module("acornApp").directive("acornIconInfo", function() {
        return {
            restrict: "C",
            transclude: !0,
            template: '<div class="acorn-icon alert-info">   <span class="bg"></span>   <i class="icon-info-circled"></i>   <div class="message" data-ng-transclude=""></div></div>'
        }
    }),
    angular.module("acornApp").directive("acornIconWarn", function() {
        return {
            restrict: "C",
            transclude: !0,
            template: '<div class="acorn-icon alert-warning">   <span class="bg"></span>   <i class="icon-warning"></i>   <div class="message" data-ng-transclude=""></div></div>'
        }
    }),
    angular.module("acornApp").directive("acornNavigation", ["$timeout", "$compile", "DevConfig", "eventConstants", "screenSizeQuery", function(e, t, n, r, a) {
        return {
            template: '<div class="acorn" data-ng-controller="NotificationCtrl">   <div data-ng-include="topNavUrl"></div>   <div  id="body-container" data-ng-swipe-left="closeNavigationTray()">       <div id="acorn-nav-side-parent"  data-ng-include="sideNavUrl" onload="attachCloseListeners()"></div>       <div id="main-content" class="page-content-wrapper" data-ng-click="closeNotificationsTray(); closeNavigationTray();" tabindex="-1">            <div data-profile-notifications=""></div>            <div data-ng-transclude=""></div>        </div>       <div data-ng-include="notificationsUrl"></div>   </div></div>',
            transclude: !0,
            scope: !1,
            link: function(i, o) {
                function s() {
                    var t = $(u);
                    t.hasClass(g) ? c() : l(),
                        e(function() {
                            t.toggleClass(g)
                        })
                }
                function c() {
                    $(p).hide(),
                        $(f).show(),
                        $(d).css("overflow-y", ""),
                        $("#side-nav-mask").remove()
                }
                function l() {
                    var e = $('<div id="side-nav-mask" data-ng-click="closeNavigationTray();"></div>');
                    t(e)(i),
                        $(u).append(e),
                        $(d).css("overflow-y", "hidden"),
                        $(f).hide(),
                        $(p).show()
                }
                i.topNavUrl = n.translateSPAResourceUrl("partials/navigation/topNav.html"),
                    i.sideNavUrl = n.translateSPAResourceUrl("partials/navigation/sideNav.html"),
                    i.notificationsUrl = n.translateSPAResourceUrl("partials/notification.html");
                var u = "#body-container"
                    , d = "body"
                    , p = "#menu-btn-close"
                    , f = "#menu-btn"
                    , g = "toggled";
                i.closeNavigationTray = function() {
                    $(u).hasClass(g) && s()
                }
                    ,
                    i.$on(r.TOGGLE_NAVIGATION, s),
                    i.$on(r.RESPONSIVE_RESIZE_EVENT, function(e, t) {
                        if (!t.isResponsiveMode && t.viewTypeChange) {
                            var n = $(u);
                            n.hasClass(g) && (n.removeClass(g),
                                c())
                        }
                    }),
                    i.attachCloseListeners = function() {
                        o.find("#acorn-nav-side-parent").find("li").filter(function(e, t) {
                            return !(angular.isDefined(angular.element(t).attr("ut-open-menu")) || angular.isDefined(angular.element(t).attr("data-ut-open-menu")))
                        }).children("a").on("click", function() {
                            a.isSmall() && s()
                        })
                    }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("contentToTooltip", ["$compile", "$timeout", "screenSizeQuery", "eventConstants", function(e, t, n, r) {
        return {
            restrict: "A",
            transclude: !0,
            compile: function(a, i, o) {
                return function(a, i, s) {
                    var c = a.$new(!1);
                    o(c, function(a, o) {
                        var l = function() {
                            var t = a.clone()
                                , n = angular.element("<span></span>");
                            n.append(t);
                            var r = s.contentToTooltipAnchor ? angular.element("<span>" + s.contentToTooltipAnchor + "</span>") : n.find(".content-to-tooltip-anchor");
                            0 === r.length && (r = angular.element(n.children()[0]));
                            var c = n.children(".content-to-tooltip-content");
                            0 === c.length && (c = n.children());
                            var l = angular.element("<span></span>").append(c);
                            o.tooltipMessage = {
                                messages: l.html()
                            },
                            r.hasClass("content-to-tooltip-anchor") || (r = angular.element('<span class="content-to-tooltip-anchor"></span>').append(r));
                            var u = angular.element('<span data-ut-tooltip="tooltipMessage" data-ut-no-tooltip-tab-index></span>');
                            u.append(r),
                                i.append(e(u)(o))
                        }
                            , u = function() {
                            i.empty(),
                                i.append(e(a)(c))
                        };
                        !function() {
                            s.contentToTooltipResponsiveOnly && "TRUE" === s.contentToTooltipResponsiveOnly.trim().toUpperCase() ? (n.isSmall() ? t(function() {
                                l()
                            }, 0) : i.append(e(a)(c)),
                                c.$on(r.RESPONSIVE_RESIZE_EVENT, function(e, t) {
                                    t.viewTypeChange && t.isResponsiveMode ? (i.empty(),
                                        l()) : t.viewTypeChange && !t.isResponsiveMode && u()
                                })) : t(function() {
                                l()
                            }, 0)
                        }()
                    })
                }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("elementHorizontalScroll", function() {
        return {
            restrict: "A",
            link: function(e, t) {
                try {
                    if (document.createEvent("TouchEvent")) {
                        var n = 0
                            , r = 0
                            , a = 0;
                        t[0].addEventListener("touchstart", function(e) {
                            n = this.scrollLeft + e.touches[0].pageX,
                                r = e.touches[0].pageX,
                                a = e.touches[0].pageY
                        }, !1),
                            t[0].addEventListener("touchmove", function(e) {
                                Math.abs(a - e.touches[0].pageY) < Math.abs(r - e.touches[0].pageX) && (e.preventDefault(),
                                    this.scrollLeft = n - e.touches[0].pageX)
                            }, !1)
                    }
                } catch (e) {}
            }
        }
    }),
    angular.module("acornApp").component("newFeatureDisclaimer", {
        template: "<ul>   <li>       For an explanation of your academic history, please view the        <a href='http://www.transcripts.utoronto.ca/guide/' target='_blank'>Guide for Reading a Transcript<data-icon-ext-link></data-icon-ext-link></a>.   </li>   <li>       To confirm your registration status, use ACORN's official        <a href='/sws/welcome.do?welcome.dispatch#/transcript'>Confirmation of Enrolment Letter</a>.   </li>   <li>       To estimate your potential GPA, use <abbr title='University of Toronto'>U of T's</abbr>        <a href='https://gpacalc.utoronto.ca/' target='_blank'>GPA Calculator<data-icon-ext-link></data-icon-ext-link></a>.   </li></ul>"
    }),
    angular.module("acornApp").directive("reportNgRepeat", function() {
        return {
            restrict: "A",
            link: function(e, t, n) {
                e.$last === !0 && e.$emit(n.onFinishRepeat)
            }
        }
    }),
    angular.module("acornApp").directive("utAccordion", ["$log", "$timeout", "$templateRequest", "$compile", function(e, t, n, r) {
        return {
            restrict: "EA",
            scope: {
                expandable: "=",
                expanded: "=",
                headerTemplate: "=",
                headerTemplateUrl: "=",
                bodyTemplate: "=",
                bodyTemplateUrl: "="
            },
            templateUrl: "partials/core/accordion.html",
            controller: ["$scope", "$element", function(e, a) {
                e.bodyClassName = "ut-accordion-body-container",
                    e.headerClassName = "ut-accordion-header",
                    e.setHtmlContentFor = function(n, i) {
                        t(function() {
                            var t = angular.element("<div/>").html(i);
                            a.find("." + n).html(r(t.contents())(e.$parent))
                        }, 0)
                    }
                    ,
                    e.headerTemplateUrl ? n(e.headerTemplateUrl, !0).then(function(t) {
                        e.setHtmlContentFor(e.headerClassName, t)
                    }) : e.setHtmlContentFor(e.headerClassName, e.headerTemplate),
                    e.refresh = function() {
                        e.expandable ? (e.collapsed = !e.expanded,
                            e.extended = e.expandable && e.expanded) : (e.collapse = !1,
                            e.extended = !0),
                            e.bodyTemplateUrl ? n(e.bodyTemplateUrl, !0).then(function(t) {
                                e.setHtmlContentFor(e.bodyClassName, t)
                            }) : e.setHtmlContentFor(e.bodyClassName, e.bodyTemplate)
                    }
                    ,
                    e.refresh(),
                    e.toggle = function() {
                        e.expandable && (e.expanded = !e.expanded,
                            e.collapsed = !e.expanded,
                            e.extended = e.expandable && e.expanded)
                    }
            }
            ],
            link: function(e) {
                function t(t, n) {
                    t !== n && e.refresh()
                }
                e.$watch("expanded", t),
                    e.$watch("expandable", t)
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utAodaFocus", ["$timeout", "$location", "Notifications", function(e, t, n) {
        return {
            scope: {},
            restrict: "A",
            link: function(r, a) {
                function i() {
                    angular.element(window).bind("keydown", function() {
                        u = !0
                    }),
                        e(function() {
                            if (!u) {
                                var e = window.scrollX
                                    , t = window.scrollY;
                                a.removeAttr("tabIndex"),
                                    c.attr("tabIndex", -1).focus(),
                                    window.scrollTo(e, t)
                            }
                        }, 3500)
                }
                function o() {
                    angular.element(document.getElementById("aodaNotifications")).text(s),
                        a.attr("tabIndex", -1),
                        a.focus(),
                        i()
                }
                var s, c = angular.element(document.getElementById("scrollMain")), l = t.path(), u = !1;
                a.attr("tabIndex", -1),
                    a.focus(),
                    r.$watch(function() {
                        return n.getNotifications()
                    }, function(e) {
                        var t = 0;
                        if ("/" === l)
                            if (e.length > 0) {
                                for (var r = 0; r < e.length; r++) {
                                    var a = e[r];
                                    n.isHighPriorityNotification(a) && t++
                                }
                                0 === t ? i() : (s = ", You have " + t + " notification",
                                t > 1 && (s += "s"),
                                    o())
                            } else
                                i();
                        else
                            i()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utDeckLayout", ["$compile", "screenSizeQuery", function(e, t) {
        return {
            restrict: "AE",
            link: function(n, r, a) {
                function i() {
                    return angular.element('<div data-acorn-card-deck=""></div>')
                }
                function o(n, r, a, o) {
                    r.html(""),
                    t.isSmall() && r.removeClass("cards-wrapper");
                    var s, c = 0;
                    a && a.length && (a.forEach(function(t) {
                        if (c % o == 0 && (s = i(),
                                r.append(s)),
                                s.append(t),
                            ++c % o == 0 || c === a.length) {
                            if (c % o > 0)
                                for (var l = c % o; l < o; l++)
                                    s.append(angular.element('<div class="acorn-card acorn-card-bg acorn-card-placeholder"></div>'));
                            e(s)(n)
                        }
                    }),
                        n.$apply(r))
                }
                function s(e, t) {
                    var n = [];
                    return t.forEach(function(t) {
                        n.push(e[t])
                    }),
                        n
                }
                n.$watch(a.utCards, function(e) {
                    var t = {};
                    e && e.length && e.forEach(function(i) {
                        $.get(i, function(c) {
                            var l = angular.element(c);
                            if (t[i] = l,
                                e.length === Object.keys(t).length) {
                                var u = parseInt(a.cardsPerDeck) || 2
                                    , d = s(t, e);
                                o(n, r, d, u)
                            }
                        })
                    })
                })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utElementAlign", ["$timeout", "$window", "repeatNotificationEvents", "screenSizeQuery", "eventConstants", function(e, t, n, r, a) {
        function i(e, t) {
            if (!l || r.isSmall()) {
                for (var n = [], a = [], i = 0; i < t.length; i++) {
                    var o = e.find("." + t[i]).children().filter(function(e, t) {
                        return "none" !== angular.element(t).css("display")
                    });
                    n.push(o),
                        a.push(o.length)
                }
                for (var s = Math.max.apply(null, a), c = 0; c < s; c++) {
                    for (var u = [], d = 0; d < n.length; d++)
                        if (n[d][c]) {
                            var p = angular.element(n[d][c]);
                            p.css("height", ""),
                                u.push(p.height())
                        }
                    for (var f = Math.max.apply(null, u), g = 0; g < n.length; g++)
                        n[g][c] && angular.element(n[g][c]).height(f)
                }
            }
        }
        function o(e, t) {
            for (var n = 0; n < t.length; n++) {
                e.find("." + t[n]).children().css("height", "")
            }
        }
        function s(e) {
            if (c.id)
                return c.id;
            var t = e.attr("id");
            if (!t) {
                var n = Date.now().toString()
                    , r = Math.random().toString();
                r = r.replace(".", ""),
                r.length > 10 && (r = r.substring(0, 10)),
                    t = n + "-" + r
            }
            return c.id = t,
                t
        }
        var c = {};
        c.id = "";
        var l = !1;
        return {
            restrict: "A",
            link: function(n, r, c) {
                var u = [];
                !function() {
                    u = c.utElementAlignClasses.trim().split(" ");
                    for (var d = 0; d < u.length; d++)
                        u[d] = u[d].trim();
                    l = "true" === c.utElementAlignResponsiveOnly;
                    var p = "resize.utElementAlign-" + s(r);
                    if (e(function() {
                            i(r, u)
                        }, 0),
                            angular.element(t).on(p, function() {
                                i(r, u)
                            }),
                            n.$on(a.RESPONSIVE_RESIZE_EVENT, function(e, t) {
                                t.viewTypeChange && !t.isResponsiveMode && l && o(r, u)
                            }),
                            r.on("$destroy", function() {
                                angular.element(t).off(p)
                            }),
                        c.utElementAlignScopeWatch && c.utElementAlignScopeWatch.trim().length > 0)
                        for (var f = c.utElementAlignScopeWatch.trim().split(" "), g = 0; g < f.length; g++) {
                            f[g] = f[g].trim();
                            var m = n[f[g]];
                            !function(e) {
                                n.$watch(function() {
                                    return e
                                }, function(e, t) {
                                    e !== t && i(r, u)
                                })
                            }(m)
                        }
                    "true" === c.utElementAlignDigestWatch && n.$watch(function() {
                        return i(r, u),
                            !0
                    })
                }()
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utHelpModal", ["$anchorScroll", "$uibModal", "DevConfig", function(e, t, n) {
        return {
            restrict: "E",
            scope: {
                linkText: "@",
                templateUrl: "@"
            },
            template: '<a href="" class="btn-link" data-ng-click="openModal()">{{linkText}}</a>',
            controller: ["$scope", function(e) {
                e.openModal = function() {
                    t.open({
                        animation: !0,
                        templateUrl: n.translateSPAResourceUrl(e.templateUrl),
                        windowClass: "modal-lg-acorn",
                        controllerAs: "$ctrl",
                        controller: function() {
                            this.scrollTo = function(e) {
                                if (e) {
                                    var t = angular.element(".modal-body")
                                        , n = angular.element("#" + e)
                                        , r = n.offset().top
                                        , a = t.offset().top
                                        , i = r - a;
                                    t.animate({
                                        scrollTop: i
                                    }, 250)
                                }
                            }
                        }
                    })
                }
            }
            ]
        }
    }
    ]),
    angular.module("acornApp").directive("utLoadProgresser", ["$parse", function(e) {
        return {
            restrict: "A",
            scope: !0,
            link: function(t, n, r) {
                var a, i = r.loadIconClass || "icon-spin3", o = r.endLoadIconClass || "icon-spin3", s = function(e) {
                    var t = e.context.parentElement;
                    if (void 0 == t || void 0 == t.attributes)
                        return "";
                    var n = t.attributes.title;
                    return void 0 == n ? "" : n.value || ""
                }(n);
                n.addClass(i),
                angular.isDefined(r.utLoadProgresser) && (a = e(r.utLoadProgresser)(t),
                angular.isFunction(a) || (a = function() {
                        return e(r.utLoadProgresser)(t)
                    }
                )),
                    t.$watch(a, function(e) {
                        e ? (o && n.removeClass(o),
                            n.addClass("animate-spin " + i).attr("title", "Loading...")) : (n.removeClass("animate-spin").attr("title", s),
                        o && n.addClass(o))
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utPeakLoadMode", ["$compile", "$interpolate", "peakLoadModeService", "utPeakLoadModeConstants", function(e, t, n, r) {
        return {
            restrict: "A",
            scope: {
                replacement: "@",
                peakModeAction: "@"
            },
            link: function(a, i, o) {
                function s(n, s) {
                    var c, l;
                    switch (n) {
                        case r.ACTION_REMOVE_ELEMENT:
                            i.remove();
                            break;
                        case r.ACTION_REMOVE_ACTIONS:
                            o.ngHref && (o.$set("ngHref", null),
                                i.removeAttr("ng-href"),
                                i.removeAttr("data-ng-href")),
                            o.ngClick && (i.removeAttr("ng-click"),
                                i.removeAttr("data-ng-click")),
                            i.attr("href") && i.removeAttr("href"),
                            i.attr("onclick") && i.removeAttr("onclick");
                            break;
                        case r.ACTION_REPLACE_ELEMENT:
                            l = t(i.html())(a.$parent),
                                c = angular.element(s),
                                i.replaceWith(e(c)(a.$parent));
                            break;
                        case r.ACTION_REPLACE_CONTENT:
                            l = t(s)(a.$parent),
                                i.html(l);
                            break;
                        case r.ACTION_REPLACE_WRAPPER:
                            l = t(i.html())(a.$parent),
                                c = angular.element(s),
                                c.append(l),
                                i.replaceWith(e(c)(a.$parent))
                    }
                }
                n.getPeakLoadMode().then(function(e) {
                    e.peakMode && s(a.peakModeAction, a.replacement)
                })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utPlaceholder", function() {
        return {
            restrict: "A",
            template: '<span class="placeholder-container"><span data-ng-transclude=""></span><div class="place-holder-text" data-ng-click="hidePlaceholder()" data-ng-bind="placeholderText"></div></span>',
            scope: !0,
            transclude: !0,
            link: function(e, t) {
                function n() {
                    0 === i.val().length && null !== e.placeholderText ? a.show() : a.hide()
                }
                var r = "placeholder"in document.createElement("input")
                    , a = t.find(".place-holder-text")
                    , i = t.find('input[type="text"]');
                a.hide(),
                r || (e.placeholderText = i.attr("placeholder") || null,
                    e.hidePlaceholder = function() {
                        a.hide(),
                            i.focus()
                    }
                    ,
                    function() {
                        n(),
                            i.blur(n).focus(function() {
                                a.hide()
                            })
                    }())
            }
        }
    }),
    angular.module("acornApp").directive("utRestrictFocus", ["$log", "Accessibility", function(e, t) {
        return {
            restrict: "A",
            transclude: !0,
            scope: !0,
            template: '<div class="restrict-focus-parent">   <div class="restrict-focus-tab-start" tabIndex="0"></div>   <div data-ng-transclude></div>   <div class="restrict-focus-tab-stop" tabIndex="0"></div></div>',
            link: function(e, n) {
                function r() {
                    t.getFirstFocusableChild(i).focus()
                }
                function a() {
                    t.getLastFocusableChild(i).focus()
                }
                var i = n.find('[data-ng-transclude=""]');
                n.on("keydown keypress", function(e) {
                    var t = document.activeElement;
                    9 === e.keyCode && (e.shiftKey === !1 ? void 0 == t ? r() : "restrict-focus-tab-stop" === t.className && (e.preventDefault(),
                        r()) : "restrict-focus-tab-start" === t.className && (e.preventDefault(),
                        a()))
                })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utRoundedNumber", ["rounding", function(e) {
        return {
            priority: 200,
            restrict: "A",
            require: "ngModel",
            link: {
                pre: function(t, n, r, a) {
                    function i() {
                        if (a.$modelValue) {
                            var t = e.round(a.$modelValue, s);
                            s > 0 ? n.val(t.toFixed(s)) : n.val(t)
                        }
                    }
                    function o(t) {
                        if (t)
                            return e.round(t, s)
                    }
                    var s = 2;
                    r.utRoundedNumberDigits && (s = parseInt(r.utRoundedNumberDigits));
                    var c = Math.pow(10, s)
                        , l = 1 / c;
                    n.attr("step", l.toString()),
                    a && (n.bind("blur", function() {
                        i()
                    }),
                        a.$formatters.push(function(e) {
                            var t = o(e);
                            if (t)
                                return s > 0 ? t.toFixed(s) : t
                        }),
                        a.$parsers.push(function(e) {
                            return o(e)
                        }))
                }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utScrollTo", ["scrollToConstants", "Accessibility", function(e, t) {
        return {
            scope: {
                clickHandler: "&",
                keypressHandler: "&"
            },
            link: function(n, r, a) {
                if (void 0 === a.utScrollToType)
                    throw new Error("utScrollTo requires the scrollToType attribute to exist");
                var i = a.utScrollToType;
                if (i === e.MAIN)
                    r.bind("click", t.scrollToMainContent),
                        r.bind("keypress", t.scrollToMainContentPress);
                else if (i === e.SIDE_NAVIGATION)
                    r.bind("click", t.scrollToNavigationContent),
                        r.bind("keypress", t.scrollToNavigationContentPress);
                else if (i === e.TYPE_AHEAD)
                    r.bind("click", t.scrollToTypeAheadInput),
                        r.bind("keypress", t.scrollToTypeAheadInputPress);
                else if (i === e.CUSTOM)
                    r.bind("click", n.clickHandler),
                        r.bind("keypress", n.keypressHandler);
                else {
                    if (i !== e.ELEMENT)
                        throw new Error("utScrollTo requires the scrollToType attribute to be one of those defined by scrollToConstants. " + i + " is invalid.");
                    if (void 0 === a.elementId)
                        throw new Error("utScrollTo: missing the element id when scrolling to type element");
                    r.bind("click", function() {
                        t.scrollToContent(a.elementId, event)
                    }),
                        r.bind("keypress", function() {
                            t.scrollToContentPress(a.elementId, event)
                        })
                }
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utToastKeepAlive", function() {
        return {
            restrict: "A",
            link: function(e, t) {
                t.bind("mouseenter", function() {
                    e.$emit("KEEP_TOAST_ALIVE", {})
                }),
                    t.bind("mouseleave", function() {
                        e.$emit("KEEP_TOAST_ALIVE_OFF", {})
                    })
            }
        }
    }),
    angular.module("acornApp").directive("utTooltip", ["$parse", "$log", "$timeout", "$document", "accessibilityConstants", "Accessibility", "eventConstants", "screenSizeQuery", "$uibModal", function(e, t, n, r, a, i, o, s, c) {
        return {
            restrict: "A",
            template: '<div>   <div data-ng-transclude=""></div>   <div class="tooltipBox">       <div id="tooltip-aria-{{$id}}" aria-hidden="true" aria-expanded="false" role="tooltip" class="tooltipContainer {{tooltip.ui.popoverClasses}}">           <div class="topArrow"></div>           <div data-ng-bind-html="tooltip.message"                 class="ut-tooltip-body {{tooltip.ui.tooltipMessageClasses}}"></div>           <div class="bottomArrow"></div>       </div>   </div></div>',
            transclude: !0,
            scope: {
                tooltipOptions: "=utTooltip",
                tooltipShowWhenExpr: "=utTooltipShowWhen",
                calcTooltipHighlightClass: "&utCalcTooltipHighlight",
                getAnchorClassesToRemove: "&utGetAnchorClassesToRemove"
            },
            link: function(e, t, n) {
                function a() {
                    for (var e = angular.element(".tooltipContainer.tooltipOpen"), t = 0; t < e.length; t++) {
                        angular.element(e[t]).removeClass("tooltipOpen")
                    }
                }
                function i() {
                    s.isSmall() ? l() : u()
                }
                function l() {
                    if (e.tooltip && e.tooltip.messages && angular.isArray(e.tooltip.messages) && e.tooltip.messages.length && e.tooltip.messages.length > 0)
                        var t = c.open({
                            animation: !0,
                            template: '<div id="ut-tooltip-modal">      <div class="modal-header">          <div class="row">              <button type="button" class="close icon-cancel" data-ng-click="close()" aria-label="Close">                  <span class="sr-only">Close</span>              </button>              <h2 class="modal-title">                  <span data-ng-show="tooltip.title" ng-bind-html="tooltip.title"></span>              </h2>          </div>      </div>      <div class="modal-body">          <div class="ut-tooltip-message">              <div class="ut-confirmation-message-content" ng-bind-html="tooltip.message"></div>          </div>      </div>      <div class="modal-footer">          <ol class="controls">              <button class="btn btn-link" data-ng-click="close()">Close</button>          </ol>      </div></div>',
                            controller: ["$scope", function(n) {
                                n.tooltip = e.tooltip,
                                    n.close = function() {
                                        t.dismiss()
                                    }
                            }
                            ],
                            windowClass: "modal-lg-acorn"
                        })
                }
                function u() {
                    if (e.tooltip && e.tooltip.messages && angular.isArray(e.tooltip.messages) && e.tooltip.messages.length && e.tooltip.messages.length > 0) {
                        a(),
                            h.addClass("tooltipOpen"),
                            h.attr({
                                "aria-hidden": "false",
                                "aria-expanded": "true"
                            });
                        var r, i, o = t.find("div[data-ng-transclude]"), s = h.outerWidth();
                        if (n.utWidth && (s = n.utWidth,
                                h.css("maxWidth", s)),
                                C.is(":visible")) {
                            A = !0;
                            for (var c = $(h).parents(), l = 0; l < c.length; l++) {
                                var u = c[l].className;
                                if (/modal-header/.test(u)) {
                                    y = $(c[l]),
                                        E = !0;
                                    break
                                }
                                if (/modal-body/.test(u)) {
                                    y = $(c[l]);
                                    break
                                }
                                if (/modal-footer/.test(u)) {
                                    y = $(c[l]);
                                    break
                                }
                            }
                        }
                        o && o.length && (h.css("position", "fixed"),
                            r = o.children(":first"),
                            i = r.offset(),
                            i.top = i.top + r.outerHeight() / 2,
                            o.append(h),
                            h.offset(i));
                        var d, p;
                        if (A)
                            d = y.offset().left + y.outerWidth(),
                                p = y.offset().top + y.outerHeight();
                        else {
                            var f = $(".page-content-wrapper");
                            d = f.outerWidth(),
                                p = f.outerHeight()
                        }
                        Math.floor($(h).offset().top + $(h).outerHeight()) > p && 0 == E && (h.find(".topArrow").hide(),
                            h.find(".bottomArrow").show(),
                            i.top = i.top - (r.outerHeight() + h.outerHeight()) + h.find(".bottomArrow").outerHeight(),
                            h.offset(i));
                        var g = Math.floor($(h).offset().left + $(h).outerWidth());
                        if (g > d) {
                            var m = g - d + 30;
                            i.left = i.left - m,
                                h.offset(i);
                            (h.find(".topArrow").is(":visible") ? h.find(".topArrow") : h.find(".bottomArrow")).css({
                                "margin-left": m
                            })
                        }
                        return !0
                    }
                    return !1
                }
                function d() {
                    h.css("position", "initial"),
                        h.offset({
                            top: 0,
                            left: 0
                        }),
                        h.find(".topArrow").show(),
                        h.find(".bottomArrow").hide(),
                        h.removeClass("tooltipOpen"),
                        h.attr({
                            "aria-hidden": "true",
                            "aria-expanded": "false"
                        })
                }
                function p() {
                    if (event.keyCode === T) {
                        var e = angular.element(document.activeElement).parent().parent()
                            , t = e.find(".tooltipContainer").length
                            , n = e.closest(".tooltipContainer").is(":visible");
                        t || n || d()
                    }
                }
                function f() {
                    s.isSmall() ? v.on("click", function() {
                        v.parent().find(".tooltipContainer").is(":visible") || i()
                    }) : (r.on("keyup", p),
                        v.on("focusin", function() {
                            v.parent().find(".tooltipContainer").is(":visible") || i()
                        }),
                        v.hover(function() {
                            v.parent().find(".tooltipContainer").is(":visible") || i()
                        }),
                        t.on("mouseleave", function() {
                            d()
                        }))
                }
                function g() {
                    v.off(),
                        t.off()
                }
                function m(e, t) {
                    t.viewTypeChange && (g(),
                        f())
                }
                var h = t.find(".tooltipContainer")
                    , v = t.find("div[data-ng-transclude]").children(":first")
                    , C = $(".modal-dialog")
                    , y = null
                    , A = !1
                    , E = !1
                    , T = 9;
                !function() {
                    function a(e, t) {
                        return t && t.length > 0 ? e : void 0
                    }
                    function s(t, n, r, o, s, c, l) {
                        var u = [];
                        angular.isDefined(n) && null != n && angular.isDefined(n.messages) && null != n.messages && (angular.isString(n.messages) ? u.push(n.messages) : angular.isArray(n.messages) && (u = n.messages));
                        var p = "highlight";
                        if (r && r.length > 0 && (p = r),
                                p = a(p, u),
                            angular.isDefined(c) && angular.isFunction(c)) {
                            var f = c();
                            angular.isDefined(r) && r.length,
                            f && f.length > 0 && (p = f)
                        }
                        void 0 != o ? t.removeAttr("tabIndex") : !s || u && 0 != u.length ? t.attr("tabIndex", "0") : t.removeAttr("tabIndex"),
                        p && p.length > 0 && (l && $(t).removeClass(l),
                            $(t).addClass(p)),
                            e.tooltip = {
                                show: i,
                                hide: d,
                                messages: u,
                                message: u.join("<br>"),
                                options: n
                            }
                    }
                    e.$on(o.RESPONSIVE_RESIZE_EVENT, m),
                        v.attr({
                            "aria-describedby": "tooltip-aria-" + e.$id
                        }),
                        f();
                    var c = h.find(".tooltip-footer");
                    if (!angular.isObject(e.tooltipOptions))
                        if (void 0 !== e.tooltipOptions && null !== e.tooltipOptions) {
                            var l = e.tooltipOptions;
                            e.tooltipOptions = {
                                messages: l
                            }
                        } else
                            e.tooltipOptions = {},
                                e.tooltipOptions.messages = [];
                    t.addClass("ut-tooltip"),
                    angular.isDefined(e.tooltipShowWhenExpr) && e.$watch(function() {
                        return e.tooltipShowWhenExpr
                    }, function(e) {
                        e ? i() : d()
                    }),
                        s(v, e.tooltipOptions, n.utTooltipHighlightClass, n.utNoTooltipTabIndex, n.utTooltipNoTabIndexOnNoMessage, e.calcTooltipHighlightClass, e.getAnchorClassesToRemove()),
                        e.$watch(function() {
                            return angular.isDefined(e.tooltipOptions) && null != e.tooltipOptions ? e.tooltipOptions.messages : void 0
                        }, function() {
                            s(v, e.tooltipOptions, n.utTooltipHighlightClass, n.utNoTooltipTabIndex, n.utTooltipNoTabIndexOnNoMessage, e.calcTooltipHighlightClass, e.getAnchorClassesToRemove())
                        }),
                        e.$watch(function() {
                            return e.calcTooltipHighlightClass
                        }, function() {
                            s(v, e.tooltipOptions, n.utTooltipHighlightClass, n.utNoTooltipTabIndex, n.utTooltipNoTabIndexOnNoMessage, e.calcTooltipHighlightClass, e.getAnchorClassesToRemove())
                        }),
                        t.on("$destroy", function() {
                            v.off(),
                                t.off(),
                                c.off(),
                                r.off("keyup", p)
                        }),
                        e.$emit(o.TOOLTIP_INIT, t)
                }()
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utTypeahead", ["$timeout", "keyCodes", function(e, t) {
        return {
            restrict: "E",
            transclude: !0,
            replace: !0,
            template: '<div class="ut-typeahead-container"><form class="form-horizontal"><div class="form-group"><label for="typeaheadInput" class="{{labelClass}} control-label">{{searchLabel}}</label><div class="ut-typeahead-input-container {{inputClass}}"><input id="typeaheadInput" ng-model="term" ng-change="query()" type="text" role="combobox" aria-autocomplete="list" aria-owns="{{id}}" aria-controls="search-result-region"aria-expanded="{{isVisible()}}" aria-activedescendant="typeaheadActiveItem" class="form-control" data-ng-class="{loadingIcon: loading}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="{{searchPlaceholder}}"><div class="ut-typeahead-results-container {{inputClass}}"><div data-ng-transclude class="ut-typeahead-results-list"></div><div data-ng-show="shouldShowViewMore()" class="view-more">{{searchViewMoreMessage}}</div><div data-ng-show="shouldShowNoResults()" class="no-results">{{searchNoResultsMessage}}</div></div><span role="region" aria-live="polite" class="sr-only" id="search-result-region"><span data-ng-show="items.length">There are {{items.length}} results available. Use the up and down arrow keys to highlight them.</span><span data-ng-show="shouldShowNoResults()">{{searchNoResultsMessage}}</span></span><span role="region" aria-live="polite" class="sr-only"><span data-ng-show="ariaDescTextForItem">{{ariaDescTextForItem}}</span></span></div></div></form></div>',
            scope: {
                items: "=",
                term: "=",
                searchLoading: "=searchLoading",
                searchError: "=",
                searchLabel: "@",
                searchPlaceholder: "@",
                searchViewMoreMessage: "@",
                searchNoResultsMessage: "@",
                search: "&searchFn",
                select: "&selectFn",
                ariaDescForItem: "&ariaDescForItemFn"
            },
            controller: ["$scope", "$element", "$attrs", function(t, n, r) {
                function a() {
                    var e = t.term.toUpperCase();
                    if (o) {
                        var n = e.match(i);
                        if (n)
                            return n.join(" ")
                    } else if (e.match(i))
                        return e;
                    return ""
                }
                t.items = [],
                    t.hide = !0,
                    t.loading = !1,
                    t.debouncePromise = null;
                var i = new RegExp("(\\w{3,})","g")
                    , o = r.hasOwnProperty("useSplitSearchTerm")
                    , s = "";
                t.labelClass = r.hasOwnProperty("labelClass") ? r.labelClass : "col-sm-3",
                    t.inputClass = r.hasOwnProperty("inputClass") ? r.inputClass : "col-sm-9";
                var c = !1
                    , l = {
                    x: 0,
                    y: 0,
                    xMinusOffset: 0,
                    yMinusOffset: 0
                }
                    , u = null;
                this.activate = function(e) {
                    t.active = e,
                        t.ariaDescForItem && e ? t.ariaDescTextForItem = t.ariaDescForItem({
                            item: e
                        }) : t.ariaDescTextForItem = null
                }
                    ,
                    this.activateNextItem = function() {
                        var e = t.items.indexOf(t.active);
                        this.activate(t.items[e + 1 === t.items.length ? e : e + 1])
                    }
                    ,
                    this.activatePreviousItem = function() {
                        var e = t.items.indexOf(t.active);
                        this.activate(t.items[0 === e ? e : e - 1])
                    }
                    ,
                    this.isActive = function(e) {
                        return t.active === e
                    }
                    ,
                    this.select = function(e) {
                        t.hide = !0,
                            t.select({
                                item: e
                            })
                    }
                    ,
                    this.selectActive = function() {
                        this.select(t.active)
                    }
                    ,
                    this.setLastCursorPosition = function(e) {
                        l = e
                    }
                    ,
                    this.getLastCursorPosition = function() {
                        return l
                    }
                    ,
                    this.setKeyboardTrigger = function(e) {
                        u = e
                    }
                    ,
                    this.getKeyboardTrigger = function() {
                        return u
                    }
                    ,
                    this.setCursorMoving = function(e) {
                        c = e
                    }
                    ,
                    this.isCursorMoving = function() {
                        return c
                    }
                    ,
                    t.shouldShowViewMore = function() {
                        return t.searchViewMoreMessage && t.shouldShowViewMoreAfterScrolling && t.items && t.items.length
                    }
                    ,
                    t.shouldShowNoResults = function() {
                        return !t.hide && !t.searchLoading && !t.searchError && !t.loading && t.items && !t.items.length
                    }
                    ,
                    t.isVisible = function() {
                        return !t.hide && (t.focused || t.mousedOver)
                    }
                    ,
                    t.query = function() {
                        if (t.term) {
                            var n = a();
                            "" !== n && n !== s && (t.hide = !1,
                                t.loading = !0,
                                s = n,
                            t.debouncePromise && e.cancel(t.debouncePromise),
                                t.debouncePromise = e(function() {
                                    t.search({
                                        term: n
                                    }),
                                        t.debouncePromise = null,
                                        t.loading = !1
                                }, 500))
                        } else
                            s = "",
                                t.hide = !0,
                                t.items = []
                    }
            }
            ],
            link: function(n, r, a, i) {
                function o(e, t) {
                    var n = e.height();
                    return t.scrollTop() + t.height() < n
                }
                n.shouldShowViewMoreAfterScrolling = !0,
                    n.id = "typeahead-" + function() {
                            return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
                        }();
                var s = r.find("form input")
                    , c = r.find("div.ut-typeahead-results-container")
                    , l = c.find("> div.ut-typeahead-results-list")
                    , u = l.find("> ul");
                u.attr("id", n.id),
                    s.bind("focus", function() {
                        e(function() {
                            n.focused = !0
                        }, 0, !1)
                    }),
                    s.bind("blur", function() {
                        n.$applyAsync(function() {
                            n.focused = !1
                        })
                    }),
                    c.bind("mouseover", function() {
                        n.$applyAsync(function() {
                            n.mousedOver = !0
                        })
                    }),
                    c.bind("mouseleave", function() {
                        n.$applyAsync(function() {
                            n.mousedOver = !1
                        })
                    }),
                    l.bind("scroll", function() {
                        n.$applyAsync(function() {
                            n.shouldShowViewMoreAfterScrolling = o(u, l)
                        })
                    }),
                    s.bind("keydown", function(e) {
                        if (e.keyCode !== t.ENTER || n.hide || n.$applyAsync(function() {
                                i.selectActive()
                            }),
                            e.keyCode === t.ESCAPE && (e.stopPropagation(),
                                e.preventDefault(),
                                n.$applyAsync(function() {
                                    n.hide = !0
                                })),
                            (e.keyCode === t.DOWN || e.keyCode === t.UP) && n.hide && n.term)
                            return void n.query();
                        e.keyCode === t.DOWN && (e.stopPropagation(),
                            e.preventDefault(),
                            n.$applyAsync(function() {
                                i.setCursorMoving(!1),
                                    i.activateNextItem(),
                                    i.setKeyboardTrigger(e.keyCode)
                            })),
                        e.keyCode === t.UP && (e.stopPropagation(),
                            e.preventDefault(),
                            n.$applyAsync(function() {
                                i.setCursorMoving(!1),
                                    i.activatePreviousItem(),
                                    i.setKeyboardTrigger(e.keyCode)
                            }))
                    }),
                    n.$watch(function() {
                        return u[0].offsetHeight
                    }, function(e, t) {
                        e !== t && (n.shouldShowViewMoreAfterScrolling = o(u, l))
                    }),
                    n.$watch("focused", function(t) {
                        t && e(function() {
                            s.focus(),
                            n.items && n.items.length && (n.hide = !1)
                        }, 0, !1)
                    }),
                    n.$watch("isVisible()", function(e) {
                        e ? c.show() : c.hide()
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utTypeaheadItem", ["keyCodes", function(e) {
        return {
            restrict: "A",
            require: "^utTypeahead",
            link: function(t, n, r, a) {
                function i(e, t) {
                    var n = e.getBoundingClientRect()
                        , r = t.getBoundingClientRect();
                    return n.top >= r.top && n.bottom <= r.bottom
                }
                var o = t.$eval(r.utTypeaheadItem);
                t.$watch(function() {
                    return a.isActive(o)
                }, function(t) {
                    if (t) {
                        n.addClass("active"),
                            n.attr("id", "typeaheadActiveItem");
                        var r = $(".ut-typeahead-results-list");
                        if (!a.isCursorMoving() && !i(n[0], r[0])) {
                            var o = n[0].getBoundingClientRect();
                            a.getKeyboardTrigger() === e.UP ? r.scrollTop(r.scrollTop() - o.height) : a.getKeyboardTrigger() === e.DOWN && r.scrollTop(r.scrollTop() + $(n[0]).outerHeight()),
                                a.setKeyboardTrigger(null)
                        }
                    } else
                        n.removeClass("active"),
                            n.removeAttr("id")
                }),
                    n.bind("mousemove", function(e) {
                        t.$applyAsync(function() {
                            var t = a.getLastCursorPosition()
                                , n = e.clientX - e.offsetX
                                , r = e.clientY - e.offsetY;
                            a.setLastCursorPosition({
                                x: e.clientX,
                                xMinusOffset: n,
                                y: e.clientY,
                                yMinusOffset: r
                            });
                            var i = !(e.clientX === t.x && e.clientY === t.y || n === t.xMinusOffset && r === t.yMinusOffset);
                            a.setCursorMoving(i),
                            i && a.activate(o)
                        })
                    }),
                    n.bind("click", function() {
                        t.$applyAsync(function() {
                            a.select(o)
                        })
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utUpload", ["$timeout", "acornToast", "acornToastConstants", function(e, t, n) {
        return {
            restrict: "EA",
            scope: {
                uploadModel: "=?",
                acceptedFileTypes: "<",
                maxTotalFileSize: "<",
                multiple: "<",
                validate: "<",
                suppressViolatingFiles: "<"
            },
            templateUrl: "partials/core/fileUpload.html",
            controller: ["$scope", function(r) {
                function a(e) {
                    return r.files.find(function(t) {
                        return t.name === e.name && t.size === e.size
                    })
                }
                function i(e) {
                    return r.isAcceptedFileType(e.type)
                }
                r.acceptedFileTypes = r.acceptedFileTypes ? r.acceptedFileTypes : {},
                    r.multiple = void 0 === r.multiple || r.multiple,
                    r.validate = void 0 === r.validate || r.validate,
                    r.suppressViolatingFiles = void 0 === r.suppressViolatingFiles || r.suppressViolatingFiles,
                    r.files = [],
                    r.duplicateFound = !1,
                    r.wrongFileTypeFound = !1,
                    r.maxSizeExceedsFound = !1;
                var o = 0;
                r.totalFileSizeAllowed = 0,
                    r.hasError = function() {
                        return r.suppressViolatingFiles ? r.duplicateFound || r.wrongFileTypeFound || r.maxSizeExceedsFound : r.exceedsSizeLimit() || r.containsUnacceptedFileTypes()
                    }
                    ,
                    r.resetErrors = function() {
                        r.duplicateFound = !1,
                            r.wrongFileTypeFound = !1,
                            r.maxSizeExceedsFound = !1,
                        r.suppressViolatingFiles || (r.exceedsSizeLimit() && (r.maxSizeExceedsFound = !0),
                        r.containsUnacceptedFileTypes() && (r.wrongFileTypeFound = !0))
                    }
                    ,
                    r.getErrorMessage = function() {
                        return r.duplicateFound ? "One or more files with the same name were already uploaded." : r.wrongFileTypeFound ? "One or more files were not uploaded. Files must be images(" + r.getAcceptedFileTypesKeys() + ")." : r.maxSizeExceedsFound ? "One or more files were not uploaded. All files combined must be " + r.maxTotalFileSize + " or less." : void 0
                    }
                    ,
                    r.setTotalFileSizeAllowed = function() {
                        r.maxTotalFileSize || (r.maxTotalFileSize = "1mb");
                        var e = r.maxTotalFileSize.match(/\d+/)
                            , t = e[0]
                            , n = e.index + e[0].length
                            , a = r.maxTotalFileSize.substring(n);
                        if (a = a.trim(),
                            "" === a && (a = "MB",
                                r.maxTotalFileSize = e + "MB"),
                            a && "MB" === a.toUpperCase())
                            t = 1024 * parseInt(t) * 1024;
                        else if (a && "KB" === a.toUpperCase())
                            t = 1024 * parseInt(t);
                        else {
                            if (!a || "B" !== a.toUpperCase())
                                throw new Error("Found invalid maxTotalFileSize: " + r.maxTotalFileSize + " should be in one of MB, KB, and B");
                            t = parseInt()
                        }
                        r.totalFileSizeAllowed = t,
                            r.maxTotalFileSize = e[0] + a
                    }
                    ,
                    r.setTotalFileSizeAllowed(),
                    r.showToastIfAny = function() {
                        var a = e(function() {
                            r.suppressViolatingFiles && r.hasError() && t.showToast({
                                message: r.getErrorMessage(),
                                type: n.TYPE_DANGER
                            }),
                                e.cancel(a)
                        })
                    }
                    ,
                    r.containsUnacceptedFileTypes = function() {
                        return Object.keys(r.acceptedFileTypes).length && r.files.some(function(e) {
                                return !r.isAcceptedFileType(e.type)
                            })
                    }
                    ,
                    r.removeFile = function(e) {
                        var t = r.files[e];
                        o -= t.size,
                            r.files.splice(e, 1),
                            r.resetErrors()
                    }
                    ,
                    r.addFile = function(e) {
                        if (a(e))
                            r.duplicateFound = !0;
                        else {
                            var t = !1;
                            e.size + o > r.totalFileSizeAllowed && (r.maxSizeExceedsFound = !0,
                                t = !0),
                            i(e) || (r.wrongFileTypeFound = !0,
                                t = !0),
                            t && r.suppressViolatingFiles || (o += e.size,
                                r.files.push(e),
                                r.$apply())
                        }
                    }
                    ,
                    r.isMultiple = function() {
                        return !!r.multiple && r.multiple
                    }
                    ,
                    r.upload = function(e) {
                        var t = e.target;
                        t.onchange = function() {
                            r.resetErrors();
                            for (var e = 0; e < t.files.length; e++)
                                t.files[e] && r.addFile(t.files[e]);
                            r.showToastIfAny(),
                                this.value = null
                        }
                    }
                    ,
                    r.getAcceptedFileTypesKeys = function() {
                        return Object.keys(r.acceptedFileTypes).join(", ")
                    }
                    ,
                    r.getAcceptedFileTypes = function() {
                        var e = [];
                        return Object.keys(r.acceptedFileTypes).forEach(function(t) {
                            e.push(r.acceptedFileTypes[t])
                        }),
                            e.join(",")
                    }
                    ,
                    r.isAcceptedFileType = function(e) {
                        return !r.acceptedFileTypes || !Object.keys(r.acceptedFileTypes).length || !!Object.keys(r.acceptedFileTypes).find(function(t) {
                                return e === r.acceptedFileTypes[t]
                            })
                    }
                    ,
                    r.exceedsSizeLimit = function() {
                        return r.files.reduce(function(e, t) {
                                return e += t.size
                            }, 0) > r.totalFileSizeAllowed
                    }
                    ,
                    r.getFileSize = function(e) {
                        var t = (e.size / 1048576).toFixed(2)
                            , n = (e.size / 1024).toFixed(2)
                            , r = e.size.toFixed(2)
                            , a = e.name + " (";
                        return a += t > 0 ? t + "MB)" : n > 0 ? n + "KB)" : r + "B)"
                    }
            }
            ],
            link: function(t, r) {
                function a(n) {
                    n.preventDefault(),
                        t.resetErrors();
                    var a = n.originalEvent.dataTransfer;
                    if (a.files) {
                        for (var i = 0; i < a.files.length; i++)
                            t.addFile(a.files[i]);
                        var o = e(function() {
                            t.showToastIfAny(),
                                e.cancel(o),
                                r.find(".drop-zone").removeClass("drag-hover")
                        })
                    }
                }
                function i(e) {
                    r.find(".drop-zone").addClass("drag-hover"),
                        e.preventDefault()
                }
                function o(e) {
                    r.find(".drop-zone").removeClass("drag-hover"),
                        e.preventDefault()
                }
                function s() {
                    var e = "uploadForm" + t.$id;
                    t.exceedsSizeLimit() && t.validate ? t[e].$setValidity("sizeLimit", !1) : t[e].$setValidity("sizeLimit", !0),
                        t.containsUnacceptedFileTypes() && t.validate ? t[e].$setValidity("mimeType", !1) : t[e].$setValidity("mimeType", !0)
                }
                t.uploadModel = t.files,
                    t.$watchCollection("files", function() {
                        s()
                    }),
                    t.$watch("multiple", function(e) {
                        e ? r.find("#file-id-" + t.$id).attr("multiple", "multiple") : r.find("#file-id-" + t.$id).removeAttr("multiple")
                    }),
                    t.$watch("maxTotalFileSize", function(e, n) {
                        e !== n && (t.setTotalFileSizeAllowed(),
                            s())
                    }),
                    t.$watch("validate", function(e, t) {
                        e !== t && s()
                    }),
                    r.on("drop", a),
                    r.on("dragover", i),
                    r.on("dragleave", o),
                    t.$on("$destroy", function() {
                        r.off("drop", a),
                            r.off("dragover", i),
                            r.off("dragleave", o)
                    }),
                    t.$on(n.REMOVE_UPLOADED_FILES, function() {
                        t.files.forEach(function(e) {
                            t.files.splice(e)
                        })
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utWordLimit", function() {
        var e = new RegExp("(?:\\s*)(\\S+)(?:\\s*)","gim");
        return {
            priority: 100,
            restrict: "A",
            require: "ngModel",
            link: function(t, n, r, a) {
                function i(t) {
                    var n, r = !1;
                    t && (n = t.match(e)) && n.length <= o() && (r = !0);
                    var a = 0;
                    return n && (a = n.length),
                    {
                        valid: r,
                        wordCount: a
                    }
                }
                function o() {
                    var e = t[r.utWordLimit]
                        , n = parseInt(e);
                    return isNaN(n) && (n = t.$eval(e)),
                        n
                }
                function s(e) {
                    var n = i(e);
                    return e ? a.$setValidity("utWordLimit", n.valid) : a.$setValidity("utWordLimit", !0),
                        t[r.utWordCount] = n.wordCount,
                        e
                }
                a && (a.$parsers.unshift(s),
                    a.$formatters.push(s),
                    s(a.$modelValue))
            }
        }
    }),
    angular.module("acornApp").directive("utWordLimitedTextArea", function() {
        return {
            priority: 100,
            template: '<div class="ut-word-limited-text-area form-group">   <div class="question-text">      <label for="ut-word-limited-text-area-{{$id}}">{{questionText}} ({{wordLimit}} word limit)</label>   </div>   <ng-form name="textareaForm">       <div data-ng-class="{\'ut-textarea-invalid\': submitted && textareaForm.textarea.$invalid}">           <textarea id="ut-word-limited-text-area-{{$id}}" class="form-control" ng-required="required" ut-word-limit="wordLimit" ut-word-count="wordCount" data-ng-model="areaText" name="textarea"></textarea>       </div>       <span class="pull-right word-limit" data-ng-class="{\'over-the-limit\': wordCount > wordLimit}">{{getWordsText()}}</span>       <div data-ng-show="submitted || textareaForm.textarea.$invalid" class="error">           <div data-ng-show="submitted && textareaForm.textarea.$error.required">               Please provide a description.           </div>       </div>   </ng-form></div>',
            scope: {
                questionText: "@questionText",
                wordLimit: "=wordLimit",
                areaText: "=areaText",
                required: "=",
                submitted: "@"
            },
            link: function(e, t, n) {
                e.wordCount = 0;
                var r = t.find("textarea");
                n.rows && r.attr("rows", n.rows),
                n.cols && r.attr("cols", n.cols),
                    e.getWordsText = function() {
                        if (!e.wordLimit)
                            return "";
                        if (!e.areaText || 0 == e.areaText.length)
                            return "Words remaining: " + e.wordLimit;
                        var t = e.wordLimit - e.wordCount;
                        return t >= 0 ? "Words remaining: " + t : t < 0 ? "Word Limit Exceeded: " + t : void 0
                    }
            }
        }
    }),
    angular.module("acornApp").factory("Accessibility", ["$timeout", "$anchorScroll", "accessibilityConstants", function(e, t, n) {
        function r(t, n, r) {
            var a = document.getElementById(t);
            a && (e(function() {
                var e = 60;
                r && (e = r),
                    window.scrollBy(0, a.getBoundingClientRect().top - e)
            }, 0),
                a.focus(),
            n && (n.preventDefault(),
                n.stopPropagation()))
        }
        function a(e) {
            return 13 == (null == e.which ? String.fromCharCode(e.keyCode) : 0 != e.which && 0 != e.charCode ? String.fromCharCode(e.which) : null)
        }
        function i(e, t) {
            a(t) && r(e, t)
        }
        function o() {
            var e = document.getElementsByClassName("notifications-listing-container");
            return !!(e && e.length > 0 && e[0].offsetHeight > 0)
        }
        function s(e) {
            o() ? r("high-priority-notification-container", e, 100) : r("main-content", e, 100)
        }
        function c(e) {
            a(e) && s(e)
        }
        function l(e) {
            r("acorn-nav-side", e)
        }
        function u(e) {
            a(e) && l(e)
        }
        function d(e) {
            r("typeaheadInput", e)
        }
        function p(e) {
            a(e) && d(e)
        }
        function f() {
            t("navigationTop")
        }
        function g(e) {
            S = e ? e : document.activeElement
        }
        function m(e) {
            g(e.target)
        }
        function h() {
            return S
        }
        function v(e) {
            return e.find("*").filter(n.FOCUSABLE_ELEMENTS).filter(":visible").first()
        }
        function C(e) {
            return e.find("*").filter(n.FOCUSABLE_ELEMENTS).filter(":visible").last()
        }
        function y(e) {
            var t = angular.element("body").find("*").filter(n.FOCUSABLE_ELEMENTS).filter(":visible")
                , r = t.index(e) + 1;
            return r >= t.length && (r = 0),
                t.eq(r)[0]
        }
        function A() {
            throw new Error("_restrictFocus is no longer supported.  Use the ut-restrict-focus directive instead.")
        }
        function E() {
            S && S.focus()
        }
        function T(e) {
            angular.element(document.getElementById(e)).attr("tabIndex", "-1").focus()
        }
        var S;
        return {
            setElemFocus: T,
            setLastFocus: g,
            setLastFocusUsingEvent: m,
            getLastFocus: h,
            restoreLastFocus: E,
            restrictFocus: A,
            getNextFocus: y,
            getFirstFocusableChild: v,
            getLastFocusableChild: C,
            scrollToMainContent: s,
            scrollToMainContentPress: c,
            scrollToContent: r,
            scrollToContentPress: i,
            scrollToNavigationContent: l,
            scrollToNavigationContentPress: u,
            scrollToTypeAheadInput: d,
            scrollToTypeAheadInputPress: p,
            focusOnTopNavigation: f
        }
    }
    ]),
    angular.module("acornApp").service("acornCoreLib", ["enrolmentManagerConstants", "acornToast", "acornToastConstants", function(e, t, n) {
        function r() {
            return this.interpolatePropertyStringWithArgs = function(e, t) {
                if (!angular.isArray(t))
                    return e;
                for (var n = e, r = t.length, a = 0; a < r; a++) {
                    var i = new RegExp("\\{" + a + "\\}","g");
                    n = n.replace(i, t[a])
                }
                return n
            }
                ,
                this
        }
        function a(e) {
            var t = !1
                , n = !1;
            if (!e || "string" != typeof e || 5 !== e.trim().length)
                return !1;
            var r = parseInt(e[4])
                , a = new Date
                , i = a.getFullYear()
                , o = a.getMonth() + 1;
            switch (i === parseInt(e.substr(0, 4)) && (n = !0),
                o) {
                case 1:
                case 2:
                case 3:
                case 4:
                    1 == r && (t = !0);
                    break;
                case 5:
                case 6:
                case 7:
                case 8:
                    5 == r && (t = !0);
                    break;
                case 9:
                case 10:
                case 11:
                case 12:
                    9 == r && (t = !0)
            }
            return t && n
        }
        function i() {
            var e, t, n = new Date, r = n.getFullYear(), a = n.getMonth() + 1;
            switch (a) {
                case 1:
                case 2:
                case 3:
                case 4:
                    e = "1",
                        t = "Winter";
                    break;
                case 5:
                case 6:
                case 7:
                case 8:
                    e = "5",
                        t = "Summer";
                    break;
                case 9:
                case 10:
                case 11:
                case 12:
                    e = "9",
                        t = "Fall"
            }
            return this.getSection = function() {
                return e
            }
                ,
                this.getMonth = function() {
                    return t
                }
                ,
                this.getYear = function() {
                    return r
                }
                ,
                this.getSessionCode = function() {
                    return r + e
                }
                ,
                this
        }
        function o(e) {
            function t() {
                var e = new Date(r + "-0" + a);
                return new Date(e.getTime() + 6e4 * e.getTimezoneOffset())
            }
            function n(t) {
                var n, i = r;
                if (2 == a.length)
                    if (1 == t)
                        if ("51" == a)
                            n = "52";
                        else {
                            if ("52" != a)
                                throw new Error("invalid session in sessionCode=" + e);
                            n = "9"
                        }
                    else
                        n = 9;
                else
                    "9" === a ? (i = parseInt(r) + 1,
                        n = "1") : "1" === a ? n = t ? "51" : "5" : "5" === a && (n = "9");
                return new o(i + n)
            }
            var r = e.substring(0, 4)
                , a = e.substring(4);
            return {
                sessionCode: e,
                year: r,
                session: a,
                getNextSession: n,
                getDate: t
            }
        }
        function s(e) {
            if (!e || "string" != typeof e || e.trim().length < 5)
                return null;
            var t = parseInt(e[4])
                , n = parseInt(e.substr(0, 4))
                , r = "";
            switch (t) {
                case 1:
                case 2:
                case 3:
                case 4:
                    r = "Winter";
                    break;
                case 5:
                case 6:
                case 7:
                case 8:
                    r = "Summer";
                    break;
                case 9:
                case 10:
                case 11:
                case 12:
                    r = "Fall"
            }
            return r + " " + n
        }
        function c() {
            function t(t) {
                if (!angular.isString(t))
                    return null;
                var n = e.SESSION_MAPPER
                    , r = parseInt(t.substring(0, 4), 10)
                    , a = parseInt(t.substring(4, 5), 10);
                return {
                    sessionStr: n[a],
                    sessionYear: r,
                    sessionNumber: a
                }
            }
            function n(e) {
                var n = t(e);
                if (null === n)
                    return e;
                var r = n.sessionNumber
                    , a = n.sessionYear
                    , i = [e];
                return 9 === r && i.push(a + 1 + "1"),
                    i
            }
            return this.getSessionsArrayFromSessionCode = n,
                this.parseROSISession = t,
                this
        }
        function l() {
            function e(e, t, n, r) {
                for (var a = [], i = 0, o = 0; i < e.length && o < t.length; ) {
                    var s = e[i][n]
                        , c = t[o][n];
                    r === !0 && s > c ? a.push(e[i++]) : r === !1 && s < c ? a.push(e[i++]) : a.push(t[o++])
                }
                return a.concat(e.slice(i)).concat(t.slice(o))
            }
            function t(n, r, a) {
                if (n.length < 2)
                    return n;
                var i = Math.floor(n.length / 2)
                    , o = n.slice(0, i)
                    , s = n.slice(i);
                return e(t(o, r, a), t(s, r, a), r, a)
            }
            var n = {}
                , r = new i;
            return n.mergeSortForKeyDESC = function(e, n) {
                return t(e, n, !0)
            }
                ,
                n.mergeSortForKeyASC = function(e, n) {
                    return t(e, n, !1)
                }
                ,
                this.getSortAlgorithms = function() {
                    return n
                }
                ,
                this.isCurrentSession = function(e) {
                    return a(e)
                }
                ,
                this.getCurrentSession = function() {
                    return r
                }
                ,
                this.getSessionToDescription = function(e) {
                    return s(e)
                }
                ,
                this.getFallWinterSessionCodes = function(e) {
                    if (angular.isUndefined(e)) {
                        var t = new Date
                            , n = t.getMonth();
                        e = n >= 1 && n < 5 ? t.getFullYear() - 1 : t.getFullYear()
                    }
                    return {
                        fallSessionCode: e + "9",
                        winterSessionCode: e + 1 + "1"
                    }
                }
                ,
                this.createSession = function(e) {
                    return new o(e)
                }
                ,
                this
        }
        this.isIE = function() {
            var e = navigator.userAgent.toLowerCase();
            return e.indexOf("msie") != -1 && parseInt(e.split("msie")[1])
        }
        ;
        var u = {};
        return u.propertyLib = null,
            u.enrolmentLib = null,
            u.utilityLib = null,
            this.getPropertiesLib = function() {
                return null === u.propertyLib && (u.propertyLib = new r),
                    u.propertyLib
            }
            ,
            this.getEnrolmentLib = function() {
                return null === u.enrolmentLib && (u.enrolmentLib = new c),
                    u.enrolmentLib
            }
            ,
            this.getUtilityLib = function() {
                return null === u.utilityLib && (u.utilityLib = new l),
                    u.utilityLib
            }
            ,
            this.getAvailabilityForDisplay = function(e, t) {
                return t ? t : "ONL" === e ? "N.A." : "TBA"
            }
            ,
            this.saveBlobAsFile = function(e, r) {
                var a = navigator.userAgent.match(/MSIE\s([\d.]+)/)
                    , i = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/)
                    , o = navigator.userAgent.match(/Edge/g)
                    , s = a ? a[1] : i ? 11 : o ? 12 : -1;
                if (a && s < 10)
                    return t.showToast({
                        message: "Failed to download your " + r + ". If you are using Internet Explorer, please make sure the version of your browser is 10 or greater.",
                        type: n.TYPE_DANGER
                    }),
                        !1;
                if (s > -1)
                    window.navigator.msSaveBlob(e, r);
                else {
                    var c = document.createElement("a");
                    c.download = r,
                        c.href = window.URL.createObjectURL(e),
                        c.onclick = function(e) {
                            document.body.removeChild(e.target)
                        }
                        ,
                        c.style.display = "none",
                        document.body.appendChild(c),
                        c.click()
                }
                return !0
            }
            ,
            this
    }
    ]),
    angular.module("acornApp").service("acornCoreProperties", function() {
        function e() {
            l.enrolment = {
                messages: {
                    toasts: {},
                    errors: {}
                },
                maps: {}
            },
                l.enrolment.maps.courseStatusMap = {
                    APP: "Currently Enrolled",
                    INT: "Interim",
                    REQ: "Requested",
                    WAIT: "Waitlisted",
                    DROP: "Withdrawn",
                    REF: "Refused"
                };
            var e = l.enrolment.messages.toasts;
            e.enrolled = {
                ADD: "You have successfully enrolled in {0} {1}",
                ADD_INT_REQ: "You have requested {0}: {1}, {2}. Divisional approval is required for enrolment and that review is now underway. ",
                UPDATE: "{0} {1} section modified",
                REMOVE: "{0} {1} has been dropped."
            },
                e.plans = {
                    ADD: "You have added {0} {1} to your enrolment cart.",
                    UPDATE: "You have updated {0} {1} in your enrolment cart.",
                    COURSE_EXISTS: "This specific combination of course activities is already in your enrolment cart for {0} {1}.",
                    UPDATE_FAILED: "Failed to update  {0} {1}. Please contact the administrator at your faculty.",
                    REMOVE: "You have removed {0} {1} {2} from your enrolment cart.",
                    PLANS_EXCEEDING_MAX: "Your Enrolment Cart has reached its limit of {0} items. To add {1} item to your Enrolment Cart, remove an existing item."
                },
                e.waitlists = {
                    ADD: "{0} {1} added to waitlist in {2}.",
                    REMOVE: "{0} {1} has been removed from the waitlist in {2}."
                };
            var t = l.enrolment.messages;
            t.errors.enrolmentBlock = {},
                t.errors.enrolmentBlock.defaultMessage = 'You are currently blocked from enrolling in this course. To determine if and when this course may become available for you consult your Registrar\'s website or the courses offering division. Please see <a href="{0}" target="_blank">{1}</a> for more details.',
                t.errors.enrolmentBlock.preReqsMessage = "You have not passed following prerequisites:<br/> {0}",
                t.errors.enrolmentBlock.coReqsMessage = "You have not passed following corequisites:<br/> {0}",
                t.errors.enrolmentBlock.exclusionsMessage = "You passed following exclusions:<br/> {0}",
                t.errors.preReq = {},
                t.errors.preReq.defaultMessage = "Prerequisite not yet completed: {0} {1}",
                t.errors.coReq = {},
                t.errors.coReq.defaultMessage = "Corequisite not yet enrolled in.",
                t.errors.exclusion = {},
                t.errors.exclusion.defaultMessage = "Exclusion already completed."
        }
        function t() {
            l.programEnrolment = {
                messages: {
                    toasts: {},
                    errors: {}
                },
                maps: {}
            };
            var e = l.programEnrolment.maps;
            e.programStatusMap = {
                ACT: "Currently Enrolled",
                INV: "Invited",
                REF: "Refused",
                REQ: "Requested",
                CMP: "Completed"
            },
                e.programStatusType = {
                    ACTIVE: "ACT",
                    INVITED: "INV",
                    REQUESTED: "REQ",
                    REFUSED: "REF",
                    COMPLETED: "CMP"
                },
                e.programApprovalTypeSpecifier = {
                    ARTSC: {
                        PRE_APPROVED: {
                            typeCode: 1,
                            typeDescription: "Auto-approved",
                            tooltip: {
                                messages: 'This <a href="http://www.artsci.utoronto.ca/current/program/enrolment-instructions/index_html" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be enrolled in during a specific enrolment period and has no enrolment requirements other than the successful completion of 4.0 full-course equivalents (FCEs).'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br>Read the registration instructions on the <a href="http://www.artsci.utoronto.ca/current/course/timetable" target="_blank">current timetable<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> to learn about deregulated program fees.'
                            }
                        },
                        APPROVAL_REQUIRED: {
                            typeCode: 2,
                            typeDescription: "Approval Required",
                            tooltip: {
                                messages: 'This <a href="http://www.artsci.utoronto.ca/current/program/enrolment-instructions/index_html" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request periods and has enrolment requirements for particular courses and/or minimum grades, and may have a limited number of spaces.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br>Read the registration instructions on the <a href="http://www.artsci.utoronto.ca/current/course/timetable" target="_blank">current timetable<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> to learn about deregulated program fees.'
                            }
                        },
                        SPECIAL_APPROVAL_REQUIRED: {
                            typeCode: 3,
                            typeDescription: "Special Approval Required",
                            tooltip: {
                                messages: 'This <a href="http://www.artsci.utoronto.ca/current/program/enrolment-instructions/index_html" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request period(s) and requires: <ul class="tooltip-list">    <li>completion of particular courses</li>    <li>minimum grades</li> </ul>An application form and/or interview may be required as part of the application process as there is limited space available for the students competing to enrol in this program.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br>Read the registration instructions on the <a href="http://www.artsci.utoronto.ca/current/course/timetable" target="_blank">current timetable<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> to learn about deregulated program fees.'
                            }
                        }
                    },
                    SCAR: {
                        PRE_APPROVED: {
                            typeCode: 1,
                            typeDescription: "Unlimited Enrolment",
                            tooltip: {
                                messages: 'This <a href="http://www.utsc.utoronto.ca/~registrar/current_students/subject_post"  target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> may be enrolled in at any time and has no enrolment requirements other than the successful completion of 4.0 credits.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="http://www.utsc.utoronto.ca/registrar/program-fees" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        },
                        APPROVAL_REQUIRED: {
                            typeCode: 2,
                            typeDescription: "Limited Enrolment",
                            tooltip: {
                                messages: 'This <a href="http://www.utsc.utoronto.ca/~registrar/current_students/subject_post" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request periods and has enrolment requirements for particular courses and/or minimum grades, and potentially other criteria.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="http://www.utsc.utoronto.ca/registrar/program-fees" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        },
                        SPECIAL_APPROVAL_REQUIRED: {
                            typeCode: 3,
                            typeDescription: "Limited Enrolment",
                            tooltip: {
                                messages: 'This <a href="http://www.utsc.utoronto.ca/~registrar/current_students/subject_post" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request periods and has enrolment requirements for particular courses and/or minimum grades, and potentially other criteria.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="http://www.utsc.utoronto.ca/registrar/program-fees" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        }
                    },
                    ERIN: {
                        PRE_APPROVED: {
                            typeCode: 1,
                            typeDescription: "Auto-approved",
                            tooltip: {
                                messages: 'This <a href="http://www.utm.utoronto.ca/registrar/node/5053/" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> may be enrolled in at any time and has no enrolment requirements other than the successful completion of 4.0 credits.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="https://www.utm.utoronto.ca/admissions/new-students/costs-financial-aid/tuition-other-costs" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        },
                        APPROVAL_REQUIRED: {
                            typeCode: 2,
                            typeDescription: "Approval Required",
                            tooltip: {
                                messages: 'This <a href="http://www.utm.utoronto.ca/registrar/node/5053/" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request periods and has enrolment requirements for particular courses, minimum GPA and/or grades. Additional information and/or an interview may be required as part of the application process.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="https://www.utm.utoronto.ca/admissions/new-students/costs-financial-aid/tuition-other-costs" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        },
                        SPECIAL_APPROVAL_REQUIRED: {
                            typeCode: 3,
                            typeDescription: "Special Approval Required",
                            tooltip: {
                                messages: 'This <a href="http://www.utm.utoronto.ca/registrar/node/5053/" target="_blank">program (Subject POSt)<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> must be requested during specific request periods and has enrolment requirements for particular courses, minimum GPA and/or grades, and competition among applicants meeting the minimum requirements for the limited available space. Additional information and/or an interview may be required as part of the application process.'
                            },
                            deregulated: {
                                messages: 'Deregulated programs usually have higher tuition fees. If you enrol in a deregulated program after completing 4.0 credits or more, you will be retroactively charged for all courses completed after earning your fourth credit.<br><br><a href="https://www.utm.utoronto.ca/admissions/new-students/costs-financial-aid/tuition-other-costs" target="_blank">Learn more about deregulated programs fees<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>.'
                            }
                        }
                    },
                    DEFAULT: {
                        PRE_APPROVED: {
                            typeCode: 1,
                            typeDescription: "Auto-approved",
                            tooltip: {
                                messages: []
                            },
                            deregulated: {
                                messages: []
                            }
                        },
                        APPROVAL_REQUIRED: {
                            typeCode: 2,
                            typeDescription: "Approval Required",
                            tooltip: {
                                messages: []
                            },
                            deregulated: {
                                messages: []
                            }
                        },
                        SPECIAL_APPROVAL_REQUIRED: {
                            typeCode: 3,
                            typeDescription: "Special Approval Required",
                            tooltip: {
                                messages: []
                            },
                            deregulated: {
                                messages: []
                            }
                        }
                    }
                },
                e.programApprovalTypeSpecifier.ARCLA = e.programApprovalTypeSpecifier.ARTSC
        }
        function n() {
            l.sessionalDateMessageMap = {};
            var e = {
                JF1: "Victoria Day",
                JF2: "Canada Day",
                JF3: "Civic Holiday",
                JF4: "Labour Day",
                JF5: "Thanksgiving Day",
                JF6: "Winter holidays  University closed",
                JF7: "Easter",
                JF8: "Family Day",
                J02: "Study Break",
                MAZ: "Course enrolment open",
                MA1: "Course enrolment open for year 1 students",
                MA2: "Course enrolment open for year 2 students",
                MA3: "Course enrolment open for year 3 students",
                MA4: "Course enrolment open for year 4 students",
                MA5: "Course enrolment open for year 5 students",
                MW1: "Waitlists available for course enrolment",
                MC1_9: "Last date to drop a fall term course",
                MC1_1: "Last date to drop a winter term course",
                MC1_5: "Last date to drop a full term summer course",
                MC1_5F: "Last date to drop a first term summer course",
                MC1_5S: "Last date to drop a second term summer course",
                MC2: "Last date to drop a 2 term (full academic session) course",
                M09_START: "First day to request enrolment in limited/type 2 programs",
                M09_END: "Last day to request enrolment in limited/type 2 programs",
                M10: "Deadline to accept invitation to restricted programs",
                M11: "Dates Program enrolment is not available to graduating students",
                N07: "Online availability of course grades",
                N09: "Online availability of academic standing",
                N10: "Dates to request graduation",
                S01_9_START: "First day of fall class",
                S01_1_START: "First day of winter class",
                S01_5_START: "First day of summer class",
                S01_9_END: "Last day of fall classes",
                S01_1_END: "Last day of winter classes",
                S01_5_END: "Last day of summer classes"
            };
            l.sessionalDateMessageMap = e
        }
        function r() {
            l.eligibleRegistration = {
                messages: {},
                maps: {}
            },
                l.eligibleRegistration.maps.regStatusMap = {
                    INVIT: "Invited",
                    REG: "Registered",
                    FINCA: "Financially Cancelled",
                    CANC: "Cancelled",
                    DEREG: "Deregistered"
                };
            var e = l.eligibleRegistration.messages;
            e.courseWorkload = {},
                e.courseWorkload.infoForOrganization = {},
                e.courseWorkload.infoForOrganization.ARTSC = 'To prevent overloading your schedule you are recommended to limit your workload to 5.0 per term, with an enforced maximum limit of 6.0 per each term in the Fall/Winter session. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances.<br/>For more information on course loads, please see: <a href="http://www.artsci.utoronto.ca/current/forms-services/term-load-limit" target="_blank">http://www.artsci.utoronto.ca/current/forms-services/term-load-limit<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>',
                e.courseWorkload.infoForOrganization.ARTSC_SUMMER = 'To prevent overloading your schedule you are recommended to limit your workload to 1.0 per term with an enforced maximum limit of 2.0 courses per term in the Summer session. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances.<br/>For more information on course loads, please see: <a href="http://www.artsci.utoronto.ca/current/forms-services/term-load-limit" target="_blank">http://www.artsci.utoronto.ca/current/forms-services/term-load-limit<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>',
                e.courseWorkload.infoForOrganization.ARCLA = 'To prevent overloading your schedule you are recommended to limit your workload to 5.0 per term, with an enforced maximum limit of 6.0 per each term in the Fall/Winter session. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances.<br/>For more information on course loads, please see: <a href="https://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration" target="_blank">https://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>',
                e.courseWorkload.infoForOrganization.ARCLA_SUMMER = 'To prevent overloading your schedule you are recommended to limit your workload to 1.0 per term with an enforced maximum limit of 2.0 courses per term in the Summer session. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances.<br/>For more information on course loads, please see: <a href="https://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration" target="_blank">https://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a>',
                e.courseWorkload.infoForOrganization.ERIN = 'Students can take up to a maximum of 6.0 credits (5.0 recommended) as a full time student and a maximum of 3.0 credits (2.5 recommended) as a part time student per academic term in the Fall/Winter Session. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances. For more information on course loads, course enrolment dates and course overload requests, please see the following materials:<ul><li>Academic Calendar: <a href="https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Course%20Loads%20and%20Overloads" target="_blank">https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Course%20Loads%20and%20Overloads<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a></li><li>Registration Guide: <a href="http://www.utm.utoronto.ca/registrar/office-registrar-publications" target="_blank">http://www.utm.utoronto.ca/registrar/office-registrar-publications<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a></li><ul>',
                e.courseWorkload.infoForOrganization.ERIN_SUMMER = 'Students can take up to a maximum of 2.0 credits during the Summer Session and a maximum of 1.0 credits in each term. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances. For more information on course loads, course enrolment dates and course overload requests, please see the following materials:<ul><li>Academic Calendar: <a href="https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Course%20Loads%20and%20Overloads" target="_blank">https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Course%20Loads%20and%20Overloads<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a></li><li>Registration Guide: <a href="http://www.utm.utoronto.ca/registrar/office-registrar-publications" target="_blank">http://www.utm.utoronto.ca/registrar/office-registrar-publications<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a></li><ul>',
                e.courseWorkload.infoForOrganization.SCAR = 'To prevent overloading your schedule you are recommended to limit your workload to 2.5 credits per term, with an enforced maximum limit of 3.0 credits per term. The workload count includes enrolled, waitlist, interim and requested courses. Some students may have different workloads enforced based on special circumstances. More information is available on the UTSC Registrar&apos;s office website.<br><br>For more information on workload limits:<br><a href="http://www.utsc.utoronto.ca/registrar/eligible-course-loads" target="_blank">http://www.utsc.utoronto.ca/registrar/eligible-course-loads<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a><br>For dates and session deadlines:<br><a href="http://www.utsc.utoronto.ca/registrar/dates-and-deadlines" target="_blank">http://www.utsc.utoronto.ca/registrar/dates-and-deadlines<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a></a>',
                e.creditNoCredit = {},
                e.creditNoCredit.infoForOrganization = {},
                e.creditNoCredit.infoForOrganization.ARTSC = "You may select up to 2.0 full-course equivalents (FCEs) of your degree credits offered by the Faculty of Arts & Science (St. George), UTM or UTSC to be <a href='http://www.artsci.utoronto.ca/current/forms-services/crncr' target='_blank'>assessed on a Credit/No Credit (CR/NCR) basis<span class='icon-link-ext'></span></a>.",
                e.creditNoCredit.infoForOrganization.ERIN = "You may select up to a total of 2.0 credits to be <a href='http://www.utm.utoronto.ca/registrar/office-registrar-publications/returning-students-registration-guide/how-select-your-courses' target='_blank'>assessed on a Credit/No Credit basis<span class='icon-link-ext'></span></a> within the total number of credits required for your degree. The choice is not restricted to year or level of course. ",
                e.creditNoCredit.infoForOrganization.SCAR = "You may select up to 2.0 full credits to be <a href='http://www.utsc.utoronto.ca/~registrar/current_students/credit_no_credit' target='_blank'>assessed on a Credit/No Credit basis<span class='icon-link-ext'></span></a>."
        }
        function a() {
            function e(e, t, n) {
                return this.getName = function() {
                    return t
                }
                    ,
                    this.getOrgCode = function() {
                        return e
                    }
                    ,
                    this.getURIForType = function(e) {
                        return n[e] || null
                    }
                    ,
                    this
            }
            var t = {};
            t.ARTSC = new e("ARTSC","Faculty of Arts &amp; Science",{
                registrar: "http://www.artsci.utoronto.ca/current",
                registrarSupport: "http://www.artsci.utoronto.ca/current/advising/ofr",
                calendar: "http://www.artsandscience.utoronto.ca/ofr/calendar/",
                enrolmentControl: "http://www.artsci.utoronto.ca/current/course/timetable/index/step1",
                postInfo: "http://www.artsci.utoronto.ca/current/program/enrolment-instructions/index_html",
                postTypes: "http://www.artsci.utoronto.ca/current/program/enrolment-instructions/index_html",
                alias: "Arts &amp; Science"
            }),
                t.ERIN = new e("ERIN","University of Toronto Mississauga",{
                    registrar: "https://www.utm.utoronto.ca/registrar/office-registrar",
                    calendar: "https://student.utm.utoronto.ca/calendar/calendar.pl",
                    enrolmentControl: "http://www.utm.utoronto.ca/registrar/sites/files/registrar/public/shared/pdfs/registrationguides/2014FINALReturningStudentsOnly.pdf",
                    postInfo: "http://www.utm.utoronto.ca/registrar/office-registrar-publications",
                    alias: "Mississauga"
                }),
                t.SCAR = new e("SCAR","University of Toronto Scarborough",{
                    registrar: "https://www.utsc.utoronto.ca/~registrar/",
                    calendar: "http://www.utsc.utoronto.ca/~registrar/calendars/calendar/",
                    enrolmentControl: "http://www.utsc.utoronto.ca/~registrar/current_students/courses",
                    postInfo: "http://www.utsc.utoronto.ca/~registrar/current_students/subject_post",
                    postLimits: "http://www.utsc.utoronto.ca/~registrar/current_students/subject_post_codes",
                    alias: "Scarborough"
                }),
                t.APSC = new e("APSC","Faculty of Applied Science &amp; Engineering",{
                    registrar: "http://www.undergrad.engineering.utoronto.ca/Office_of_the_Registrar.htm",
                    registrarSupport: "http://www.undergrad.engineering.utoronto.ca/Office_of_the_Registrar.htm",
                    calendar: "http://www.undergrad.engineering.utoronto.ca/Office_of_the_Registrar/Academic_Calendar.htm",
                    alias: "Engineering"
                }),
                t.SGS = new e("SGS","School of Graduate Studies",{
                    calendar: "http://www.sgs.utoronto.ca/calendar/Pages/default.aspx",
                    alias: "Graduate Studies"
                }),
                t.MUSIC = new e("MUSIC","Faculty of Music",{
                    calendar: "http://www.artsandscience.utoronto.ca/ofr/calendar/",
                    registrarSupport: "https://music.utoronto.ca/student-services-resources.php",
                    alias: "Music"
                }),
                t.FPEH = new e("FPEH","Faculty of Kinesiology &amp; Physical Education",{
                    registrar: "http://www.physical.utoronto.ca/Undergraduate/Current_Students/Registrar_Services.aspx",
                    registrarSupport: "http://physical.utoronto.ca/Undergraduate/Current_Students/Registrar_Services.aspx",
                    calendar: "http://www.physical.utoronto.ca/Undergraduate/Current_Students/Calendar.aspx",
                    alias: "Kinesiology &amp; Phys Ed"
                }),
                t.NURS = new e("NURS","Faculty of Nursing",{
                    registrar: "http://bloomberg.nursing.utoronto.ca/admissions-financial-aid/contact-student-services",
                    registrarSupport: "https://bloomberg.nursing.utoronto.ca/current-students/academic-contact",
                    calendar: "http://bloomberg.nursing.utoronto.ca/academic/sessional-dates-and-calendar#content3",
                    alias: "Bloomberg Nursing"
                }),
                t.MGT = new e("MGT","Joseph L. Rotman School of Management",{
                    registrar: "http://www.artsci.utoronto.ca/current",
                    registrarSupport: "http://rotmancommerce.utoronto.ca/currentstudents/",
                    calendar: "http://www.artsandscience.utoronto.ca/ofr/calendar",
                    alias: "Rotman Management"
                }),
                t.OISUT = new e("OISUT","OISE",{
                    registrar: "http://www.oise.utoronto.ca/ro",
                    registrarSupport: "http://www.oise.utoronto.ca/ro/index.html",
                    calendar: "http://www.oise.utoronto.ca/ro/Publications.html",
                    alias: "OISE"
                }),
                t.DENT = new e("DENT","Faculty of Dentistry",{
                    calendar: "http://www.dentistry.utoronto.ca/students/faculty-calender",
                    registrarSupport: "https://www.dentistry.utoronto.ca/students/student-services",
                    alias: "Dentistry"
                }),
                t.LAW = new e("LAW","Faculty of Law",{
                    registrarSupport: "http://www.law.utoronto.ca/",
                    alias: "Law"
                }),
                t.MED = new e("MED","Faculty of Medicine",{
                    registrar: "http://www.md.utoronto.ca/ouroffices/registrar.htm",
                    registrarSupport: "http://www.md.utoronto.ca/ouroffices/registrar.htm",
                    alias: "Medicine"
                }),
                t.PHM = new e("PHM","Faculty of Pharmacy",{
                    registrar: "http://www.pharmacy.utoronto.ca/pharmd/contact-office-registrar",
                    registrarSupport: "http://www.pharmacy.utoronto.ca/pharmd/office-registrar",
                    alias: "Pharmacy"
                }),
                t.ARCLA = new e("ARCLA","John H. Daniels Faculty of Architecture, Landscape, and Design",{
                    registrarSupport: "https://daniels.utoronto.ca/students/undergraduate-students/support-and-services/office-registrar-and-student-services"
                }),
                l.org_info_map = t
        }
        function i() {
            l.dashboard = {
                messages: {
                    errors: {}
                }
            },
                l.dashboard.messages.widgets = {
                    ENROL_MANAGE: {
                        NO_CONTENT: {
                            DEFAULT: '<a href="http://www.future.utoronto.ca/current-students/registrars//" target="_blank">Registrar<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - Your first-stop whenever you have questions, concerns or are facing issues that are getting in the way of your success.',
                            SCAR: '<a href="http://www.utsc.utoronto.ca/~registrar/" target="_blank">Contact your Registrar<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - Your first-stop whenever you have questions, concerns or are facing issues that are getting in the way of your success.',
                            ERIN: '<a href="http://www.utm.utoronto.ca/registrar/" target="_blank">Contact your Registrar<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - Your first-stop whenever you have questions, concerns or are facing issues that are getting in the way of your success.'
                        }
                    },
                    PLAN_AND_EXPLORE: {
                        NO_CONTENT: {
                            DEFAULT: '<a href="https://www.studentlife.utoronto.ca/asc/" target="_blank">Academic Support<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - Develop your general academic, exam preparation, writing, math or English language skills.',
                            SCAR: '<a href="http://www.utsc.utoronto.ca/aacc/academic-advising-study-skills" target="_blank">Academic Advising & Study Skills<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - Support services to help you succeed academically.',
                            ERIN: '<a href="http://www.utm.utoronto.ca/asc/" target="_blank">Academic Skills Centre<span class="acorn-fa fa fa-external-link" aria-hidden="true"></span><span class="sr-only">, External link</span></a> - A full range of workshops, seminars and individual consultations are available to help you identify and develop the academic skills you need.'
                        }
                    }
                }
        }
        function o() {
            l.timetable = {
                messages: {
                    errors: {}
                }
            };
            var e = l.timetable.messages;
            e.errors.conflict = {},
                e.errors.conflict.defaultMessage = "One or more activities conflicts with another activity on your timetable."
        }
        function s(e, t) {
            var n = e
                , r = n
                , a = !1;
            "SGS" === n && void 0 != l.keyDatesMap[t] && (n = t,
                r = n + "G",
                a = !0);
            var i;
            return void 0 !== l.keyDatesMap[n] && (i = l.keyDatesMap[n],
            a && (i.url = l.keyDatesMap[n].sgsUrl)),
            {
                KEYDATE: i,
                ORGKEY: r
            }
        }
        function c() {
            l.serverSettings = {},
                l.serverSettings.contextPath = "/sws"
        }
        var l = {};
        this.getSessionalDate = function(e, t, n) {
            var r = [];
            if (null === t)
                return r.push(n),
                    r;
            var a = t.substring(4, t.length);
            switch (e) {
                case "JF1":
                case "JF2":
                case "JF3":
                case "JF4":
                case "JF5":
                case "JF6":
                case "JF7":
                case "JF8":
                case "J02":
                case "MAZ":
                case "MA1":
                case "MA2":
                case "MA3":
                case "MA4":
                case "MA5":
                case "MW1":
                case "MC2":
                case "M10":
                case "M11":
                case "N07":
                case "N09":
                case "N10":
                    r.push(l.sessionalDateMessageMap[e]);
                    break;
                case "MC1":
                    r.push(l.sessionalDateMessageMap[e + "_" + a]);
                    break;
                case "M09":
                    r.push(l.sessionalDateMessageMap[e + "_START"]),
                        r.push(l.sessionalDateMessageMap[e + "_END"]);
                    break;
                case "S01":
                    r.push(l.sessionalDateMessageMap[e + "_" + a.substring(0, 1) + "_START"]),
                        r.push(l.sessionalDateMessageMap[e + "_" + a.substring(0, 1) + "_END"]);
                    break;
                default:
                    r.push(n)
            }
            return r
        }
            ,
            this.getCourseWorkloadMessage = function(e, t) {
                var n = l.eligibleRegistration.messages.courseWorkload.infoForOrganization;
                if (e)
                    return "ARTSC" === e ? t.indexOf("Summer") > -1 ? n.ARTSC_SUMMER : n.ARTSC : "ARCLA" === e ? t.indexOf("Summer") > -1 ? n.ARCLA_SUMMER : n.ARCLA : "ERIN" === e ? t.indexOf("Summer") > -1 ? n.ERIN_SUMMER : n.ERIN : "SCAR" === e ? n.SCAR : void 0
            }
            ,
            this.getCreditNoCreditMessage = function(e) {
                if (e) {
                    var t = l.eligibleRegistration.messages.creditNoCredit.infoForOrganization;
                    return "ARCLA" == e || "ARTSC" == e ? t.ARTSC : "ERIN" == e ? t.ERIN : "SCAR" == e ? t.SCAR : void 0
                }
            }
        ;
        var u = function() {
            l.enrolmentControl = {
                errors: {
                    default: "There is an enrolment control acting on activity"
                }
            }
        }
            , d = function() {
            l.spaceUnavailable = {
                errors: {
                    default: "There is currently no space in"
                }
            }
        }
            , p = function() {
            l.courseStatus = {
                errors: {
                    REQ: "<b>This course requires approval to enrol from the offering division and/or instructing faculty member.</b><br><span>You may request to enrol in this course and view your division&apos;s response via the Courses screen in ACORN.</span>",
                    INT: "<b>This course requires approval to enrol from the offering division and/or instructing faculty member.</b><br><span>You may request to enrol in this course and view your division&apos;s response via the Courses screen in ACORN.</span>"
                }
            }
        }
            , f = function() {
            l.keyDatesMap = {
                APSC: {
                    name: "Faculty of Applied Science and Engineering",
                    url: "http://www.undergrad.engineering.utoronto.ca/About/Dates_Deadlines.htm",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                ARCLA: {
                    name: "John H. Daniels Faculty of Architecture, Landscape, and Design",
                    url: "http://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration",
                    sgsUrl: "https://www.daniels.utoronto.ca/current-students/graduate-students/academics-and-registration"
                },
                ARTSC: {
                    name: "Faculty of Arts and Science",
                    url: "http://www.artsci.utoronto.ca/newstudents/courses/dates",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                DENT: {
                    name: "Faculty of Dentistry",
                    url: "http://www.dentistry.utoronto.ca/students/doctor-dental-surgery-dds/sessional-dates",
                    sgsUrl: "http://www.dentistry.utoronto.ca/students/graduate-studies/sessional-dates"
                },
                OISUT: {
                    name: "Ontario Institute for Studies in Education",
                    url: "http://www.oise.utoronto.ca/ss/index.html",
                    sgsUrl: "http://www.oise.utoronto.ca/ro/Graduate_Students/Continuing_Students/Important_Dates.html"
                },
                FOR: {
                    name: "Faculty of Forestry",
                    url: "http://www.forestry.utoronto.ca/index.php/undergraduate-student-resources/",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                SGS: {
                    name: "School of Graduate Studies",
                    url: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                FIS: {
                    name: "Faculty of Information",
                    url: "http://current.ischool.utoronto.ca/studies/academic-dates",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                FPEH: {
                    name: "Faculty of Kinesiology and Physical Education",
                    url: "http://physical.utoronto.ca/Undergraduate/Current_Students/Calendar.aspx",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                LAW: {
                    name: "Faculty of Law",
                    url: "http://www.law.utoronto.ca/academic-programs/sessional-dates",
                    sgsUrl: "http://www.law.utoronto.ca/academic-programs/sessional-dates"
                },
                MGT: {
                    name: "Joseph L. Rotman School of Management",
                    url: "http://www.future.utoronto.ca/newly-admitted-students/important-dates/",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                MED: {
                    name: "Faculty of Medicine",
                    url: "http://www.md.utoronto.ca/admissions/information/Important_Dates.htm",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                MUSIC: {
                    name: "Faculty of Music",
                    url: "https://www.music.utoronto.ca/student-services-resources.php",
                    sgsUrl: "https://www.music.utoronto.ca/information-graduate-students.php"
                },
                NURS: {
                    name: "Lawrence S. Bloomberg Faculty of Nursing",
                    url: "https://bloomberg.nursing.utoronto.ca/academic/sessional-dates-and-calendar",
                    sgsUrl: "http://bloomberg.nursing.utoronto.ca/academic/sessional-dates-and-calendar#content2"
                },
                PHM: {
                    name: "Leslie L. Dan Faculty of Pharmacy",
                    url: "http://www.pharmacy.utoronto.ca/bscphm/current-students/registrar/dates",
                    sgsUrl: "http://www.pharmacy.utoronto.ca/gradprograms/course-schedule"
                },
                DLSPH: {
                    name: "Dalla Lana School of Public Health",
                    url: "http://www.dlsph.utoronto.ca/page/timetables",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                },
                ERIN: {
                    name: "University of Toronto Mississauga",
                    url: "http://www.utm.utoronto.ca/registrar/important-dates"
                },
                SCAR: {
                    name: "University of Toronto Scarborough",
                    url: "http://www.utsc.utoronto.ca/~registrar/calendars/calendar/Sessional_Dates.html"
                },
                SWK: {
                    name: "Factor-Inwentash Faculty of Social Work",
                    sgsUrl: "http://www.sgs.utoronto.ca/currentstudents/Pages/Sessional-Dates.aspx"
                }
            }
        };
        return function() {
            e(),
                i(),
                t(),
                r(),
                o(),
                a(),
                u(),
                d(),
                p(),
                c(),
                n(),
                f()
        }(),
            this.getPropertiesForKey = function(e) {
                return angular.isDefined(l[e]) && angular.isString(e) ? l[e.toLowerCase()] : null
            }
            ,
            this.getEnrolmentControlProperties = function() {
                return l.enrolmentControl
            }
            ,
            this.getSpaceUnavailableProperties = function() {
                return l.spaceUnavailable
            }
            ,
            this.getCourseStatusProperties = function() {
                return l.courseStatus
            }
            ,
            this.getEnrolmentProperties = function() {
                return l.enrolment
            }
            ,
            this.getTimetableProperties = function() {
                return l.timetable
            }
            ,
            this.getEligibleRegistrationProperties = function() {
                return l.eligibleRegistration
            }
            ,
            this.getProgramEnrolmentProperties = function() {
                return l.programEnrolment
            }
            ,
            this.getOrgInfoByOrgCode = function(e) {
                return "string" != typeof e ? null : l.org_info_map[e.toUpperCase()] || null
            }
            ,
            this.getDashboardProperties = function() {
                return l.dashboard
            }
            ,
            this.getLandingPageProperties = function() {
                return l.landingPage
            }
            ,
            this.getServerProperties = function() {
                return l.serverSettings
            }
            ,
            this.getSessionalDateMessageMap = function() {
                return l.sessionalDateMessageMap
            }
            ,
            this.getKeyDateForOrg = function(e, t) {
                return s(e, t)
            }
            ,
            this
    }),
    angular.module("acornApp").service("acornSettings", ["$q", "$cookieStore", "acornCorePropertyConstants", function(e, t, n) {
        function r() {
            s = a(n.COOKIE_PROPERTIES.SESSION_COOKIE_NAME) || {}
        }
        function a(e) {
            return t.get(e)
        }
        function i(e) {
            o(n.COOKIE_PROPERTIES.SESSION_COOKIE_NAME, e)
        }
        function o(e, n) {
            t.put(e, n)
        }
        var s = {}
            , c = e.defer();
        return {
            initialize: function() {
                return r(),
                    c.resolve("acornSettings initialized"),
                    c.promise
            },
            getSetting: function(e) {
                return s[e] || null
            },
            saveSetting: function(e, t) {
                s[e] = t,
                    i(s)
            }
        }
    }
    ]),
    angular.module("acornApp").factory("acornToast", ["$timeout", "$window", "acornToastConstants", function(e, t, n) {
        function r(e) {
            var t = e.vPos
                , n = e.hPos
                , r = t + "_" + n
                , a = angular.element("#" + r);
            if (!a.length) {
                var i = "top" === t ? angular.element("#acorn-nav-top").outerHeight() + 20 : 0
                    , o = "right" === n ? 20 : angular.element("#acorn-nav-side-parent").width()
                    , s = '<div id="' + r + '" class="acorn-toast-container" style="position: fixed; ' + t + ": " + i + "px; " + n + ": " + o + 'px; z-index: 1100;"></div>';
                a = angular.element(s),
                    a.appendTo(document.body)
            }
            return a
        }
        var a = function(t) {
            function r() {
                switch (d) {
                    case n.TYPE_DANGER:
                        return {
                            bg: "fa-exclamation-triangle",
                            fg: "fa-exclamation"
                        };
                    case n.TYPE_SUCCESS:
                        return {
                            bg: "fa-circle",
                            fg: "fa-check"
                        };
                    case n.TYPE_WARNING:
                        return {
                            bg: "fa-circle",
                            fg: "fa-exclamation"
                        };
                    default:
                        return {
                            bg: "fa-circle",
                            fg: "fa-info"
                        }
                }
            }
            function a() {
                m = !1
            }
            function i() {
                m = !0,
                h && o()
            }
            function o() {
                m && c()
            }
            function s() {
                c()
            }
            function c() {
                C.removeClass("toast-animate"),
                    angular.element(C).off("mouseover", a),
                    angular.element(C).off("mouseleave", i),
                    e.cancel(l),
                    e(function() {
                        C.remove()
                    }, 300)
            }
            t || (t = {});
            var l, u = t.message || "", d = t.type || d !== n.TYPE_INFO, p = t.dismissOnTimeout || 1e4, f = t.hPos || n.POSITION_RIGHT, g = t.vPos || n.POSITION_TOP;
            d = d !== n.TYPE_SUCCESS && d !== n.TYPE_DANGER && d !== n.TYPE_WARNING ? n.TYPE_INFO : d,
                f = f !== n.POSITION_LEFT ? n.POSITION_RIGHT : f,
                g = g !== n.POSITION_BOTTOM ? n.POSITION_TOP : g;
            var m = !0
                , h = !1
                , v = '<div class="flex-display acorn-toast alert alert-' + d + '" tabindex="-1" role="alert">   <div class="flex-item toast-icon">       <span class="fa-stack" aria-hidden="true">           <i class="fa-bg fa ' + r().bg + ' fa-stack-1x"></i>           <i class="fg-icon fa ' + r().fg + ' fa-stack-1x"></i>       </span>   </div>   <div class="flex-item toast-body">' + u + '</div>   <div class="flex-item toast-exit">       <span aria-label="Dismiss this notification" tabindex="0">           <i class="fa fa-close fa-lg"></i>       </span>   </div></div>'
                , C = angular.element(v)
                , y = function() {
                return {
                    vPos: g,
                    hPos: f
                }
            };
            return {
                show: function(t) {
                    var n = C.find(".toast-exit span");
                    n.on("click", s),
                        n.on("keydown", s),
                        t.append(C),
                        C.show().addClass("toast-animate").focus(),
                        C.on("mouseover", a),
                        C.on("mouseleave", i),
                        l = e(function() {
                            h = !0,
                                o()
                        }, p)
                },
                getPositionRefs: y
            }
        };
        return {
            showToast: function(e) {
                var t = new a(e)
                    , n = t.getPositionRefs()
                    , i = r(n);
                t.show(i)
            }
        }
    }
    ]),
    angular.module("acornApp").service("DevConfig", ["$location", function(e) {
        function t() {
            return e.protocol() + "://" + e.host() + ":" + e.port() + "/"
        }
        function n(e, n, r) {
            return n || (n = t()),
            r || "undefined" != typeof testBaseUrl && (r = testBaseUrl),
                r ? "" : /welcome.do\?welcome.dispatch/.test(n) ? "" : e
        }
        this.translateURL = function(e, n, r) {
            r || "undefined" != typeof testBaseUrlForHttp && (r = testBaseUrlForHttp);
            var a = void 0 === r ? t() : r;
            "/" == e[0] && (a = a.replace(/\/$/, ""));
            var i = a + e;
            return 1 == n ? i : i += (i.match(/\?/) ? "&" : "?") + "t=" + (new Date).getTime()
        }
            ,
            this.translateSPAResourceUrl = function(e, t, r) {
                return n("/sws/", t, r) + e
            }
            ,
            this.translateSPAViewUrl = function(e, t, r) {
                var a = /^#/.test(e) ? e : "#" + e;
                return n("/sws/welcome.do?welcome.dispatch", t, r) + a
            }
            ,
            this.translateCalendarUrl = this.translateSPAResourceUrl,
            this.getNotificationsAndActivityUrl = function(e, t) {
                return this.translateSPAViewUrl("#/notifications_and_activity", e, t)
            }
            ,
            this.isDevelopmentMode = function() {
                return "undefined" != typeof testBaseUrl
            }
    }
    ]),
    angular.module("acornApp").factory("deviceZoomLock", function() {
        function e(e, t, n, r) {
            var a = r.find(e).filter(function(e, r) {
                var a = angular.element(r).attr(t);
                return a && n.test(a)
            });
            return a.length > 0 ? a : void 0
        }
        function t(t) {
            var n = angular.element("head")
                , r = e("meta", "content", /user-scalable[ ]*[=][ ]*['"]?no['"]?/, n);
            if (t) {
                if (!r) {
                    var a = angular.element('<meta name="viewport" content="width=device-width, user-scalable=no" />');
                    n.append(a)
                }
                var i = e("meta", "content", /user-scalable[ ]*[=][ ]*['"]?yes['"]?/, n);
                i && i.remove()
            } else
                r && r.remove()
        }
        return {
            setZoomLock: t
        }
    }),
    angular.module("acornApp").factory("forms", function() {
        function e(e) {
            return angular.isUndefined(e) || "" === e || null === e || e !== e
        }
        function t(t, n, r) {
            return 1 == n && e(r) ? void t.$setValidity("required", !1) : (t.$setValidity("required", !0),
                r)
        }
        return {
            validate: t
        }
    }),
    angular.module("acornApp").factory("Org", ["$resource", function(e) {
        return e("/sws/rest/orgs-and-offices/org/:path/:primaryOrgCode/:associatedOrgCode/:secondaryOrgCode/:adminOrgCode", {}, {
            findOrgsByPrimaryOrgCode: {
                method: "GET",
                params: {
                    path: "primary"
                },
                isArray: !0
            }
        })
    }
    ]).factory("Office", ["$resource", function(e) {
        return e("/sws/rest/orgs-and-offices/office/:name")
    }
    ]),
    angular.module("acornApp").factory("orgKeyDatesSvc", ["acornCoreProperties", function(e) {
        function t(t) {
            var n = null;
            if (t) {
                t.length > 0 && (n = {});
                for (var r = 0; r < t.length; r++) {
                    var a = t[r]
                        , i = a.getPrimaryOrgCode()
                        , o = a.getSecondaryOrgCode()
                        , s = e.getKeyDateForOrg(i, o);
                    n[s.ORGKEY] = s.KEYDATE
                }
            }
            return n
        }
        return {
            getKeyDateOrgs: t
        }
    }
    ]),
    angular.module("acornApp").service("peakLoadModeService", ["$q", "peakLoadServerResources", "utMoment", "utPeakLoadModeConstants", function(e, t, n, r) {
        function a() {
            var e = n(new Date).format(r.DATE_FORMAT);
            return !(i && !n(e).isAfter(i)) && (i = e,
                    !0)
        }
        var i, o, s;
        this.getPeakLoadMode = function() {
            return a() ? (s = e.defer(),
                t.getTodayStartDateForARTSC(null, function(e) {
                    o = e,
                        s.resolve(e)
                }, function(e) {
                    s.reject(e)
                })) : o && s.resolve(o),
                s.promise
        }
            ,
            this.setLastRetrievedDate = function(e) {
                i = e
            }
            ,
            this.setCachedData = function(e) {
                o = e
            }
            ,
            this.setDeferredObject = function() {
                s = e.defer()
            }
    }
    ]),
    angular.module("acornApp").factory("peakLoadServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
            getTodayStartDateForARTSC: {
                method: "GET",
                params: {
                    kind: "peak-load",
                    type: "is-today-peak-load"
                }
            }
        })
    }
    ]),
    angular.module("acornApp").factory("Promises", ["$log", "$timeout", "$q", function(e, t, n) {
        function r(e, n, r) {
            function a() {
                l = !0,
                    e.reject(o)
            }
            function i() {
                return !!l
            }
            var o = null
                , s = null
                , c = !1
                , l = !1;
            return function() {
                o = n,
                    s = r,
                    t(function() {
                        c || l || a()
                    }, s),
                    e.promise.then(function() {
                        c = !0
                    })
            }(),
            {
                isRejected: i,
                reject: a
            }
        }
        function a(t, a, i) {
            function o() {
                return f.isRejected()
            }
            function s(e) {
                return o() || d ? n.reject(d) : e
            }
            function c(t) {
                e.log("promise cancelled with value = " + t),
                    d = t,
                f.isRejected() || f.reject()
            }
            function l() {
                return null != d
            }
            function u(e, t) {
                return p.then(e, t)
            }
            var d = null
                , p = null
                , f = null;
            return function() {
                f = new r(t,a,i),
                    p = t.promise.then(s)
            }(),
            {
                cancelationHandler: s,
                cancel: c,
                isCancelled: l,
                isRejected: o,
                then: u
            }
        }
        function i(e, t, n) {
            return new a(e,t,n)
        }
        function o(e, t) {
            return i(e, t, 3e4)
        }
        return {
            createCancellableAndTimeoutablePromise: i,
            createDefaultCancellableAndTimeoutablePromise: o
        }
    }
    ]),
    angular.module("acornApp").factory("realtimeElementBind", ["$compile", function(e) {
        function t(e) {
            return e ? e.constructor !== Array && (e = [e]) : e = [],
                e
        }
        return {
            unbind: function(n, r, a, i) {
                var o = r.clone();
                a = t(a),
                    i = t(i);
                for (var s = 0; s < o.length; s++) {
                    for (var c = angular.element(r[s]), l = angular.element(o[s]), u = 0; u < a.length; u++)
                        l.removeAttr(a[u]);
                    for (var d = 0; d < i.length; d++)
                        l.removeClass(i[d]);
                    var p = l.find("[data-ng-transclude], [ng-transclude]");
                    if (p.length > 0) {
                        var f = angular.element(p[0]).children();
                        l.empty(),
                            l.append(f)
                    }
                    var g = c.parent();
                    c.remove(),
                        e(l)(n),
                        g.append(l)
                }
            },
            bind: function(n, r, a, i) {
                var o = r.clone();
                a = t(a),
                    i = t(i);
                for (var s = 0; s < o.length; s++) {
                    for (var c = angular.element(r[s]), l = angular.element(o[s]), u = 0; u < a.length; u++)
                        l.attr(a[u].name, a[u].value);
                    for (var d = 0; d < i.length; d++)
                        l.addClass(i[d]);
                    var p = c.parent();
                    c.remove(),
                        e(l)(n),
                        p.append(l)
                }
            },
            DirectiveAttribute: function(e, t) {
                this.name = e,
                    this.value = t ? t : ""
            }
        }
    }
    ]),
    angular.module("acornApp").factory("rounding", function() {
        function e(e, n) {
            var r = Math.pow(10, n)
                , a = t(e);
            return Math.round(r * a) / r
        }
        var t = function(e) {
            return e && "number" != typeof e && (e = parseFloat(e)),
                e
        };
        return {
            round: e
        }
    }),
    angular.module("acornApp").provider("screenSizeQuery", ["screenSizeConstants", function(e) {
        function t(e) {
            return window.matchMedia("screen and (max-width: " + e + "px)").matches
        }
        function n() {
            return t(e.LARGE)
        }
        function r() {
            return t(e.MEDIUM)
        }
        function a() {
            return t(e.SMALL)
        }
        function i() {
            return t(e.EXTRA_SMALL)
        }
        function o() {
            return t(e.EXTRA_SMALL) ? e.EXTRA_SMALL : t(e.SMALL) ? e.SMALL : t(e.MEDIUM) ? e.MEDIUM : t(e.LARGE) ? e.LARGE : e.EXTRA_LARGE
        }
        var s = o();
        this.$get = ["$rootScope", "$window", "eventConstants", function(t, c, l) {
            function u() {
                var n = o();
                s !== n && (t.$broadcast(l.RESPONSIVE_RESIZE_EVENT, {
                    isResponsiveMode: n === e.SMALL || n === e.EXTRA_SMALL,
                    screenSize: n,
                    viewTypeChange: !((s !== e.EXTRA_LARGE && s !== e.LARGE && s !== e.MEDIUM || n !== e.SMALL && n !== e.EXTRA_SMALL) && (s !== e.SMALL && s !== e.EXTRA_SMALL || n !== e.EXTRA_LARGE && n !== e.LARGE && n !== e.MEDIUM))
                }),
                    s = n)
            }
            return function() {
                u(),
                    angular.element(c).on("resize.screenSizeQuery", u)
            }(),
            {
                getCurrentScreenSize: o,
                isLarge: n,
                isMedium: r,
                isSmall: a,
                isExtraSmall: i
            }
        }
        ]
    }
    ]),
    angular.module("acornApp").service("studentBasicInfoSvc", ["$q", "$log", "userService", function(e, t, n) {
        var r, a, i, o = null;
        this.getStudentBasicInfo = function() {
            var r = {}
                , a = e.defer();
            return n.getStudentBasicInfo(function(e) {
                r.firstName = e.firstName,
                    r.lastName = e.lastName,
                    a.resolve(r)
            }, function(e) {
                t.error("*** Could not retrieve studentBasicInfo. Error: " + e),
                    r.firstName = "N/A",
                    r.lastName = "N/A",
                    a.resolve(r)
            }),
                a.promise
        }
            ,
            this.isDomesticStudent = function() {
                var a = e.defer();
                return null != o ? e.when(o.value) : null != r ? r : (r = a.promise,
                    n.isDomesticStudent(function(e) {
                        o = e,
                            a.resolve(e.value)
                    }, function(e) {
                        t.error("*** Could not retrieve student status (domestic or international). Error: " + e),
                            o = null,
                            a.reject(e)
                    }),
                    r)
            }
            ,
            this.getStudentEmailAddress = function() {
                return a ? e.when(a) : i ? i.promise : (i = e.defer(),
                    n.getEmailAddress(function(e) {
                        a = e,
                            i.resolve(e)
                    }),
                    i.promise)
            }
    }
    ]),
    angular.module("acornApp").factory("userService", ["$q", "$resource", function(e, t) {
        return t(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:service/:type", {}, {
            getMailingAddress: {
                method: "GET",
                params: {
                    service: "tc",
                    type: "mailingAddress"
                }
            },
            getStudentBasicInfo: {
                method: "GET",
                params: {
                    service: "profile",
                    type: "studentBasicInfo"
                }
            },
            getEmailAddress: {
                method: "GET",
                params: {
                    service: "profile",
                    type: "email"
                }
            },
            isDomesticStudent: {
                method: "GET",
                params: {
                    service: "profile",
                    type: "domesticStudent"
                }
            }
        })
    }
    ]),
    angular.module("acornApp").factory("utActionInProgressModal", ["$uibModal", function(e) {
        var t = null;
        return {
            show: function() {
                t = e.open({
                    animation: !0,
                    templateUrl: "partials/core/actionInProgress.html",
                    backdrop: "static",
                    windowClass: "modal-lg-acorn"
                })
            },
            hide: function() {
                t && (t.dismiss("Closing in progress modal"),
                    t = null)
            }
        }
    }
    ]),
    angular.module("acornApp").factory("utConfirmation", ["$q", "$uibModal", "$uibModalStack", "utConfirmationConstants", function(e, t, n, r) {
        function a() {
            var n = {
                actionDeferred: null
            }
                , r = t.open({
                animation: !0,
                templateUrl: "partials/core/bootstrapConfirmation.html",
                controller: ["$scope", function(t) {
                    function r() {
                        t.actionInProgress = !1
                    }
                    function a() {
                        t.actionInProgress === !1 && (i.cancelIconFunction ? i.cancelIconFunction() : o.dismiss())
                    }
                    t.actionInProgress = !1,
                        t.UTConfirmation = i,
                        t.handleCancelAction = function(e, n) {
                            0 == t.actionInProgress && (e && angular.isFunction(e) ? e(n) : a())
                        }
                        ,
                        t.handleAction = function(a, i) {
                            if (0 == t.actionInProgress) {
                                t.actionInProgress = !0;
                                var o = e.defer();
                                n.actionDeferred = o,
                                    a(o, i),
                                    o.promise.then(r, r)
                            }
                        }
                }
                ],
                windowClass: "modal-lg-acorn"
            });
            return angular.extend(r, n)
        }
        var i = null
            , o = null;
        return {
            init: function(e) {
                i = e,
                    i.constants = r,
                    i.classes = e.classes || "",
                    i.classes = angular.isArray(e.classes) ? e.classes.join(" ") : e.classes,
                    o = a(),
                    o.result.then(function() {
                        o.actionDeferred && o.actionDeferred.resolve("utConfirmation modal closed")
                    }, function() {
                        o && o.actionDeferred && o.actionDeferred.reject("utConfirmation modal dismissed"),
                            o = null,
                        i.cancelIconFunction && i.cancelIconFunction()
                    }),
                    i.tooltip && i.tooltip.messages ? i.tooltip.messages.constructor === String && (i.tooltip.messages = [i.tooltip.messages]) : i.tooltip = {
                        messages: []
                    }
            },
            dismiss: function() {
                null != o && o.dismiss()
            },
            dismissAll: function() {
                n.dismissAll()
            },
            close: function() {
                null != o && o.close()
            }
        }
    }
    ]),
    angular.module("acornApp").provider("utMoment", function() {
        this.$get = ["$window", function(e) {
            return e.moment
        }
        ]
    }),
    angular.module("acornApp").factory("utToast", ["acornToast", "acornToastConstants", function(e, t) {
        function n(n) {
            var r = t.TYPE_INFO;
            n.successState ? r = t.TYPE_SUCCESS : n.errorState ? r = t.TYPE_DANGER : n.warningState && (r = t.TYPE_WARNING),
                e.showToast({
                    message: n.text,
                    type: r
                })
        }
        return {
            show: n
        }
    }
    ]),
    angular.module("acornApp").factory("utTooltipBinding", ["realtimeElementBind", "screenSizeQuery", "tooltipDomConstants", function(e, t, n) {
        return {
            unbindTooltips: function(t, r) {
                e.unbind(t, r, [n.UT_TOOLTIP_DIRECTIVE, n.UT_TOOLTIP_TAB_DIRECTIVE], n.UT_TOOLTIP_CSS_CLASS)
            },
            bindTooltips: function(t, r, a) {
                e.bind(t, r, [new e.DirectiveAttribute(n.UT_TOOLTIP_DIRECTIVE,a), new e.DirectiveAttribute(n.UT_TOOLTIP_TAB_DIRECTIVE,"")], n.UT_TOOLTIP_CSS_CLASS)
            },
            handleRspScreenResize: function(e, r, a) {
                r.hasClass(n.UT_TOOLTIP_CSS_CLASS) && t.isSmall() ? this.unbindTooltips(e, r) : r.hasClass(n.UT_TOOLTIP_CSS_CLASS) || t.isSmall() || this.bindTooltips(e, r, a)
            }
        }
    }
    ]),
    angular.module("acornApp").factory("utTypeaheadState", function() {
        var e;
        return {
            getState: function() {
                return e
            },
            setState: function(t) {
                e = t
            }
        }
    }),
    angular.module("acornApp").factory("viewport", ["$log", "viewportConstants", function(e, t) {
        function n(e, n) {
            var r = e[0]
                , a = r.getBoundingClientRect()
                , i = a.top
                , o = i + a.height
                , s = n.getBoundingClientRect()
                , c = s.top
                , l = c + s.height;
            return l <= o && c >= i ? t.VISIBLE : l <= o && l > i ? t.PARTIALLY_VISIBLE : c >= i && c < o ? t.PARTIALLY_VISIBLE : t.INVISIBLE
        }
        return {
            isElementVisible: n
        }
    }
    ]),
    function() {
        "use strict";
        angular.module("acornApp").controller("DashboardCtrl", ["$rootScope", "$scope", "$q", "$timeout", "$location", "$log", "dashboardServerResources", "acornCoreProperties", "acornCoreLib", "dashboardAppConstants", "eligibleRegistrationManager", "accountBalanceManager", "dashboardManager", "utConfirmation", "utToast", "acornSettings", "Notifications", "$window", "screenSizeQuery", "eventConstants", "utTooltipBinding", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f, g, m, h, v, C, y, A) {
            function E(e) {
                var t = n.defer();
                return o.cancelPostWithInviteStatus(e, function(e) {
                    t.resolve(e)
                }, function(e) {
                    t.reject(e)
                }),
                    t.promise
            }
            function T(e) {
                var t = "You have declined the invitation for " + e;
                g.show({
                    text: t,
                    infoState: !0
                })
            }
            function S(e, t) {
                var n = "";
                e.data && (n = "<br>" + e.data);
                var r = "Your attempt to decline the invitation for " + t + " failed." + n;
                g.show({
                    text: r,
                    errorState: !0
                })
            }
            function w() {
                function e() {
                    var e = n.defer();
                    return o.getStudentEnrolledCourses(null, function(t) {
                        d = t,
                            p.setWidgetToLoaded(I.ENROL_AND_MANAGE),
                            e.resolve(t)
                    }, function() {
                        d = !1,
                            p.setWidgetToLoaded(I.ENROL_AND_MANAGE),
                            e.reject(!1)
                    }),
                        e.promise
                }
                function r() {
                    return null === d && (d = e()),
                        d
                }
                function a() {
                    return angular.isObject(d) && angular.isArray(d.enrolledCourses) && d.enrolledCourses.length > 0
                }
                function i() {
                    return angular.isObject(d) && angular.isArray(d.enrolledCourses) && d.enrolledCourses.length > 1
                }
                function s() {
                    var e = "";
                    return angular.isObject(d) && d.sessionDescription && (e = d.sessionDescription),
                        e
                }
                function c() {
                    return i() ? "Courses" : "Course"
                }
                function l() {
                    return t.allRegistrations.length > 1 ? "Statuses" : "Status"
                }
                function u() {
                    var e = null
                        , t = D.messages.widgets.ENROL_MANAGE.NO_CONTENT;
                    return null !== N && (e = t[N],
                    angular.isDefined(e) || (e = t.DEFAULT)),
                        e
                }
                var d = null;
                return this.getEnrolledCourses = r,
                    this.hasEnrolledCourses = a,
                    this.hasMultipleCourses = i,
                    this.currentSessionDescription = s,
                    this.courseInflection = c,
                    this.registrationStatusInflection = l,
                    this.getNoContentMessaging = u,
                    this
            }
            function b() {
                function e() {
                    var e = new Date
                        , t = e.getMonth() + 1
                        , n = e.getFullYear()
                        , r = e.getDate();
                    t < 10 && (t = "0" + t),
                    r < 10 && (r = "0" + r);
                    var a = n + "-" + t + "-" + r;
                    return "https://www.events.utoronto.ca/index.php?action=calendarEvent&gDate=" + encodeURIComponent(e.toString().split(" ").splice(0, 4).join(" ") + " ") + "&fDate=" + a
                }
                function t() {
                    var e = n.defer();
                    return o.getStartTimes(null, function(t) {
                        h = t,
                            e.resolve(t)
                    }, function() {
                        h = !1,
                            e.reject(null)
                    }),
                        e.promise
                }
                function r() {
                    return null === h && (h = t()),
                        h
                }
                function a() {
                    var e = n.defer();
                    return o.getTodaysEvents(null, function(t) {
                        function n(e) {
                            var t = e.match(/(\d+):(\d+)([ap]m)/i);
                            if (4 !== t.length)
                                return e;
                            var n = parseInt(t[1], 10)
                                , r = t[2];
                            return n + ("pm" === t[3].toLowerCase() ? 12 : 0) + ":" + r
                        }
                        g = t;
                        var r = g.dashboardEventList;
                        if (void 0 !== r && angular.isArray(r))
                            for (var a = 0; a < r.length; a++) {
                                var i = r[a];
                                void 0 !== i.startTime && (i.startTime = n(i.startTime)),
                                void 0 !== i.endTime && (i.endTime = n(i.endTime))
                            }
                        p.setWidgetToLoaded(I.CALENDAR_TODAY),
                            e.resolve(t)
                    }, function() {
                        g = !1,
                            p.setWidgetToLoaded(I.CALENDAR_TODAY),
                            e.reject(null)
                    }),
                        e.promise
                }
                function i() {
                    return null === g && (g = a()),
                        g
                }
                function c() {
                    var e = n.defer();
                    return o.getUpcomingEvents(null, function(t) {
                        m = t,
                            p.setWidgetToLoaded(I.CALENDAR_UPCOMING),
                            e.resolve(t)
                    }, function() {
                        m = !1,
                            p.setWidgetToLoaded(I.CALENDAR_UPCOMING),
                            e.reject(!1)
                    }),
                        e.promise
                }
                function l() {
                    return null === m && (m = c()),
                        m
                }
                function u() {
                    return angular.isObject(g) && angular.isArray(g.dashboardEventList) && g.dashboardEventList.length > 0
                }
                function d() {
                    var e = l();
                    return angular.isArray(e) && e.length > 0
                }
                function f(e, t, n) {
                    return s.getSessionalDate(e, t, n)
                }
                var g = null
                    , m = null
                    , h = null;
                return this.getTodaysEvents = i,
                    this.hasTodayEvents = u,
                    this.todaysEventsUrl = e,
                    this.getUpcomingEvents = l,
                    this.hasUpcomingEvents = d,
                    this.getSessionalDateFor = f,
                    this.getStartTimes = r,
                    this
            }
            function _() {
                var e = n.defer();
                return o.getOptOutSessionCode(function(t) {
                    e.resolve(t)
                }, function(t) {
                    e.reject(t)
                }),
                    e.promise
            }
            var D = s.getDashboardProperties()
                , I = l.WIDGETS.IDS
                , N = null;
            t.acornCoreProperties = s,
                t.allRegistrations = [],
                t.model = {},
                t.cancelDegreePostConfirm = function(e) {
                    var n = function() {
                        f.close();
                        var n = {
                            postCode: e.getDegreeCode(),
                            sessionCode: e.getSessionCode(),
                            secondarySessionCode: e.getSecondarySessionCode()
                        }
                            , r = E(n)
                            , a = e.getDegreeCode() + " " + e.getSessionDescription();
                        r.then(function() {
                            T(a),
                                e.setRegistrationStatus("FINCA"),
                                u.initAllRegistrations(function(e, n) {
                                    t.hasInvitRegistration = n,
                                        t.allRegistrations = e
                                })
                        }, function(e) {
                            S(e, a)
                        })
                    }
                        , r = e.getDegreeCode() + " " + e.getSessionDescription()
                        , a = e.getDegreeName() + " " + e.getSessionDescription()
                        , i = "If you decline this invitation to register, you will no longer be eligible to enrol in courses for this program of study in the specified academic session. Are you sure you want to decline the invitation for " + r + "?";
                    f.init({
                        title: "Decline Invitation for " + a,
                        tooltip: t.declineRegistrationTooltip,
                        message: i,
                        actions: {
                            main: {
                                title: "Decline",
                                action: n
                            },
                            textControl: [{
                                title: "Cancel",
                                action: function() {
                                    f.dismiss()
                                }
                            }]
                        }
                    })
                }
                ,
                t.getSessionDescription = function(e) {
                    return p.getSessionDescription(e)
                }
            ;
            var O = null;
            !function() {
                t.optOutFlag = !1,
                O || (O = _()),
                    O.then(function(e) {
                        var n = e.value;
                        n ? (t.optOutFlag = !0,
                            t.optOutSessionDescr = p.getSessionDescription(n)) : t.optOutFlag = !1
                    }, function(e) {
                        i.error("*** errorData: " + e),
                            t.optOutFlag = !1
                    })
            }(),
                function() {
                    function n() {
                        if (5 == ++r)
                            return !0
                    }
                    switch (a.path().toLowerCase()) {
                        default:
                            t.eventManager = new b,
                                t.enrolledCoursesManager = new w
                    }
                    t.declineRegistrationTooltip = {
                        messages: "<p>Multiple Registrations with Invited Status.</p><p>You have an <i>invited</i> status in more than one program of study.</p><p>If you do not intend to register in all programs you are invited to, you can decline the invitation for the unwanted program.</p>"
                    },
                        t.isCalendarDashboardLoaded = function() {
                            return t.isCalendarTodayDashboardLoaded()
                        }
                        ,
                        t.isCalendarTodayDashboardLoaded = function() {
                            return p.isWidgetLoaded(p.getWidgetIDConstants().CALENDAR_TODAY)
                        }
                        ,
                        t.isEnrolAndManageDashboardLoaded = function() {
                            return p.isWidgetLoaded(p.getWidgetIDConstants().ENROL_AND_MANAGE)
                        }
                        ,
                        t.isPlanAndExploreDashboardLoaded = function() {
                            return p.isWidgetLoaded(p.getWidgetIDConstants().PLAN_AND_EXPLORE)
                        }
                        ,
                        t.isFinanceDashboardLoaded = function() {
                            return p.isWidgetLoaded(p.getWidgetIDConstants().FINANCE)
                        }
                        ,
                        u.initManager(function(e) {
                            t.eligibleRegistrations = e;
                            var n = u.getPredominantUserCampus();
                            m.saveSetting("campus", n),
                                m.saveSetting("multiCampusRegistration", u.isMultiCampusRegistration()),
                                t.hasFutureExams = p.hasFutureExams
                        }),
                        u.initAllRegistrations(function(e, n) {
                            t.hasInvitRegistration = n,
                                t.allRegistrations = e
                        }),
                        e.$watch(function() {
                            return h.getNotifications()
                        }, function(e) {
                            t.notifications = e
                        }),
                        t.configureAccountBalanceTooltip = d.configureBasicAccountBalanceTooltip,
                        d.initManager().then(function(e) {
                            if (angular.isObject(e) && (t.model.studentInfo = e,
                                    t.model.accountBalance = d.getBasicAccountBalance(),
                                    angular.isArray(e.registrationStatusList))) {
                                for (var n = null, r = e.registrationStatusList.length, a = {}, i = 0; i < r; i++) {
                                    var o = e.registrationStatusList[i].primaryOrgCode.toUpperCase()
                                        , s = null;
                                    switch (o) {
                                        case "ERIN":
                                        case "SCAR":
                                            s = o;
                                            break;
                                        default:
                                            s = "STG"
                                    }
                                    null !== s && (t.orgOrigin = s,
                                    angular.isDefined(a[s]) || (a[s] = 0),
                                        a[s]++)
                                }
                                var c = 0;
                                for (var l in a)
                                    c < a[l] && (n = l,
                                        c = a[l]);
                                N = n
                            }
                        }, function() {
                            t.model.studentInfo = !1
                        }),
                        document.title = "ACORN";
                    var r = 0;
                    1 == angular.element("#maincontent").length && function() {
                        var e = setInterval(function() {
                            t.$apply(),
                            1 == n() && clearInterval(e)
                        }, 500)
                    }();
                    var i = function() {
                        A.handleRspScreenResize(t, angular.element(".declineBtn"), "declineRegistrationTooltip")
                    };
                    angular.element(v).on("resize.dashboard", i);
                    var o = t.$on(y.TOOLTIP_INIT, function(e, n) {
                        n.hasClass("declineBtn") && C.isSmall() && A.unbindTooltips(t, n)
                    });
                    t.$on("$destroy", function() {
                        angular.element(v).off("resize.dashboard", i),
                            o()
                    })
                }()
        }
        ])
    }(),
    angular.module("acornApp").controller("enrolAndManageLandingCtrl", ["$scope", "$q", "eligibleRegistrationManager", "acornCoreProperties", "courseTabService", "dashboardServerResources", function(e, t, n, r, a, i) {
        function o() {
            var e = t.defer();
            return i.getStartTimes(null, function(t) {
                c = t,
                    e.resolve(t)
            }, function() {
                c = !1,
                    e.reject(null)
            }),
                e.promise
        }
        function s() {
            return null === c && (c = o()),
                c
        }
        var c = null;
        n.initManager(function(t) {
            if (e.eligibleRegistrations = t,
                e.eligibleRegistrations && e.eligibleRegistrations.length > 1) {
                var n = a.getCurrentTabIndex();
                if (null !== n && 0 !== n && e.eligibleRegistrations[n])
                    e.eligibleRegistrations[n].active = !0;
                else
                    for (var r = 0; r < e.eligibleRegistrations.length; r++)
                        if (e.eligibleRegistrations[r].isCurrentRegistration()) {
                            e.eligibleRegistrations[r].active = !0;
                            break
                        }
            }
        }),
            e.getCampusSpecificSupportContent = function(e) {
                return "partials/dashboard/support/academic-support-resources-" + ("ERIN" === e || "SCAR" === e || "SGS" === e ? e : "STG") + ".html"
            }
            ,
            e.getStgSpecificRegistrarLink = function(e) {
                var t = r.getOrgInfoByOrgCode(e);
                return t && t.getURIForType("registrarSupport") ? t.getURIForType("registrarSupport") : "http://www.future.utoronto.ca/current-students/registrars//"
            }
            ,
            e.getStartTimes = s,
            e.selectTab = function(e) {
                a.setCurrentTabIndex(e)
            }
            ,
            e.getSelectedTabIndex = function() {
                return a.getCurrentTabIndex()
            }
    }
    ]),
    angular.module("acornApp").controller("FinancialAccountLandingCtrl", ["$scope", "accountBalanceManager", function(e, t) {
        !function() {
            e.model = {},
                e.isDataLoaded = function() {
                    return void 0 !== e.model.studentInfo
                }
                ,
                e.configureAccountBalanceTooltip = t.configureDetailedAccountBalanceTooltip,
                t.initManager().then(function(n) {
                    e.model.studentInfo = n,
                        t.getDetailedAccountBalancePromise().then(function() {
                            var n = t.getDetailedAccountBalance();
                            e.model.accountBalance = n
                        })
                })
        }()
    }
    ]),
    function() {
        "use strict";
        angular.module("acornApp").controller("LifeContentCtrl", ["$scope", "campusService", function(e, t) {
            e.getCampusSpecificLifeContent = function(e) {
                return "partials/dashboard/" + e + "_" + t.getCampus() + ".html"
            }
        }
        ])
    }(),
    angular.module("acornApp").controller("NotificationsAndActivityCtrl", ["$scope", "$rootScope", "$log", "$http", "DateUtil", function(e, t, n, r, a) {
        e.categories = ["Academics", "Finances", "Personal"],
            e.activityCategories = ["Academics", "Finances", "Personal", "System"],
            e.currentPage = 1,
            e.currentActivityPage = 1,
            e.maxSize = 5,
            e.loadingNotifications = !1,
            e.loadingActivities = !1;
        var i = "undefined" == typeof testBaseUrlForHttp ? location.protocol + "//" + window.location.host + "/" : testBaseUrlForHttp
            , o = "undefined" == typeof testBaseUrlForHttp ? "/sws" : "";
        e.logs = [{
            id: "notification-tab",
            title: "Notifications",
            categories: [{
                name: "Academics",
                selected: !0
            }, {
                name: "Finances",
                selected: !0
            }, {
                name: "Personal",
                selected: !0
            }],
            view: o + "/partials/dashboard/notificationView.html"
        }, {
            id: "activity-tab",
            title: "Activity",
            categories: [{
                name: "Academics",
                selected: !0
            }, {
                name: "Finances",
                selected: !0
            }, {
                name: "Personal",
                selected: !0
            }, {
                name: "System",
                selected: !0
            }],
            view: o + "/partials/dashboard/activityView.html"
        }],
            e.retrieveNotifications = function(t, a) {
                e.loadingNotifications = !0;
                var o = "";
                if (void 0 !== t && t.length > 0)
                    for (var s = t.length, c = 0; c < s; c++)
                        switch (t[c]) {
                            case e.logs[0].categories[0].name:
                                o += "&category=EXAM&category=COURSE_ENROLMENT&category=PROGRAM_ENROLMENT";
                                break;
                            case e.logs[0].categories[1].name:
                                o += "&category=FINANCIAL_ACTION";
                                break;
                            case e.logs[0].categories[2].name:
                                o += "&category=UPCOMING_KEY_DATE"
                        }
                void 0 === a && (a = 1),
                    r({
                        url: i + "sws/rest/notification/all?page=" + a + o,
                        method: "GET"
                    }).then(function(t) {
                        var n = t.data;
                        e.notifications = n.notifications,
                            e.totalItems = n.numResults,
                            e.currentPage = a,
                            e.itemsPerPage = n.itemsPerPage,
                            e.loadingNotifications = !1,
                            e.numNotificationPages = n.numPages
                    }, function(t) {
                        n.error("GET request failed: ", t.statusText),
                            e.loadingNotifications = !1
                    })
            }
            ,
            e.retrieveActivities = function(t, a) {
                e.loadingActivities = !0;
                var o = "";
                if (void 0 !== t && t.length > 0)
                    for (var s = t.length, c = 0; c < s; c++)
                        o = o + "&category=" + t[c];
                void 0 === a && (a = 1),
                    r({
                        url: i + "sws/rest/webactivity?page=" + a + o,
                        method: "GET"
                    }).then(function(t) {
                        var n = t.data;
                        e.activities = n.webActivity,
                            e.totalActivityItems = n.total,
                            e.currentActivityPage = a,
                            e.itemsPerPage = n.resultsPerPage,
                            e.loadingActivities = !1,
                            e.numActivityPages = n.numPages
                    }, function(t) {
                        n.error("GET request failed: ", t.statusText),
                            e.loadingActivities = !1
                    })
            }
            ,
            e.filterByCategory = function(t, n) {
                void 0 !== n && (n === e.logs[0].title ? e.filterByNotificationCategory(t) : n === e.logs[1].title && e.filterByActivityCategory(t))
            }
            ,
            e.filterByNotificationCategory = function(t) {
                if (t.selected)
                    e.categories.push(t.name);
                else {
                    var n = e.categories.indexOf(t.name);
                    n > -1 && e.categories.splice(n, 1)
                }
                e.retrieveNotifications(e.categories)
            }
            ,
            e.filterByActivityCategory = function(t) {
                if (t.selected)
                    e.activityCategories.push(t.name);
                else {
                    var n = e.activityCategories.indexOf(t.name);
                    n > -1 && e.activityCategories.splice(n, 1)
                }
                e.retrieveActivities(e.activityCategories)
            }
            ,
            e.isLessThanDayOld = a.isLessThanDayOld,
            e.pageChanged = function(t) {
                e.retrieveNotifications(e.categories, t)
            }
            ,
            e.activityPageChanged = function(t) {
                e.retrieveActivities(e.activityCategories, t)
            }
            ,
            e.getActivityCategory = function(e) {
                return e ? e.webActivityCode.category : "Unknown"
            }
            ,
            e.retrieveNotifications(),
            e.retrieveActivities()
    }
    ]),
    angular.module("acornApp").controller("UTPaginationController", ["$scope", "$attrs", "$parse", "$interpolate", function(e, t, n, r) {
        var a = this
            , i = t.numPages ? n(t.numPages).assign : angular.noop;
        this.init = function(r) {
            t.itemsPerPage ? e.$parent.$watch(n(t.itemsPerPage), function(t) {
                a.itemsPerPage = parseInt(t, 10),
                    e.totalPages = a.calculateTotalPages()
            }) : this.itemsPerPage = r
        }
            ,
            this.noPrevious = function() {
                return 1 === this.page
            }
            ,
            this.noNext = function() {
                return this.page === e.totalPages
            }
            ,
            this.isActive = function(e) {
                return this.page === e
            }
            ,
            this.calculateTotalPages = function() {
                var t = this.itemsPerPage < 1 ? 1 : Math.ceil(e.totalItems / this.itemsPerPage);
                return Math.max(t || 0, 1)
            }
            ,
            this.getAttributeValue = function(t, n, a) {
                return angular.isDefined(t) ? a ? r(t)(e.$parent) : e.$parent.$eval(t) : n
            }
            ,
            this.render = function() {
                this.page = parseInt(e.page, 10) || 1,
                this.page > 0 && this.page <= e.totalPages && (e.pages = this.getPages(this.page, e.totalPages))
            }
            ,
            e.selectPage = function(t) {
                !a.isActive(t) && t > 0 && t <= e.totalPages && (e.page = t,
                    e.onSelectPage({
                        page: t
                    }))
            }
            ,
            e.$watch("page", function() {
                a.render()
            }),
            e.$watch("totalItems", function() {
                e.totalPages = a.calculateTotalPages()
            }),
            e.$watch("totalPages", function(t) {
                i(e.$parent, t),
                    a.page > t ? e.selectPage(t) : a.render()
            })
    }
    ]),
    angular.module("acornApp").directive("equalHeight", function() {
        return {
            restrict: "A",
            link: function(e, t) {
                function n() {
                    r[0].style.height = "auto",
                        a[0].style.height = "auto"
                }
                var r = t.find(".contentLeft")
                    , a = t.find(".contentRight");
                r.length && a.length && e.$watch(function() {
                    return {
                        height: r.height() - a.height()
                    }
                }, function(e, t) {
                    e.height != t.height && n(),
                        r[0].offsetHeight > a[0].offsetHeight ? a[0].style.height = r[0].offsetHeight + "px" : r[0].style.height = a[0].offsetHeight + "px"
                }, !0)
            }
        }
    }),
    angular.module("acornApp").directive("keyDates", ["orgKeyDatesSvc", function(e) {
        return {
            restrict: "A",
            replace: !0,
            scope: {
                registrations: "="
            },
            template: '<div><div data-ng-show="keyDateOrgs"><p>View the sessional dates for your division:</p><ul class="key-dates">   <li data-ng-repeat="(key, keyDateOrg) in keyDateOrgs">       <a href="{{keyDateOrg.url}}" target="_blank">{{keyDateOrg.name}}<data-icon-ext-link></data-icon-ext-link></a>   </li></ul></div><p data-ng-hide="keyDateOrgs">There are no relevant sessional dates to be displayed.</p></div>',
            controller: ["$scope", function(t) {
                t.$watch("registrations", function(n) {
                    var r = e.getKeyDateOrgs(n);
                    t.keyDateOrgs = r
                })
            }
            ]
        }
    }
    ]),
    angular.module("acornApp").directive("nonSwsPost", function() {
        return {
            restrict: "A",
            replace: !0,
            scope: {
                registrations: "="
            },
            link: function() {},
            template: '<div class="non-sws-post"><p data-ng-repeat="reg in registrations | filter: { useSws: \'N\'}"><strong>Note: </strong><span data-ng-bind-html="reg.getPostInfo()"></span> <span data-ng-bind-html="reg.getSessionDescription()"></span> is not eligible for course enrolment in ACORN. Please see your registrar for further information.</p></div>'
        }
    }),
    angular.module("acornApp").directive("notificationDirective", ["$rootScope", "$timeout", "NotificationViewConstants", "DateUtil", function(e, t, n, r) {
        return {
            restrict: "A",
            scope: {
                notification: "=notificationDirective"
            },
            require: "^notificationViewDirective",
            link: function(a, i, o, s) {
                var c = a.notification
                    , l = i.find(".notification-body")
                    , u = c.read;
                i.attr("id", "ps_notification_" + c.id),
                    i.click(function(e) {
                        e.stopPropagation()
                    }),
                    s.addPanelNotification(i, c),
                    e.$on(n.NOTIFICATION_VIEW_READ_STATUS_WILL_UPDATE_EVENT, function(e, n) {
                        if (null !== n && !u)
                            for (var r in n) {
                                var a = n[r];
                                a.id === c.id && (u = !0,
                                    l.animate({
                                        backgroundColor: "#d9e5ef"
                                    }, 1e3, function() {
                                        l.animate({
                                            backgroundColor: "#FFFFFF"
                                        }, 1e3, function() {
                                            t(function() {
                                                c.read = !0
                                            }, 0)
                                        })
                                    }))
                            }
                    }),
                    a.isLessThanDayOld = r.isLessThanDayOld
            }
        }
    }
    ]),
    angular.module("acornApp").directive("notificationViewDirective", ["$rootScope", "$timeout", "$log", "dashboardServerResources", "NotificationViewConstants", function(e, t, n, r, a) {
        return {
            restrict: "A",
            scope: !0,
            controller: ["$scope", function(i) {
                function o(t, i) {
                    r.batchMarkNotificationsAsRead({
                        ids: i
                    }, function() {
                        e.$broadcast(a.NOTIFICATION_VIEW_READ_STATUS_WILL_UPDATE_EVENT, t),
                            e.$broadcast(a.NOTIFICATION_VIEW_READ_STATUS_UPDATED_EVENT, c.length - d)
                    }, function() {
                        n.warn("Notifications could not be set to read :", t)
                    })
                }
                function s() {
                    if (null !== u && 0 !== c.length) {
                        l = parseFloat(u.height());
                        var e = null
                            , t = u.scrollTop()
                            , n = c.length
                            , r = Math.ceil(t + l);
                        if (!(r <= p)) {
                            p = r;
                            for (var a = [], i = 0; i < n; i++) {
                                var s = c[i]
                                    , f = Math.floor(parseFloat(s.notificationEl.offset().top))
                                    , g = s.notificationData;
                                1 != g.read && (t <= f && (null === e && (e = {}),
                                    e[g.id] = g,
                                    a.push(g.id),
                                    d++))
                            }
                            null !== e && o(e, a)
                        }
                    }
                }
                var c = []
                    , l = 0
                    , u = null
                    , d = 0
                    , p = 0
                    , f = null;
                return this.addPanelNotification = function(e, n) {
                    c.push({
                        notificationEl: e,
                        notificationData: n
                    }),
                    n.read && d++,
                    null !== f && t.cancel(f),
                        f = t(function() {
                            s()
                        }, 1e3)
                }
                    ,
                    i._initPageSlidePanel = function(e) {
                        null === u && (u = e)
                    }
                    ,
                    i._scanForUnreadNotifications = s,
                    i.getNotificationCategory = function(e) {
                        return e ? "COURSE_ENROLMENT" == e.category || "EXAM" == e.category || "PROGRAM_ENROLMENT" == e.category ? "Academics" : "FINANCIAL_ACTION" == e.category ? "Finances" : "UPCOMING_KEY_DATE" == e.category || "PROFILE" == e.category ? "Personal" : void 0 : "Unknown"
                    }
                    ,
                    this
            }
            ],
            link: function(e, t) {
                !function() {
                    e._initPageSlidePanel(t),
                        $(document).scroll(function() {
                            e._scanForUnreadNotifications()
                        })
                }()
            }
        }
    }
    ]),
angular.module("acornApp").directive("pageTitle", function() {
    return {
        restrict: "C",
        link: function(e, t) {
            document.title = t.text()
        }
    }
}),
angular.module("acornApp").directive("regStatus", function() {
    function e(e) {
        switch (e) {
            case "INVIT":
                return {
                    cssClass: "invited",
                    toolTip: "You are still required to make the minimum payment or defer your fees for this academic session before your division's registration deadline. Before the deadline you are eligible to continue enrolling in courses, if applicable."
                };
            case "REG":
                return {
                    cssClass: "registered",
                    toolTip: "You have made the minimum payment or deferred your fees for this academic session. You are eligible to continue enrolling in courses, if applicable."
                };
            case "DEREG":
                return {
                    cssClass: "deregistered",
                    toolTip: "You have been dropped from your last course by your Registrar and are deregistered from this academic session."
                };
            case "CANC":
                return {
                    cssClass: "cancelled",
                    toolTip: "You or your Registrar have dropped your last course and cancelled your registration for this academic session."
                };
            case "FINCA":
                return {
                    cssClass: "financially-cancelled",
                    toolTip: "You have not deferred your fees or made the minimum payment required for this academic session before your division's registration deadline. You have been removed from any courses you were enrolled in and you will not be able to enrol in other courses for this session."
                }
        }
    }
    return {
        restrict: "A",
        replace: !0,
        scope: {
            registration: "=",
            isDashboard: "="
        },
        template: '<div class="row" data-ng-show="registration.getRegistrationStatusDescription() != \'Unknown\'" >   <div class="col-xs-6 title">       <strong data-ng-if="isDashboard">{{registration.getPostInfo()}}            <span class="sessionDescr" ng-bind-html="registration.getSessionDescription()"></span>       </strong>       <strong data-ng-if="!isDashboard">           <span data-ng-bind-html="registration.getSessionDescription()"></span> <span>Degree Registration Status:</span>       </strong>   </div>   <div class="col-xs-6 status" ut-tooltip="toolTip" data-ut-calc-tooltip-highlight="getTooltipHighlight()">       <a href="" class="highlight" aria-label="{{getAriaLabel()}}" data-ng-bind="registration.getRegistrationStatusDescription()"></a>   </div></div>',
        controller: ["$scope", function(t) {
            var n = e(t.registration.getRegistrationStatus());
            void 0 != n && (t.getTooltipHighlight = function() {
                return n.cssClass
            }
                ,
                t.getAriaLabel = function() {
                    return "Your status for program " + t.registration.getDegreeCode() + ": " + t.registration.getDegreeName() + " in " + t.registration.getSessionDescription() + " is " + t.registration.getRegistrationStatusDescription()
                }
                ,
                t.getTitle = function() {
                    t.isDashboard
                }
                ,
                t.toolTip = n.toolTip)
        }
        ]
    }
}),
angular.module("acornApp").directive("startTimeInfo", function() {
    return {
        restrict: "A",
        replace: !0,
        scope: {
            startTimes: "=startTimeInfo"
        },
        template: '<div data-ng-show="startTimes.length" class="start-time-info">   <h3>Enrolment Start Date and Time</h3>   <p ng-repeat="startTime in startTimes" ng-show="startTime.allowed">       <strong>{{startTime.sessionDescription}} {{startTime.postTitle}}</strong>        begins on {{startTime.date}} at {{startTime.time}}.   </p>   <p>       <strong>Note:</strong> You will not be automatically enrolled in any courses in        your Enrolment Cart once your enrolment period begins.   </p></div>'
    }
}),
angular.module("acornApp").directive("tempStartTime", function() {
    return {
        restrict: "E",
        replace: !0,
        scope: {
            registrations: "=registrations"
        },
        template: '<div data-ng-show="(isARTSC(registrations) || isARCLA(registrations)) && isWithinTimeFrame()" class="row">   <div class="acorn-info col-sm-12"><p>On August 4, 2017, the priority enrolment period will end and you\'ll be free to enrol in additional        courses for the upcoming Fall-Winter session beginning at your enrolment start time. Your enrolment        start time is based on your Year of Study (all times in Eastern Standard Time):</p>        <ul>           <li>Year 4: 9:00AM</li>            <li>Year 3: 10:00AM</li>            <li>Year 2: 11:00AM</li>            <li>Year 1: 12:00PM</li>       </ul>        <p>On August 4, 2017, you will not be able to log on to ACORN or the SWS prior to your enrolment            start time listed above. Learn more about            <a data-ng-show="isARTSC(registrations)" href="http://www.artsci.utoronto.ca/current/course/timetable/1718_fw/step-5#priority" target="_blank">enrolment start times on August 4.<span class="icon-link-ext"></span></a>           <a data-ng-show="isARCLA(registrations)" href="https://www.daniels.utoronto.ca/course-enrolment-and-registration-instructions" target="_blank">enrolment start times on August 4.<span class="icon-link-ext"></span></a>       </p>   </div></div>',
        controller: ["$scope", function(e) {
            e.isARCLA = function(e) {
                if (!e)
                    return !1;
                if (!angular.isArray(e))
                    return "ARCLA" === e.primaryOrgCode;
                for (var t = 0; t < e.length; t++)
                    if ("ARCLA" === e[t].getPrimaryOrgCode())
                        return !0;
                return !1
            }
                ,
                e.isARTSC = function(e) {
                    if (!e)
                        return !1;
                    if (!angular.isArray(e))
                        return "ARTSC" === e.primaryOrgCode;
                    for (var t = 0; t < e.length; t++)
                        if ("ARTSC" === e[t].getPrimaryOrgCode())
                            return !0;
                    return !1
                }
                ,
                e.isWithinTimeFrame = function() {
                    var t = e.today;
                    t || (t = new Date);
                    var n = new Date("2017-07-28")
                        , r = new Date("2017-08-04");
                    return t.getTime() >= n.getTime() && t.getTime() < r.getTime()
                }
        }
        ]
    }
}),
angular.module("acornApp").directive("utAccountBalance", function() {
    function e(e, t) {
        return void 0 == e ? "no-tooltip" : t.isCreditBalance() ? "balance highlight" : t.isDebitBalance() ? "balance-red highlight" : t.isClearBalance() ? "no-tooltip" : void 0
    }
    return {
        restrict: "A",
        template: '<div class="account-balance"><div class="col-xs-8 col-sm-6 heading">{{balanceHeadingName}} </div> <div class="col-xs-4 col-sm-6 indent" data-ut-method-tooltip  data-ut-get-anchor-classes-to-remove="anchorTooltipClasses()" data-ut-method-tooltip-anchor-text="accountBalanceValue"           data-ut-method-tooltip-configure="configureAccountBalanceTooltip(argValue)"           data-ut-method-tooltip-arg-value="accountBalance"           data-ut-aria-label-value="getAriaLabel()"></div><div class="clearfix"></div><div class="col-xs-8 col-sm-6 subheading">{{balanceSubHeadingName}}</div></div>',
        replace: !0,
        scope: {
            accountBalance: "=utAccountBalanceObject",
            configureTooltip: "&utAccountBalanceConfigureTooltip"
        },
        link: function(t) {
            t.anchorTooltipClasses = function() {
                return "no-tooltip  balance-red dotted balance dotted"
            }
                ,
                t.getAriaLabel = function() {
                    return "Your " + t.balanceHeadingName + " is " + t.accountBalanceValue
                }
                ,
                t.configureAccountBalanceTooltip = function(n) {
                    if (void 0 != n) {
                        var r = {};
                        r.accountBalance = n;
                        var a = t.configureTooltip(r)
                            , i = {
                            messages: a.tooltip
                        }
                            , o = a.highlight;
                        return void 0 == o && (o = e(a.tooltip, n)),
                        {
                            tooltip: i,
                            highlight: o
                        }
                    }
                }
                ,
                t.$watch(function() {
                    return t.accountBalance
                }, function() {
                    t.balanceHeadingName = "Account Balance",
                        t.balanceSubHeadingName = "",
                    void 0 != t.accountBalance && (t.accountBalanceValue = t.$eval('accountBalance.getStudentAccountBalance() | acornCurrency: "$"'),
                        t.accountBalance.isDebitBalance() ? (t.balanceHeadingName = "Outstanding Balance",
                            t.balanceSubHeadingName = "(Debit Account Balance)") : t.accountBalance.isCreditBalance() ? (t.balanceHeadingName = "Credit Balance",
                            t.balanceSubHeadingName = "(Credit Account Balance)",
                            t.accountBalanceValue = t.accountBalanceValue + " CR") : (t.accountBalance.isClearBalance(),
                            t.balanceHeadingName = "Account Balance",
                            t.balanceSubHeadingName = ""))
                })
        }
    }
}),
angular.module("acornApp").directive("utAccountStatus", function() {
    return {
        restrict: "A",
        replace: !0,
        template: '<div class="account-status" data-ng-show="status && status != \'Active\'">\t<div class="col-xs-8 col-sm-6 heading">Account Status</div>\t<div class="col-xs-4 col-sm-6 indent">{{status}}</div></div>',
        scope: {
            studentInfo: "=utAccountStatusStudentInfo"
        },
        link: function(e) {
            e.$watch("studentInfo", function() {
                e.studentInfo && e.studentInfo.financialStatus && e.studentInfo.financialStatus.accountStatusDescr ? e.status = e.studentInfo.financialStatus.accountStatusDescr : e.status = void 0
            })
        }
    }
}),
angular.module("acornApp").directive("utCourseWorkload", ["$parse", "$q", "acornCoreProperties", function(e, t, n) {
    function r(e, t) {
        return t.isSummerSession() ? "indicator highlight" : e.courseWorkloadTotal < e.maxCourseLoad ? "indicator good highlight" : e.courseWorkloadTotal == e.maxCourseLoad ? "indicator ok highlight" : e.courseWorkloadTotal > e.maxCourseLoad ? "indicator warn highlight" : void 0
    }
    return {
        restrict: "A",
        template: '<div class="courseWorkLoads">     <div data-ng-repeat="courseWorkload in courseWorkloadDescriptions" data-ng-show="courseWorkload.maxCourseLoad > 0">         <div class="col-xs-6 title">             <span><strong>{{courseWorkload.sessionDescription}} Workload:</strong></span>         </div>         <div class="col-xs-6">             <span ut-method-tooltip                 data-ut-method-tooltip-anchor-text="courseWorkload.courseWorkloadDescription"                 data-ut-method-tooltip-configure="configureWorkloadTooltip(argValue)"                 data-ut-method-tooltip-arg-value="courseWorkload"                 data-ut-aria-label-value="getAriaLabel(courseWorkload)">             </span>         </div>     </div></div>',
        scope: {
            reg: "=utCourseWorkloadRegistration"
        },
        controller: ["$scope", function(e) {
            e.reg.getCourseWorkloadDescriptionsPromise().then(function(t) {
                e.courseWorkloadDescriptions = t
            }),
                e.configureWorkloadTooltip = function(t) {
                    var a = e.reg.getPrimaryOrgCode();
                    return {
                        tooltip: {
                            messages: n.getCourseWorkloadMessage(a, t.sessionDescription)
                        },
                        highlight: r(t, e.reg)
                    }
                }
                ,
                e.getAriaLabel = function(e) {
                    return e.sessionDescription + " Workload: " + e.courseWorkloadDescription
                }
        }
        ]
    }
}
]),
angular.module("acornApp").directive("utCreditNoCredit", ["$parse", "$q", "acornCoreProperties", function(e, t, n) {
    function r(e) {
        var t = e.getCNCTotal()
            , n = e.getCNCLimit();
        return t < n ? "totalText indicator good" : t == n ? "totalText indicator ok" : "totalText indicator"
    }
    return {
        restrict: "A",
        template: '<div class="creditNoCredit" data-ng-show="total > 0"> \t<span class="heading"><strong>Credit/No Credit:</strong></span> \t<span ut-method-tooltip \t   \t  data-ut-method-tooltip-anchor-text="description"       \t  data-ut-method-tooltip-configure="configureCreditNoCreditTooltip()" >\t</span> </div>',
        replace: !0,
        scope: {
            reg: "=utCreditNoCreditRegistration"
        },
        controller: ["$scope", function(e) {
            e.reg.getCNCDescriptionPromise().then(function() {
                e.total = e.reg.getCNCTotal(),
                    e.description = e.reg.getCNCDescription()
            }),
                e.configureCreditNoCreditTooltip = function() {
                    var t = e.reg.getPrimaryOrgCode();
                    return {
                        tooltip: {
                            messages: n.getCreditNoCreditMessage(t)
                        },
                        highlight: r(e.reg)
                    }
                }
                ,
                e.$watch(function() {
                    return e.description
                }, function() {
                    e.configureCreditNoCreditTooltip()
                })
        }
        ]
    }
}
]),
angular.module("acornApp").directive("utFinancialArrangement", function() {
    return {
        restrict: "A",
        template: '<div class="financial-arrangements" data-ng-show="financialStatus.length">     <h5 class="col-xs-12 card-list-heading">       <ng-pluralize count="financialStatus.length"            when="{\'one\':\'Financial Arrangement\',                   \'other\':\'Financial Arrangements\'}">       </ng-pluralize>   </h5>   <div class="col-xs-12" data-ng-repeat="financialInfo in financialStatus"          ng-show="financialInfo.financialArrangement">     <span class="col-xs-8 col-sm-6"><strong>{{financialInfo.sessionDesc}}</strong></span>     <span data-ut-tooltip="tooltip" data-ut-tooltip-highlight-class="financial-arrangement">\t        <a href="" class="indent highlight" aria-label="{{getAriaLabel(financialInfo)}}" >           {{financialInfo.financialArrangement}}         </a>     </span>   </div></div>',
        scope: {
            studentInfo: "=utFinancialArrangementStudentInfo"
        },
        replace: !0,
        controller: ["$scope", function(e) {
            e.tooltip = '<p>Some financial arrangements will automatically register you for the latest academic session without requiring payment:</p><ul>   <li>       <a href="http://www.fees.utoronto.ca/financial_arrangements_register_without_payment.htm" target="_blank">           Financial Arrangements that will register you without payment (fee deferral).<data-icon-ext-link></data-icon-ext-link>       </a>   </li>   <li>       <a href="http://www.fees.utoronto.ca/financial_arrangements_payment_required.htm" target="_blank">           Financial Arrangements that will not register you.<data-icon-ext-link></data-icon-ext-link>       </a>   </li></ul>',
                e.getAriaLabel = function(e) {
                    return "Your financial arrangement for " + e.sessionDesc + " is " + e.financialArrangement
                }
                ,
                e.$watch("studentInfo", function() {
                    e.studentInfo && e.studentInfo.financialStatuses ? e.financialStatus = e.studentInfo.financialStatuses : e.financialStatus = void 0
                })
        }
        ]
    }
}),
angular.module("acornApp").directive("utFinancialHold", function() {
    return {
        restrict: "A",
        template: '<div class="financial-holds" data-ng-show="financialHoldsInstitutions.length">\t<div class="col-xs-8 col-sm-6 heading">Financial Holds</div>\t<div class="col-xs-4 col-sm-6 indent" data-ut-tooltip="tooltip" data-ut-no-tooltip-tab-index>\t    <a href="" aria-label="{{getAriaLabelValue()}}" class="financial-hold">            \t<span class="indent" aria-hidden="true" ng-repeat="hold in financialHoldsInstitutions">{{hold}}<br></span>        </a>\t</div></div>',
        replace: !0,
        scope: {
            studentInfo: "=utFinancialHoldStudentInfo"
        },
        controller: ["$scope", function(e) {
            function t() {
                e.studentInfo && (e.financialHoldsInstitutions = e.studentInfo.financialStatus.financialHoldsInstitutions)
            }
            e.tooltip = '<p>Financial holds may appear for unpaid fees billed on ACORN or fees billed outside of ACORN, and can restrict you from taking actions such as ordering transcripts.</p><p>Learn more about <a href="http://www.fees.utoronto.ca/restrictions_penalties_past_due_and_financial_holds.htm" target="_blank">how to pay for overdue fees<data-icon-ext-link></data-icon-ext-link></a>.</p>',
                e.getAriaLabelValue = function() {
                    var t = "";
                    return e.financialHoldsInstitutions && (t = "You currently have the following financial holds ",
                        e.financialHoldsInstitutions.forEach(function(e) {
                            t += ": " + e
                        })),
                        t
                }
                ,
                e.$watch("studentInfo", function() {
                    t()
                })
        }
        ]
    }
}),
angular.module("acornApp").directive("utMethodTooltip", function() {
    return {
        restrict: "A",
        template: '<div ut-tooltip="tooltip" ut-get-anchor-classes-to-remove="_getAnchorClassesToRemove()" ut-calc-tooltip-highlight="getTooltipHighlight()"><a href="">{{anchorText}}</a></div>',
        scope: {
            anchorText: "=utMethodTooltipAnchorText",
            getAnchorClassesToRemove: "&utGetAnchorClassesToRemove",
            configureTooltip: "&utMethodTooltipConfigure",
            configureTooltipArgValue: "=utMethodTooltipArgValue",
            getAriaLabelValue: "&utAriaLabelValue"
        },
        controller: ["$scope", "$element", function(e, t) {
            e._getAnchorClassesToRemove = function() {
                return e.getAnchorClassesToRemove && angular.isFunction(e.getAnchorClassesToRemove) ? e.getAnchorClassesToRemove() : void 0
            }
                ,
                e.$watch(function() {
                    return e.configureTooltipArgValue
                }, function() {
                    angular.isFunction(e.getAriaLabelValue) && e.getAriaLabelValue() && t.find("a").attr("aria-label", e.getAriaLabelValue());
                    var n = void 0;
                    if (void 0 != e.configureTooltipArgValue) {
                        var r = {};
                        r.argValue = e.configureTooltipArgValue,
                            n = e.configureTooltip(r)
                    } else
                        n = e.configureTooltip();
                    void 0 != n && (e.tooltip = n.tooltip,
                            e.getTooltipHighlight = function() {
                                return n.highlight
                            }
                    )
                })
        }
        ]
    }
}),
angular.module("acornApp").constant("utPagerConfig", {
    itemsPerPage: 10,
    previousText: " Previous",
    nextText: "Next ",
    align: !0
}).directive("utPager", ["utPagerConfig", function(e) {
    return {
        restrict: "A",
        scope: {
            page: "=",
            totalItems: "=",
            onSelectPage: " &"
        },
        controller: "UTPaginationController",
        template: '<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>',
        replace: !0,
        link: function(t, n, r, a) {
            function i(e, t, n, r, a) {
                return {
                    number: e,
                    text: t,
                    disabled: n,
                    previous: c && r,
                    next: c && a
                }
            }
            var o = a.getAttributeValue(r.previousText, e.previousText, !0)
                , s = a.getAttributeValue(r.nextText, e.nextText, !0)
                , c = a.getAttributeValue(r.align, e.align);
            a.init(e.itemsPerPage),
                a.getPages = function(e) {
                    return [i(e - 1, o, a.noPrevious(), !0, !1), i(e + 1, s, a.noNext(), !1, !0)]
                }
        }
    }
}
]),
angular.module("acornApp").constant("utPaginationConfig", {
    itemsPerPage: 10,
    boundaryLinks: !1,
    directionLinks: !0,
    firstText: "First",
    previousText: "Previous",
    nextText: "Next",
    lastText: "Last",
    rotate: !0
}).directive("utPagination", ["$parse", "utPaginationConfig", function(e, t) {
    return {
        restrict: "A",
        scope: {
            page: "=",
            totalItems: "=",
            onSelectPage: " &"
        },
        controller: "UTPaginationController",
        template: '<ul class="pagination">\n<li ng-repeat="page in pages" ng-class="{active: page.active, disabled: page.disabled}"><a ng-click="selectPage(page.number)" role="button" aria-label="{{page.arialabel}}" aria-role="link" data-ng-href="javascript:void(0)" data-access-on-key-up="" data-access-on-key-up-action="selectPage(page.number)" data-access-on-key-up-enable-spacebar="true">{{page.text}}</a></li>\n</ul>',
        replace: !0,
        link: function(n, r, a, i) {
            function o(e, t, n, r, a) {
                return {
                    number: e,
                    text: t,
                    active: n,
                    disabled: r,
                    arialabel: a
                }
            }
            var s, c = i.getAttributeValue(a.boundaryLinks, t.boundaryLinks), l = i.getAttributeValue(a.directionLinks, t.directionLinks), u = i.getAttributeValue(a.firstText, t.firstText, !0), d = i.getAttributeValue(a.previousText, t.previousText, !0), p = i.getAttributeValue(a.nextText, t.nextText, !0), f = i.getAttributeValue(a.lastText, t.lastText, !0), g = i.getAttributeValue(a.rotate, t.rotate);
            i.init(t.itemsPerPage),
            a.maxSize && n.$parent.$watch(e(a.maxSize), function(e) {
                s = parseInt(e, 10),
                    i.render()
            }),
                i.getPages = function(e, t) {
                    var n = []
                        , r = 1
                        , a = t
                        , m = angular.isDefined(s) && s < t;
                    m && (g ? (r = Math.max(e - Math.floor(s / 2), 1),
                    (a = r + s - 1) > t && (a = t,
                        r = a - s + 1)) : (r = (Math.ceil(e / s) - 1) * s + 1,
                        a = Math.min(r + s - 1, t)));
                    for (var h = r; h <= a; h++) {
                        var v = h + " of " + a
                            , C = o(h, h, i.isActive(h), !1, v);
                        n.push(C)
                    }
                    if (m && !g) {
                        if (r > 1) {
                            var y = o(r - 1, "...", !1, !1, "Previous page set");
                            n.unshift(y)
                        }
                        if (a < t) {
                            var A = o(a + 1, "...", !1, !1, "Next page set");
                            n.push(A)
                        }
                    }
                    if (l) {
                        var E = o(e - 1, d, !1, i.noPrevious(), "Previous page");
                        n.unshift(E);
                        var T = o(e + 1, p, !1, i.noNext(), "Next page");
                        n.push(T)
                    }
                    if (c) {
                        var S = o(1, u, !1, i.noPrevious(), "Jump to first page");
                        n.unshift(S);
                        var w = o(t, f, !1, i.noNext(), "Jump to last page");
                        n.push(w)
                    }
                    return n
                }
        }
    }
}
]),
angular.module("acornApp").directive("utProgramWithFees", function() {
    function e(e, t) {
        var n = " higher fees because they are unregulated:<br> " + t;
        return 1 == e ? {
            messages: "The following program has" + n
        } : e > 1 ? {
            messages: "The following programs have" + n
        } : void 0
    }
    return {
        restrict: "A",
        template: '<div class="program-fees" data-ng-show="programsWithFees.length">     <div class="col-xs-8 col-sm-6 heading">Programs with Higher Fees</div>\t    <div class="col-xs-4 col-sm-6 indent" data-ut-tooltip="tooltip" data-ut-tooltip-highlight-class="program-fee" data-ut-no-tooltip-tab-index>         <a href=""><span class="indent highlight" aria-hidden="true" data-ng-repeat="program in programsWithFees">{{program}}</span></a>     </div></div>',
        replace: !0,
        scope: {
            studentInfo: "=utProgramWithFeesStudentInfo"
        },
        link: function(t) {
            function n() {
                if (t.studentInfo && t.studentInfo.financialStatus && t.studentInfo.financialStatus.postsWithFees && (t.programsWithFees = t.studentInfo.financialStatus.postsWithFees,
                        t.programsWithFees)) {
                    t.programsWithFeesContent = "";
                    for (var n = t.programsWithFees.length, r = 0; r < n; r++)
                        t.programsWithFeesContent += t.programsWithFees[r] + ": ";
                    angular.isDefined(t.programsWithFees) && null != t.programsWithFees && (t.tooltip = e(n, t.programsWithFeesContent))
                }
            }
            t.tooltip = e(1),
                t.$watch("studentInfo", function() {
                    n()
                }),
                n()
        }
    }
}),
angular.module("acornApp").directive("utProgressBar", function() {
    return {
        restrict: "A",
        scope: {
            progress: "=utProgressBar"
        },
        link: function(e, t) {
            t.width("0%"),
                e.$watch(function() {
                    return e.progress
                }, function(e) {
                    e = e || "0",
                        setTimeout(function() {
                            t.animate({
                                width: e + "%"
                            }, "slow")
                        }, 250)
                })
        }
    }
}),
angular.module("acornApp").directive("utToggleShowHide", function() {
    return {
        restrict: "A",
        template: '<div class="ut-toggle-show-hide" data-ng-transclude=""></div>',
        transclude: !0,
        scope: {
            toggleShowHide: "=utToggleShowHide"
        },
        link: function(e, t) {
            t.hide(),
                e.$watch(function() {
                    return e.toggleShowHide
                }, function(e) {
                    e ? (t.fadeIn("slow"),
                    t.hasClass("calendar") && t.addClass("rightBorder")) : t.fadeOut("slow")
                })
        }
    }
}),
angular.module("acornApp").service("accountBalanceManager", ["$q", "$http", "dashboardServerResources", "acornCoreProperties", "acornCoreLib", "dashboardManager", "dashboardAppConstants", "accountBalanceConstants", function(e, t, n, r, a, i, o, s) {
    function c(e) {
        function t() {
            return Math.abs(i)
        }
        function n() {
            return 0 == i
        }
        function r() {
            return i < 0
        }
        function a() {
            return i > 0
        }
        var i = 0;
        return e && (i = e),
        {
            getStudentAccountBalance: t,
            isClearBalance: n,
            isCreditBalance: r,
            isDebitBalance: a
        }
    }
    function l(e) {
        function t() {
            return c.balance
        }
        function n() {
            return c.indicator
        }
        function r() {
            return c.accountStatusIncomplete
        }
        function a() {
            return 0 == c.balance
        }
        function i() {
            return c.indicator == s.INDICATOR_CREDIT && c.balance > 0
        }
        function o() {
            return c.indicator == s.INDICATOR_NO_CREDIT && c.balance > 0
        }
        var c = e;
        return this.getStudentAccountBalance = t,
            this.getAccountBalanceIndicator = n,
            this.isAccountStatusIncomplete = r,
            this.isClearBalance = a,
            this.isCreditBalance = i,
            this.isDebitBalance = o,
            this
    }
    function u(e) {
        if (R = e,
                angular.isArray(e.registrationStatusList))
            for (var t = 0; t < e.registrationStatusList.length; t++)
                M[e.registrationStatusList[t].primaryOrgCode] = e.registrationStatusList[t].primaryOrgCode
    }
    function d(e, t) {
        N = new c(t),
            u(e)
    }
    function p(e, t) {
        S(t),
            u(e)
    }
    function f(t, r, a) {
        if (void 0 !== t && void 0 !== r)
            if (void 0 === a)
                d(t, r);
            else if (void 0 !== a) {
                var o = s.INDICATOR_NO_CREDIT;
                r < 0 && (o = s.INDICATOR_CREDIT),
                    p(t, {
                        balance: Math.abs(r),
                        indicator: o,
                        accountStatusIncomplete: a
                    })
            }
        if (null != R)
            return e.when(R);
        if (null != P)
            return P;
        var c = C()
            , l = e.defer();
        return P = l.promise,
            c.then(function() {
                n.getStudentAccountBalance(null, function(e) {
                    d(e, e.financialStatus.accountBalance),
                        i.setWidgetToLoaded(k.FINANCE),
                        i.setFutureExamsAvailablity(e.studentHasFutureExams),
                        l.resolve(e)
                }, function() {
                    R = !1,
                        i.setWidgetToLoaded(k.FINANCE),
                        l.reject(!1)
                })
            }),
            P
    }
    function g() {
        return R
    }
    function m() {
        return N
    }
    function h() {
        return O
    }
    function v() {
        return I
    }
    function C() {
        if (null == I) {
            var t = e.defer();
            return n.getCurrentDate(null, function(e) {
                I = e.currentDate,
                    t.resolve(I)
            }),
                t.promise
        }
        return e.when(I)
    }
    function y() {
        return M
    }
    function A(e) {
        var t = !1;
        return M[e] && (t = !0),
            t
    }
    function E() {
        return R.financialStatus.financialArrangement
    }
    function T() {
        var t = e.defer();
        return f().then(function() {
            t.resolve(m())
        }, function(e) {
            t.reject(e)
        }),
            t.promise
    }
    function S(e) {
        O = new l(e);
        var t = O.getStudentAccountBalance();
        O.isCreditBalance() && (t *= -1),
            N = new c(t)
    }
    function w() {
        if (null != O)
            return e.when(O);
        if (null != L)
            return L;
        var t = e.defer();
        return L = t.promise,
            n.getAccountBalanceFromMainframe(null, function(e) {
                S(e),
                    t.resolve(e)
            }, function() {
                t.reject("Could not retrieve Account Balance from Mainframe")
            }),
            L
    }
    function b(e) {
        var t = null;
        if (e.isCreditBalance())
            t = 'This balance indicates any refundable credit on your account as well as deposit payments received that have not yet been applied to fees. <p/>To receive a refund you must: <ol><li>Ensure your <a href="person/bankMain.do?main.dispatch">direct deposit</a> information is up to date</li><li>Ensure your <a href="person/addressView.do?view.dispatch">mailing address</a> information is up to date</li><li>Learn <a href="http://www.fees.utoronto.ca/refunds.htm" target="_blank">how to request a refund<data-icon-ext-link></data-icon-ext-link></a>&nbsp for outstanding credits on your account</li></ol>';
        else {
            if (!e.isDebitBalance())
                return {
                    tooltip: void 0,
                    highlight: void 0
                };
            t = 'This balance reflects all transactions on your account and may include multiple academic sessions. View the <a href="http://www.fees.utoronto.ca/payment_service_charge_billing.htm" target="_blank">fee payment and service charge billing schedule<data-icon-ext-link></data-icon-ext-link></a> to determine your upcoming required payments and, if an outstanding balance persists, the monthly service charge your account will be subject to. <p/>Your account balance must be paid in full by the end of each academic session:<ul>\t<li>April 30th for the Fall-Winter Session</li>\t<li>August 31st for the Summer Session</li></ul><p/>Failure to do so will result in a financial hold being placed on your account and you will be blocked from enrolling in future academic sessions.'
        }
        return {
            tooltip: t,
            highlight: void 0
        }
    }
    function _(e) {
        function t(e, t) {
            return {
                tooltip: e,
                highlight: t
            }
        }
        function n(e) {
            return t(e, void 0)
        }
        var r = "This balance indicates any refundable credit on your account as well as deposit payments received that have not yet been applied to fees. "
            , a = 'To receive a refund you must: <ol><li>Ensure your <a href="person/bankMain.do?main.dispatch">direct deposit</a> information is up to date</li><li>Ensure your <a href="person/addressView.do?view.dispatch">mailing address</a> information is up to date</li><li>Learn <a href="http://www.fees.utoronto.ca/refunds.htm" target="_blank">how to request a refund<data-icon-ext-link></data-icon-ext-link></a>&nbsp for outstanding credits on your account</li></ol>'
            , i = 'This balance reflects all transactions on your account and may include multiple academic sessions.View the <a href="http://www.fees.utoronto.ca/payment_service_charge_billing.htm" target="_blank">fee payment and service charge billing schedule<data-icon-ext-link></data-icon-ext-link></a> to determine your upcoming required payments and, if an outstanding balance persists, the monthly service charge your account will be subject to. '
            , o = "Your account balance must be paid in full by the end of each academic session:<ul>\t<li>April 30th for the Fall-Winter Session</li>\t<li>August 31st for the Summer Session</li></ul><p/>Failure to do so will result in a financial hold being placed on your account and you will be blocked from enrolling in future academic sessions."
            , s = "Note: Some fee assessment of your account has not yet taken place for the upcoming academic session.";
        return e.isCreditBalance() && !e.isAccountStatusIncomplete() ? n(r + "<p/>" + a) : e.isDebitBalance() && !e.isAccountStatusIncomplete() ? n(i + "<p/>" + o) : e.isCreditBalance() && e.isAccountStatusIncomplete() ? n(r + "<p/>" + s + "<p/>" + a) : e.isDebitBalance() && e.isAccountStatusIncomplete() ? n(i + "<p/>" + s + "<p/>" + o) : t(s, "dotted")
    }
    function D(e) {
        return new c(e)
    }
    var I = null
        , N = null
        , O = null
        , R = null
        , P = null
        , L = null
        , M = {}
        , k = o.WIDGETS.IDS;
    return this.configureBasicAccountBalanceTooltip = b,
        this.configureDetailedAccountBalanceTooltip = _,
        this.getBasicAccountBalance = m,
        this.getDetailedAccountBalance = h,
        this.getBasicAccountBalancePromise = T,
        this.getDetailedAccountBalancePromise = w,
        this.getStudentInfo = g,
        this.getCurrentDate = v,
        this.getPrimaryOrgCode = y,
        this.isStudentOfPrimaryOrg = A,
        this.getFinancialArrangement = E,
        this.createAccountBalanceObj = D,
        this.initManager = f,
        this
}
]),
angular.module("acornApp").service("campusService", ["acornSettings", function(e) {
    return this.getCampus = function() {
        var t = e.getSetting("campus")
            , n = e.getSetting("multiCampusRegistration");
        return angular.isDefined(t) && null != t && !n || (t = "STG"),
            t
    }
        ,
        this
}
]),
angular.module("acornApp").service("dashboardManager", ["$q", "$http", "dashboardServerResources", "acornCoreProperties", "acornCoreLib", "dashboardAppConstants", function(e, t, n, r, a, i) {
    function o(e) {
        var t = p[e];
        return angular.isDefined(t) && t
    }
    function s(e) {
        p[e] = !0
    }
    function c(e) {
        g = e
    }
    function l() {
        return g
    }
    function u(e) {
        return null === e ? null : a.getUtilityLib().getSessionToDescription(e)
    }
    var d = i.WIDGETS.IDS
        , p = {}
        , f = !1
        , g = !1;
    return this.isWidgetLoaded = o,
        this.setWidgetToLoaded = s,
        this.hasFutureExams = l,
        this.setFutureExamsAvailablity = c,
        this.getWidgetIDConstants = function() {
            return d
        }
        ,
        this.setDashboardLoaded = function(e) {
            f = e
        }
        ,
        this.isDashboardLoaded = function() {
            return f
        }
        ,
        this.getSessionDescription = u,
        this
}
]),
angular.module("acornApp").factory("dashboardServerResources", ["$resource", function(e) {
    return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
        getStudentAccountBalance: {
            method: "GET",
            params: {
                kind: "profile",
                type: "studentRegistrationInfo"
            }
        },
        getAccountBalanceFromMainframe: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "finance",
                type2: "mainframe-accountBalance"
            }
        },
        getStudentEnrolledCourses: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "courseRegistration",
                type2: "enrolledCourses"
            }
        },
        getTodaysEvents: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "eventCalendar",
                type2: "getDashboardEvents",
                param: "TODAY"
            }
        },
        getUpcomingEvents: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "eventCalendar",
                type2: "getUpcomingEvents"
            },
            isArray: !0
        },
        getStartTimes: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "course",
                type2: "start-times"
            },
            isArray: !1
        },
        getDeData: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "programProgress"
            }
        },
        getRefreshedDeData: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "programProgress"
            }
        },
        getCurrentDate: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "eventCalendar",
                type2: "getCurrentDate",
                param: "yyyy-MM-dd"
            }
        },
        getEligibleRegistrations: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "eligible-registrations"
            },
            isArray: !0
        },
        getCurrentRegistrations: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "current-registrations"
            },
            isArray: !0
        },
        getPostsWithInviteStatus: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "posts-with-invite-status"
            }
        },
        cancelPostWithInviteStatus: {
            method: "POST",
            params: {
                kind: "enrolment",
                type: "cancel-registration"
            }
        },
        getCNCTotal: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "cnc",
                type2: "total-credits"
            }
        },
        getTermCourseLoad: {
            method: "GET",
            params: {
                kind: "enrolment",
                type: "term-course-loads"
            },
            isArray: !0
        },
        getHeartbeatStatus: {
            method: "GET",
            params: {
                kind: "admin",
                type: "heartbeat"
            }
        },
        batchMarkNotificationsAsRead: {
            method: "POST",
            params: {
                kind: "notification",
                type: "batch-read"
            }
        },
        getOptOutSessionCode: {
            method: "GET",
            params: {
                kind: "dashboard",
                type: "finance",
                type2: "optOutSessionCode"
            }
        }
    })
}
]),
angular.module("acornApp").service("eligibleRegistrationManager", ["$q", "$http", "$log", "dashboardServerResources", "acornCoreProperties", "acornCoreLib", function(e, t, n, r, a, i) {
    function o(a) {
        function i() {
            return H.postInfo || "Unknown"
        }
        function o() {
            return H.sessionCode
        }
        function s() {
            return H.sessionDescription || "Unknown"
        }
        function c() {
            return H.post.code || "Unknown"
        }
        function l() {
            return H.post.description || "Unknown"
        }
        function u() {
            return H.academicStatusDesc || "Unknown"
        }
        function d(e) {
            var t = ""
                , n = "";
            if (e) {
                switch ($()) {
                    case 1:
                        var r = H.registrationStatuses[e];
                        r && angular.isObject(r) && (n = r.registrationStatusCode);
                        break;
                    case 2:
                        n = H.status;
                        break;
                    default:
                        n = H.status
                }
            } else
                n = H.status;
            return n && (t = E.maps.regStatusMap[n.toUpperCase()]),
                t
        }
        function p() {
            return H.status.toUpperCase()
        }
        function f(e) {
            return H.status = e
        }
        function g() {
            if (null != z)
                return z;
            if (null != Y)
                return e.when(q);
            var n = e.defer()
                , r = T.getSessionsArrayFromSessionCode(H.sessionCode)
                , a = "primaryOrgCode=" + encodeURIComponent(H.primaryOrgCode) + "&postCode=" + encodeURIComponent(H.post.code)
                , i = r.length;
            z = n.promise,
                Y = {};
            for (var o = 0; o < i; o++)
                a += "&sessionCodes=" + encodeURIComponent(r[o]);
            var s = "undefined" == typeof testBaseUrl ? "" : testBaseUrl;
            return t({
                method: "GET",
                url: s.replace(/\\(.)/gm, "$1") + "/sws/rest/enrolment/term-course-loads?" + a,
                cache: !1
            }).then(function(e) {
                var t = e.data;
                for (var r in t) {
                    var a = ""
                        , i = T.parseROSISession(r);
                    Y[r] = t[r].courseLoad;
                    var o = t[r].maxCourseLoad;
                    a = P() ? "View Workload Limits" : Y[r] < o ? "Within Recommended Limit" : Y[r] == o ? "At Recommended Limit" : "Over Recommended Limit",
                        q.push({
                            maxCourseLoad: o,
                            courseWorkloadTotal: Y[r],
                            courseWorkloadDescription: a,
                            sessionCode: r,
                            sessionDescription: i.sessionYear + " " + i.sessionStr
                        })
                }
                n.resolve(q)
            }, function() {
                n.reject("Course Load Service Unavailable. Please try again later.")
            }),
                n.promise
        }
        function m() {
            return null === Y && g(),
                q
        }
        function h() {
            return Y
        }
        function v() {
            if (null !== W)
                return B;
            C()
        }
        function C() {
            if (null != K)
                return K;
            if (null != W)
                return e.when(B);
            var t = e.defer();
            return K = t.promise,
                r.getCNCTotal({
                    candidacyPostCode: H.candidacyPostCode,
                    candidacySessionCode: H.candidacySessionCode
                }, function(e) {
                    W = (parseFloat(e.value) || 0).toFixed(2),
                        B = W + " of " + D(),
                        t.resolve(B)
                }, function() {
                    t.reject("CNC Service Unavailable. Please try again later.")
                }),
                K
        }
        function y() {
            return W
        }
        function A(e) {
            var t = null;
            if (e) {
                switch ($()) {
                    case 1:
                        var n = H.registrationStatuses[e];
                        n && angular.isObject(n) && (t = n.yearOfStudy);
                        break;
                    case 2:
                        t = H.yearOfStudy || null;
                        break;
                    default:
                        t = H.yearOfStudy || null
                }
            } else
                t = H.yearOfStudy || null;
            return t
        }
        function S() {
            return H.attendanceClassDesc || null
        }
        function w() {
            return H.associatedOrgName || null
        }
        function b() {
            return H.primaryOrgCode || null
        }
        function _() {
            return H.secondaryOrgCode || null
        }
        function D() {
            return (parseFloat(H.postOfferCncLimit) || 0).toFixed(2)
        }
        function I(e) {
            return "Y" == e ? "Yes" : "N" == e ? "No" : null === e ? "N/A" : void 0
        }
        function N() {
            var e = H.exchangeTitle;
            return angular.isDefined(e) && null !== e ? e : "N/A"
        }
        function O() {
            return !!angular.isString(H.levelOfInstruction) && "U" === H.levelOfInstruction.toUpperCase()
        }
        function R() {
            return I(H.gradFundingIndicator)
        }
        function P() {
            var e = H.sessionCode;
            return null != e && "5" == e.charAt(e.length - 1)
        }
        function L() {
            return "INVIT" === H.status.toUpperCase()
        }
        function M(e) {
            H.canDeclineRegistration = e
        }
        function k() {
            return H.canDeclineRegistration
        }
        function F(e) {
            H.secondarySessionCode = e
        }
        function x() {
            return H.secondarySessionCode
        }
        function U() {
            return "ARTSC" !== b() && "SCAR" !== b() && null != S()
        }
        function $() {
            return H.acpDuration || null
        }
        function G() {
            return H.registrationStatuses || null
        }
        function j(e) {
            var t = T.parseROSISession(e);
            return t.sessionYear + " " + t.sessionStr
        }
        function V() {
            return H.currentRegistration
        }
        var H = a
            , W = null
            , B = "Loading..."
            , Y = null
            , q = []
            , z = null
            , K = null;
        return this.primaryOrgCode = H.primaryOrgCode,
            this.secondaryOrgCode = H.secondaryOrgCode,
            function() {
                angular.isObject(H) || n.error("Expected and eligible Registration Object Parameter but got: ", H)
            }(),
            this.getPostInfo = i,
            this.getSessionCode = o,
            this.getSessionDescription = s,
            this.getDegreeCode = c,
            this.getDegreeName = l,
            this.getAcademicStanding = u,
            this.getRegistrationStatusDescription = d,
            this.getRegistrationStatus = p,
            this.getCourseWorkloadDescriptions = m,
            this.getCourseWorkloadDescriptionsPromise = g,
            this.getCourseWorkloadTotals = h,
            this.getCNCDescription = v,
            this.getCNCDescriptionPromise = C,
            this.getCNCTotal = y,
            this.getCNCLimit = D,
            this.getYearOfStudy = A,
            this.getAttendanceDescription = S,
            this.getOrgName = w,
            this.getPrimaryOrgCode = b,
            this.getSecondaryOrgCode = _,
            this.getExchangeProgramStatus = N,
            this.getGraduateFundingStatus = R,
            this.isUndergradRegistration = O,
            this.isSummerSession = P,
            this.isRegistrationStatusInvited = L,
            this.setRegistrationStatus = f,
            this.setCanDeclineRegistration = M,
            this.canDeclineRegistration = k,
            this.setSecondarySessionCode = F,
            this.getSecondarySessionCode = x,
            this.useSws = function() {
                return H.useSws
            }(),
            this.shouldShowAttendance = U,
            this.getAcpDuration = $,
            this.getRegStatusMap = G,
            this.getRegistrationSessionDescription = j,
            this.isCurrentRegistration = V,
            this.id = (this.getPostInfo() + "-" + this.getSessionCode()).replace(/\s/g, "-"),
            this
    }
    function s(e) {
        if (angular.isArray(e)) {
            for (var t = null, n = e.length, r = {}, a = 0; a < n; a++) {
                var i = e[a].primaryOrgCode.toUpperCase()
                    , o = null;
                switch (i) {
                    case "ERIN":
                    case "SCAR":
                        o = i;
                        break;
                    default:
                        o = "STG"
                }
                null !== o && (angular.isDefined(r[o]) || (r[o] = 0),
                    r[o]++)
            }
            var s = 0;
            for (var c in r)
                s < r[c] && (t = c,
                    s = r[c]);
            v = t,
                C = Object.keys(r).length > 1
        }
    }
    function c(e) {
        function t(t) {
            y = !!angular.isArray(t) && t,
                e.call(this, y)
        }
        e = angular.isFunction(e) ? e : function() {}
            ,
            y = null,
            f().then(t, t)
    }
    function l(e) {
        function t(t) {
            if (angular.isArray(t)) {
                A = t;
                for (var r = 0; r < A.length; r++) {
                    if ("INVIT" === A[r].getRegistrationStatus()) {
                        S = !0;
                        break
                    }
                }
                e.call(this, A, S),
                    m().then(function(e) {
                        u(e)
                    }, function(e) {
                        n.error(e)
                    })
            } else
                A = !1
        }
        e = angular.isFunction(e) ? e : function() {}
            ,
            A = null,
            g().then(t, t)
    }
    function u(e) {
        if (e.multiple)
            for (var t = A.length, n = 0; n < t; n++) {
                var r = A[n];
                if ("INVIT" === r.getRegistrationStatus())
                    for (var a = e.sessions, i = a.length, o = 0; o < i; o++) {
                        var s = a[o].code
                            , c = a[o].secondaryCode;
                        if (r.getSessionCode() === s)
                            for (var l = a[o].posts, u = l.length, d = 0; d < u; d++) {
                                var p = l[d].code;
                                r.getDegreeCode() === p && (r.setCanDeclineRegistration(!0),
                                    r.setSecondarySessionCode(c))
                            }
                    }
            }
    }
    function d() {
        return v
    }
    function p() {
        return C
    }
    function f() {
        var t = e.defer();
        return r.getEligibleRegistrations(function(e) {
            var n = [];
            if (!angular.isArray(e))
                return void t.resolve(n);
            var r = e.length;
            s(e);
            for (var a = 0; a < r; a++) {
                var i = new o(e[a]);
                n.push(i)
            }
            t.resolve(n)
        }, function() {
            t.reject(null)
        }),
            t.promise
    }
    function g() {
        var t = e.defer();
        return r.getCurrentRegistrations(function(e) {
            var n = [];
            if (!angular.isArray(e))
                return void t.resolve(n);
            for (var r = e.length, a = 0; a < r; a++) {
                var i = new o(e[a]);
                n.push(i)
            }
            t.resolve(n)
        }, function() {
            t.reject(null)
        }),
            t.promise
    }
    function m() {
        var t = e.defer();
        return r.getPostsWithInviteStatus(function(e) {
            t.resolve(e)
        }, function(e) {
            t.reject(e)
        }),
            t.promise
    }
    function h() {
        return y
    }
    var v = null
        , C = !1
        , y = null
        , A = null
        , E = a.getEligibleRegistrationProperties()
        , T = i.getEnrolmentLib()
        , S = !1;
    return this.initManagerWithEligibleRegistrationData = s,
        this.initManager = c,
        this.initAllRegistrations = l,
        this.getEligibleRegistrations = h,
        this.getPredominantUserCampus = d,
        this.isMultiCampusRegistration = p,
        this
}
]),
angular.module("acornApp").controller("CancelRegCtrl", ["$scope", "$rootScope", "$uibModal", "enrolmentServerResources", "utToast", "enrolmentEventsConstants", "acornCoreLib", function(e, t, n, r, a, i, o) {
    function s(t, n) {
        if (e.cr_modal.hasOwnProperty("terms"))
            for (var r = e.cr_modal.terms, a = r.length, i = 0; i < a; i++)
                if (r[i].type === n) {
                    if (r[i].selected)
                        break;
                    return !1
                }
        return t[n]
    }
    function c(e) {
        var t = s(e, "sessionCode")
            , n = s(e, "secondarySessionCode")
            , r = {
            regStatus: e.regStatus,
            secondaryRegStatus: e.secondaryRegStatus,
            post: {
                code: e.post.code
            }
        };
        return t && (r.sessionCode = t),
        n && (r.secondarySessionCode = n),
            r
    }
    function l(e) {
        for (var t = e.length, n = 0; n < t; n++)
            if (e[n].selected)
                return !0;
        return !1
    }
    var u = null;
    e.notice = {
        show: !1,
        startCancelReg: function() {
            e.cr_modal.show = !0,
                u = n.open({
                    animation: !0,
                    templateUrl: "partials/enrolment/modal/cancelRegistration.html",
                    scope: e,
                    windowClass: "modal-lg-acorn"
                })
        },
        hide: function() {
            e.notice.show = !1
        }
    },
        e.cr_modal = {
            title: "Cancel Registration",
            show: !1,
            noSessionSelected: !1,
            cancelAction: function() {
                u.dismiss("cancel"),
                    e.cr_modal.show = !1
            },
            proceedAction: function() {
                function n() {
                    u.close("action complete"),
                        e.cr_modal.show = !1,
                        e.notice.show = !1
                }
                function i(r, i) {
                    var s = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession].sessionDescription
                        , c = "You have cancelled your registration for the " + s + " session";
                    if ("SCAR" === e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession].primaryOrgCode)
                        if (i.sessionCode && i.secondarySessionCode) {
                            var l = o.getUtilityLib().getSessionToDescription(i.sessionCode)
                                , u = o.getUtilityLib().getSessionToDescription(i.secondarySessionCode);
                            c = "You have cancelled your registration for the " + l + " and " + u + " sessions"
                        } else {
                            var d;
                            i.sessionCode ? d = o.getUtilityLib().getSessionToDescription(i.sessionCode) : i.secondarySessionCode && (d = o.getUtilityLib().getSessionToDescription(i.secondarySessionCode)),
                            d && (c = "You have cancelled your registration for the " + d + " session")
                        }
                    a.show({
                        text: c,
                        infoState: !0
                    }),
                        e.cr_modal.hasOwnProperty("terms") ? t.$broadcast("COURSE_ENROLMENT_PARTIAL_END_REG", "Tell user they will be redirected back to enrolment landing area.") : t.$broadcast("COURSE_ENROLMENT_END_REG", "Safe to hide the enrolment screen"),
                        n()
                }
                function s(t) {
                    var r = t.data || "Unable to " + e.cr_modal.title;
                    a.show({
                        text: r,
                        errorState: !0
                    }),
                        n()
                }
                if (e.cr_modal.hasOwnProperty("terms") && !l(e.cr_modal.terms))
                    return void (e.cr_modal.noSessionSelected = !0);
                var d = c(e.cr_modal.canReg);
                r.cancelRegistration(d, function(e) {
                    i(e, d)
                }, function(e) {
                    s(e)
                })
            },
            hideError: function() {
                e.cr_modal.noSessionSelected = !1
            }
        },
        e.$on("ADD_TO_CURRENTLY_ENROLED", function() {
            e.notice.show = !1
        }),
        e.$on("CANCEL_REGISTRATION_CTRL_FLOW_START", function(t, n) {
            var r = null;
            r = void 0 !== n.responseObject ? n.responseObject : n;
            var a = r;
            e.cr_modal.canReg = a;
            var i = {
                cancelreg: {
                    single: "Single Cancel Message",
                    multiple: "Mulitple cancel message",
                    trimester: "Trimester Deregister Message",
                    button: "Cancel Registration"
                },
                dereg: {
                    single: "Single Deregister Message",
                    multiple: "Multiple deregister message",
                    trimester: "Trimester Deregister Message",
                    button: "De-register"
                }
            }
                , o = a.sessionDescription
                , s = a.secondarySessionDescription;
            if (function(e) {
                    return "string" == typeof e ? !(e.length > 0) : null === e || void 0 === e
                }(s))
                e.cr_modal.session = o;
            else {
                var c = o.split(" ")
                    , l = s.split(" ");
                e.cr_modal.session = c[0] + "-" + l[0] + " " + c[1] + "/" + l[1],
                    1 === a.postAcpDuration ? e.cr_modal.terms = [{
                        type: "sessionCode",
                        name: a.sessionDescription,
                        value: a.sessionCode,
                        selected: !1
                    }, {
                        type: "secondarySessionCode",
                        name: a.secondarySessionDescription,
                        value: a.secondarySessionCode,
                        selected: !1
                    }] : a.secondaryRegCancellable ? e.cr_modal.multiple = i.cancelreg.multiple : e.cr_modal.multiple = i.dereg.multiple
            }
            a.primaryRegCancellable || void 0 === n.responseObject ? (e.notice.buttonText = i.cancelreg.button,
                e.cr_modal.buttonText = i.cancelreg.button) : (e.notice.buttonText = i.dereg.button,
                e.cr_modal.buttonText = i.dereg.button),
                e.notice.show = !0,
            1 == e.notice.show && window.scrollTo(0, 0)
        })
}
]),
angular.module("acornApp").controller("CourseTypeaheadSearchCtrl", ["$scope", "$http", "$uibModal", "DisplayCourseInfo", "enrolmentConstantsService", "SessionAssignment", "Accessibility", "enrolmentServerResources", "utToast", "modalCourseData", "utTypeaheadState", "screenSizeQuery", function(e, t, n, r, a, i, o, s, c, l, u, d) {
    var p = {
        STG: "St. George",
        ERI: "Mississauga",
        SCA: "Scarborough",
        OFF: "Off Campus"
    };
    e.searchLoading = !1,
        e.searchError = !1,
        e.getSessionShortName = function(e) {
            return i.getSessionShortName(e)
        }
        ,
        e.campusMap = function(e) {
            return p.hasOwnProperty(e) ? p[e] : p.OFF
        }
        ,
        e.searchCourses = function(n) {
            e.cantFindResults = !1,
                e.searchLoading = !0,
                e.searchError = !1;
            var i = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
                , o = i.studentCampusCode
                , s = i.registrationSessions
                , l = {
                coursePrefix: n,
                studentCampus: o,
                sessions: s
            }
                , u = r.prepareCourseVariables(i, l)
                , d = a.queryBuilder(u);
            t({
                method: "GET",
                url: a.particalUrl.replace("\\:", ":") + "course/matching-courses" + d,
                cache: !1
            }).then(function(t) {
                var n = t.data;
                e.searchResultsFromCourseCtrl = angular.isArray(n) && n.length ? n : [],
                    e.cantFindResults = !e.searchResultsFromCourseCtrl.length,
                    e.searchLoading = !1,
                    e.searchError = !1
            }, function(t) {
                var r = t.data;
                e.searchResultsFromCourseCtrl = [],
                    e.searchLoading = !1,
                    e.searchError = !0;
                var a = r || "An unexpected error has occured while searching for your course query: <b>" + n + "</b>";
                c.show({
                    text: a,
                    warningState: !0
                })
            })
        }
        ,
        e.$watch(function() {
            return u.getState()
        }, function(t) {
            t && (e.term = t.term,
            "" === t.term && (e.searchResultsFromCourseCtrl = void 0))
        }),
        e.selectCourse = function(t) {
            o.setLastFocus($("#typeaheadInput"));
            var a = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
                , i = {
                courseCode: t.activityCode,
                sectionCode: t.sectionCode,
                courseSessionCode: t.sessionCode,
                activityApprovedInd: a.activityApprovedInd,
                activityApprovedOrg: a.activityApprovedOrg
            }
                , u = r.prepareCourseVariables(a, i);
            s.getCourseInfo(u, function(a) {
                e.currentCourse = t,
                    e.currentActivity = {
                        primaryActivity: "",
                        secondaryActivity: "",
                        thirdActivity: ""
                    },
                    r.transferCourseResponseObject(a.responseObject, e.currentCourse);
                var i = r.getMeetings(a.responseObject.meetingList, a.responseObject.meetings, a.responseObject);
                if (angular.isDefined(i)) {
                    e.currentCourse.info = r.getMappedActivities(i.updatedMeetings, a.responseObject.primaryTeachMethod),
                        e.currentCourse.primaryTeachMethod = a.responseObject.primaryTeachMethod,
                        l.setData(e);
                    var s = n.open({
                        animation: !0,
                        templateUrl: "partials/enrolment/modalCourse.html",
                        controller: "ModalCourseCtrl",
                        scope: e,
                        windowClass: "modal-lg-acorn"
                    });
                    s.result.then(o.restoreLastFocus, o.restoreLastFocus),
                        s.rendered.then(function() {
                            o.setElemFocus("courseCodeAndTitle")
                        })
                } else {
                    var u = "No meeting sections found for <b>" + e.currentCourse.activityCode + "</b>.";
                    c.show({
                        text: u,
                        warningState: !0
                    })
                }
            }, function(e) {
                e.hasOwnProperty("data") && e.data.hasOwnProperty("value") && c.show({
                    text: e.data.value,
                    errorState: !0
                })
            })
        }
        ,
        e.ariaDescForCourse = function(t) {
            return "Highlighted " + t.activityCode + " " + t.sectionCode + " (" + e.getSessionShortName(t) + "): " + t.activityTitle + ", at " + t.campusEnDesc + " campus."
        }
        ,
        e.placeholderText = d.isSmall() ? "Search by course code or title" : "Search in this session by course code or title"
}
]),
angular.module("acornApp").constant("courseEnrolmentConstants", {
    MESSAGES: {
        INT_COURSE_ENROLLED: "Some Interim Course Message",
        REQ_COURSE_ENROLLED: "Some Requested Course Message"
    }
}).controller("CurrentCoursesCtrl", ["$scope", "$log", "$uibModal", "$rootScope", "CourseCRUD", "modalCourseData", "enrolmentServerResources", "Accessibility", "utGlobalHelpers", "utConfirmation", "utToast", "enrolmentEventsConstants", "CourseCRUDConstants", "courseEnrolmentConstants", "acornCoreProperties", "acornCoreLib", "activityUpdateNotification", "SessionAssignment", "campusType", "formatString", "EnrolledCoursesCartService", "eventConstants", "EnrolmentMessageService", "studentBasicInfoSvc", "internationalStudentsConstants", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f, g, m, h, v, C, y, A, E, T, S, w) {
    function b() {
        r.$broadcast(d.UI_PANEL_REFRESH_EVENT, {})
    }
    function _(e) {
        var n = {}
            , r = ["APP", "WAIT", "REQ", "INT", "REF", "DROP"];
        if (!angular.isObject(e))
            return void t.warn("Courses passed was not an object - instead got: ", e);
        P.length = 0;
        for (var a = 0; a < r.length; a++) {
            var i = r[a];
            void 0 !== e[i] && (n[i] = e[i],
                P.push(i))
        }
        for (var o in e) {
            var s = e[o];
            void 0 === n[o] && (t.warn("Did not recognize courses with course status: " + o + "!\nAppending these courses to the end of the course list object..."),
                n[o] = s,
                P.push(o))
        }
        return n
    }
    function D(t) {
        var n = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession];
        return t.cncAllowed = null == t.cncAllowed ? "" : t.cncAllowed,
            t.attendanceStatus = null == t.attendanceStatus ? "" : t.attendanceStatus,
            e.cncInfo.currentAmount = e.cncInfo.currentAmount ? parseFloat(e.cncInfo.currentAmount) : 0,
        {
            postOfferCncAllowed: "Y" === n.postOfferCncAllowed.toUpperCase(),
            isCncCourse: "CNC" === t.attendanceStatus.toUpperCase() || "CNX" === t.attendanceStatus.toUpperCase(),
            courseNotWithinSessionalDates: 0 == t.withinSessionalDatesForCnc,
            courseNotEligibleForCNC: function() {
                return parseFloat(e.cncInfo.currentAmount) + parseFloat(t.courseCredits) > parseFloat(e.cncInfo.maxAmount)
            },
            courseDoesNotAllowCNC: "N" === t.cncAllowed.toUpperCase()
        }
    }
    function I(n) {
        if ("Y" === e.session.postOfferCncAllowed && ("APP" === n.statusType || "REQ" === n.statusType || "INT" === n.statusType)) {
            var r = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
                , a = {
                postCode: r.postInfo,
                sessionCode: n.regSessionCode1,
                code: n.activityCode,
                sectionCode: n.sectionCode,
                status: n.statusType
            };
            n.loadingCNCStatus = !0,
                o.cncInfo(a, function(e) {
                    n.loadingCNCStatus = !1,
                        n.cncAllowed = e.cncAllowed,
                        n.withinSessionalDatesForCnc = e.withinSessionalDatesForCnc,
                        n.cncObj = D(n)
                }, function(e) {
                    n.loadingCNCStatus = !1,
                        t.error(e)
                })
        }
    }
    var N = g.getEnrolmentProperties();
    e.$emit("COURSE_CONTROL_LOADED", "Loaded"),
        e.loading = !0,
        e.showCurDetails = !0,
        e.enrolmentCodeMap = N.maps.courseStatusMap;
    var O = function() {
        var t = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
            , n = t.primaryOrgCode
            , r = {};
        return r = w.UTSC_PRIMARY_ORG_CD === n ? w.UTSC : w.SCAR_PRIMARY_ORG_CD === n ? w.SCAR : w.NON_UTSC_OR_SCAR,
            T.getDropCourseMsgForIntlStudents(r)
    };
    e.cncInfo = {};
    var R = function(t) {
        var n = {};
        for (var r in t)
            if (t.hasOwnProperty(r) && void 0 !== e.enrolmentCodeMap[r]) {
                var i = t[r].length;
                n[r] = [];
                for (var o = 0; o < i; o++) {
                    var s = function(e, t, n) {
                        return t = a.readCourse.getMeetings(e, t, n),
                            angular.isDefined(t) ? t.filteredMeetings : []
                    }(t[r][o].meetingList, t[r][o].meetings, t[r][o])
                        , c = {
                        activityCode: t[r][o].code,
                        primaryTeachMethod: t[r][o].primaryTeachMethod,
                        sectionCode: t[r][o].sectionCode,
                        activityTitle: t[r][o].title,
                        campusEnDesc: "",
                        note: "created in current_courses.js",
                        courseCredits: t[r][o].courseCredits,
                        attendanceStatus: t[r][o].attendanceStatus,
                        cncAllowed: t[r][o].cncAllowed,
                        regSessionCode1: t[r][o].regSessionCode1,
                        regSessionCode2: t[r][o].regSessionCode2,
                        regSessionCode3: t[r][o].regSessionCode3,
                        sessionCode: t[r][o].sessionCode,
                        subSessionCode: t[r][o].subSessionCode,
                        sessionShortName: v.getSessionShortName(t[r][o]),
                        sessionOrder: v.getSessionOrder(t[r][o]),
                        withinSessionalDatesForCnc: t[r][o].isWithinSessionalDatesForCnc,
                        loadingCNCStatus: !1,
                        info: a.readCourse.getMappedActivities(s, t[r][o].primaryTeachMethod, r)
                    };
                    "APP" !== r && "REQ" !== r && "INT" !== r || (c.cncObj = D(c)),
                        n[r].push(c)
                }
            }
        return _(n)
    };
    e.getCoursesForStatus = function(t) {
        return [e.coursesObj[t]] || []
    }
    ;
    var P = [];
    e.getOrderedCourseStatuses = function() {
        return P
    }
        ,
        e.$on("CURRENT_COURSE_CNC_TOTAL_UPDATE", function(t, n) {
            e.cncInfo.currentAmount = "" === n ? 0 : n
        }),
        e.$on("ENROLMENT_INFO_READY", function() {
            var n = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession];
            e.session = n,
                e.cncInfo = {
                    campusType: C.getCampusType(n),
                    maxAmount: n.postOfferCncLimit
                };
            var i = {}
                , s = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession];
            i = a.readCourse.prepareCourseVariables(s, i),
                o.enroledCourses(i, function(t) {
                    e.loading = !1,
                        e.coursesObj = R(t),
                        A.setEnrolledCoursesAndProcess(t, s),
                        e.noCourses = c.isEmpty(e.coursesObj),
                        r.$broadcast("CURRENTLY_ENROLED_READY", e.coursesObj)
                }, function(n) {
                    e.errorMessage = "Unable to get currently enrolled courses. Please try to login again.",
                        r.$broadcast("CURRENTLY_ENROLED_NOT_READY", e.coursesObj),
                        t.error(n)
                })
        }),
        e.dropCourse = function(t) {
            return a.dropCourse(e, t)
        }
        ,
        e.dropCourseCheck = function(n, r) {
            s.setLastFocus();
            var i = function() {
                e.dropCourse(n).then(function() {
                    l.close()
                }, function(e) {
                    t.error(e)
                })
            }
                , o = function() {
                n.modifyControls = !0,
                    n.dropCourseTrigger = !1,
                    l.dismiss()
            }
                , c = r === !1 ? "Drop" : "Remove"
                , u = function() {
                l.init({
                    title: c + " " + n.activityCode + " " + n.sectionCode + " " + n.activityTitle,
                    cancelIconFunction: o,
                    message: d,
                    actions: {
                        main: {
                            title: c + " Course",
                            action: i
                        },
                        textControl: [{
                            title: "Cancel",
                            action: o
                        }]
                    }
                })
            }
                , d = "Are you sure you would like to " + c.charAt(0).toLowerCase() + c.slice(1) + " <strong>" + n.activityCode + " " + n.sectionCode + "</strong>?";
            S.isDomesticStudent().then(function(e) {
                if ("Drop" === c && e === !1) {
                    var t = O();
                    d += "<br/><br/>",
                        d += t
                }
                u()
            }),
                a.dropSave(e, n)
        }
        ,
        e.$on(p.EVENTS.DROPPED_COURSE_ALLOWED, function(e, t) {
            t.dropCourseTrigger = !0,
                t.modifyControls = !1
        }),
        e.$on(p.EVENTS.CURRENTLY_ENROLLED_FAILURE, function(e, t) {
            var n = angular.isObject(t) ? t.data || "Sorry, your enrolment failed." : "Sorry, your enrolment failed.";
            u.show({
                text: n,
                errorState: !0
            })
        }),
        e.$on(p.EVENTS.DROPPED_COURSE_FAILURE, function(e, t) {
            t.dropCourseTrigger = !1,
                t.modifyControls = !0
        }),
        e.$on(p.EVENTS.DROPPED_COURSE_SUCCESS, function(t, n) {
            n.dropCourseTrigger = !1,
                n.modifyControls = !0;
            for (var r = n.statusType, a = e.coursesObj[r].length, i = 0; i < a; i++)
                if (e.coursesObj[r][i].activityCode == n.activityCode && e.coursesObj[r][i].sectionCode == n.sectionCode) {
                    e.coursesObj[r].splice(i, 1);
                    break
                }
            0 == e.coursesObj[r].length && delete e.coursesObj[r],
                _(e.coursesObj),
                b(),
                e.noCourses = c.isEmpty(e.coursesObj)
        }),
        e.$on("ADD_TO_WAITLIST_CURRENTLY_ENROLED", function(t, n) {
            n.currentActivity.primaryActivity && (n.courseObj.info.primaryActivities = n.currentActivity.waitListActivities,
                n.courseObj.info.secondaryActivities = [],
                n.courseObj.info.thirdActivities = []),
                h.clearPrecedingDots(e.coursesObj),
                h.updatedArea(n.courseObj);
            for (var r = n.response.meetingSections.length, a = !1, i = 0; i < r; i++)
                "FAIL" == n.response.meetingSections[i].action && (a = !0,
                    n.courseObj.info.primaryActivities[i].failedToSave = !0);
            angular.isArray(e.coursesObj.WAIT) || (e.coursesObj.WAIT = []),
                L(e.coursesObj, "WAIT", n.courseObj),
                _(e.coursesObj),
                e.noCourses = c.isEmpty(e.coursesObj),
            a && alert("There was a failure to add the waitlist, please correct.")
        });
    var L = function(e, t, n) {
        var r = e[t];
        n.sessionOrder = v.getSessionOrder(n);
        for (var a in e)
            if (e.hasOwnProperty(a))
                for (var i = e[a].length, o = 0; o < i; o++)
                    if (e[a][o].activityCode === n.activityCode && e[a][o].sectionCode === n.sectionCode)
                        return e[a].splice(o, 1),
                            r.push(n),
                            void (0 === e[a].length && delete e[a]);
        r.push(n)
    };
    e.$on(p.EVENTS.CURRENTLY_ENROLLED_SUCCESS, function(t, n) {
        n.currentActivity.primaryActivity && (n.courseObj.info.primaryActivities = [n.currentActivity.primaryActivity]),
            n.currentActivity.secondaryActivity ? n.courseObj.info.secondaryActivities = [n.currentActivity.secondaryActivity] : n.courseObj.info.secondaryActivities = [],
            n.currentActivity.thirdActivity ? n.courseObj.info.thirdActivities = [n.currentActivity.thirdActivity] : n.courseObj.info.thirdActivities = [],
            n.courseObj.attendanceStatus = n.response.attendanceStatus,
            n.courseObj.statusType = n.response.status,
            n.courseObj.courseCredits = n.response.courseCredits,
            I(n.courseObj),
            h.clearPrecedingDots(e.coursesObj),
            h.updatedArea(n.courseObj);
        var r = angular.isDefined(n.response.status) ? n.response.status.toUpperCase() : "";
        angular.isArray(e.coursesObj[r]) || (e.coursesObj[r] = []),
            L(e.coursesObj, r, n.courseObj),
            _(e.coursesObj),
            e.noCourses = c.isEmpty(e.coursesObj)
    }),
        e.changeActivity = function(t, r) {
            s.setLastFocusUsingEvent(r),
                t.moreDetails = !t.moreDetails,
                t.currentCourse = {},
                t.eligibleRegistrations = e.eligibleRegistrations,
                t.enrolmentGlobalObj = e.enrolmentGlobalObj,
                t.courseSessionCode = t.regSessionCode1,
                a.readCourse.getCourseInfo(t).then(function() {
                    var t = n.open({
                        animation: !0,
                        templateUrl: "partials/enrolment/modalCourse.html",
                        controller: "ModalCourseCtrl",
                        scope: e,
                        windowClass: "modal-lg-acorn"
                    });
                    t.result.then(s.restoreLastFocus, s.restoreLastFocus),
                        t.rendered.then(function() {
                            s.setElemFocus("courseCodeAndTitle")
                        })
                })
        }
        ,
        e.removeCreditNoCredit = function(t) {
            var n = M[e.cncInfo.campusType] ? M[e.cncInfo.campusType].removeMessage : ""
                , r = {
                height: 300,
                title: "Remove Credit/No Credit for Course " + t.activityCode + " " + t.sectionCode + " " + t.activityTitle,
                message: "Once you have confirmed that you want to remove your Credit/No Credit declaration, your final grade in this course will appear on your academic record/transcript and count towards your GPA <br><br>" + n,
                classes: "creditNoCreditRemoveConfirmModal CNCModal",
                actions: {
                    textControl: [{
                        title: "Cancel",
                        action: function() {
                            l.dismiss()
                        }
                    }],
                    main: {
                        title: "Remove Credit/No Credit",
                        action: function() {
                            var n = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
                                , r = {
                                postCode: n.postInfo,
                                sessionCode: t.regSessionCode1,
                                code: t.activityCode,
                                sectionCode: t.sectionCode
                            };
                            o.removeCNC({}, r, function() {
                                l.close(),
                                    u.show({
                                        text: y(e.toolTip.removeCNC, t.activityCode, t.sectionCode, t.activityTitle, Number(e.cncInfo.currentAmount - t.courseCredits).toFixed(2), e.cncInfo.maxAmount),
                                        warningState: !0
                                    }),
                                    t.attendanceStatus = "",
                                    t.loadingCNCStatus = !1,
                                    b(),
                                angular.isObject(t.cncObj) && (t.cncObj.isCncCourse = !1)
                            }, function() {
                                u.show({
                                    text: e.toolTip.removeCNCError,
                                    errorState: !0
                                })
                            })
                        }
                    }
                }
            };
            return l.init(r),
                !0
        }
    ;
    var M = {
        ARTSC: {
            removeMessage: 'Refer to the <a target="_blank" href="http://www.artsci.utoronto.ca/current/forms-services/crncr">Arts and Sciences Credit/No Credit website<data-icon-ext-link></data-icon-ext-link></a> for more information.',
            addMessage: 'Refer to the <a target="_blank" href="http://www.artsci.utoronto.ca/current/forms-services/crncr">Arts and Sciences Credit/No Credit website<data-icon-ext-link></data-icon-ext-link></a> for more information.'
        },
        ARCLA: {
            removeMessage: 'Refer to the <a target="_blank" href="https://daniels.utoronto.ca/students/undergraduate-students/academics-and-registration">Architecture Credit/No Credit<data-icon-ext-link></data-icon-ext-link></a> for more information.',
            addMessage: 'Refer to the <a target="_blank" href="https://daniels.utoronto.ca/students/undergraduate-students/academics-and-registration">Architecture Credit/No Credit<data-icon-ext-link></data-icon-ext-link></a> for more information.'
        },
        SCAR: {
            removeMessage: 'Refer to the <a target="_blank" href="http://www.utsc.utoronto.ca/~registrar/current_students/credit_no_credit">UTSC Credit/No Credit website<data-icon-ext-link></data-icon-ext-link></a> for more information.',
            addMessage: 'Refer to the <a target="_blank" href="http://www.utsc.utoronto.ca/~registrar/current_students/credit_no_credit">UTSC Credit/No Credit website<data-icon-ext-link></data-icon-ext-link></a> for more information.'
        },
        ERIN: {
            removeMessage: 'Refer to the <a target="_blank" href="https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Credit%2FNo%20Credit">UTM Credit/No Credit<data-icon-ext-link></data-icon-ext-link></a> for more information.',
            addMessage: 'Refer to the <a target="_blank" href="https://student.utm.utoronto.ca/calendar/calendar_detail2.pl?Topic=Credit%2FNo%20Credit">UTM Credit/No Credit website<data-icon-ext-link></data-icon-ext-link></a> for more information.'
        }
    };
    e.notEnoughCNC = function(t) {
        var n = {
            title: "Cannot Add Credit/No Credit for Course " + t.activityCode + " " + t.sectionCode + " " + t.activityTitle,
            message: t.activityCode + t.sectionCode + " " + t.activityTitle + " cannot be assessed as Credit/No Credit because your CR/NCR count will exceed your limit of " + e.cncInfo.maxAmount,
            actions: {
                type: 2,
                main: {
                    title: "OK",
                    action: function() {
                        l.close()
                    }
                }
            }
        };
        l.init(n)
    }
        ,
        e.isCNCNotAvailable = function(e) {
            return e && (e.courseDoesNotAllowCNC || e.courseNotWithinSessionalDates || e.courseNotEligibleForCNC)
        }
        ,
        e.tooltipForCNCNotAvailable = function(t) {
            var n = "";
            return t ? (t.courseDoesNotAllowCNC && (n = e.toolTip.CNCNotAvailable),
            t.courseNotWithinSessionalDates && ("" !== n && (n += "<br/>"),
                n += e.toolTip.courseNotWithinSessionalDates),
            t.courseNotEligibleForCNC && ("" !== n && (n += "<br/>"),
                n += e.toolTip.notSufficientFCE),
                n) : n
        }
        ,
        e.isModifiable = function(t) {
            return "Y" === e.session.useSws && "REF" !== t.statusType && "DROP" !== t.statusType
        }
        ,
        e.isCreditNoCreditLoading = function(t, n) {
            return t.loadingCNCStatus && "Y" === e.session.postOfferCncAllowed && "WAIT" !== n
        }
        ,
        e.isCreditNoCreditLoaded = function(t, n) {
            return !t.loadingCNCStatus && "Y" === e.session.postOfferCncAllowed && "WAIT" !== n
        }
        ,
        e.checkCNCNotAvailableForRemove = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && t.cncObj.isCncCourse && t.cncObj.courseDoesNotAllowCNC && !t.cncObj.courseNotWithinSessionalDates
        }
        ,
        e.isCourseNotWithinSessionalDates = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && t.cncObj.isCncCourse && !t.cncObj.courseDoesNotAllowCNC && t.cncObj.courseNotWithinSessionalDates
        }
        ,
        e.canRemoveCreditNoCredit = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && t.cncObj.isCncCourse && !t.cncObj.courseDoesNotAllowCNC && !t.cncObj.courseNotWithinSessionalDates
        }
        ,
        e.checkCNCNotAvailableForAdd = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && !t.cncObj.isCncCourse && e.isCNCNotAvailable(t.cncObj)
        }
        ,
        e.canAddCreditNoCredit = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && !t.cncObj.courseNotEligibleForCNC && !t.cncObj.isCncCourse && !e.isCNCNotAvailable(t.cncObj)
        }
        ,
        e.isNotEnoughCNC = function(t, n) {
            return e.isCreditNoCreditLoaded(t, n) && t.cncObj.courseNotEligibleForCNC && !t.cncObj.isCncCourse && !e.isCNCNotAvailable(t.cncObj)
        }
        ,
        e.addCreditNoCredit = function(t) {
            var n = M[e.cncInfo.campusType] ? M[e.cncInfo.campusType].addMessage : ""
                , r = {
                height: 450,
                title: "Assess as Credit/No Credit for Course " + t.activityCode + " " + t.sectionCode + " " + t.activityTitle,
                message: 'Degree students may select up to <strong>2.0 full-course equivalents</strong> to be assessed on a Credit/No Credit basis.<br /><br /><p class="leftJustify">Note that:</p> <ul class="bulletList"><li> Courses with a final status of Credit (CR) or No Credit(NCR) do not affect the GPA</li><li>To achieve a final status of CR, students must pass the course (i.e. achieve a grade of 50% or higher).</li><li>CR courses will count towards Distribution/Breadth Requirements and degree credits, but cannot be used to satisfy Subject POSt/Program requirements.</li><li>CR/NCR is only open to degree students. Once you have graduated you may not complete courses on a CR/NCR basis even if you enrolled in the course before graduation.</li></ul>' + n,
                classes: "creditNoCreditConfirmModal CNCModal",
                actions: {
                    textControl: [{
                        title: "Cancel",
                        action: function() {
                            l.dismiss()
                        }
                    }],
                    main: {
                        title: "Assess as Credit/No Credit",
                        action: function() {
                            if (t.loadingCNCStatus !== !0) {
                                t.loadingCNCStatus = !0;
                                var n = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
                                    , r = {
                                    postCode: n.postInfo,
                                    sessionCode: t.regSessionCode1,
                                    code: t.activityCode,
                                    sectionCode: t.sectionCode
                                };
                                o.addCNC({}, r, function() {
                                    l.close(),
                                        u.show({
                                            text: e.toolTip.addCNC,
                                            successState: !0
                                        }),
                                        b(),
                                        t.loadingCNCStatus = !1,
                                        t.attendanceStatus = "CRE" == t.attendanceStatus ? "CNC" : "CNX",
                                    angular.isObject(t.cncObj) && (t.cncObj.isCncCourse = !0)
                                }, function(n) {
                                    t.loadingCNCStatus = !1,
                                        u.show({
                                            text: n.data || e.toolTip.addCNCError,
                                            errorState: !0
                                        })
                                })
                            }
                        }
                    }
                }
            };
            return l.init(r),
                !0
        }
        ,
        e.$watch("cncInfo.currentAmount", function() {
            for (var t in e.coursesObj)
                for (var n = e.coursesObj[t].length, r = 0; r < n; r++) {
                    var a = e.coursesObj[t][r];
                    angular.isObject(a.cncObj) && (a.cncObj.courseNotEligibleForCNC = !1,
                    parseFloat(e.cncInfo.currentAmount) + parseFloat(a.courseCredits) > parseFloat(e.cncInfo.maxAmount) && (a.cncObj.courseNotEligibleForCNC = !0))
                }
        }),
        e.$on(E.RESPONSIVE_RESIZE_EVENT, function() {
            e.$digest()
        }),
        e.toolTip = {
            courseNotWithinSessionalDates: "Course not within sessional date",
            CNCNotAvailable: "Credit / No Credit option not available for this course",
            notSufficientFCE: "Not sufficient full course equivalents",
            notEnoughCNC: "You do not have enough CR/NCR count for this action",
            removeCNC: "{0} {1} {2} will no longer be assessed as Credit/No Credit. Your CR/NCR count is now {3} of {4}",
            removeCNCError: "Unable to remove Credit/No Credit status",
            addCNC: "Assessed as Credit/No Credit",
            addCNCError: "Unable to assess as Credit/No Credit"
        },
        e.getAvailabilityForDisplay = m.getAvailabilityForDisplay
}
]),
angular.module("acornApp").constant("enrolmentEventsConstants", {
    UI_PANEL_REFRESH_EVENT: "enrolment.refresh.ui.event",
    DROPPED_LAST_COURSE_EVENT: "dropped.last.course.event"
}).controller("EnrolmentCtrl", ["$scope", "$q", "$log", "$routeParams", "$rootScope", "$http", "enrolmentConstantsService", "enrolmentServerResources", "acornCoreProperties", "DisplayCourseInfo", "utToast", "enrolmentEventsConstants", "eligibleRegistrations", "enrolmentManagerConstants", "acornCoreLib", "courseTabService", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f, g, m) {
    function h() {
        var e = t.defer();
        return s.getStartTimes(null, function(t) {
            N = t,
                e.resolve(t)
        }, function() {
            N = !1,
                e.reject(null)
        }),
            e.promise
    }
    function v() {
        return null === N && (N = h()),
            N
    }
    function C(e) {
        var t = e.sessionCode;
        return 2 === e.acpDuration && "1" === g.getUtilityLib().getCurrentSession().getSection() && (t = e.registrationSessions[1]),
            t
    }
    function y(e) {
        var n = t.defer()
            , r = C(e)
            , a = {
            primaryOrgCode: e.primaryOrgCode,
            secondaryOrgCode: e.secondaryOrgCode,
            levelOfInstruction: e.levelOfInstruction,
            yearOfStudy: e.yearOfStudy,
            sessionCode: r
        };
        s.getEnrolStatus(a, function(e) {
            O = e,
                n.resolve(O)
        }, function() {
            O = !1,
                n.reject(null)
        }),
            e.registrationSessions.length > 1 && "9" === r[4] ? (a.sessionCode = e.registrationSessions[1],
                s.getEnrolStatus(a, function(e) {
                    R = e,
                        P = !1,
                        n.resolve(R)
                }, function() {
                    R = !1,
                        P = !1,
                        n.reject(null)
                })) : (P = !1,
                R = !1)
    }
    function A() {
        var t = e.eligibleRegistrations[D];
        return t ? (null !== O || null !== R || P || (P = !0,
            O = y(t)),
        void 0 !== O && null !== O && void 0 !== R && null !== R && (e.enrolmentObject || (e.enrolmentObject = {
            enrolmentErrorCode: O.messageCode,
            enrolNotStarted: O.enrolNotStarted,
            nextEnrolmentErrorCode: void 0,
            nextEnrolNotStarted: void 0,
            courseInCart: !1,
            useSws: t.useSws
        },
        R && (e.enrolmentObject.nextEnrolmentErrorCode = R.messageCode,
            e.enrolmentObject.nextEnrolNotStarted = R.enrolNotStarted))),
            O) : O
    }
    function E() {
        return e.eligibleRegistrations[D]
    }
    function T(t) {
        function r(t) {
            void 0 !== t && t.hasOwnProperty("postInfo") ? (t.sessionDescription.indexOf("&nbsp;") > -1 && (t.sessionDescription = t.sessionDescription.replace("&nbsp;", " ")),
                e.session = {
                    campus: t.studentCampusCode,
                    primaryOrgCode: t.primaryOrgCode,
                    postInfo: t.postInfo.replace("  ", " "),
                    name: t.sessionDescription,
                    term: t.sessionDescription.split(" ")[1],
                    degree: t.post.description,
                    regStatus: t.status,
                    yearOfStudy: t.yearOfStudy,
                    courseWorkLoads: [],
                    perTerm: "",
                    postOfferCncAllowed: t.postOfferCncAllowed,
                    postOfferCncLimit: t.postOfferCncLimit,
                    creditNoCreditTotal: "",
                    useSws: t.useSws
                }) : e.session = {
                sessionNotFound: !0
            }
        }
        function a(e) {
            return {
                sessionYear: parseInt(e.substring(0, 4), 10),
                sessionMonth: parseInt(e.substring(e.length - 1, e.length), 10)
            }
        }
        function o(e) {
            var t = g[e]
                , n = t.sessionCode
                , r = [n]
                , i = a(n)
                , o = i.sessionYear;
            return 9 === i.sessionMonth && r.push(o + 1 + "1"),
                r
        }
        function c(e) {
            var t = f.SESSION_MAPPER
                , n = a(e);
            return n.sessionYear + " " + t[n.sessionMonth]
        }
        function l(t) {
            var r = g[t];
            if (!angular.isObject(r))
                return void n.warn("Expected Eligible Registration to be and object but got - ", r);
            for (var a = o(t), s = a.length, l = {
                primaryOrgCode: encodeURIComponent(r.primaryOrgCode),
                postCode: encodeURIComponent(r.post.code),
                sessionCodes: a
            }, u = "undefined" == typeof testBaseUrl ? "" : testBaseUrl, d = "primaryOrgCode=" + l.primaryOrgCode + "&postCode=" + l.postCode, p = 0; p < s; p++)
                d += "&sessionCodes=" + encodeURIComponent(a[p]);
            i({
                method: "GET",
                url: u.replace(/\\(.)/gm, "$1") + "/sws/rest/enrolment/term-course-loads?" + d,
                cache: !1
            }).then(function(t) {
                var n = t.data
                    , r = e.session.courseWorkLoads;
                r.length = 0;
                for (var a in n)
                    if (n.hasOwnProperty(a) && /^\d{5}$/.test(a)) {
                        var i = n[a];
                        i.sessionName = c(a);
                        var o = "";
                        o = "5" == a.charAt(a.length - 1) ? "View Workload Limits" : i.courseLoad < i.maxCourseLoad ? "Within Recommended Limit" : i.courseLoad == i.maxCourseLoad ? "At Recommended Limit" : "Over Recommended Limit",
                            i.description = o,
                            r.push(i)
                    }
            })
        }
        function u(t) {
            var n = g[t];
            if (angular.isObject(n)) {
                var r = {
                    candidacyPostCode: n.candidacyPostCode,
                    candidacySessionCode: n.candidacySessionCode
                };
                s.getCNCTotalCredits(r, function(t) {
                    if (angular.isDefined(t.value)) {
                        var n = Number(t.value).toFixed(2);
                        e.session.creditNoCreditTotal = n + " of " + e.session.postOfferCncLimit,
                            e.$broadcast("CURRENT_COURSE_CNC_TOTAL_UPDATE", n)
                    }
                }, function() {})
            }
        }
        function d() {
            u(D),
                l(D)
        }
        function p() {
            l(D)
        }
        var g = t;
        return function() {
            angular.isArray(g) && r(g[D])
        }(),
            this.refreshAll = d,
            this.setDisplayInfo = r,
            this.refreshCourseLoadForRegistration = p,
            this
    }
    function S(e) {
        a.$broadcast("ENROLMENT_INFO_READY", e)
    }
    function w(t) {
        e.notLoggedIn = t
    }
    function b(e, t) {
        return "Summer" == e ? "indicator highlight" : t.courseLoad < t.maxCourseLoad ? "indicator good highlight" : t.courseLoad == t.maxCourseLoad ? "indicator ok highlight" : t.courseLoad > t.maxCourseLoad ? "indicator warn highlight" : void 0
    }
    function _() {
        function e() {
            return o.getTodaysDate()
        }
        var t = {
            week: {
                url: "/sws/timetable/main.do?main.dispatch#/calendar/view/agendaWeek/alias/COURSES/" + e()
            }
        };
        this.getTodaysDate = e(),
            this.getCurrentWeekUrl = function() {
                return t.week.url
            }()
    }
    e.notification = "Your enrolment start time for Fall/Winter 2013-2014 is 11:00 AM EST. Monday, July 14th, 2014";
    var D = r.sessionID ? r.sessionID : 0
        , I = null
        , N = null
        , O = null
        , R = null
        , P = !1;
    m.setCurrentTabIndex(D),
        e.enrolmentGlobalObj = {
            currentSession: D
        },
        e.notLoggedIn = !1,
        e.noDataToShow = !1,
        e.sessions = [],
        e.eligibleRegistrations = [],
        e.getStartTimes = v,
        e.getEnrolStatus = A,
        e.getCurrentEligibleRegistration = E,
        this.determinePertinentRegSessionCode = C;
    var L = [p.init().then(function(t) {
        e.eligibleRegistrations = t,
            p.setCurrentSession(D),
            I = new T(t),
            I.refreshAll();
        for (var n = t.length, r = 0; r < n; r++)
            null !== t[r].sessionDescription && t[r].sessionDescription.indexOf("&nbsp;") > -1 && (t[r].sessionDescription = t[r].sessionDescription.replace("&nbsp;", " ")),
                e.sessions.push({
                    postInfo: t[r].postInfo.replace("  ", " "),
                    session: t[r].sessionDescription,
                    degree: t[r].post.description
                })
    }), function() {
        var n = t.defer();
        return e.$on("COURSE_CONTROL_LOADED", function() {
            n.resolve("Controller ready")
        }),
            e.$on(d.UI_PANEL_REFRESH_EVENT, function() {
                I.refreshAll()
            }),
            n.promise
    }(), function() {
        var n = t.defer();
        return e.$on("PLAN_CONTROL_LOADED", function() {
            n.resolve("Plan controller ready")
        }),
            n.promise
    }()];
    t.all(L).then(function(t) {
        e.session.hasOwnProperty("sessionNotFound") ? e.loadingError = "Invalid session information.  Please try logging in again." : (e.readyDashboard = !0,
            S(t))
    }, function(t) {
        "No enrolment information found." === t ? (e.loadingError = t,
            n.error(t)) : (w(t),
            e.noDataToShow = !0)
    }),
        e.configureWorkloadTooltip = function(t) {
            var n = e.session.primaryOrgCode
                , r = c.getCourseWorkloadMessage(n, t.sessionName)
                , a = void 0;
            return void 0 != r && (a = {
                messages: r
            }),
            {
                tooltip: a,
                highlight: b(e.session.term, t)
            }
        }
        ,
        e.$on("ENROLMENT_INFO_READY", function() {
            var t = e.session.primaryOrgCode
                , n = c.getCreditNoCreditMessage(t);
            e.creditNoCreditTooltipMessage = void 0 == n ? n : {
                messages: n
            }
        }),
        e.$on("NOT_LOGGED_IN", function(e, t) {
            w(t)
        }),
        e.$on("COURSE_ENROLMENT_END_REG", function() {
            e.readyDashboard = !0,
                e.loadingError = "No enrolment information found."
        }),
        e.$on("COURSE_ENROLMENT_PARTIAL_END_REG", function() {
            e.readyDashboard = !0,
                e.loadingError = "Enrolment status has been updated."
        }),
        e.refreshTermCourseLoad = function() {
            I && I.refreshCourseLoadForRegistration()
        }
        ,
        e.CalendarManager = new _,
        document.title = "Courses"
}
]),
angular.module("acornApp").constant("ModalCourseConstants", {
    EVENTS: {
        SHOW_MODAL: "MODAL_COURSE_CTRL_SHOW",
        PLANNED_SECTION_CANCELLED: "MODAL_COURSE_PLANNED_SECTION_CANCELLED",
        HIDE_MODAL: "MODAL_COURSE_CTRL_HIDE",
        MODAL_ERROR: "MODAL_COURSE_CTRL_ERROR"
    },
    WARNING_CATEGORIES: {
        COURSE_STATUS: "Course Status",
        COURSE_REQUISITES: "Course Requisites",
        TIMETABLE_CONFLICTS: "Timetable Conflicts"
    }
}).controller("ModalCourseCtrl", ["$scope", "$rootScope", "$q", "$timeout", "$log", "$uibModalInstance", "CourseCRUD", "utToast", "WaitlistCRUD", "PlanCRUD", "utConfirmation", "acornCoreLib", "acornCoreProperties", "ModalCourseConstants", "planManager", "SpaceUnavailable", "PreReqChecks", "TimetableConflict", "EnrolmentMessageService", "CourseStatus", "SessionAssignment", "Warnings", "modalCourseData", "eligibleRegistrations", "enrolmentInfoConstant", "eventConstants", "CourseCRUDConstants", "enrolmentSpaceConstants", "strformat", "enrolmentIndicatorService", "acornToast", "acornToastConstants", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f, g, m, h, v, C, y, A, E, T, S, w, b, _, D, I, N, O, R) {
    function P() {
        j && j.cancel("cancel CourseStatus check"),
        V && V.cancel("cancel Requisite check"),
        H && H.cancel("cancel TimetableConflict check")
    }
    function L(e) {
        return angular.element(e.currentTarget).hasClass("disabled")
    }
    function M(t) {
        if (t && t.event) {
            var n, r;
            t.event === _.EVENTS.SHOW_FAILED_FULL_REG ? (t.successData.messages.errors ? (t.successData.messages.errors.forEach(function(e) {
                s.show({
                    text: e,
                    errorState: !0
                })
            }),
                e.modalCourse.interModalNotificationsTop = !1) : (e.modalCourse.interModalNotificationsTop = {
                baseInfo: t.baseInfo,
                modalControlObj: t.modalControlObj
            },
                angular.element(".modal-body").scrollTop(0)),
                J(e),
                o.readCourse.getSingleCourseInfo(e, function(e) {
                    for (e.status.actionHappening = !1,
                             e.modalCourse.modifyActivity = !0,
                             e.currentCourse.enroled = !0,
                             e.currentCourse.statusType = t.successData.responseObject.status,
                             e.originallySelectedActivities = [],
                             U(),
                             n = 0; n < e.currentCourse.info.secondaryActivities.length; n++)
                        if (r = e.currentCourse.info.secondaryActivities[n],
                                r.joinedActivity) {
                            e.currentActivity.secondaryActivity = r;
                            break
                        }
                    for (n = 0; n < e.currentCourse.info.thirdActivities.length; n++)
                        if (r = e.currentCourse.info.thirdActivities[n],
                                r.joinedActivity) {
                            e.currentActivity.thirdActivity = r;
                            break
                        }
                    e.setOriginallySelectedActivity(!1)
                })) : t.event === _.EVENTS.PRIMARY_ENROLLED_FAILURE && (t.successData.messages.errors && t.successData.messages.errors.forEach(function(e) {
                s.show({
                    text: e,
                    errorState: !0
                })
            }),
                Z(e),
                o.readCourse.getSingleCourseInfo(e, function(e) {
                    if (e.status.actionHappening = !1,
                            e.modalCourse.modifyActivity = !!e.currentCourse.statusType,
                            e.currentCourse.statusType) {
                        for (n = 0; n < e.currentCourse.info.primaryActivities.length; n++)
                            if (r = e.currentCourse.info.primaryActivities[n],
                                    r.joinedActivity) {
                                if (e.currentActivity.primaryActivity = r,
                                    "WAIT" !== e.currentCourse.statusType)
                                    break;
                                r.waitlistable = !0
                            }
                        for (n = 0; n < e.currentCourse.info.secondaryActivities.length; n++)
                            if (r = e.currentCourse.info.secondaryActivities[n],
                                    r.joinedActivity) {
                                e.currentActivity.secondaryActivity = r;
                                break
                            }
                        for (n = 0; n < e.currentCourse.info.thirdActivities.length; n++)
                            if (r = e.currentCourse.info.thirdActivities[n],
                                    r.joinedActivity) {
                                e.currentActivity.thirdActivity = r;
                                break
                            }
                        e.setOriginallySelectedActivity("WAIT" === e.currentCourse.statusType)
                    } else {
                        for ($(),
                                 n = 0; n < e.currentCourse.info.secondaryActivities.length; n++)
                            if (r = e.currentCourse.info.secondaryActivities[n],
                                e.currentActivity.secondaryActivity.activityId === r.activityId) {
                                r.joinedActivity = !0;
                                break
                            }
                        for (n = 0; n < e.currentCourse.info.thirdActivities.length; n++)
                            if (r = e.currentCourse.info.thirdActivities[n],
                                e.currentActivity.thirdActivity.activityId === r.activityId) {
                                r.joinedActivity = !0;
                                break
                            }
                    }
                    q(e.currentActivity)
                }))
        } else
            a.error(t)
    }
    function k(e) {
        for (var t = e.length, n = [], r = 0; r < t; r++)
            e[r].checkedStatus && e[r].waitlistable && n.push({
                teachMethod: e[r].teachMethod,
                sectionNo: e[r].sectionNo
            });
        return n
    }
    function F(e) {
        return A.getSessionShortName(e)
    }
    function x(t, n) {
        e.enrolmentObject && (e.enrolmentObject.showActivityNotAvailable = !1);
        var r = void 0 !== n;
        if (e.enrolmentObject = {
                enrolmentErrorCode: t.currentCourse.enrolmentErrorCode,
                enrolNotStarted: t.currentCourse.enrolNotStarted,
                courseInCart: r
            },
            e.currentCourse.hasOwnProperty("enrolmentErrorMessage") && null !== e.currentCourse.enrolmentErrorMessage && e.currentCourse.enrolmentErrorMessage.length > 0) {
            e.modalCourse.cannotEnrol = !0,
                e.modalCourse.enrolmentErrorMessage = t.currentCourse.enrolmentErrorMessage,
                e.modalCourse.enrolmentErrorCode = t.currentCourse.enrolmentErrorCode,
                e.modalCourse.enrolmentErrorCodeSuffix = t.currentCourse.enrolmentErrorCodeSuffix,
                e.modalCourse.enrolNotStarted = t.currentCourse.enrolNotStarted,
                e.modalCourse.enrolEnded = t.currentCourse.enrolEnded,
                e.infoMsg = null;
            var a = C.getTooltip(e.enrolmentObject);
            e.enrolTooltip = {
                messages: a.enrol
            },
                e.waitlistTooltip = {
                    messages: a.waitlist
                }
        } else {
            var i = t.currentCourse.info.primaryActivities && t.currentCourse.info.primaryActivities.length
                , o = t.currentCourse.info.secondaryActivities && t.currentCourse.info.secondaryActivities.length
                , s = t.currentCourse.info.thirdActivities && t.currentCourse.info.thirdActivities.length;
            i || !o && !s || (e.enrolmentObject.showActivityNotAvailable = !0)
        }
        e.modalCourse.planningAllowed = !!t.currentCourse.planningAllowed,
            e.modalCourse.planningStartDate = t.currentCourse.planningStartDate,
            e.modalCourse.planningEndDate = t.currentCourse.planningEndDate,
            e.modalCourse.planErrorCode = t.currentCourse.planErrorCode,
            e.modalCourse.enroled = t.currentCourse.enroled,
            e.modalCourse.isFromPlan = n,
            e.modalCourse.courseDivision = {
                primaryOrgCode: t.currentCourse.activityPrimaryOrgCode,
                secondaryOrgCode: t.currentCourse.activitySecondaryOrgCode
            },
        e.enrolmentObject && (e.enrolmentObject.planErrorCode = e.modalCourse.planErrorCode,
            e.enrolmentObject.planningAllowed = e.modalCourse.planningAllowed,
            e.enrolmentObject.planningStartDate = e.modalCourse.planningStartDate,
            e.enrolmentObject.planningEndDate = e.modalCourse.planningEndDate)
    }
    function U() {
        if (angular.isObject(e.currentCourse) && angular.isObject(e.currentCourse.info)) {
            for (var t = e.currentCourse.info.primaryActivities, n = 0; n < t.length; n++)
                t[n].checkedStatus && e.originallySelectedActivities.push(t[n].activityId);
            if ("WAIT" !== e.currentCourse.statusType) {
                for (var r = e.currentCourse.info.secondaryActivities, a = 0; a < r.length; a++)
                    r[a].checkedStatus && e.originallySelectedActivities.push(r[a].activityId);
                for (var i = e.currentCourse.info.thirdActivities, o = 0; o < i.length; o++)
                    i[o].checkedStatus && e.originallySelectedActivities.push(i[o].activityId)
            }
        }
    }
    function $() {
        for (var t = e.currentCourse.info, n = -1, r = !1, a = 0; a < t.primaryActivities.length; a++)
            if (n < 0 && t.primaryActivities[a].waitlistable && !t.primaryActivities[a].cancelled && (n = a),
                t.primaryActivities[a].spaceLeft > 0 && !t.primaryActivities[a].cancelled) {
                r = !0,
                e.modalCourse.isPlannedItem || (t.primaryActivities[a].joinedActivity = !0),
                    e.currentActivity.primaryActivity = t.primaryActivities[a],
                    e.currentCourse.primaryActivityIndex = a,
                    t.primaryActivities[a].hasSubTitle ? e.selectedActivitySubtitle = t.primaryActivities[a].subTitle : e.selectedActivitySubtitle = "";
                break
            }
        n >= 0 && !r && (t.primaryActivities[n].checkedStatus = !0,
            e.currentActivity.primaryActivity = t.primaryActivities[n],
            e.currentCourse.primaryActivityIndex = n,
            e.currentActivity.waitListActivities = [],
            e.currentActivity.waitListActivities.push(t.primaryActivities[n]),
            t.primaryActivities[n].hasSubTitle ? e.selectedActivitySubtitle = t.primaryActivities[n].subTitle : e.selectedActivitySubtitle = "")
    }
    var G = void 0;
    e.selectedActivitySubtitle = "",
        e.activitySubtitles = {},
        e.enrolmentInfoConstant = w,
        e.status = {},
        e.originallySelectedActivities = [];
    var j = null
        , V = null
        , H = null;
    e.initModalCourse = function() {
        e.selectedActivitySubtitle = "",
            e.activitySubtitles = {},
            e.modalCourse = {
                waitlistAvailabilityTooltip: C.getWaitlistHeaderTooltip(),
                display: !1,
                waitlist: !1,
                waitlistContext: !1,
                enrolContext: !1,
                removeCourse: !1,
                showRemovalButton: !1,
                modifyActivity: !1,
                waitlistArray: [],
                showPrereqs: !1,
                interModalNotificationsTop: !1,
                interModalNotificationsBottom: !1,
                waitlistExpand: !0,
                cannotEnrol: !1,
                enrolNotStarted: !1,
                enrolEnded: !1,
                isFromPlan: !1
            },
            e.enrolTooltip = {},
            e.waitlistTooltip = {}
    }
    ;
    var W = function(t) {
        e.modalCourse.modifyActivity = t.currentCourse.enroled
    }
        , B = function(e) {
        for (var t = e.length, n = 0; n < t; n++)
            if (e[n].joinedActivity)
                return e[n];
        return ""
    }
        , Y = function(e, t) {
        for (var n = e.length, r = 0; r < n; r++)
            if (e[r].hasSubTitle) {
                var a = e[r].activityId;
                t[a] = {
                    messages: e[r].subTitle
                }
            }
        return ""
    }
        , q = function(t) {
        t.currentActivity.primaryActivity = B(t.currentCourse.info.primaryActivities),
            t.currentActivity.secondaryActivity = B(t.currentCourse.info.secondaryActivities),
            t.currentActivity.thirdActivity = B(t.currentCourse.info.thirdActivities),
            Y(t.currentCourse.info.primaryActivities, e.activitySubtitles),
            Y(t.currentCourse.info.secondaryActivities, e.activitySubtitles),
            Y(t.currentCourse.info.thirdActivities, e.activitySubtitles)
    };
    e.disableInvalidActivity = function(e, t) {
        angular.isObject(e) && angular.isObject(t) && (e.readOnlyMode = 0 === e.spaceLeft || t.enrolmentErrorCode === w.NOT_ALLOWED || e.closed)
    }
        ,
        e.getSpaceAvailabilityMessage = function(t, n, r) {
            var a = n.full || n.enrollmentControlFull
                , i = n.teachMethod === t.primaryTeachMethod;
            return e.enrolledInActivity(t, n, r) ? a ? D.ENROLLED_FULL : I(D.ENROLLED_SPACE_AVAILABLE, n.spaceLeft || 0, n.spaceTotal) : n.readOnlyMode === !1 ? I(D.AVAILABLE, n.spaceLeft || 0, n.spaceTotal) : n.readOnlyMode && n.cancelled ? D.CANCELLED : n.readOnlyMode && a && n.waitlistable === !1 && i ? D.SECTION_FULL_NO_WAIT : n.readOnlyMode && a ? D.SECTION_FULL : (n.indicator || (n.indicator = {}),
                n.indicator.messages = N.getInidcatorMessage(t.activityPrimaryOrgCode, n.enrolmentIndicatorMsg, n.enrolmentIndicatorDates),
                n.enrolmentIndicatorDisplay && n.indicator && "SCAR" !== t.activityPrimaryOrgCode ? I(D.INDICATOR, n.enrolmentIndicatorDisplay) : D.BLOCKED)
        }
        ,
        e.isActivityDisabled = function(t) {
            return !(e.isPlannable(t) && !t.enroled) && (t.readOnlyMode || e.enrolledInActivity(e.currentCourse, t, e.currentActivity.isPlannedItem))
        }
        ,
        e.isPlannable = function(t) {
            return t && !t.cancelled && !t.closed && !T.isPlannedItem && e.modalCourse.planningAllowed && e.currentCourse.enrolmentErrorCode !== w.NOT_ALLOWED
        }
        ,
        e.enrolledInActivity = function(e, t, n) {
            return e.statusType && t.joinedActivity && !n
        }
        ,
        e.enrolFromPlannedCourse = function(t) {
            if (e.currentPlanCourse && e.currentPlanCourse.primaryActivity && e.currentPlanCourse.primaryActivity.length > 0 && e.currentPlanCourse.primaryActivity[0].waitlistable) {
                var n = g.getCurrentCourseBasedOnPlan(e.currentCourse, e.planCourse);
                e.currentCourse.info = {
                    primaryActivities: n.primaryActivity,
                    secondaryActivities: [],
                    thirdActivities: []
                },
                    e.joinWaitList(t)
            } else
                e.currentActivity = g.getCurrentCourseBasedOnPlanNonArray(e.currentCourse, e.planCourse),
                    e.enrolInCourse(t, !0)
        }
        ,
        e.addToPlan = function(t, n, a) {
            if (!L(t))
                if (e.status.actionHappening = !0,
                        a.primaryActivity) {
                    var o = n.activityCode;
                    a.messages = E.getWarningsForCourse(o),
                        l.addCourseToPlan(e, n, a).then(function() {
                            i.close()
                        }, function(e) {
                            if (e.PLAN_DUPLICATE || e.PLANS_EXCEEDING_MAX) {
                                var t;
                                e.PLAN_DUPLICATE ? t = d.getPropertiesLib().interpolatePropertyStringWithArgs(p.getEnrolmentProperties().messages.toasts.plans.COURSE_EXISTS, [n.activityCode + " " + n.sectionCode, n.activityTitle]) : e.PLANS_EXCEEDING_MAX && (t = d.getPropertiesLib().interpolatePropertyStringWithArgs(p.getEnrolmentProperties().messages.toasts.plans.PLANS_EXCEEDING_MAX, [w.PLAN_MAX_COUNT, "this"])),
                                    s.show({
                                        text: t,
                                        infoState: !0
                                    })
                            } else
                                e.PLAN_INVALID && O.showToast({
                                    message: "The course is not allowed to be added to the enrolment cart.",
                                    type: R.TYPE_WARNING
                                });
                            i.close()
                        })
                } else
                    r(function() {
                        e.status.actionHappening = !1
                    }, 0)
        }
        ,
        e.modifyPlan = function(t, n, a) {
            if (!L(t))
                if (e.status.actionHappening = !0,
                        a.primaryActivity) {
                    var o = n.activityCode;
                    a.messages = E.getWarningsForCourse(o),
                        l.updateCourseInPlan(e, n, a).then(function() {
                            i.close()
                        }, function(e) {
                            if (e.PLAN_DUPLICATE || e.PLAN_FAILED) {
                                var t;
                                e.PLAN_DUPLICATE ? t = d.getPropertiesLib().interpolatePropertyStringWithArgs(p.getEnrolmentProperties().messages.toasts.plans.COURSE_EXISTS, [n.activityCode + " " + n.sectionCode, n.activityTitle]) : e.PLAN_FAILED && (t = d.getPropertiesLib().interpolatePropertyStringWithArgs(p.getEnrolmentProperties().messages.toasts.plans.UPDATE_FAILED, [n.activityCode + " " + n.sectionCode, n.activityTitle])),
                                    s.show({
                                        text: t,
                                        infoState: !0
                                    })
                            }
                            i.close()
                        })
                } else
                    r(function() {
                        e.status.actionHappening = !1
                    }, 0)
        }
        ,
        e.enrolInCourse = function(t, n) {
            L(t) || (e.status.actionHappening = !0,
                e.currentActivity.primaryActivity ? o.addCourse(e, n).then(function() {
                    e.refreshTermCourseLoad(),
                        i.close()
                }, M) : r(function() {
                    e.status.actionHappening = !1
                }, 0))
        }
        ,
        e.modifyCourse = function(t) {
            L(t) || (e.status.actionHappening = !0,
                o.updateCourse(e).then(function() {
                    i.close()
                }, M))
        }
        ,
        e.setActive = function(t, n, r) {
            var a = n.length;
            e.currentActivity.waitListActivities = [];
            for (var i = 0; i < a; i++)
                n[i].checkedStatus && n[i].waitlistable && e.currentActivity.waitListActivities.push(n[i]);
            e.currentActivity.primaryActivity = t,
                e.currentCourse.primaryActivityIndex = r
        }
        ,
        e.setChecked = function(e) {
            e.checkedStatus = !e.checkedStatus
        }
        ,
        e.joinWaitList = function(t) {
            if (!L(t)) {
                e.status.actionHappening = !0;
                var n = k(e.currentCourse.info.primaryActivities);
                null === e.currentCourse.waitlistMeetings && e.currentCourse.enroled ? c.addToWaitlistFromEnroled(e, n).then(function() {
                    i.close()
                }, function(e) {
                    a.error(e)
                }) : c.addToWaitlist(e, n).then(function() {
                    i.close()
                }, function(e) {
                    a.error(e)
                })
            }
        }
        ,
        e.cancel = function() {
            e.modalCourse.display = !1,
            void 0 !== G && (document.getElementById("enrolFromPlan").className = G),
                P(),
                i.dismiss("cancel")
        }
        ,
        e.waitlistable = function(t) {
            return t.waitlistable && (e.modalCourse.waitlist = !0),
                t.waitlistable
        }
        ,
        e.notWaitlistable = function(t) {
            return !e.waitlistable(t) || "WAIT" !== e.currentCourse.statusType && angular.isDefined(e.modalCourse.oldCourse) && e.modalCourse.oldCourse.activityId === t.activityId
        }
        ,
        e.isSwitchingToWaitlistActivity = function(t) {
            var n = angular.isDefined(e.modalCourse.oldCourse) ? e.modalCourse.oldCourse : null;
            return n && t && !n.waitlistable && t.waitlistable && !e.notWaitlistable(t)
        }
    ;
    var z = function(t) {
        e.modalCourse.removeCourse = !1;
        for (var n = t.length, r = !1, a = 0; a < n; a++)
            t[a].checkedStatus && (r = !0),
                t[a].checkedStatus = !1;
        return e.modalCourse.waitlistContext = !0,
        r && e.currentActivity.primaryActivity.waitlistable && (e.currentActivity.primaryActivity = null,
            e.currentCourse.primaryActivityIndex = null),
            !0
    };
    e.activitySelected = function(t, n, r) {
        e.isActivityDisabled(t) || ("PRI" === r ? (e.currentActivity.primaryActivity = t,
            e.currentCourse.primaryActivityIndex = n) : "SEC" === r ? (e.currentActivity.secondaryActivity = t,
            e.currentCourse.secondaryActivityIndex = n) : "TER" === r && (e.currentActivity.thirdActivity = t,
            e.currentCourse.thirdActivityIndex = n),
            t.hasSubTitle ? e.selectedActivitySubtitle = t.subTitle : e.selectedActivitySubtitle = "",
            z(e.currentCourse.info.primaryActivities)),
            e.setOriginallySelectedActivity(!1)
    }
    ;
    var K = function() {
        e.currentActivity.secondaryActivity = "",
            e.currentCourse.secondaryActivityIndex = null,
            e.currentActivity.thirdActivity = "",
            e.currentCourse.thirdActivityIndex = null
    }
        , X = function() {
        for (var t = angular.element('.courseResultForm input[type="radio"]'), n = t.length, r = 0; r < n; r++)
            t[r].checked = !1;
        var a, i = e.currentCourse.info.primaryActivities.length;
        for (a = 0; a < i; a++)
            e.currentCourse.info.primaryActivities[a].waitlistable || (e.currentCourse.info.primaryActivities[a].checkedStatus = !1);
        e.modalCourse.enrolContext = !0;
        var o = angular.element('.courseResultForm input[type="checked"]')
            , s = o.length
            , c = !1;
        for (a = 0; a < s; a++)
            o[a].checked && (c = !0);
        return c && (e.currentActivity.primaryActivity = null,
            e.currentCourse.primaryActivityIndex = null),
            !0
    };
    e.waitlistSelected = function(t, n) {
        K(),
            e.setChecked(t),
            e.setActive(t, e.currentCourse.info.primaryActivities, n),
            X(e.currentCourse.info.primaryActivities),
            e.checkIfDelete(e.currentCourse.info.primaryActivities),
            e.setOriginallySelectedActivity(!0)
    }
        ,
        e.checkIfDelete = function(t) {
            var n = t.length;
            e.modalCourse.removeCourse = !0,
                e.modalCourse.showRemovalButton = !1;
            for (var r = 0; r < n; r++) {
                if (t[r].checkedStatus)
                    return void (e.modalCourse.removeCourse = !1);
                t[r].joinedActivity && (e.modalCourse.showRemovalButton = !0)
            }
        }
        ,
        e.removeCourse = function() {
            var t = function() {
                e.dropCourse(e.currentCourse).then(function() {
                    i.close()
                }, function(e) {
                    a.error(e)
                })
            }
                , n = function() {
                e.status.actionHappening = !1,
                    e.currentCourse.modifyControls = !0,
                    e.currentCourse.dropCourseTrigger = !1,
                    u.dismiss()
            }
                , r = "Are you sure you would like to remove <strong>" + e.currentCourse.activityCode + " " + e.currentCourse.sectionCode + "</strong>?";
            u.init({
                title: "Remove course",
                message: r,
                cancelIconFunction: n,
                actions: {
                    main: {
                        title: "Remove course",
                        action: t
                    },
                    textControl: [{
                        title: "cancel",
                        action: n
                    }]
                }
            }),
                o.dropSave(e, e.currentCourse)
        }
        ,
        e.dropCourse = function(t) {
            return o.dropCourse(e, t)
        }
        ,
        e.getCourseWarningsLoadingMessage = function() {
            return void 0 === e.currentCourse || void 0 === e.currentCourse.activityCode ? void 0 : E.getStatsMessageForCourse(e.currentCourse.activityCode)
        }
        ,
        e.getCourseWarnings = function() {
            if (void 0 !== e.currentCourse && void 0 !== e.currentCourse.activityCode) {
                var t = e.currentCourse.activityCode;
                return E.getWarningsForCourse(t)
            }
        }
    ;
    var Q = function(t) {
        if (void 0 === e.currentCourse || void 0 === e.currentCourse.activityCode)
            return [];
        var n = e.currentCourse.activityCode;
        E.initializeCourseCategories(n, [f.WARNING_CATEGORIES.COURSE_STATUS, f.WARNING_CATEGORIES.COURSE_REQUISITES, f.WARNING_CATEGORIES.TIMETABLE_CONFLICTS]),
            e.courseWarningStats = null,
            function() {
                var n = e.currentCourse.activityCode
                    , r = e.currentCourse.sessionCode;
                j = y.check(e.currentCourse, t),
                    j.then(function(t) {
                        e.currentCourse.currentStatusMessage = t,
                            E.registerSuccessForCourse(n, f.WARNING_CATEGORIES.COURSE_STATUS),
                            e.courseWarningStats = E.getStatsForCourse(n)
                    }, function(t) {
                        t === "Invalid Message for currentCourse: " + n ? E.registerSuccessForCourse(n, f.WARNING_CATEGORIES.COURSE_STATUS) : E.registerFailureForCourse(n, f.WARNING_CATEGORIES.COURSE_STATUS),
                            e.courseWarningStats = E.getStatsForCourse(n)
                    }),
                    V = h.check(n, r),
                    V.then(function(t) {
                        if (angular.isArray(t))
                            for (var r = 0; r < t.length; r++) {
                                var a = t[r];
                                E.storeWarningForCourse(n, f.WARNING_CATEGORIES.COURSE_REQUISITES, a)
                            }
                        return E.registerSuccessForCourse(n, f.WARNING_CATEGORIES.COURSE_REQUISITES),
                            e.courseWarningStats = E.getStatsForCourse(n),
                            t
                    }, function() {
                        E.registerFailureForCourse(n, f.WARNING_CATEGORIES.COURSE_REQUISITES),
                            e.courseWarningStats = E.getStatsForCourse(n)
                    }),
                    H = function() {
                        if (angular.isObject(e.planCourse)) {
                            var t;
                            for (var n in e.planCourse.info) {
                                var r = 0
                                    , a = e.currentCourse.info[n];
                                if (t = [],
                                    angular.isArray(a) && 0 !== a.length) {
                                    for (var i = 0; i < a.length; i++) {
                                        var o = a[r++]
                                            , s = a[i];
                                        s.activityId === o.activityId && t.push(s)
                                    }
                                    e.currentCourse.info[n] = t
                                }
                            }
                        }
                        return v.check(e.currentCourse)
                    }(),
                    H.then(function(t) {
                        return t && E.mergeTimeTableConflictsWithCurrentCourse(t, e.currentCourse),
                            E.registerSuccessForCourse(n, f.WARNING_CATEGORIES.TIMETABLE_CONFLICTS),
                            e.courseWarningStats = E.getStatsForCourse(n),
                            t
                    }, function(t) {
                        "no conflicts after all" === t ? E.registerSuccessForCourse(n, f.WARNING_CATEGORIES.TIMETABLE_CONFLICTS) : E.registerFailureForCourse(n, f.WARNING_CATEGORIES.TIMETABLE_CONFLICTS),
                            e.courseWarningStats = E.getStatsForCourse(n)
                    })
            }()
    }
        , J = function(e) {
        e.currentActivity.secondaryActivity = {},
            e.currentActivity.thirdActivity = {}
    }
        , Z = function(e) {
        e.currentActivity.primaryActivity = {}
    }
        , ee = function() {
        if (e.hasOwnProperty("currentCourse"))
            for (var t = e.currentCourse.info.primaryActivities.length, n = 0; n < t; n++)
                if (e.currentCourse.info.primaryActivities[n].waitlistable && e.currentCourse.info.primaryActivities[n].checkedStatus)
                    return !0;
        return !1
    }
        , te = function() {
        for (var e = angular.element('.courseResultForm input[type="radio"]'), t = e.length, n = 0; n < t; n++)
            if (e[n].checked)
                return !0;
        return !1
    }
        , ne = function() {
        return e.modalCourse.oldCourse
    };
    e.showWaitListLeaving = function() {
        return ne() && !ee() && !te()
    }
        ,
        e.showSwitchingActivity = function() {
            return ne() && te() && !ee()
        }
        ,
        e.isEnrolmentControlled = function(e) {
            return angular.isObject(e) && "E" === e.waitlistLookupMethod
        }
        ,
        e.getCourseDivision = function() {
            return e.modalCourse.courseDivision
        }
        ,
        e.getEnrolmentCartButtonStateClasses = function() {
            return e.isPlannable(e.currentActivity.primaryActivity) ? "active" : "disabled"
        }
        ,
        e.getEnrolButtonStateClasses = function() {
            return !e.currentActivity.primaryActivity || e.modalCourse.cannotEnrol || e.currentActivity.primaryActivity.readOnlyMode ? "disabled" : "active"
        }
        ,
        e.canShowModalBodyNotices = function() {
            var t = e.enrolmentObject && e.enrolmentObject.showActivityNotAvailable;
            return e.currentCourse.currentStatusMessage || e.modalCourse.cannotEnrol || e.modalCourse.interModalNotificationsTop || e.planUnavailableMessage || e.showPlanMessage() || t
        }
        ,
        e.isOriginallySelectedActivity = function() {
            return e.isOriginallySelected
        }
        ,
        e.setOriginallySelectedActivity = function(t) {
            var n = e.currentCourse
                , r = e.currentActivity
                , a = 0;
            if (t) {
                for (var i = n.info.primaryActivities, o = 0; o < i.length; o++)
                    if (i[o].checkedStatus && (a++,
                        e.originallySelectedActivities.indexOf(i[o].activityId) === -1))
                        return void (e.isOriginallySelected = !1)
            } else {
                if (r.primaryActivity && r.primaryActivity.activityId && (a++,
                    e.originallySelectedActivities.indexOf(r.primaryActivity.activityId) === -1))
                    return void (e.isOriginallySelected = !1);
                if (r.secondaryActivity && r.secondaryActivity.activityId && (a++,
                    e.originallySelectedActivities.indexOf(r.secondaryActivity.activityId) === -1))
                    return void (e.isOriginallySelected = !1);
                if (r.thirdActivity && r.thirdActivity.activityId && (a++,
                    e.originallySelectedActivities.indexOf(r.thirdActivity.activityId) === -1))
                    return void (e.isOriginallySelected = !1)
            }
            e.isOriginallySelected = a === e.originallySelectedActivities.length
        }
        ,
        e.notOnlyWaitList = function() {
            for (var t = e.currentCourse.info.primaryActivities, n = 0; n < t.length; n++)
                if (e.notWaitlistable(t[n]))
                    return !0;
            return !1
        }
        ,
        e.canAddToEnrolmentCart = function() {
            return !(!e.modalCourse || !e.modalCourse.enrolFromPlan) && !(e.modalCourse.enrolFromPlan.display || e.modalCourse.removeCourse || e.modalCourse.modifyActivity || e.modalCourse.enrolmentErrorCode == w.NOT_ALLOWED || e.modalCourse.isPlannedItem)
        }
        ,
        e.canEnrol = function() {
            return !!(e.modalCourse && e.modalCourse.enrolFromPlan && e.currentActivity && e.currentActivity.primaryActivity) && !(e.modalCourse.enrolFromPlan.display || e.currentActivity.primaryActivity.waitlistable || e.modalCourse.modifyActivity || e.modalCourse.enrolmentErrorCode == w.NOT_ALLOWED || e.modalCourse.isPlannedItem)
        }
        ,
        e.showPlanMessage = function() {
            return !!e.modalCourse && (!e.modalCourse.isFromPlan && !e.modalCourse.enroled && (e.canAddToEnrolmentCart() || "active" !== e.getEnrolmentCartButtonStateClasses()) && "active" !== e.getEnrolButtonStateClasses())
        }
        ,
        e.$on(f.EVENTS.HIDE_MODAL, function() {
            a.error("Broadcast on HIDE_MODAL")
        }),
        e.$on(f.EVENTS.MODAL_ERROR, function() {
            e.status.actionHappening = !1
        }),
        e.$on("SHOW_WARNING_WAITLIST_REMOVE", function() {
            e.modalCourse.interModalNotificationsBottom = !0
        }),
        e.$on(b.RESPONSIVE_RESIZE_EVENT, function() {
            e.$digest()
        }),
        e.getAvailabilityForDisplay = d.getAvailabilityForDisplay,
        function() {
            var t = T.getData();
            e.initModalCourse(),
                e.modalCourse.display = !0,
                e.currentActivity = t.currentActivity,
                e.currentCourse = t.currentCourse,
                e.modalCourse.isPlannedItem = t.isPlannedItem,
            t.isPlannedItem && (e.currentCourse.planId = t._id);
            var n;
            if (e.isOriginallySelected = !0,
                    e.originallySelectedActivities = [],
                    U(),
                e.originallySelectedActivities.length || (e.isOriginallySelected = !1),
                angular.isObject(e.currentCourse) && angular.isObject(e.currentCourse.info) && "WAIT" !== e.currentCourse.statusType) {
                var r = e.currentCourse.info.primaryActivities.length;
                for (n = 0; n < r; n++) {
                    var a = e.currentCourse.info.primaryActivities[n];
                    !t.isPlannedItem && a.joinedActivity && a.waitlistable && (a.waitlistable = !1)
                }
            }
            e.currentCourse.sessionShortName = F(t.currentCourse),
                x(e, t.enrolFromPlan),
                t.enrolFromPlan ? (e.planCourse = t.enrolFromPlan.courseFromPlan,
                    e.currentPlanCourse = g.getCurrentCourseBasedOnPlan(e.currentCourse, e.planCourse),
                    e.currentPlanCourse.enrolmentErrorMessage = t.currentCourse.enrolmentErrorMessage) : (delete e.planCourse,
                    delete e.currentPlanCourse),
                q(t),
            void 0 !== e.currentCourse && Q(t.currentActivity),
                e.modalCourse.oldCourse = "" !== e.currentActivity.primaryActivity && e.currentActivity.primaryActivity,
                e.modalCourse.enrolFromPlan = {
                    display: !1
                },
                t.isPlannedItem ? e.planUnavailableMessage = g.getPlanStatus(e.currentCourse, t) : t.enrolFromPlan && (e.planUnavailableMessage = g.getPlanStatus(e.currentCourse, e.planCourse),
                void 0 === e.planUnavailableMessage && (e.modalCourse.enrolFromPlan = {
                    display: !0
                })),
                W(t),
            e.modalCourse.modifyActivity || t.enrolFromPlan || $(),
                S.init().then(function() {
                    e.currentEligibleRegistration = S.getCurrentEligibleRegistration()
                })
        }()
}
]),
angular.module("acornApp").controller("PlanCtrl", ["$rootScope", "$scope", "$uibModal", "$log", "enrolmentServerResources", "PlanCRUD", "CourseCRUD", "utToast", "activityUpdateNotification", "planManager", "acornCoreProperties", "acornCoreLib", "SessionAssignment", "Accessibility", "utTypeaheadState", "utConfirmation", "enrolmentInfoConstant", "CourseCRUDConstants", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f, g, m, h, v) {
    function C(e) {
        return void 0 !== e && 0 !== e.length || (e = [{
            activityId: ""
        }]),
            e[0]
    }
    function y(e, t) {
        for (var n = {
            primaryActivity: C(t.info.primaryActivities),
            secondaryActivity: C(t.info.secondaryActivities),
            thirdActivity: C(t.info.thirdActivities)
        }, r = e.length, a = 0; a < r; a++) {
            var i = {
                primaryActivity: C(e[a].info.primaryActivities),
                secondaryActivity: C(e[a].info.secondaryActivities),
                thirdActivity: C(e[a].info.thirdActivities)
            };
            if (e[a].courseCode == t.courseCode && e[a].courseTitle == t.courseTitle && i.primaryActivity.activityId == n.primaryActivity.activityId && i.secondaryActivity.activityId == n.secondaryActivity.activityId && i.thirdActivity.activityId == n.thirdActivity.activityId && e[a].sectionCode == t.sectionCode)
                return a
        }
        return -1
    }
    function A(e) {
        var t = "";
        if (e.info) {
            t = "(";
            var n = e.info.primaryActivities;
            if (n)
                for (var r = 0; r < n.length; r++)
                    t += n[r].activityId + ", ";
            e.info.secondaryActivities && (t += e.info.secondaryActivities.length ? e.info.secondaryActivities[0].activityId + ", " : ""),
            e.info.thirdActivities && (t += e.info.thirdActivities.length ? e.info.thirdActivities[0].activityId + ", " : ""),
                t = t.substring(0, t.lastIndexOf(",")),
                t += ") "
        }
        return t
    }
    var E = u.getEnrolmentProperties()
        , T = E.messages.toasts.plans
        , S = d.getPropertiesLib();
    t.planName = "Plan Name",
        t.plannedCourses = [],
        t.$emit("PLAN_CONTROL_LOADED", "Loaded"),
        t.loading = !0,
        t.myEnrolmentCartTooltip = {
            messages: "<p>Courses in your enrolment cart <strong>will not automatically be enrolled in</strong> once your enrolment period begins.</p><p>Your enrolment cart is used to plan ahead of time the courses and activity sections you intend to enrol in later.</p><p>Use the Check Availability link on each entry in your enrolment cart to retrieve its current information, leading up to and during your course enrolment period.</p>"
        },
        t.$on("ENROLMENT_INFO_READY", function() {
            t.planName = t.eligibleRegistrations[t.enrolmentGlobalObj.currentSession].postInfo + " " + t.eligibleRegistrations[t.enrolmentGlobalObj.currentSession].sessionDescription,
                i.readPlan(t)
        }),
        t.plansExceededMaximumAllowed = function() {
            return t.plannedCourses && t.plannedCourses.length >= h.PLAN_MAX_COUNT ? S.interpolatePropertyStringWithArgs(T.PLANS_EXCEEDING_MAX, [h.PLAN_MAX_COUNT, "a new"]) : void 0
        }
        ,
        t.isWaitlistedCourse = function(e) {
            var t = e;
            return angular.isArray(e) && e.length > 0 && (t = e[0]),
            !!angular.isObject(t) && ("true" === t.waitlistable || t.waitlistable === !0)
        }
        ,
        t.displayCourseInfo = function(e, r) {
            if (!angular.element(r.currentTarget).hasClass("disabled")) {
                f.setLastFocusUsingEvent(r);
                var a = {
                    activityCode: e.courseCode,
                    activityTitle: e.courseTitle,
                    sectionCode: e.sectionCode,
                    courseSessionCode: e.regSessionCode1
                };
                a.eligibleRegistrations = t.eligibleRegistrations,
                    a.enrolmentGlobalObj = t.enrolmentGlobalObj,
                    a.retrieveCancelledCourses = !0;
                o.readCourse.getCourseInfo(a, e).then(function() {
                    var e = n.open({
                        animation: !0,
                        templateUrl: "partials/enrolment/modalCourse.html",
                        controller: "ModalCourseCtrl",
                        scope: t,
                        windowClass: "modal-lg-acorn"
                    });
                    e.result.then(f.restoreLastFocus, f.restoreLastFocus),
                        e.rendered.then(function() {
                            f.setElemFocus("courseCodeAndTitle")
                        })
                })
            }
        }
        ,
        t.isPrimarySectionCancelled = function(e) {
            if (!(e && angular.isObject(e) && e.info && e.info.primaryActivities && angular.isArray(e.info.primaryActivities) && 0 !== e.info.primaryActivities.length))
                return !0;
            var t = !1
                , n = 0
                , r = e.info.primaryActivities.length;
            for (n = 0; n < r; n++)
                if (e.info.primaryActivities[n].cancelled) {
                    t = !0;
                    break
                }
            return t
        }
        ,
        t.$on("ADD_TO_PLAN", function(e, n) {
            if (g.setState({
                    term: ""
                }),
                y(t.plannedCourses, n) < 0) {
                n.isPlannedItem = !0,
                    c.updatedArea(n),
                    t.plannedCourses.push(n),
                    t.loading = !1;
                var r = S.interpolatePropertyStringWithArgs(T.ADD, [n.courseCode + " " + n.sectionCode, n.courseTitle]);
                s.show({
                    text: r,
                    successState: !0
                })
            } else {
                var a = {
                    text: S.interpolatePropertyStringWithArgs(T.COURSE_EXISTS, [n.courseCode + " " + n.sectionCode, n.courseTitle]),
                    infoState: !0
                };
                s.show(a)
            }
        }),
        t.$on("UPDATE_IN_PLAN", function(e, n) {
            g.setState({
                term: ""
            });
            var r;
            if (t.plannedCourses.some(function(e) {
                    if (e._id === n.planId)
                        return r = e,
                            !0
                }),
                    r) {
                r.info.primaryActivities = n.info.primaryActivities || [],
                    r.info.secondaryActivities = n.info.secondaryActivities || [],
                    r.info.thirdActivities = n.info.thirdActivities || [],
                    c.updatedArea(r),
                    t.loading = !1;
                var a = S.interpolatePropertyStringWithArgs(T.UPDATE, [n.courseCode + " " + n.sectionCode, n.courseTitle]);
                s.show({
                    text: a,
                    successState: !0
                })
            }
        }),
        t.confirmDeletePlan = function(e) {
            f.setLastFocus();
            var n = function() {
                i.deleteCourseFromPlan(t, e),
                    m.close()
            }
                , r = function() {
                m.dismiss()
            }
                , a = A(e)
                , o = "Are you sure you would like to remove <strong>" + e.courseCode + " " + e.sectionCode + " " + a + "</strong>from your Enrolment Cart?";
            m.init({
                title: "Remove " + e.courseCode + " " + e.sectionCode + " " + e.courseTitle,
                cancelIconFunction: r,
                message: o,
                actions: {
                    main: {
                        title: "Remove Course",
                        action: n
                    },
                    textControl: [{
                        title: "Cancel",
                        action: r
                    }]
                }
            })
        }
        ,
        t.$on("DELETE_ALL_COURSECODE_FROM_PLAN", function(e, n, r) {
            for (var a = t.plannedCourses, i = a.length, o = {}, s = i - 1; s >= 0; s--)
                a[s].courseCode === n && a[s].regSessionCode1 === r && (o.hasOwnProperty(a[s].courseCode) || (o[a[s].courseCode] = !0),
                    a.splice(s, 1))
        }),
        t.$on("DELETE_ON_PLAN", function(e, n) {
            t.plannedCourses.some(function(e, r) {
                if (e._id === n._id)
                    return t.plannedCourses.splice(r, 1),
                        !0
            });
            var r = A(n)
                , a = S.interpolatePropertyStringWithArgs(T.REMOVE, [n.courseCode, n.courseTitle, r]);
            s.show({
                text: a,
                infoState: !0
            })
        }),
        t.$on("NO_COURSE_IN_PLAN", function() {}),
        t.$on(v.EVENTS.PLAN_DROP_COURSE, function(e, n) {
            l.removeFromPlan(t, n)
        }),
        t.getSessionShortName = function(e) {
            return p.getSessionShortName(e)
        }
        ,
        t.getAvailabilityForDisplay = d.getAvailabilityForDisplay,
        t.changeActivity = function(e, r) {
            f.setLastFocusUsingEvent(r),
                e.activityCode = e.courseCode,
                e.moreDetails = !e.moreDetails,
                e.currentCourse = {},
                e.eligibleRegistrations = t.eligibleRegistrations,
                e.enrolmentGlobalObj = t.enrolmentGlobalObj,
                e.courseSessionCode = e.regSessionCode1,
                e.retrieveCancelledCourses = !0;
            var a = o.readCourse.getCourseInfo(e);
            e.currentCourse.activityTitle = e.courseTitle,
                a.then(function() {
                    var e = n.open({
                        animation: !0,
                        templateUrl: "partials/enrolment/modalCourse.html",
                        controller: "ModalCourseCtrl",
                        scope: t,
                        windowClass: "modal-lg-acorn"
                    });
                    e.result.then(f.restoreLastFocus, f.restoreLastFocus),
                        e.rendered.then(function() {
                            f.setElemFocus("courseCodeAndTitle")
                        })
                })
        }
}
]),
angular.module("acornApp").directive("enrolmentModalHeight", ["$timeout", function(e) {
    return {
        restrict: "A",
        link: function(t, n) {
            function r(e, t) {
                return e.modalFooterHeight !== t.modalFooterHeight || e.modalHeaderHeight !== t.modalHeaderHeight
            }
            function a() {
                return {
                    modalFooterHeight: i.outerHeight(!0),
                    modalHeaderHeight: o.outerHeight(!0)
                }
            }
            var i = n.find(".modal-footer")
                , o = n.find(".modal-header")
                , s = n.find(".modal-body")
                , c = {
                modalFooterHeight: 0,
                modalHeaderHeight: 0
            };
            t.$watch(function() {
                var t = a();
                r(c, t) && (c = t,
                    e(function() {
                        var e = i.outerHeight(!0)
                            , t = o.outerHeight(!0)
                            , n = e + t + 60;
                        s.css({
                            "max-height": "calc(100vh - " + n + "px"
                        })
                    }))
            })
        }
    }
}
]),
angular.module("acornApp").directive("enrolmentNotice", ["$compile", "$log", "EnrolmentMessageService", "acornCoreProperties", function(e, t, n, r) {
    return {
        restrict: "E",
        replace: !0,
        scope: {
            enrolStatusModel: "=",
            coursePage: "=",
            getRegistration: "&",
            getCourseDivision: "&",
            showPlanMessage: "="
        },
        link: function(a, i) {
            function o() {
                if (a.showNoticeMessage = !1,
                        a.showPlanningMessage = !1,
                        a.enrolStatusModel) {
                    a.enrolStatusModel.registration = "getRegistration()",
                        a.enrolStatusModel.courseDivision = "getCourseDivision()";
                    try {
                        var o = n.getInfoMessage(a.enrolStatusModel, a.coursePage);
                        !o && a.enrolStatusModel.showActivityNotAvailable && (o = n.getNoMeetingSectionAvailableMessage());
                        var s, c;
                        if (o && (a.showNoticeMessage = !0,
                                s = e("<div>" + o + "</div>")(a)),
                                i.find(".notice-message").empty(),
                            s && i.find(".notice-message").append(s),
                                !a.coursePage) {
                            var l = a.enrolStatusModel.planningAllowed
                                , u = r.getOrgInfoByOrgCode(a.getCourseDivision().primaryOrgCode).getName()
                                , d = n.getEnrolmentCartActivitiesFinalizedMessage(l, a.enrolStatusModel.planningStartDate, a.enrolStatusModel.planningEndDate, u);
                            c = e("<div>" + d + "</div>")(a),
                                i.find(".planning-message").empty(),
                                i.find(".planning-message").append(c)
                        }
                    } catch (e) {
                        t.warn("Could not compile.")
                    }
                }
            }
            a.$watch("enrolStatusModel", function() {
                o()
            }),
                o()
        },
        template: '<div class="planning-notice-message" data-ng-show="showNoticeMessage || showPlanMessage">   <div class="notice-message" data-ng-show="showNoticeMessage"></div>   <div class="planning-message" data-ng-show="showPlanMessage"></div></div>'
    }
}
]),
angular.module("acornApp").directive("keyDatesInline", ["acornCoreProperties", function(e) {
    return {
        restrict: "E",
        replace: !0,
        scope: {
            registration: "="
        },
        controller: ["$scope", function(t) {
            function n() {
                if (void 0 != t.registration) {
                    var n = e.getKeyDateForOrg(t.registration.primaryOrgCode, t.registration.secondaryOrgCode);
                    t.keyDateOrg = n.KEYDATE
                }
            }
            t.$watch("registration", function() {
                n()
            }),
                n()
        }
        ],
        template: '<span data-ng-show="keyDateOrg">    <a href="{{keyDateOrg.url}}" target="_blank">{{keyDateOrg.name}}<data-icon-ext-link></data-icon-ext-link></a></span>'
    }
}
]),
angular.module("acornApp").directive("utSetChecked", ["$parse", function(e) {
    return {
        link: function(t, n, r) {
            r.utSetChecked && t.$watch(function() {
                return e(r.utSetChecked)(t)
            }, function(e) {
                t.enabled = e
            }),
                t.enabled = !0,
                n.bind("mouseup", function(e) {
                    e.preventDefault();
                    var n = angular.element(e.currentTarget).find("input")[0];
                    t.enabled && ("checkbox" !== e.target.type && "radio" !== n.type ? n.checked = !n.checked : "radio" == n.type && (n.checked = !0))
                })
        }
    }
}
]),
angular.module("acornApp").factory("activityUpdateNotification", function() {
    function e(e) {
        e.bud = !0
    }
    function t(e) {
        var t;
        for (var n in e)
            if (e.hasOwnProperty(n)) {
                var r = e[n].length;
                for (t = 0; t < r; t++)
                    if (e[n][t].bud)
                        return void delete e[n][t].bud
            }
    }
    return {
        updatedArea: e,
        clearPrecedingDots: t
    }
}),
angular.module("acornApp").factory("campusType", function() {
    return {
        getCampusType: function(e) {
            return "ARCLA" === e.coSecondaryOrgCode ? e.coSecondaryOrgCode : e.adminOrgCode
        }
    }
}),
angular.module("acornApp").constant("CourseCRUDConstants", {
    EVENTS: {
        CURRENTLY_ENROLLED_SUCCESS: "ADD_TO_CURRENTLY_ENROLED",
        CURRENTLY_ENROLLED_FAILURE: "ENROL_FAILED",
        DROPPED_COURSE_SUCCESS: "DROPPED_COURSE",
        DROPPED_COURSE_FAILURE: "DROPPED_COURSE_FAILURE",
        DROPPED_COURSE_ALLOWED: "DROPPING_ALLOWED",
        PLAN_DROP_COURSE: "PLAN_DROP_COURSE",
        SHOW_FAILED_FULL_REG: "SHOW_FAILED_FULL_REG",
        PRIMARY_ENROLLED_FAILURE: "PRIMARY_ENROLLED_FAILURE"
    }
}).factory("CourseCRUD", ["$http", "$q", "enrolmentServerResources", "DisplayCourseInfo", "$rootScope", "utToast", "utConfirmation", "CourseCRUDConstants", "ModalCourseConstants", "utConfirmationConstants", "acornCoreLib", "enrolmentConstantsService", "acornCoreProperties", "utTypeaheadState", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f) {
    function g(e, t, n) {
        var r = !1
            , a = {
            COURSE_DROP_PAST_SESSIONAL_DATES: "6716"
        };
        if (!angular.isString(n))
            return r;
        for (var i in a)
            var s = new RegExp("\\b" + a[i] + "\\b");
        if (s.test(n)) {
            switch (r = !0,
                i) {
                case "COURSE_DROP_PAST_SESSIONAL_DATES":
                    var c = {
                        classes: "sessional-date-warning",
                        type: l.TYPE.WARN,
                        cancelIconFunction: o.dismissAll,
                        title: "Drop Course " + e.activityCode + " " + e.sectionCode + " " + e.activityTitle,
                        message: "The add/drop period for " + t.sessionDescription + " courses has ended.",
                        actions: {
                            textControl: [{
                                title: "Cancel",
                                action: o.dismissAll
                            }],
                            main: {
                                title: "Return to Courses",
                                action: o.dismissAll
                            }
                        }
                    };
                    o.init(c)
            }
            return r
        }
        return r
    }
    var m = p.getEnrolmentProperties()
        , h = m.messages.toasts.enrolled
        , v = m.messages.toasts.waitlists
        , C = u.getPropertiesLib()
        , y = function(e) {
        function o(e) {
            var t = e.responseObject;
            return t.hasOwnProperty("tutorial") && t.tutorial && !t.tutorial.enroled || t.hasOwnProperty("practical") && t.practical && !t.practical.enroled
        }
        function l(e) {
            return e.responseObject.primaryFailed
        }
        function u(e) {
            var t = e.data;
            a.$broadcast(c.EVENTS.MODAL_ERROR, t || "Enrolment error."),
                i.show({
                    text: t,
                    errorState: !0
                })
        }
        var d = " "
            , p = ""
            , g = e.currentCourse;
        p = g.enroled === !0 ? C.interpolatePropertyStringWithArgs(h.UPDATE, [g.activityCode + " " + g.sectionCode, g.activityTitle]) : C.interpolatePropertyStringWithArgs(h.ADD, [g.activityCode + " " + g.sectionCode, g.activityTitle]);
        var m = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
            , v = {}
            , y = {
            activeCourse: {
                course: {
                    code: e.currentCourse.activityCode,
                    sectionCode: e.currentCourse.sectionCode,
                    primaryTeachMethod: e.currentCourse.primaryTeachMethod,
                    enroled: e.currentCourse.enroled
                },
                lecture: {},
                tutorial: {},
                practical: {}
            },
            eligRegParams: r.prepareCourseVariables(m, v)
        };
        y.activeCourse.lecture.sectionNo = e.currentActivity.primaryActivity.teachMethod + "," + e.currentActivity.primaryActivity.sectionNo,
            d += y.activeCourse.lecture.sectionNo.replace(",", ""),
        void 0 !== e.currentActivity.secondaryActivity.teachMethod && (y.activeCourse.tutorial.sectionNo = e.currentActivity.secondaryActivity.teachMethod + "," + e.currentActivity.secondaryActivity.sectionNo,
            d += " " + y.activeCourse.tutorial.sectionNo.replace(",", "")),
        void 0 !== e.currentActivity.thirdActivity.teachMethod && (y.activeCourse.practical.sectionNo = e.currentActivity.thirdActivity.teachMethod + "," + e.currentActivity.thirdActivity.sectionNo,
            d += " " + y.activeCourse.practical.sectionNo.replace(",", ""));
        var A = function(e, t) {
            return e.hasOwnProperty(t) && null !== e[t] ? e[t].length : 0
        }
            , E = function(e, t) {
            return !e.hasOwnProperty(t) || !e[t] || e[t].enroled
        }
            , T = function(e, t) {
            var n = A(e.tutorial, "sectionNo")
                , r = A(e.practical, "sectionNo")
                , a = {
                lecture: {
                    sectionNo: e.lecture.sectionNo.replace(",", "")
                },
                tutorial: {
                    enroled: !0,
                    sectionNo: e.tutorial.sectionNo ? e.tutorial.sectionNo.replace(",", "") : ""
                },
                practical: {
                    enroled: !0,
                    sectionNo: e.practical.sectionNo ? e.practical.sectionNo.replace(",", "") : ""
                }
            };
            return n && (a.tutorial.enroled = E(t, "tutorial")),
            r && (a.practical.enroled = E(t, "practical")),
                a
        }
            , S = t.defer();
        return n.addCourseEnrol(y, function(t) {
            if (f.setState({
                    term: ""
                }),
                    l(t))
                S.reject({
                    event: s.EVENTS.PRIMARY_ENROLLED_FAILURE,
                    successData: t,
                    baseInfo: y,
                    modalControlObj: T(y.activeCourse, t.responseObject)
                });
            else if (o(t))
                S.reject({
                    event: s.EVENTS.SHOW_FAILED_FULL_REG,
                    successData: t,
                    baseInfo: y,
                    modalControlObj: T(y.activeCourse, t.responseObject)
                }),
                    a.$broadcast("ENROLMENT_INFO_READY", t);
            else {
                var n = {
                    text: p + ": " + d.trim().replace(/ /g, ", ") + "."
                };
                if (g.enroled)
                    n.infoState = !0;
                else {
                    var r = C.interpolatePropertyStringWithArgs(h.ADD_INT_REQ, [g.activityCode + " " + g.sectionCode, g.activityTitle, d])
                        , c = t.responseObject.status;
                    "INT" === c || "REQ" === c ? (n.text = r,
                        n.infoState = !0) : n.successState = !0
                }
                "APP" === c && (g.courseCredits = t.responseObject.courseCredits),
                    i.show(n),
                    a.$broadcast(s.EVENTS.CURRENTLY_ENROLLED_SUCCESS, {
                        currentActivity: e.currentActivity,
                        courseObj: e.currentCourse,
                        response: t.responseObject
                    }),
                    a.$broadcast(s.EVENTS.PLAN_DROP_COURSE, e.currentCourse),
                    S.resolve("Successfully enrolled in course")
            }
        }, u),
            S.promise
    }
        , A = function(e) {
        return y(e)
    }
        , E = function(e, t) {
        var c = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
            , l = {}
            , u = {
            course: {
                code: t.activityCode,
                sectionCode: t.sectionCode,
                status: t.statusType
            },
            eligRegParams: r.prepareCourseVariables(c, l)
        };
        n.dropSaveCourseEnrol(u, function(e) {
            e.messages.errors ? e.messages.errors.forEach(function(e) {
                i.show({
                    text: e,
                    errorState: !0
                })
            }) : a.$broadcast(s.EVENTS.DROPPED_COURSE_ALLOWED, t)
        }, function(e) {
            o.dismiss();
            var n = e.data || "Sorry an error occurred while attempting to drop " + t.activityCode + " " + t.activityTitle + ".";
            i.show({
                text: n,
                errorState: !0
            })
        })
    }
        , T = function(e, o) {
        var l = {}
            , u = t.defer()
            , d = e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession]
            , p = {
            course: {
                code: o.activityCode,
                sectionCode: o.sectionCode,
                status: o.statusType
            },
            eligRegParams: r.prepareCourseVariables(d, l)
        };
        return n.dropCourseEnrol(p, function(t) {
            var n = "";
            n = angular.isString(o.statusType) && "WAIT" === o.statusType.toUpperCase() ? C.interpolatePropertyStringWithArgs(v.REMOVE, [o.activityCode + " " + o.sectionCode, o.activityTitle, e.eligibleRegistrations[e.enrolmentGlobalObj.currentSession].sessionDescription]) : C.interpolatePropertyStringWithArgs(h.REMOVE, [o.activityCode + " " + o.sectionCode, o.activityTitle]),
                null != t.messages.errorMessages ? (i.show({
                    text: t.messages.errorMessages,
                    errorState: !0
                }),
                    u.reject("Error occurred while dropping course")) : null != t.messages.infoMessages ? (i.show({
                    text: t.messages.infoMessages,
                    infoState: !0
                }),
                    a.$broadcast(s.EVENTS.DROPPED_COURSE_SUCCESS, o),
                    u.resolve("Successfully dropped course")) : null != t.messages.warningMessages ? (i.show({
                    text: t.messages.warningMessages,
                    warningState: !0
                }),
                    u.reject("Error occurred while dropping course")) : (null === t.responseObject ? i.show({
                    text: n,
                    infoState: !0
                }) : t.responseObject.hasOwnProperty("sqpda") ? i.show({
                    text: t.responseObject.sqpda.displayMessage,
                    infoState: !0
                }) : (i.show({
                    text: n,
                    infoState: !0
                }),
                    a.$broadcast("CANCEL_REGISTRATION_CTRL_FLOW_START", t)),
                    a.$broadcast(s.EVENTS.DROPPED_COURSE_SUCCESS, o),
                    u.resolve("Successfully dropped course"))
        }, function(e) {
            var t = angular.isDefined(e.data) ? e.data : null
                , n = t || "Sorry an error occurred while attempting to drop " + o.activityCode + " " + o.activityTitle + ".";
            g(o, d, t) || i.show({
                text: n,
                errorState: !0
            }),
                a.$broadcast(s.EVENTS.DROPPED_COURSE_FAILURE, o),
                a.$broadcast(c.EVENTS.MODAL_ERROR, o),
                u.reject("Error occurred while dropping")
        }),
            u.promise
    };
    return {
        addCourse: y,
        updateCourse: A,
        dropSave: E,
        dropCourse: T,
        readCourse: r
    }
}
]),
angular.module("acornApp").factory("CourseStatus", ["$q", "acornCoreProperties", "Promises", "EnrolmentMessageService", function(e, t, n, r) {
    function a(e, t) {
        if (!e || !angular.isObject(t))
            return !1;
        var n = !1;
        return (t.primaryActivity && t.primaryActivity.activityId && t.primaryActivity.activityId === e || t.secondaryActivity && t.secondaryActivity.activityId && t.secondaryActivity.activityId === e || t.thirdActivity && t.thirdActivity.activityId && t.thirdActivity.activityId === e) && (n = !0),
            n
    }
    function i(e, t) {
        var n = !1;
        if (e && t)
            for (var r = e.length, i = 0; i < r; i++) {
                var o = a(e[i], t);
                if (o) {
                    n = !0;
                    break
                }
            }
        return n
    }
    var o = t.getCourseStatusProperties()
        , s = function(e, t, n, r) {
        for (var a = e.length, i = [], o = 0; o < a; o++)
            e[o].hasOwnProperty(t) && e[o][t] === n && e[o].hasOwnProperty(r) && i.push(e[o][r]);
        return i
    }
        , c = function(e) {
        for (var t = [], n = ["primaryActivities", "secondaryActivities", "thirdActivities"], r = n.length, a = 0; a < r; a++)
            if (e.info.hasOwnProperty(n[a])) {
                var i = s(e.info[n[a]], "professorApprovalReq", "Y", "activityId");
                i.length > 0 && (t = t.concat(i))
            }
        return t
    }
        , l = function(e, t) {
        var n = c(e);
        if (0 === n.length)
            return !1;
        var a = i(n, t);
        return r.getActivityThatNeedApprovalMessage(a, n)
    };
    return {
        check: function(t, r) {
            var a = e.defer()
                , i = n.createDefaultCancellableAndTimeoutablePromise(a, "Course Status")
                , s = o.errors[t.courseStatusIfEnroling]
                , c = l(t, r);
            return c ? a.resolve(c) : void 0 !== s ? a.resolve(s) : a.reject("Invalid Message for currentCourse: " + t.activityCode),
                i
        }
    }
}
]),
angular.module("acornApp").constant("displayCourseInfoConstants", {
    TEACH_METHODS_DISPLAY_ORDER: ["LEC", "TUT", "PRA"]
}).factory("DisplayCourseInfo", ["$q", "$rootScope", "$log", "$filter", "Accessibility", "enrolmentServerResources", "utToast", "SessionAssignment", "displayCourseInfoConstants", "modalCourseData", function(e, t, n, r, a, i, o, s, c, l) {
    function u(e, t, n, r) {
        for (var a = [], i = 0, o = e.length; i < o; i++)
            e[i].teachMethod === t && a.push(d(e[i], n));
        return a
    }
    function d(e, t) {
        if (null === e)
            return {};
        var n = {
            sectionNo: e.sectionNo,
            teachMethod: e.teachMethod,
            activityId: e.displayName,
            cancelled: e.cancelled,
            closed: e.closed,
            spaceTotal: e.enrollSpace,
            spaceLeft: e.enrollmentSpaceAvailable,
            classTotal: e.totalSpace,
            enrollmentControlFull: e.enrollmentControlFull,
            full: e.full,
            enrollmentControlMissing: e.enrollmentControlMissing,
            enrolmentIndicatorDisplay: e.enrolmentIndicatorDisplay,
            enrolmentIndicatorMsg: e.enrolmentIndicatorMsg,
            enrolmentIndicatorDates: e.enrolmentIndicatorDates,
            note: "displayCourseInfo.js:getActivity",
            professorApprovalReq: e.professorApprovalReq,
            waitlistable: e.waitlistable,
            waitlistableForAll: e.waitlistableForAll,
            joinedActivity: e.joinedActivity,
            checkedStatus: e.joinedActivity,
            status: e.status,
            enroled: e.enroled,
            waitlistRank: e.waitlistRank,
            attendanceStatus: e.attendanceStatus,
            commaSeparatedInstructorNames: e.commaSeparatedInstructorNames,
            subTitle: e.subTitle,
            hasSubTitle: e.hasSubTitle,
            days: [],
            enrolledInAllActivities: e.enrolledInAllActivities,
            waitlistLookupMethod: e.waitlistLookupMethod,
            deliveryMode: e.deliveryMode
        };
        t && (angular.isArray(t) ? angular.forEach(t, function(e) {
            delete n[e]
        }) : delete n[t]);
        for (var r = e.times.length, a = 0; a < r; a++) {
            var i = {
                roomLocation: e.times[a].buildingCode + " " + e.times[a].room,
                startTime: e.times[a].startTime,
                endTime: e.times[a].endTime,
                dayOfWeek: e.times[a].day.dayName
            };
            n.days.push(i)
        }
        return n
    }
    function p(e, t) {
        e = e.registrationParams;
        for (var n in e)
            "sessionCode" !== n && "acpDuration" !== n && "status" !== n && "yearOfStudy" !== n && "assocOrgCode" !== n && "typeOfProgram" !== n && "subjectCode1" !== n && "designationCode1" !== n && "primaryOrgCode" !== n && "secondaryOrgCode" !== n && "collaborativeOrgCode" !== n && "adminOrgCode" !== n && "coSecondaryOrgCode" !== n && "sessionDescription" !== n && "sqpda" !== n && "levelOfInstruction" !== n && "postCode" !== n && "postDescription" !== n && "postAcpDuration" !== n && "useSws" !== n || (t[n] = e[n]);
        return t
    }
    function f(t) {
        var r, a = e.defer(), s = t.eligibleRegistrations[t.enrolmentGlobalObj.currentSession];
        r = t.courseSessionCode ? t.courseSessionCode : t.currentCourse.regSessionCode1;
        var c = {
            courseCode: t.currentCourse.activityCode,
            sectionCode: t.currentCourse.sectionCode,
            courseSessionCode: r,
            activityApprovedInd: s.activityApprovedInd,
            activityApprovedOrg: s.activityApprovedOrg
        };
        return c = p(s, c),
        angular.isDefined(t.retrieveCancelledCourses) && (c.retrieveCancelledCourses = t.retrieveCancelledCourses),
            i.getCourseInfo(c, function(e) {
                e.hasOwnProperty("value") && a.reject(e),
                    a.resolve(e),
                    t.loadingResults = !1
            }, function(e) {
                n.error(e);
                var r = e.data;
                if (angular.isDefined(r.value))
                    o.show({
                        text: r.value,
                        errorState: !0
                    });
                else {
                    o.show({
                        text: "This action could not be completed. Please log in to ACORN again to continue.",
                        errorState: !0
                    })
                }
                c.errorObject = r,
                    a.reject(e),
                    t.loadingResults = !1
            }),
            a.promise
    }
    function g(e, t) {
        t.enroled = e.enroled,
            t.waitlistMeetings = e.waitlistMeetings,
            t.waitlistMeetings = e.waitlistMeetings,
            t.statusType = e.status,
            t.assigned_from = "displayCourseInfo.js:getCourseInfo",
            t.courseStatusIfEnroling = e.courseStatusIfEnroling,
            t.sessionShortName = s.getSessionShortName(e),
            t.enrolmentErrorMessage = e.enrolmentErrorMessage,
            t.enrolmentErrorCode = e.enrolmentErrorCode,
            t.planErrorCode = e.planErrorCode,
            t.planningAllowed = e.planningAllowed,
            t.planningStartDate = e.planningStartDate,
            t.planningEndDate = e.planningEndDate,
            t.enrolNotStarted = e.enrolNotStarted,
            t.enrolEnded = e.enrolEnded,
            t.activityPrimaryOrgCode = e.activityPrimaryOrgCode,
            t.activitySecondaryOrgCode = e.activitySecondaryOrgCode,
            t.regSessionCode1 = e.regSessionCode1,
            t.regSessionCode2 = e.regSessionCode2,
            t.regSessionCode3 = e.regSessionCode3,
            t.sessionCode = e.sessionCode,
            t.subSessionCode = e.subSessionCode,
            t.loadingCNCStatus = !1,
            t.waitlisted = e.waitlisted,
            t.enroledMeetingSections = e.enroledMeetingSections
    }
    var m = function(e, t) {
        var n = t.primaryTeachMethod;
        if (null != t.waitlistMeetings)
            for (var r = e.length, a = !1, i = 0; i < r; i++)
                e[i].toUpperCase().indexOf(n) >= 0 ? a = !0 : a && (e[i] = n + e[i]);
        return e
    }
        , h = function(e, t, n) {
        if (null != t) {
            for (var r = [], a = t.length, i = e.length, o = 0; o < a; o++) {
                for (var s = 0; s < i; s++)
                    for (var c = e[s].split("/"), l = c.length, u = m(c, n), d = 0; d < l; d++) {
                        var p = t[o].displayName.replace(/ /g, "").replace(/\(.*?\)/g, "").toUpperCase()
                            , f = u[d].replace(/ /g, "").toUpperCase();
                        if (p === f) {
                            t[o].joinedActivity = !0,
                                r.push(t[o]);
                            break
                        }
                    }
                t[o].enroled = n.enroled,
                    t[o].enrolledInAllActivities = n.enroledInAll
            }
            return {
                filteredMeetings: r,
                updatedMeetings: t
            }
        }
    }
        , v = function(e, t, n, a) {
        var i = r("filter")(c.TEACH_METHODS_DISPLAY_ORDER, "!" + t);
        return n && "WAIT" === n ? {
            primaryActivities: u(e, e[0].teachMethod, a),
            secondaryActivities: [],
            thirdActivities: []
        } : {
            primaryActivities: u(e, t, a),
            secondaryActivities: u(e, i[0], a),
            thirdActivities: u(e, i[1], a)
        }
    };
    return {
        getSingleCourseInfo: function(e, t, r) {
            f(e).then(function(n) {
                var a = h(n.responseObject.meetingList, n.responseObject.meetings, n.responseObject);
                if (angular.isDefined(a)) {
                    e.currentCourse.info = v(a.updatedMeetings, n.responseObject.primaryTeachMethod, null, r);
                    for (var i = 0; i < e.currentCourse.info.primaryActivities.length; i++) {
                        var o = e.currentCourse.info.primaryActivities[i];
                        o.joinedActivity && o.waitlistable && (o.waitlistable = !1)
                    }
                }
                angular.isDefined(e.currentCourseInPlan) && angular.isDefined(e.retrieveCancelledCourses) && (e.currentCourseInPlan.cancelled = n.responseObject.cancelled),
                    t(e)
            }, function(e) {
                n.error(e)
            })
        },
        getCourseInfo: function(t, n) {
            t.currentCourse = {
                activityCode: t.activityCode,
                activityTitle: t.activityTitle,
                sectionCode: t.sectionCode
            },
                t.currentActivity = {
                    primaryActivity: "",
                    secondaryActivity: "",
                    thirdActivity: ""
                };
            var r = e.defer();
            return f(t).then(function(e) {
                if (g(e.responseObject, t.currentCourse),
                        t.isPlannedItem) {
                    for (var a = e.responseObject.meetings || [], i = t.info.primaryActivities, s = 0; s < i.length; s++)
                        for (var c = 0; c < a.length; c++) {
                            var u = e.responseObject.meetings[c];
                            if (i[s].activityId == u.displayName) {
                                u.joinedActivity = !0;
                                break
                            }
                        }
                    for (var d = t.info.secondaryActivities || [], p = 0; p < d.length; p++)
                        for (c = 0; c < e.responseObject.meetings.length; c++) {
                            var f = e.responseObject.meetings[c];
                            if (d[p].activityId == f.displayName) {
                                f.joinedActivity = !0;
                                break
                            }
                        }
                    for (var m = t.info.thirdActivities || [], C = 0; C < m.length; C++)
                        for (c = 0; c < e.responseObject.meetings.length; c++) {
                            var y = e.responseObject.meetings[c];
                            if (m[C].activityId == y.displayName) {
                                y.joinedActivity = !0;
                                break
                            }
                        }
                }
                var A = h(e.responseObject.meetingList, e.responseObject.meetings, e.responseObject);
                if (!angular.isDefined(A)) {
                    var E;
                    return E = angular.isDefined(e.responseObject) && angular.isDefined(e.responseObject.regSessionCode1) ? "No meeting sections found for <b>" + t.currentCourse.activityCode + "</b>." : "Sorry the server did not send a proper response. Please refresh this page to try again.",
                        o.show({
                            text: E,
                            warningState: !0
                        }),
                        void r.reject(E)
                }
                t.currentCourse.info = v(A.updatedMeetings, e.responseObject.primaryTeachMethod),
                    t.currentCourse.primaryTeachMethod = e.responseObject.primaryTeachMethod,
                n && (t.enrolFromPlan = {
                    courseFromPlan: n
                }),
                    t.courseBox = !0,
                    l.setData(t),
                    r.resolve(e)
            }, function(e) {
                e.hasOwnProperty("value") && o.show({
                    text: e.value,
                    errorState: !0
                }),
                    r.reject(e)
            }),
                r.promise
        },
        prepareCourseVariables: function(e, t) {
            return p(e, t)
        },
        getMappedActivities: v,
        transferCourseResponseObject: g,
        getMeetings: h
    }
}
]),
angular.module("acornApp").factory("eligibleRegistrations", ["$q", "enrolmentServerResources", function(e, t) {
    function n() {
        return null != i ? e.when(i) : null != o ? o.promise : (o = e.defer(),
            t.eligibleRegistrations("").$promise.then(function(e) {
                i = e,
                e.length > 0 && o.resolve(e),
                    o.reject("No enrolment information found.")
            }, function() {
                o.reject("Student Info: Failed to load.  Please try to login again.")
            }),
            o.promise)
    }
    function r(e) {
        s = e
    }
    function a() {
        return i[s]
    }
    var i = null
        , o = null
        , s = null;
    return {
        init: n,
        setCurrentSession: r,
        getCurrentEligibleRegistration: a
    }
}
]),
angular.module("acornApp").factory("EnrolledCoursesCartService", ["enrolmentServerResources", "$rootScope", function(e, t) {
    function n(e, t) {
        var n = [];
        return e && 0 !== e.length && t && 0 !== t.length ? n = e.filter(function(e) {
            var n = Object.keys(e)
                , r = n[0];
            return t.indexOf(r) !== -1
        }) : n
    }
    function r() {
        var r = a() || []
            , c = i() || []
            , u = c.length
            , d = n(c, r);
        if (d)
            for (var p = d.length, f = 0; f < p; f++) {
                var g = d[f]
                    , m = Object.keys(g)[0]
                    , h = g[m];
                e.bulkRemovePlan({
                    sessionCode: l.sessionCode,
                    regSessionCode: h.regSessionCode1,
                    candidacyPostCode: l.candidacyPostCode,
                    candidacySessionCode: l.candidacySessionCode
                }, {
                    courseId: h.courseCode
                }, function() {
                    0 == (u -= 1) && t.$broadcast("NO_COURSE_IN_PLAN")
                }, function() {}),
                    s.splice(s.indexOf(h), 1)
            }
        o()
    }
    function a() {
        var e = [];
        if (c)
            for (var t = Object.keys(c), n = t.length, r = 0; r < n; r++)
                for (var a = c[t[r]], i = a.length, o = 0; o < i; o++) {
                    var s = a[o];
                    e.push(s.code + s.sectionCode + l.sessionCode + l.candidacyPostCode + l.candidacySessionCode)
                }
        return e
    }
    function i() {
        var e = [];
        if (s)
            for (var t = s.length, n = 0; n < t; n++) {
                var r = s[n]
                    , a = r.courseCode + r.sectionCode + l.sessionCode + l.candidacyPostCode + l.candidacySessionCode
                    , i = {};
                i[a] = r,
                    e.push(i)
            }
        return e
    }
    function o() {
        s = null,
            c = null
    }
    var s = null
        , c = null
        , l = null;
    return Array.prototype.filter || (Array.prototype.filter = function(e) {
            "use strict";
            if (void 0 === this || null === this)
                throw new TypeError;
            var t = Object(this)
                , n = t.length;
            if ("function" != typeof e)
                throw new TypeError;
            for (var r = [], a = arguments.length >= 2 ? arguments[1] : void 0, i = 0; i < n; i++)
                if (i in t) {
                    var o = t[i];
                    e.call(a, o, i, t) && r.push(o)
                }
            return r
        }
    ),
    Object.keys || (Object.keys = function() {
        "use strict";
        var e = Object.prototype.hasOwnProperty;
        return function(t) {
            if ("object" != typeof t && ("function" != typeof t || null === t))
                throw new TypeError("Object.keys called on non-object");
            var n, r = [];
            for (n in t)
                e.call(t, n) && r.push(n);
            return r
        }
    }()),
    {
        setCartCoursesAndProcess: function(e) {
            (s = e) && c && r()
        },
        setEnrolledCoursesAndProcess: function(e, t) {
            c = e,
                l = t,
            s && c && r()
        }
    }
}
]),
angular.module("acornApp").factory("enrolmentConstantsService", function() {
    function e(e) {
        var t, n = "?", r = 0;
        for (t in e) {
            if (0 !== r && (n += "&"),
                e[t]instanceof Array)
                for (var a = e[t].length, i = 0; i < a; i++)
                    0 !== r && (n += "&"),
                        n += t + "=" + encodeURIComponent(e[t][i]),
                        r++;
            else
                n += t + "=" + encodeURIComponent(e[t]);
            r++
        }
        return n
    }
    var t = "undefined" == typeof testBaseUrl ? "" : testBaseUrl
        , n = t + "/sws/rest/enrolment/"
        , r = n + ":type/:command/:command2"
        , a = new Date;
    return {
        baseUrl: t,
        enrolmentUrl: "/sws/rest/enrolment/",
        commandQuery: ":type/:command/:command2",
        particalUrl: n,
        fullUrl: r,
        getTodaysDate: function() {
            var e = a.getMonth() + 1
                , t = a.getFullYear()
                , n = a.getDate();
            return e < 10 && (e = "0" + e),
            n < 10 && (n = "0" + n),
            t + "-" + e + "-" + n
        },
        queryBuilder: e
    }
}),
angular.module("acornApp").service("enrolmentIndicatorService", ["strformat", function(e) {
    var t = {
        ARTSC: {
            pIndMessage: 'Priority enrolment in this course is granted to qualifying students until <strong>{0}</strong>. Beginning <strong>{1}</strong>, all other Arts &amp; Science and Daniels Faculty students can also enrol. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            eIndMessage: 'Enrolment in this course via ACORN is not possible. Students must request permission to enrol by contacting the course\'s sponsoring department. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            r1IndMessage: 'This course is restricted to qualifying students only. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information. <br/><br/><strong>Note:</strong> Enrolment dates may differ between R courses.',
            r2IndMessage: 'This course is restricted to qualifying students until <strong>{0}</strong>. Beginning <strong>{1}</strong>, additional groups of qualifying students can also enrol. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information. <br/><br/><strong>Note:</strong> Enrolment dates may differ between R courses.',
            peIndMessage: 'Priority enrolment in this course is granted to qualifying students until <strong>{0}</strong>. Beginning <strong>{1}</strong>, all students must request permission to enrol by contacting the course\'s sponsoring department. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            aeIndMessage: 'Students can request enrolment in this course via ACORN until <strong>{0}</strong>. Beginning <strong>{1}</strong>, enrolment can no longer be requested via ACORN and must be done by contacting the course\'s sponsoring department. Please consult the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">A&amp;S Timetable course listing<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            pStarIndMessage: 'Priority enrolment is granted to qualifying students until <strong>{0}</strong>, but spaces for each priority group are not equal. Beginning <strong>{1}</strong>, all other Arts &amp; Science students can enrol. Please consult the course listing in the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">Arts &amp; Science Timetable<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            rStarIndMessage: 'This course is restricted to qualifying students only, but spaces for each restricted group are not equal. Please consult the course listing in the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">Arts &amp; Science Timetable <data-icon-ext-link></data-icon-ext-link></a> for complete information. <br/><br/><strong>Note:</strong> Enrolment dates may differ between R courses.',
            rpStarIndMessage: 'This course is restricted to qualifying students for enrolment and the waitlist until <strong>{0}</strong>, but spaces for each restricted group are not equal. Beginning <strong>{1}</strong>, additional groups of qualifying students are also able to enrol or waitlist in the course, but spaces for each restricted group are not equal. Please consult the course listing in the <a href="https://timetable.iit.artsci.utoronto.ca/" target="_blank">Arts &amp; Science Timetable <data-icon-ext-link></data-icon-ext-link></a> for complete information. <br/><br/><strong>Note:</strong> Enrolment dates may differ between R courses.'
        },
        ARCLA: {
            pIndMessage: 'Priority enrolment in this course is granted to qualifying students until <strong>{0}</strong>. Beginning <strong>{1}</strong>, all other Daniels Faculty and Faculty of Arts &amp; Science students can also enrol. Please consult the <a href="http://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration/timetable-registration" target="_blank">Daniels Faculty Timetable<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            eIndMessage: 'Enrolment in this course via ACORN is not possible. Students must request permission to enrol by contacting the course\'s sponsoring department. Please consult the <a href="http://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration/timetable-registration"  target="_blank">Daniels Faculty Timetable<data-icon-ext-link></data-icon-ext-link></a> for complete information.',
            rIndMessage: 'This course is restricted to qualifying students only. Please consult the <a href="http://www.daniels.utoronto.ca/students/undergraduate-students/academics-and-registration/timetable-registration"  target="_blank">Daniels Faculty Timetable<data-icon-ext-link></data-icon-ext-link></a> for complete information. <br/><br/><strong>Note:</strong> Enrolment dates may differ between R courses.'
        },
        SCAR: {
            indMessage: 'Your enrolment in this section is blocked. View the <a href="https://www.utsc.utoronto.ca/~registrar/scheduling/timetable" target="_blank">UTSC timetable<data-icon-ext-link></data-icon-ext-link></a> for common causes of this, e.g. enrolment controls, sessional dates, closed sections, etc.'
        }
    };
    this.getInidcatorMessage = function(n, r, a) {
        if (t[n] && t[n][r])
            return e(t[n][r], a)
    }
}
]),
angular.module("acornApp").service("EnrolmentMessageService", ["strformat", "enrolmentInfoConstant", function(e, t) {
    var n = {
        messages: "Your waitlist rank represents your current position on the waitlist within your enrolment group. When the priority enrolment period ends, waitlists merge and your rank on the waitlist may change."
    }
        , r = "Course enrolment is not yet available for {0}."
        , a = "Course enrolment is not available for {0} currently."
        , i = '<span>Course enrolment {0}. However, <strong>you may add {1} to your enrolment cart</strong> if there are no enrolment blocks on the section(s) you select. Adding this course to your enrolment cart <strong>will not automatically enrol you in</strong> the course, but you can use it to plan for your timetable for the upcoming session.<br><br>Contact {2} (<key-dates-inline registration="{3}"></key-dates-inline>) {4}.</span>'
        , o = '<span>Course enrolment {0}. Contact {2} (<key-dates-inline registration="{3}"></key-dates-inline>) {4}.</span>'
        , s = function(t) {
        var n = t.length > 1 ? "activities" : "activity"
            , r = t.length > 1 ? "require" : "requires";
        return e("<p><b>The following {0} {1} {2} approval to enrol from the offering division and/or instructing faculty member.</b></p>", n, t.join(", "), r)
    }
        , c = function(t, n) {
        var r = t.length > 1 ? "these activities" : "this activity"
            , a = e(n, r);
        return s(t) + a
    };
    this.getNoMeetingSectionAvailableMessage = function() {
        return "No meeting sections are currently available for enrolment."
    }
        ,
        this.getWaitlistHeaderTooltip = function() {
            return n
        }
    ;
    var l = function() {
        return e(r, "you")
    }
        , u = function() {
        return e(r, "this course")
    }
        , d = function() {
        return e("Course {0} dates weren't found. Contact your registrar for assistance.", "enrolment")
    }
        , p = function() {
        return e("Course {0} dates weren't found. Contact your registrar for assistance.", "waitlist")
    }
        , f = function() {
        return e(a, "you")
    }
        , g = function() {
        return e(a, "this course")
    }
        , m = function() {
        return e(a, "you")
    }
        , h = function() {
        return e(a, "this course")
    }
        , v = function(t, n) {
        var r = "";
        return r = n ? i : o,
            e(r, "is not yet available for you", "this course", "your registrar", t, "to determine when enrolment will be available")
    }
        , C = function(t, n) {
        var r = "";
        return r = n ? i : o,
            e(r, "is not yet available for this course", "this course", "the course's offering division", t, "to determine when enrolment will be available")
    }
        , y = function(t) {
        return e(i, "dates weren't found", "courses", "your registrar", t, "for assistance")
    }
        , A = function(t) {
        return e(i, "is not yet available for you", "courses", "your registrar", t, "to determine when enrolment will be available")
    }
        , E = function(t) {
        return e('<span>You are not permitted access to this course via ACORN. Please contact the course\'s offering division (<key-dates-inline registration="{0}"></key-dates-inline>) for further details.</span>', t)
    }
        , T = function(t) {
        return e('<span>Your degree isn\'t eligible for course enrolment via ACORN. However, here are the courses you have been enrolled in, waitlisted, etc. by your division. Please contact the <key-dates-inline registration="{0}"></key-dates-inline> if you need assistance.</span>', t)
    }
        , S = function(e, n) {
        var r = null;
        return e == t.MA_ERROR ? r = n ? t.BEFORE_MA_DATE : t.AFTER_MA_DATE : e == t.M07_ERROR ? r = n ? t.BEFORE_M07_DATE : t.AFTER_M07_DATE : e == t.DATE_NOT_FOUND ? r = t.DATE_NOT_FOUND : e == t.NOT_ALLOWED && (r = t.NOT_ALLOWED),
            r
    };
    this.getDropCourseMsgForIntlStudents = function(t) {
        return e('There may be immigration implications if dropping this course brings you to part-time status. Please visit the <a href="{0}" target="_blank">{1}<data-icon-ext-link></data-icon-ext-link> </a> if you have questions about these implications.', t.url, t.text)
    }
        ,
        this.getTooltip = function(e) {
            var n = S(e.enrolmentErrorCode, e.enrolNotStarted)
                , r = {};
            if (null == n)
                return r;
            switch (n) {
                case t.BEFORE_MA_DATE:
                    r.enrol = l(),
                        r.waitlist = l();
                    break;
                case t.AFTER_MA_DATE:
                    r.enrol = f(),
                        r.waitlist = f();
                    break;
                case t.BEFORE_M07_DATE:
                    r.enrol = u(),
                        r.waitlist = u();
                    break;
                case t.AFTER_M07_DATE:
                    r.enrol = g(),
                        r.waitlist = g;
                    break;
                case t.DATE_NOT_FOUND:
                    r.enrol = d(),
                        r.waitlist = p();
                    break;
                case t.NOT_ALLOWED:
            }
            return r
        }
        ,
        this.getEnrolmentCartActivitiesFinalizedMessage = function(t, n, r, a) {
            if (t)
                return r ? e("You may add this course to your enrolment cart until {0}, but you may be blocked from enrolling once the priority enrolment period has ended if you are not affiliated with the course's offering division.", r.toString(), a) : e("You can add this course to your enrolment cart, but you may be blocked from enrolling once the priority enrolment period has ended if you are not affiliated with the course's offering division.", a);
            var i = Date.now();
            return i < new Date(n).getTime() ? e("The activities for this course are still being finalized by the offering division.  Please check back on {0} to view the available activities for the upcoming session and add them to your enrolment cart.", n.toString()) : i > new Date(r).getTime() ? e("The date to add this course to your enrolment cart has passed.", r.toString()) : void 0
        }
        ,
        this.getInfoMessage = function(e, n) {
            if (e.useSws && "N" === e.useSws)
                return T(e.registration);
            var r = S(e.enrolmentErrorCode, e.enrolNotStarted)
                , a = "";
            if (null == r)
                return a;
            switch (r) {
                case t.BEFORE_MA_DATE:
                    a = n ? A(e.registration) : v(e.registration, n);
                    break;
                case t.AFTER_MA_DATE:
                    a = m(),
                    n && 0 === e.nextEnrolmentErrorCode && (a = "Course enrolment is not available for Fall and full year courses, however, you can still enrol in Winter courses.");
                    break;
                case t.BEFORE_M07_DATE:
                    a = C(e.courseDivision, n);
                    break;
                case t.AFTER_M07_DATE:
                    a = h();
                    break;
                case t.DATE_NOT_FOUND:
                    n ? a = y(e.registration) : (e.courseInCart,
                        a = "Course enrolment dates weren't found. Contact your registrar for assistance.");
                    break;
                case t.NOT_ALLOWED:
                    a = E(e.courseDivision)
            }
            return a
        }
        ,
        this.getActivityThatNeedApprovalMessage = function(e, t) {
            var n = e ? "<p>Your request to enrol in {0} is being reviewed by your division. You may view your division&apos;s response in the Courses screen in ACORN.</p>" : "<p>You may request to enrol in {0} and view your division&apos;s response via the Courses screen in ACORN.</p>";
            return c(t, n)
        }
}
]),
angular.module("acornApp").factory("enrolmentServerResources", ["$resource", "enrolmentConstantsService", function(e, t) {
    return e(t.fullUrl, {}, {
        eligibleRegistrations: {
            method: "GET",
            params: {
                type: "eligible-registrations"
            },
            isArray: !0
        },
        getTermCourseLoads: {
            method: "GET",
            params: {
                type: "term-course-loads"
            },
            isArray: !1
        },
        enroledCourses: {
            method: "GET",
            params: {
                type: "course",
                command: "enrolled-courses"
            }
        },
        getCourseInfo: {
            method: "GET",
            params: {
                type: "course",
                command: "view"
            }
        },
        addCourseEnrol: {
            method: "POST",
            params: {
                type: "course",
                command: "modify"
            }
        },
        dropCourseEnrol: {
            method: "POST",
            params: {
                type: "course",
                command: "drop"
            }
        },
        dropSaveCourseEnrol: {
            method: "POST",
            params: {
                type: "course",
                command: "drop-save"
            }
        },
        getSimplifiedPreReq: {
            method: "GET",
            params: {
                type: "course",
                command: "get-course-prereqs"
            }
        },
        placeOnWaitList: {
            method: "POST",
            params: {
                type: "waitlist",
                command: "wait"
            }
        },
        confirmEnroledChange: {
            method: "POST",
            params: {
                type: "waitlist",
                command: "confirm-enrolled-change"
            }
        },
        getStartTimes: {
            method: "GET",
            params: {
                type: "course",
                command: "start-times"
            },
            isArray: !1
        },
        addCourseToPlan: {
            method: "POST",
            params: {
                type: "plan",
                sessionCode: "@sessionCode",
                candidacyPostCode: "@candidacyPostCode",
                candidacySessionCode: "@candidacySessionCode"
            }
        },
        updateCourseInPlan: {
            method: "POST",
            params: {
                type: "plan",
                command: "update",
                command2: "course",
                sessionCode: "@sessionCode",
                candidacyPostCode: "@candidacyPostCode",
                candidacySessionCode: "@candidacySessionCode"
            }
        },
        readPlan: {
            method: "GET",
            params: {
                type: "plan",
                sessionCode: "@sessionCode",
                candidacyPostCode: "@candidacyPostCode",
                candidacySessionCode: "@candidacySessionCode"
            },
            isArray: !0
        },
        deleteCourseFromPlan: {
            method: "DELETE",
            params: {
                type: "plan",
                planId: "@planId"
            }
        },
        bulkRemovePlan: {
            method: "POST",
            params: {
                type: "plan",
                command: "remove",
                sessionCode: "@sessionCode",
                candidacyPostCode: "@candidacyPostCode",
                candidacySessionCode: "@candidacySessionCode",
                regSessionCode: "@regSessionCode"
            }
        },
        cncInfo: {
            method: "GET",
            params: {
                type: "cnc",
                command: "info"
            }
        },
        getCNCTotalCredits: {
            method: "GET",
            params: {
                type: "cnc",
                command: "total-credits"
            }
        },
        addCNC: {
            method: "POST",
            params: {
                type: "cnc",
                command: "add-cnc"
            }
        },
        removeCNC: {
            method: "POST",
            params: {
                type: "cnc",
                command: "remove-cnc"
            }
        },
        cancelRegistration: {
            method: "POST",
            params: {
                type: "confirm-cancel-registration"
            }
        },
        getEnrolStatus: {
            method: "GET",
            params: {
                type: "enrol-status"
            },
            isArray: !1
        }
    })
}
]),
angular.module("acornApp").factory("formatString", function() {
    return function(e) {
        var t = arguments;
        return e.replace(/\{(\d+)}/g, function(e, n) {
            return t[1 * n + 1]
        })
    }
}),
angular.module("acornApp").factory("modalCourseData", function() {
    function e(e) {
        n = e
    }
    function t() {
        return n
    }
    var n = null;
    return {
        setData: e,
        getData: t
    }
}),
angular.module("acornApp").constant("PlanCRUDConstants", {
    EVENTS: {
        ADDED_TO_PLAN_SUCCESS: "ADD_TO_PLAN",
        UPDATED_IN_PLAN_SUCCESS: "UPDATE_IN_PLAN",
        PLAN_DELETE: "DELETE_ON_PLAN"
    }
}).factory("PlanCRUD", ["$rootScope", "$log", "$q", "enrolmentServerResources", "utGlobalHelpers", "PlanCRUDConstants", "ModalCourseConstants", "utToast", "acornCoreProperties", "acornCoreLib", "SessionAssignment", "EnrolledCoursesCartService", "eligibleRegistrations", function(e, t, n, r, a, i, o, s, c, l, u, d, p) {
    function f(e) {
        for (var t = [], n = e.messages.length, r = 0; r < n; r++)
            t.push({
                title: e.messages[r].getTitle(),
                value: e.messages[r].getTooltip().messages
            });
        return t
    }
    function g(e, t) {
        for (var n = 0; n < e.length; n++) {
            var r = e[n];
            if (r.activityId === t.activityId)
                return r
        }
        return null
    }
    function m(e, t) {
        if (void 0 === e || 0 === e.length)
            return [];
        if (t.waitListActivities && t.waitListActivities.length > 0) {
            for (var n = [], r = 0; r < t.waitListActivities.length; r++) {
                var a = t.waitListActivities[r]
                    , i = g(e, a);
                null != i && n.push(i)
            }
            return n
        }
        var o = g(e, t.primaryActivity);
        return null != o ? [o] : []
    }
    var h = function(e, t) {
        if (void 0 === e || 0 === e.length)
            return [];
        for (var n = e.length, r = 0; r < n; r++)
            if (e[r].activityId === t)
                return [e[r]]
    }
        , v = function(e, t) {
        var n = b(e.info);
        return {
            primaryActivities: m(n.primaryActivities, t),
            secondaryActivities: h(n.secondaryActivities, t.secondaryActivity.activityId),
            thirdActivities: h(n.thirdActivities, t.thirdActivity.activityId)
        }
    }
        , C = function(e, t) {
        return {
            courseCode: e.activityCode,
            courseTitle: e.activityTitle,
            sectionCode: e.sectionCode,
            info: v(e, t),
            messages: f(t),
            regSessions: u.addRegSessions(e),
            planId: e.planId
        }
    }
        , y = function(a, c, l) {
        var d = n.defer()
            , f = p.getCurrentEligibleRegistration()
            , g = {
            sessionCode: f.sessionCode,
            candidacyPostCode: f.candidacyPostCode,
            candidacySessionCode: f.candidacySessionCode
        }
            , m = C(c, l);
        return r.addCourseToPlan(g, m, function(t) {
            if (t._id) {
                var n = u.addRegSessions(c);
                for (var r in n)
                    n.hasOwnProperty(r) && (m[r] = n[r]);
                m._id = t._id,
                    m.sessionOrder = u.getSessionOrder(c),
                    E(m),
                    e.$broadcast(i.EVENTS.ADDED_TO_PLAN_SUCCESS, m),
                    d.resolve("Successfully added course to plan.")
            } else
                d.reject(t)
        }, function(n) {
            t.error(n),
                s.show({
                    text: "Failed to add course to plan. Please contact the administrator at your faculty.",
                    errorState: !0
                }),
                e.$broadcast(o.EVENTS.MODAL_ERROR, m),
                d.reject(n)
        }),
            d.promise
    }
        , A = function(a, c, l) {
        var d = n.defer()
            , f = p.getCurrentEligibleRegistration()
            , g = {
            sessionCode: f.sessionCode,
            candidacyPostCode: f.candidacyPostCode,
            candidacySessionCode: f.candidacySessionCode
        }
            , m = C(c, l);
        return r.updateCourseInPlan(g, m, function(t) {
            t.PLAN_SUCCESS ? (m.sessionOrder = u.getSessionOrder(c),
                E(m),
                e.$broadcast(i.EVENTS.UPDATED_IN_PLAN_SUCCESS, m),
                d.resolve("Successfully updated course in plan.")) : d.reject(t)
        }, function(n) {
            t.error(n),
                s.show({
                    text: "Failed to update plan. Please contact the administrator at your faculty.",
                    errorState: !0
                }),
                e.$broadcast(o.EVENTS.MODAL_ERROR, m),
                d.reject(n)
        }),
            d.promise
    }
        , E = function(e) {
        angular.isObject(e) && !angular.isArray(e) && (e = [e]);
        for (var t = e.length, n = {
            "Space Unavailable": !0,
            "Timetable Conflict": !0,
            "Enrolment Control": !0
        }, r = 0; r < t; r++)
            if (e[r].hasOwnProperty("messages"))
                for (var a = e[r].messages.length, i = a - 1; i >= 0; i--)
                    void 0 !== n[e[r].messages[i].title] && e[r].messages.splice(i, 1)
    }
        , T = function(e) {
        for (var t = 0; t < e.length; t++) {
            var n = e[t];
            n.sessionOrder = u.getSessionOrder(n),
                n.isPlannedItem = !0
        }
    }
        , S = function(e) {
        var n = p.getCurrentEligibleRegistration()
            , a = {
            sessionCode: n.sessionCode,
            candidacyPostCode: n.candidacyPostCode,
            candidacySessionCode: n.candidacySessionCode
        };
        r.readPlan(a, function(t) {
            e.loading = !1,
                e.plannedCourses = t,
                d.setCartCoursesAndProcess(t),
                E(e.plannedCourses),
                T(e.plannedCourses)
        }, function(n) {
            e.loading = !1,
                t.error(n),
            500 == n.status && (e.errorMessage = "Failed to load plan.  Database error, please try loading this page again.")
        })
    }
        , w = function(e) {
        for (var t = e.length, n = 0; n < t; n++) {
            var r = e[n];
            if (delete r.allowChangeActivity,
                    delete r.successfulUpdate,
                    delete r.enrollmentControlFull,
                    delete r.enrollmentControlMissing,
                    delete r.enrolmentIndicatorDisplay,
                    delete r.enrolmentIndicatorMsg,
                    delete r.enrolmentIndicatorDates,
                    delete r.full,
                    delete r.hoverText,
                    delete r.professorApprovalReq,
                    delete r.conflictingActivities,
                    delete r.deliveryMode,
                    delete r.indicator,
                    angular.isArray(r.days))
                for (var a = 0; a < r.days.length; a++) {
                    var i = r.days[a];
                    void 0 !== i.conflictMessage && delete i.conflictMessage
                }
        }
        return e
    }
        , b = function(e) {
        for (var t = ["primaryActivities", "secondaryActivities", "thirdActivities"], n = t.length, r = {}, a = 0; a < n; a++)
            e.hasOwnProperty(t[a]) && void 0 !== e[t[a]] ? r[t[a]] = w(e[t[a]]) : r[t[a]] = [];
        return r
    };
    return {
        addCourseToPlan: y,
        updateCourseInPlan: A,
        readPlan: S,
        deleteCourseFromPlan: function(n, a) {
            var o = {
                planId: a._id
            };
            r.deleteCourseFromPlan(o, function() {
                e.$broadcast(i.EVENTS.PLAN_DELETE, a)
            }, function(e) {
                t.error(e)
            })
        },
        bulkRemove: function(t, n) {
            for (var a = !1, i = 0; i < t.plannedCourses.length; i++)
                if (t.plannedCourses[i].courseCode === n.activityCode && t.plannedCourses[i].sectionCode === n.sectionCode) {
                    a = !0;
                    break
                }
            if (a) {
                var o = p.getCurrentEligibleRegistration()
                    , c = {
                    sessionCode: o.sessionCode,
                    regSessionCode: n.regSessionCode1,
                    candidacyPostCode: o.candidacyPostCode,
                    candidacySessionCode: o.candidacySessionCode
                }
                    , l = {
                    courseId: n.activityCode
                };
                r.bulkRemovePlan(c, l, function() {
                    e.$broadcast("DELETE_ALL_COURSECODE_FROM_PLAN", n.activityCode, n.regSessionCode1)
                }, function() {
                    s.show({
                        text: "You have not removed " + n.activityCode + " " + n.activityTitle + " from your enrolment cart.",
                        errorState: !0
                    })
                })
            }
        },
        buildPlanObject: C,
        filterNotUsedParams: b
    }
}
]),
angular.module("acornApp").factory("planManager", ["$rootScope", "strformat", "CourseCRUDConstants", "PlanCRUD", "SpaceUnavailable", function(e, t, n, r, a) {
    function i(e) {
        return void 0 === e || null == e || 0 == e.length
    }
    function o(e, t) {
        if (i(e) || null == t)
            return null;
        for (var n = 0; n < e.length; n++) {
            var r = e[n];
            if (r.activityId === t.activityId)
                return r
        }
        return null
    }
    function s(e) {
        return i(e) ? null : e[0]
    }
    function c(e, t) {
        if (i(t))
            return [];
        if (i(e))
            return [];
        for (var n = [], r = 0; r < t.length; r++) {
            var a = t[r]
                , s = o(e, a);
            null != s && (s.waitlistable && (s.checkedStatus = !0),
                n.push(s))
        }
        return n
    }
    function l(e) {
        var t = e.primaryActivities[0];
        return !(!e.secondaryActivities || 0 != e.secondaryActivities.length || !e.thirdActivities || 0 != e.thirdActivities.length) && (1 == t.waitlistable && 0 == t.spaceLeft)
    }
    function u(e) {
        function t(e) {
            return "<b>" + e.activityId + "</b>"
        }
        var n = "";
        if (0 != e.length) {
            if (n = t(e[0]),
                1 == e.length)
                return n;
            for (var r = 1; r < e.length - 1; r++)
                n = n + ", " + t(e[r]);
            return n = n + " and " + t(e[e.length - 1])
        }
    }
    function d(e, t) {
        return !(!t.info.primaryActivities || e.primaryActivity.length == t.info.primaryActivities.length) || (!(!t.info.secondaryActivities || e.secondaryActivity.length == t.info.secondaryActivities.length) || !(!t.info.thirdActivities || e.thirdActivity.length == t.info.thirdActivities.length))
    }
    function p(e) {
        var t = e.primaryActivity[0];
        return !!t.cancelled || (!!(e.secondaryActivity.length > 0 && (t = e.secondaryActivity[0],
                t.cancelled)) || !!(e.thirdActivity.length > 0 && (t = e.thirdActivity[0],
                t.cancelled)))
    }
    var f = function(e, t) {
        var n = c(e.info.primaryActivities, t.info.primaryActivities)
            , r = o(e.info.secondaryActivities, s(t.info.secondaryActivities))
            , a = o(e.info.thirdActivities, s(t.info.thirdActivities))
            , i = []
            , l = [];
        return null != r && (i = [r]),
        null != a && (l = [a]),
        {
            primaryActivity: n,
            secondaryActivity: i,
            thirdActivity: l
        }
    }
        , g = function(e, t) {
        var n = f(e, t);
        return {
            primaryActivity: n.primaryActivity && n.primaryActivity.length ? n.primaryActivity[0] : {},
            secondaryActivity: n.secondaryActivity && n.secondaryActivity.length ? n.secondaryActivity[0] : {},
            thirdActivity: n.thirdActivity && n.thirdActivity.length ? n.thirdActivity[0] : {}
        }
    };
    return {
        getPlanStatus: function(e, n) {
            var r = "Unfortunately, after you added this course to your enrolment cart, one or more of the activities that you selected ({1}) {0}. Please select a different section to enrol or waitlist in."
                , i = [];
            i = i.concat(n.info.primaryActivities),
            n.info.secondaryActivities && (i = i.concat(n.info.secondaryActivities)),
            n.info.thirdActivities && (i = i.concat(n.info.thirdActivities));
            var o = u(i);
            if (n.info.primaryActivities.length > 1 || l(n.info)) {
                var s, g = c(e.info.primaryActivities, n.info.primaryActivities), m = !0;
                if (null != g && g.length != n.info.primaryActivities.length)
                    m = !1,
                        s = t(r, "became unavailable", o);
                else
                    for (var h = 0; h < g.length; h++) {
                        var v = g[h];
                        if (v.cancelled) {
                            m = !1,
                                s = t(r, "was cancelled", o);
                            break
                        }
                        if (v.spaceLeft > 0) {
                            m = !1,
                                s = t("Good news! After you added this course to your enrolment cart, space became available in one or more of the activities that you selected({0}). You may now enrol directly in one of them.", o);
                            break
                        }
                    }
                if (0 == m)
                    return s
            } else {
                var C, y = !0, A = f(e, n);
                if (d(A, n) ? (y = !1,
                        C = t(r, "became unavailable", o)) : p(A) ? (y = !1,
                        C = t(r, "was cancelled", o)) : a.areAnyActivitiesFull(A) && (y = !1,
                        C = t(r, "became full", o)),
                    0 == y)
                    return C
            }
        },
        removeFromPlan: function(e, t) {
            r.bulkRemove(e, t)
        },
        getCurrentCourseBasedOnPlan: f,
        getCurrentCourseBasedOnPlanNonArray: g
    }
}
]),
angular.module("acornApp").factory("PreReqChecks", ["$q", "$log", "enrolmentServerResources", "Warnings", "Promises", function(e, t, n, r, a) {
    var i = function(e) {
        for (var t = [], n = e.length, r = 0; r < n; r++)
            t.push(e[r].description);
        return t
    }
        , o = function(e, t) {
        var n = []
            , a = {}
            , o = ["prerequisites", "corequisites", "exclusions", "orderedExclusions"]
            , s = {
            prerequisites: {
                title: "Prerequisite",
                firstMessage: "Course(s) you need to take before you are eligible for this one: ",
                type: "info"
            },
            corequisites: {
                title: "Corequisite",
                firstMessage: "Course must be taken during the same term, unless previously passed: ",
                type: "info"
            },
            exclusions: {
                title: "Exclusions",
                firstMessage: "Courses with content too similar to each other to be taken for credit: ",
                type: "info"
            },
            orderedExclusions: {
                title: "Ordered Exclusions",
                firstMessage: "Courses with content too similar to each other to be taken for credit: ",
                type: "info"
            }
        };
        if (void 0 !== t)
            for (var c = 0; c < o.length; c++) {
                var l = o[c];
                if (void 0 !== t[l] && (a[l] = i(t[l])),
                    a.hasOwnProperty(l) && a[l].length > 0) {
                    var u = s[l]
                        , d = a[l].slice();
                    void 0 !== u.firstMessage && d.splice(0, 0, u.firstMessage);
                    var p = r.createWarning(u.title, l, u.type, d.join("<br/>"));
                    n.push(p)
                }
            }
        return n
    }
        , s = function(e, r, a) {
        var i = {
            courseCode: e,
            sessionCode: r
        };
        n.getSimplifiedPreReq(i, function(e) {
            var t = o(0, e);
            a.resolve(t)
        }, function(e) {
            t.error("getSimplifiedPreReq failed with: " + e),
                a.reject("Failed to get prereqs")
        })
    };
    return {
        check: function(t, n) {
            var r = e.defer()
                , i = a.createDefaultCancellableAndTimeoutablePromise(r, "Course Requisites");
            return s(t, n, r),
                i
        }
    }
}
]),
angular.module("acornApp").factory("SessionAssignment", function() {
    function e(e) {
        switch (e) {
            case "F":
                return "First Sub-Session";
            case "S":
                return "Second Sub-Session";
            case "P":
                return "Summer";
            default:
                return "Full Session"
        }
    }
    var t = {
        FALL: "Fall",
        WINTER: "Winter",
        SUMMER: "Summer",
        FULL_SESSION: "Full Session"
    }
        , n = {
        9: t.FALL,
        1: t.WINTER,
        5: t.SUMMER,
        S: t.SUMMER,
        Y: t.FULL_SESSION
    }
        , r = function(e) {
        for (var t = ["regSessionCode1", "regSessionCode2", "regSessionCode3"], n = t.length, r = 0, a = 0; a < n; a++)
            e.hasOwnProperty(t[a]) && void 0 !== e[t[a]] && e[t[a]].length > 0 && r++;
        return !(r < 2)
    }
        , a = function(e) {
        return e.slice(-1)[0]
    }
        , i = {
        9: 1,
        1: 3,
        5: 4,
        S: 4,
        Y: 2
    };
    return {
        getSessionShortName: function(i) {
            var o = "";
            if (void 0 !== i) {
                r(i) ? o = "Y" : i.hasOwnProperty("regSessionCode1") && (o = a(i.regSessionCode1))
            }
            var s, c = n[o];
            return s = i.subSessionCode ? i.subSessionCode : i.sessionCode ? i.sessionCode.substring(i.sessionCode.length - 1) : "P",
                c === t.SUMMER ? e(s) : c
        },
        getSessionOrder: function(e) {
            var t = "";
            return void 0 !== e && (r(e) ? t = "Y" : e.hasOwnProperty("regSessionCode1") && (t = a(e.regSessionCode1))),
                i[t]
        },
        addRegSessions: function(e) {
            for (var t = {}, n = ["regSessionCode1", "regSessionCode2", "regSessionCode3"], r = n.length, a = 0; a < r; a++)
                void 0 !== e[n[a]] && e[n[a]].length > 0 && (t[n[a]] = e[n[a]]);
            return t
        }
    }
}),
angular.module("acornApp").factory("SpaceUnavailable", ["$q", "$log", "acornCoreProperties", "Promises", "Warnings", function(e, t, n, r, a) {
    function i(e) {
        if (!e || 0 == e.length)
            return !1;
        for (var t = 0; t < e.length; t++) {
            var n = e[t];
            if (l(n))
                return !0
        }
        return !1
    }
    function o(e, t) {
        for (var n = e.length, r = 0; r < n; r++)
            l(e[r]) && t.push(e[r].activityId)
    }
    function s(e) {
        var n = '<a href="http://www.future.utoronto.ca/current-students/registrars/" target="_blank">St. George registrar\'s website<data-icon-ext-link></data-icon-ext-link></a>'
            , r = '<a href="http://www.utm.utoronto.ca/registrar/" target="_blank">UTM registrar website<data-icon-ext-link></data-icon-ext-link></a>'
            , a = '<a href="http://www.utsc.utoronto.ca/~registrar/" target="_blank">UTSC registrar website<data-icon-ext-link></data-icon-ext-link></a>';
        return "STG" == e ? n : "ERIN" == e ? r : "SCAR" == e ? a : (t.error('_getCampusSpecificRegistrar: invalid CampusCode: "' + e + '" showing all campus registrar links'),
        '<ul style="margin-top: 0;"><li>' + n + "</li><li>" + r + "</li><li>" + a + "</li></ul>")
    }
    function c(t) {
        function n(e, n) {
            var r = 1 == n ? "this course" : "at least one section of this course"
                , i = t.currentCourse.campusCode
                , o = "";
            o = void 0 == i ? "You are currently blocked from enrolling in " + r + ". To determine if and when blocked sections of this course may become available to you, please consult the course&#39;s offering division or one of the following: " + s(i) : "You are currently blocked from enrolling in " + r + ". To determine if and when this activity may become available for you, consult the " + s(i) + "  or the course&#39;s offering division",
                e.resolve(a.createWarning("Enrolment Blocked", "spaceUnavailable", "warning", o))
        }
        var i = e.defer()
            , c = r.createDefaultCancellableAndTimeoutablePromise(i, "Space Unavailable")
            , l = []
            , u = t.currentCourse.info.primaryActivities.length;
        return o(t.currentCourse.info.primaryActivities, l),
        1 == u && t.currentCourse.waitlisted || t.currentCourse.waitlisted && 0 == l.length || (o(t.currentCourse.info.secondaryActivities, l),
            o(t.currentCourse.info.thirdActivities, l)),
            angular.isDefined(t.anySectionCancelled) ? i.reject("scope.anySectionCancelled is not defined so don't detect warnings") : l.length == u ? n(i, !0) : l.length > 0 ? n(i, !1) : i.reject("no space unavailable warning detected"),
            c
    }
    var l = function(e) {
        if (0 === e.spaceLeft && e.waitlistable !== !0)
            return !0
    };
    return {
        areAnyActivitiesFull: function(e) {
            return !!i(e.primaryActivity) || (!!i(e.secondaryActivity) || !!i(e.thirdActivity))
        },
        check: c
    }
}
]),
angular.module("acornApp").factory("TimetableConflict", ["$q", "$rootScope", "$log", "acornCoreProperties", "Promises", "Warnings", function(e, t, n, r, a, i) {
    function o(e) {
        return angular.isString(e) ? {
            SUNDAY: 0,
            MONDAY: 1,
            TUESDAY: 2,
            WEDNESDAY: 3,
            THURSDAY: 4,
            FRIDAY: 5,
            SATURDAY: 6
        }[e.toUpperCase()] || null : null
    }
    function s(e, t, n, r) {
        for (var a = [], i = 0, o = 0; i < e.length && o < t.length; ) {
            var s = e[i][n]
                , c = t[o][n];
            r === !0 && s > c ? a.push(e[i++]) : r === !1 && s < c ? a.push(e[i++]) : a.push(t[o++])
        }
        return a.concat(e.slice(i)).concat(t.slice(o))
    }
    function c(e, t, n) {
        if (e.length < 2)
            return e;
        var r = Math.floor(e.length / 2)
            , a = e.slice(0, r)
            , i = e.slice(r);
        return s(c(a, t, n), c(i, t, n), t, n)
    }
    function l(e) {
        var t = 0;
        if (!angular.isString(e) || !/\d+:\d+/.test(e))
            return t;
        var n = e.split(":")
            , r = parseInt(n[0], 10);
        return t += 60 * r + parseInt(n[1].replace(/[a-z]+/i, ""), 10),
        /PM/i.test(e) && r < 12 && (t += 720),
            t
    }
    function u(e) {
        var t = null
            , r = null;
        if (!angular.isObject(e) || !angular.isDefined(e.info) || !angular.isObject(e.info))
            return n.warn("Expected course object but got: ", e),
                t;
        angular.isObject(e.info) && (t = {});
        for (var a in e.info) {
            var i = e.info[a];
            if (angular.isArray(i) && 0 !== i.length)
                for (var s = i.length, c = 0; c < s; c++)
                    for (var u = i[c], d = u.days || [], p = d.length, f = 0; f < p; f++) {
                        var g = d[f]
                            , m = o(g.dayOfWeek);
                        null !== m ? (r = {},
                            angular.copy(u, r),
                            angular.extend(r, e),
                            angular.extend(r, u),
                            angular.extend(r, g),
                            delete r.info,
                            delete r.days,
                            delete r.note,
                            r.startTimeMinutes = l(r.startTime),
                            r.endTimeMinutes = l(r.endTime),
                        void 0 === t[m] && (t[m] = []),
                            t[m].push(r)) : n.warn("Invalid Day of week found for activity and day: ", u, g)
                    }
        }
        return t
    }
    function d(e) {
        var t = [];
        if (!angular.isArray(e))
            return null;
        for (var r = e.length, a = {}, i = 0; i < r; i++) {
            var o = e[i];
            if (angular.isDefined(o.activityCode) && angular.isDefined(o.activityId)) {
                var s = (o.activityCode + (o.instructor || "") + o.activityId).replace(/\s+/, "");
                angular.isDefined(a[s]) || (a[s] = !0,
                    t.push(e[i]))
            } else
                n.warn("Expected valid activity but got: ", o)
        }
        return t
    }
    function p(e) {
        return null != e && "5" == e.charAt(e.length - 1)
    }
    function f(e, t) {
        if (null == e || null == t)
            return !0;
        var n = !0;
        if (p(e.sessionCode) && p(t.sessionCode)) {
            var r = e.subSessionCode
                , a = t.subSessionCode;
            r !== a && (n = !("F" === r && "S" === a || "S" === r && "F" === a))
        }
        return n
    }
    function g(e) {
        var t = [];
        if (!angular.isArray(e))
            return t;
        for (var n = e.length, r = 0; r < n; r++)
            for (var a = e[r], i = r + 1; i < n; i++) {
                var o = e[i];
                a.startTimeMinutes < o.endTimeMinutes && a.endTimeMinutes > o.startTimeMinutes && a.activityCode !== o.activityCode && f(a, o) && t.push({
                    conflictedActivity1: a,
                    conflictedActivity2: o
                })
            }
        return t
    }
    function m(e) {
        var t = [];
        return angular.isObject(e) ? (e.regSessionCode1 && t.push(e.regSessionCode1),
        e.regSessionCode2 && t.push(e.regSessionCode2),
        e.regSessionCode3 && t.push(e.regSessionCode3),
            t) : t
    }
    function h(e, t) {
        var n = m(e)
            , r = m(t)
            , a = n.length
            , i = r.length
            , o = !1;
        if (0 === i)
            return o;
        for (var s = 0; s < a; s++)
            if (r.indexOf(n[s]) >= 0) {
                o = !0;
                break
            }
        return o
    }
    function v(e, t) {
        for (var n = r.getTimetableProperties(), a = null, i = "", o = t, s = o.conflictingActivities, c = null, l = !1, u = [], d = 0; d < s.length; d++) {
            var p = s[d]
                , f = p.conflictedActivity1
                , g = p.conflictedActivity2
                , m = null;
            if (f.activityCode === e.activityCode)
                m = g,
                    c = f;
            else {
                if (g.activityCode !== e.activityCode)
                    continue;
                m = f,
                    c = g
            }
            u.push({
                currentActivityObj: c,
                conflictActivityObj: m
            }),
                i += '<li><span style="color: lightblue">' + c.activityCode + " " + c.activityId + '</span> on <span style="text-decoration: underline;">' + c.dayOfWeek + '</span> <span style="color: lightgreen">' + c.startTime + " - " + c.endTime + '</span> <span style="color: rgb(237, 78, 78)">conflicts with</span> ',
                i += '<span style="color: lightblue">' + m.activityCode + " " + m.activityId + '</span> scheduled from  <span style="color: lightgreen">' + m.startTime + " - " + m.endTime + "</span></li>",
                l = !0
        }
        return l ? (a = n.messages.errors.conflict.defaultMessage + "<br />",
            a = a + "<ul>" + i + "<br />",
            o.tooltip.messages = a,
            o.conflictingActivities = u) : o = null,
            o
    }
    var C = e.defer()
        , y = {};
    return t.$on("CURRENTLY_ENROLED_READY", function(e, t) {
        y = t,
            C.resolve("Timetable conflict checked")
    }),
        t.$on("CURRENTLY_ENROLED_NOT_READY", function(e, t) {
            C.reject("Underlying course data failed to load: " + t)
        }),
    {
        check: function(t) {
            var n = e.defer()
                , r = a.createDefaultCancellableAndTimeoutablePromise(n, "Timetable Conflicts");
            return C.promise.then(function() {
                var e = [[], [], [], [], [], [], []]
                    , r = null;
                for (var a in y) {
                    switch (a.toUpperCase()) {
                        case "WAIT":
                        case "INT":
                        case "APP":
                            var o = y[a]
                                , s = o.length;
                            if (0 === s)
                                break;
                            for (var l = 0; l < s; l++)
                                if (h(t, o[l]) && (t.activityCode !== o[l].activityCode || t.sessionCode !== o[l].sessionCode)) {
                                    var p = u(o[l]);
                                    if (angular.isObject(p))
                                        for (var f in p) {
                                            var m = p[f];
                                            if (void 0 !== m)
                                                for (var C = 0; C < m.length; C++)
                                                    e[f].push(p[f][C])
                                        }
                                }
                    }
                }
                if (angular.isObject(t) && angular.isDefined(t.activityCode) && (r = u(t),
                        angular.isObject(r)))
                    for (f in r)
                        if (void 0 !== r[f])
                            for (C = 0; C < r[f].length; C++)
                                e[f].push(r[f][C]);
                var A = [[], [], [], [], [], [], []]
                    , E = e.length
                    , T = [];
                for (l = 0; l < E; l++)
                    p = e[l],
                    p.length < 1 || (A[l] = c(p, "startTimeMinutes", !1),
                        A[l] = d(A[l]),
                        T = T.concat(g(A[l])));
                if (T.length) {
                    var S = {
                        title: "Timetable Conflict",
                        name: "timeTableConflict",
                        type: "warning",
                        tooltip: {
                            messages: null
                        },
                        conflictingActivities: T
                    };
                    if (null !== (S = v(t, S))) {
                        var w = i.createWarning(S.title, S.name, "warning", S.tooltip.messages);
                        w.setConflictingActivities(S.conflictingActivities),
                            n.resolve(w)
                    } else
                        n.reject("no conflicts after all")
                } else
                    n.reject("no conflicts after all")
            }, function() {
                n.reject("courses not ready for currentCourse:" + t.activityCode)
            }),
                r
        }
    }
}
]),
angular.module("acornApp").factory("utGlobalHelpers", function() {
    return {
        isEmpty: function(e) {
            if (e === [])
                return !0;
            for (var t in e)
                if (e.hasOwnProperty(t))
                    return !1;
            return !0
        }
    }
}),
angular.module("acornApp").factory("WaitlistCRUD", ["$rootScope", "$q", "enrolmentServerResources", "DisplayCourseInfo", "acornCoreProperties", "acornCoreLib", "eligibleRegistrations", "utToast", "utTypeaheadState", "ModalCourseConstants", "CourseCRUDConstants", function(e, t, n, r, a, i, o, s, c, l, u) {
    var d = a.getEnrolmentProperties()
        , p = d.messages.toasts.waitlists
        , f = i.getPropertiesLib()
        , g = function(a, i) {
        var d = {}
            , g = t.defer()
            , m = {
            waitlistedCourse: {
                course: {
                    code: a.currentCourse.activityCode,
                    sectionCode: a.currentCourse.sectionCode,
                    status: a.currentCourse.status,
                    primaryTeachMethod: a.currentCourse.primaryTeachMethod
                },
                meetingSections: i
            },
            originalCourse: {
                code: a.currentCourse.activityCode,
                sectionCode: a.currentCourse.sectionCode,
                status: a.currentCourse.status,
                primaryTeachMethod: a.currentCourse.primaryTeachMethod,
                enroled: a.currentCourse.enroled,
                waitlistMeetings: a.currentCourse.waitlistMeetings
            },
            eligRegParams: r.prepareCourseVariables(o.getCurrentEligibleRegistration(), d)
        }
            , h = a.currentCourse
            , v = f.interpolatePropertyStringWithArgs(p.ADD, [h.activityCode + " " + h.sectionCode, h.activityTitle, o.getCurrentEligibleRegistration().sessionDescription]);
        return n.placeOnWaitList(m, function(t) {
            c.setState({
                term: ""
            }),
                s.show({
                    text: v,
                    warningState: !0
                }),
                e.$broadcast("ADD_TO_WAITLIST_CURRENTLY_ENROLED", {
                    currentActivity: a.currentActivity,
                    courseObj: a.currentCourse,
                    response: t.responseObject,
                    messages: t.messages
                }),
                e.$broadcast(u.EVENTS.PLAN_DROP_COURSE, a.currentCourse),
                g.resolve("Successfully added course to waitlist")
        }, function(t) {
            e.$broadcast(u.EVENTS.CURRENTLY_ENROLLED_FAILURE, t),
                e.$broadcast(l.EVENTS.MODAL_ERROR, "Failed to add to waitlist."),
                g.reject("Failed to add course to waitlist")
        }),
            g.promise
    }
        , m = function(e) {
        for (var t = e.length, n = 0; n < t; n++)
            if (e[n].joinedActivity)
                return e[n];
        return {}
    };
    return {
        addToWaitlist: g,
        addToWaitlistFromEnroled: function(a, i) {
            var o = {
                primary: m(a.currentCourse.info.primaryActivities),
                secondary: m(a.currentCourse.info.secondaryActivities),
                third: m(a.currentCourse.info.thirdActivities)
            }
                , d = {}
                , g = t.defer()
                , h = {
                waitlistedCourse: {
                    course: {
                        code: a.currentCourse.activityCode,
                        sectionCode: a.currentCourse.sectionCode,
                        status: a.currentCourse.status,
                        primaryTeachMethod: a.currentCourse.primaryTeachMethod
                    },
                    meetingSections: i
                },
                originalCourse: {
                    primaryTeachMethod: o.primary.teachMethod,
                    primarySectionNo: o.primary.sectionNo,
                    secondaryTeachMethod1: o.secondary.teachMethod,
                    secondarySectionNo1: o.secondary.sectionNo,
                    secondaryTeachMethod2: o.third.teachMethod,
                    secondarySectionNo2: o.third.sectionNo,
                    enroled: a.currentCourse.enroled
                },
                eligRegParams: r.prepareCourseVariables(a.eligibleRegistrations[a.enrolmentGlobalObj.currentSession], d)
            };
            return n.confirmEnroledChange(h, function(t) {
                var n = a.currentCourse
                    , r = f.interpolatePropertyStringWithArgs(p.ADD, [n.activityCode + " " + n.sectionCode, n.activityTitle, a.eligibleRegistrations[a.enrolmentGlobalObj.currentSession].sessionDescription]);
                c.setState({
                    term: ""
                }),
                    s.show({
                        text: r,
                        warningState: !0
                    }),
                    e.$broadcast("ADD_TO_WAITLIST_CURRENTLY_ENROLED", {
                        currentActivity: a.currentActivity,
                        courseObj: a.currentCourse,
                        response: t.responseObject,
                        messages: t.messages
                    }),
                    e.$broadcast(u.EVENTS.PLAN_DROP_COURSE, a.currentCourse),
                    g.resolve("Successfully changed from enroled to waitlist.")
            }, function(t) {
                e.$broadcast(u.EVENTS.CURRENTLY_ENROLLED_FAILURE, t),
                    e.$broadcast(l.EVENTS.MODAL_ERROR, "Failed to add to waitlist"),
                    g.reject("Failed to change from enroled to waitlist.")
            }),
                g.promise
        }
    }
}
]),
angular.module("acornApp").service("Warnings", function() {
    function e(e) {
        function t() {
            return l
        }
        function n() {
            return c
        }
        function r() {
            return u
        }
        function a() {
            return d
        }
        function i(e) {
            c.push(e)
        }
        function o() {
            u = !1,
                d = !1
        }
        function s() {
            u = !1,
                d = !0
        }
        var c = []
            , l = e
            , u = !0
            , d = !1;
        return {
            getName: t,
            getWarnings: n,
            isLoading: r,
            isFailed: a,
            setSuccess: o,
            setFailed: s,
            addWarning: i
        }
    }
    function t(e, t, n, r) {
        function a() {
            return u.tooltip ? u.tooltip : null
        }
        function i() {
            return u.title
        }
        function o() {
            return u.type
        }
        function s() {
            return u.name
        }
        function c() {
            return u.conflictingActivities
        }
        function l(e) {
            u.conflictingActivities = [];
            for (var t = 0; t < e.length; t++) {
                var n = e[t];
                u.conflictingActivities.push(n)
            }
        }
        var u = null;
        return function() {
            if (!angular.isString(e))
                throw new Error("title paramter must be a string");
            if (!angular.isString(t))
                throw new Error("name paramter must be a string");
            if (!angular.isString(n))
                throw new Error("type paramter must be a string");
            if (!angular.isString(r))
                throw new Error("tooltipMessage paramter must be a string");
            var a = {
                messages: r
            };
            u = {
                title: e,
                name: t,
                type: n,
                tooltip: a,
                conflictingActivities: []
            }
        }(),
        {
            getTooltip: a,
            getTitle: i,
            getName: s,
            getType: o,
            getConflictingActivities: c,
            setConflictingActivities: l
        }
    }
    function n(t, n, r) {
        if (void 0 === t)
            throw new Error("courseCode parameter is not defined.");
        if (void 0 === n)
            throw new Error("categoryName parameter is not defined");
        if (void 0 === r)
            throw new Error("Warning to be stored is undefined");
        var a = f[t];
        if (void 0 === a)
            throw new Error("Categories are not initialized for course: " + t);
        var i = a[n];
        void 0 === i && (i = new e(n),
            a[n] = i),
            i.addWarning(r)
    }
    function r(e, n, r, a) {
        return new t(e,n,r,a)
    }
    function a(e, t) {
        var n = f[e];
        if (n)
            for (var r in n)
                if (n.hasOwnProperty(r)) {
                    var a = n[r];
                    t(a)
                }
    }
    function i(e) {
        var t = [];
        return a(e, function(e) {
            var n = e.getWarnings();
            n.length > 0 && (t = t.concat(n))
        }),
            t
    }
    function o(e) {
        var t = []
            , n = []
            , r = [];
        return a(e, function(e) {
            e.isFailed() ? t.push(e.getName()) : e.isLoading() ? n.push(e.getName()) : r.push(e.getName())
        }),
        {
            loaded: r.length,
            loadedCategoryNames: r,
            loading: n.length,
            loadingCategoryNames: n,
            failed: t.length,
            failedCategoryNames: t
        }
    }
    function s(e, t) {
        return e.length > 0 ? e + "<br/>" + t : t
    }
    function c(e) {
        var t = o(e);
        if (0 !== t.loading || 0 !== t.failed) {
            var n, r = "";
            for (n = 0; n < t.failed; n++) {
                r = s(r, "Unable to Load " + t.failedCategoryNames[n])
            }
            for (n = 0; n < t.loading; n++) {
                r = s(r, "Loading " + t.loadingCategoryNames[n] + " &hellip;")
            }
            return r
        }
    }
    function l(e, t) {
        var n = e.getConflictingActivities();
        if ((!angular.isArray(n) || 0 != n.length) && t)
            for (var r = 0; r < n.length; r++) {
                var a = n[r]
                    , i = a.conflictActivityObj
                    , o = a.currentActivityObj;
                for (var s in t.info)
                    for (var c = t.info[s], l = 0; l < c.length; l++) {
                        var u = c[l];
                        if (u.activityId === o.activityId) {
                            angular.isArray(u.conflictingActivities) || (u.conflictingActivities = []),
                                u.conflictingActivities.push(i);
                            for (var d = 0; d < u.days.length; d++)
                                u.days[d].dayOfWeek === i.dayOfWeek && (void 0 == u.days[d].conflictMessage ? u.days[d].conflictMessage = {
                                    messages: "<strong>Timetable Conflict</strong> with the currently enrolled course(s):<ul><li>" + i.activityCode + ": " + i.activityId + " (" + i.dayOfWeek + " " + i.startTime + " - " + i.endTime + ")</li></ul>"
                                } : (u.days[d].conflictMessage.messages = u.days[d].conflictMessage.messages.replace("</ul>", ""),
                                    u.days[d].conflictMessage.messages += "<li>" + i.activityCode + ": " + i.activityId + " (" + i.dayOfWeek + " " + i.startTime + " - " + i.endTime + ")</li></ul>"));
                            break
                        }
                    }
            }
    }
    function u(t, n) {
        var r = {};
        f[t] = r;
        for (var a = 0; a < n.length; a++) {
            var i = n[a]
                , o = new e(i);
            r[i] = o
        }
    }
    function d(e, t) {
        f[e][t].setSuccess()
    }
    function p(e, t) {
        f[e][t].setFailed()
    }
    var f = {};
    return {
        createWarning: r,
        storeWarningForCourse: n,
        getWarningsForCourse: i,
        mergeTimeTableConflictsWithCurrentCourse: l,
        registerSuccessForCourse: d,
        registerFailureForCourse: p,
        initializeCourseCategories: u,
        getStatsForCourse: o,
        getStatsMessageForCourse: c
    }
}),
angular.module("acornApp").component("confirmationOfEnrolment", {
    bindings: {
        refresh: "<"
    },
    templateUrl: "partials/enrolmentLetter/confirmationOfEnrolment.html",
    controller: ConfirmationOfEnrolmentCtrl
}),
angular.module("acornApp").factory("enrolmentLetterServerResources", ["$resource", function(e) {
    return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
        downloadEnrolmentLetter: {
            method: "POST",
            params: {
                kind: "enrolment-letter",
                type: "generate-confirmation-letter",
                enrolmentLetter: "@enrolmentLetter"
            },
            responseType: "arraybuffer",
            isArray: !1,
            transformResponse: function(e) {
                return {
                    data: e
                }
            }
        },
        load: {
            method: "GET",
            params: {
                kind: "enrolment-letter",
                type: "load"
            }
        }
    })
}
]),
angular.module("acornApp").controller("FeePaymentCtrl", ["$scope", "$location", "$timeout", "$log", "$uibModal", "utToast", "feePaymentServerResources", "feePaymentConstants", "feePaymentResourcesService", "accountBalanceManager", "deviceZoomLock", "$httpParamSerializer", function(e, t, n, r, a, i, o, s, c, l, u, d) {
    function p(e, a) {
        if (e.result.then(function() {
                a = T
            }, function() {
                a = T
            }),
            a < T) {
            ++a;
            var l = Math.random();
            o.checkMonerisResponse({
                cb: l
            }, function(r) {
                var o = r.transactionStatus
                    , l = r.totalCharge
                    , u = s.TRANSACTION_STATUS;
                if (o == u.APPROVED || o == u.DECLINED) {
                    t.path("/transaction_history");
                    var d;
                    o == u.APPROVED ? (d = c.getPaymentSuccessToast(l),
                        i.show({
                            text: d,
                            successState: !0
                        })) : (d = c.getPaymentFailureToast(l),
                        i.show({
                            text: d,
                            errorState: !0
                        })),
                        e.close()
                } else
                    o == u.CANCELED ? (d = s.TOAST_PAYMENT_CANCELLED,
                        i.show({
                            text: d,
                            infoState: !0
                        }),
                        e.close()) : o == u.INCOMPLETE ? (d = s.TOAST_PAYMENT_INCOMPLETE,
                        i.show({
                            text: d,
                            errorState: !0
                        }),
                        e.close()) : n(function() {
                        p(e, a)
                    }, 1e3)
            }, function(t) {
                r.error(t);
                var n = s.TOAST_RESPONSE_PROCESSING_ERROR;
                i.show({
                    text: n,
                    errorState: !0
                }),
                    e.close()
            })
        }
    }
    var f = function(e) {
        r.error(e),
            i.show({
                text: s.TOAST_GENERAL_ERROR,
                errorState: !0
            })
    }
        , g = function(t) {
        e.accountBalanceObj = l.createAccountBalanceObj(t),
            e.configureAccountBalanceTooltip = l.configureBasicAccountBalanceTooltip
    }
        , m = function(t) {
        var n = new RegExp(s.REGEX_EMAIL)
            , r = n.test(t);
        e.isEmailReadonly = !!r
    }
        , h = function() {
        o.getCountries({}, function(t) {
            e.countries = t
        }, f)
    }
        , v = function() {
        o.getProvinces({}, function(t) {
            e.provinces = t
        }, f)
    }
        , C = function(e, t) {
        var n = Math.pow(10, t);
        return Math.round((n * e).toFixed(t)) / n
    };
    !function() {
        e.serviceFeePercentage = s.SERVICE_FEE_PERCENTAGE,
            e.minPayment = s.MIN_CC_FEE_PAYMENT,
            e.tpMaximumPayment = s.TOOLTIP_MAXIMUM_PAYMENT,
            e.tpServiceFee = s.TOOLTIP_SERVICE_FEE,
            e.payment = {},
            e.payment.convenienceFeeMsg = s.SERVICE_FEE_INITIAL_MSG,
            e.payment.totalAmountMsg = s.TOTAL_CHARGE_INITIAL_MSG,
            e.elemTitle = "",
            o.getPaymentInfo({}, function(t) {
                e.paymentInfo = t,
                    e.paymentInfoReceived = !0,
                    e.maxPayment = e.paymentInfo.maximumPayment,
                    e.payment.userEmail = e.paymentInfo.email,
                0 == e.maxPayment && (e.isReadonly = !0,
                    e.elemTitle = s.CANNOT_MAKE_PAYMENT),
                    g(e.paymentInfo.currentBalance),
                    m(e.payment.userEmail)
            }, f),
            o.getFeePaymentAmounts({}, function(t) {
                e.feePaymentAmounts = t,
                null != e.feePaymentAmounts.paymentAmount && (e.isReadonly = !0,
                    e.elemTitle = s.CANNOT_MAKE_PAYMENT),
                e.isReadonly || (h(),
                    v())
            }, f)
    }(),
        e.isDataInvalid = function(e) {
            return !(!e.$invalid || !e.$dirty)
        }
        ,
        e.validateEmail = function(e, t) {
            if (angular.isDefined(e)) {
                if (e.required)
                    return c.getFillInRequiredMsg(t);
                if (e.email)
                    return s.VALIDATION_EMAIL_MSG
            }
        }
    ;
    var y = function(e) {
        return c.getPaymentAmountValidationMsg(e)
    };
    e.validatePaymentAmount = function(t, n) {
        if (angular.isDefined(t)) {
            if (t.required)
                return c.getFillInRequiredMsg(n);
            if (t)
                return y(e.paymentInfo.maximumPayment)
        }
    }
        ,
        e.convenienceFee = function() {
            return e.payment.convenienceFee = C(e.payment.paidAmount * e.serviceFeePercentage / 100, 2),
                e.payment.convenienceFee
        }
        ,
        e.totalAmount = function() {
            return e.payment.totalAmount = C(Number(e.payment.paidAmount) + Number(e.payment.convenienceFee), 2),
                e.payment.totalAmount
        }
        ,
        e.showDefaultMsg = function(e) {
            return !!(!e.$dirty || e.$dirty && e.$invalid)
        }
        ,
        e.showAmount = function(e) {
            return !(!e.$dirty || !e.$valid)
        }
        ,
        e.isCountryCanadaOrUSA = function() {
            var t = !1;
            if (angular.isDefined(e.payment.billCountry)) {
                var n = s.COUNTRY;
                t = e.payment.billCountry === n.CANADA || e.payment.billCountry === n.USA
            }
            return t
        }
        ,
        e.provinceStateOrRegionLabel = function() {
            var t = "Region";
            if (angular.isDefined(e.payment.billCountry)) {
                var n = s.COUNTRY;
                e.payment.billCountry === n.CANADA ? t = "Province" : e.payment.billCountry === n.USA && (t = "State")
            }
            return t
        }
        ,
        e.zipOrPostalCodeLabel = function() {
            var t = "Postal Code";
            return angular.isDefined(e.payment.billCountry) && e.payment.billCountry === s.COUNTRY.USA && (t = "Zip Code"),
                t
        }
        ,
        e.validateBillPostalZipCode = function(e, t) {
            if (angular.isDefined(e)) {
                if (e.required)
                    return c.getFillInRequiredMsg(t);
                if (e.postalCode)
                    return c.getPostalZipCodeValidationMsg(t)
            }
        }
        ,
        e.resetRegionAndPostalZipCode = function() {
            e.payment.billStateOrProv = "",
                e.payment.billPostalCode = ""
        }
        ,
        e.validateRequired = function(e, t) {
            if (angular.isDefined(e) && e.required)
                return c.getFillInRequiredMsg(t)
        }
    ;
    var A = s.MONERIS_PARAMS_NAMES
        , E = function(t) {
        var n = function(t) {
            for (var n, r, a = e.countries, i = a.length, o = 0; o < i; o++)
                if (r = a[o],
                    r.code === t) {
                    n = r.description;
                    break
                }
            return n
        };
        this.getParams = function() {
            var e = n(t.billCountry)
                , r = {};
            return r[A.BILL_FIRST_NAME] = t.billFirstName,
                r[A.BILL_LAST_NAME] = t.billLastName,
                r[A.BILL_ADDRESS_ONE] = t.billAddressOne,
                r[A.BILL_CITY] = t.billCity,
                r[A.BILL_STATE_OR_PROVINCE] = t.billStateOrProv,
                r[A.BILL_POSTAL_CODE] = t.billPostalCode,
                r[A.BILL_COUNTRY] = e,
                r[A.BILL_EMAIL] = t.userEmail,
                r[A.TOTAL_CHARGE] = Number(t.paidAmount).toFixed(2),
                r
        }
    };
    e.makePayment = function() {
        var t = e.payment
            , n = new E(t)
            , i = n.getParams();
        o.storeInfoAndGetMonerisParams({
            billFirstName: i[A.BILL_FIRST_NAME],
            billLastName: i[A.BILL_LAST_NAME],
            billAddressOne: i[A.BILL_ADDRESS_ONE],
            billCity: i[A.BILL_CITY],
            billStateOrProvince: i[A.BILL_STATE_OR_PROVINCE],
            billPostalCode: i[A.BILL_POSTAL_CODE],
            billCountry: i[A.BILL_COUNTRY],
            email: i[A.BILL_EMAIL],
            paidAmount: t.paidAmount,
            convenienceFeeAmt: t.convenienceFee,
            totalAmount: t.totalAmount
        }, function(t) {
            r.info("Moneris params from backend:" + t);
            var n;
            for (var o in t)
                t.hasOwnProperty(o) && ("url" == o ? n = t.url : i[o] = t[o]);
            e.feePaymentGatewayUrl = n + "?" + d(i);
            var s = a.open({
                animation: !0,
                backdrop: "static",
                templateUrl: "partials/feePayment/monerisModal.html",
                scope: e,
                windowClass: "modal-lg-acorn"
            });
            u.setZoomLock(!0),
                function() {
                    var e = s.close;
                    s.close = function() {
                        u.setZoomLock(!1),
                            e.apply(s)
                    }
                }();
            p(s, 0)
        }, f)
    }
    ;
    var T = s.MAX_MONERIS_RESPONSE_SERVER_CHECKS
}
]),
angular.module("acornApp").controller("MakePaymentCtrl", ["$scope", "$log", "feePaymentServerResources", "feePaymentConstants", "utActionInProgressModal", "utToast", function(e, t, n, r, a, i) {
    function o(e, t) {
        this.id = e,
            this.templateUrl = t
    }
    var s = {
        BANK_PAYMENT_CARD_TEMPLATE: "BANK_PAYMENT_CARD_TEMPLATE",
        WESTERN_UNION_GLOBALPAY_CARD_TEMPLATE: "WESTERN_UNION_GLOBALPAY_CARD_TEMPLATE",
        CREDIT_CARD_PAYMENT_CARD_TEMPLATE: "CREDIT_CARD_PAYMENT_CARD_TEMPLATE",
        MAKING_A_PAYMENT_CARD_TEMPLATE: "MAKING_A_PAYMENT_CARD_TEMPLATE"
    }
        , c = function(e, t) {
        var n = angular.copy(e);
        if (t)
            for (var r = 0; r < n.length; r++)
                if (n[r].id && n[r].id === s.WESTERN_UNION_GLOBALPAY_CARD_TEMPLATE) {
                    n.splice(r, 1);
                    break
                }
        for (var a = [], i = 0; i < n.length; i++)
            n[i].templateUrl && a.push(n[i].templateUrl);
        return a
    };
    !function() {
        var a = [new o(s.BANK_PAYMENT_CARD_TEMPLATE,"partials/feePayment/cards/bankPaymentCard.html"), new o(s.WESTERN_UNION_GLOBALPAY_CARD_TEMPLATE,"partials/feePayment/cards/westernUnionGlobalpayCard.html"), new o(s.CREDIT_CARD_PAYMENT_CARD_TEMPLATE,"partials/feePayment/cards/creditCardPaymentCard.html"), new o(s.MAKING_A_PAYMENT_CARD_TEMPLATE,"partials/feePayment/cards/makingAPaymentCard.html")];
        e.cardTemplates = c(a, !1),
            e.serviceFeePercentage = r.SERVICE_FEE_PERCENTAGE,
            n.getFeePaymentAmounts({}, function(t) {
                e.feePaymentAmounts = t
            }, function(e) {
                t.error(e),
                    i.show({
                        text: r.TOAST_GENERAL_ERROR,
                        errorState: !0
                    })
            }),
            n.isStudentDomestic({}, function(t) {
                e.isStudentDomestic = t.value,
                    e.cardTemplates = c(a, e.isStudentDomestic)
            }, function(n) {
                t.error(n),
                    e.isStudentDomestic = !1,
                    e.cardTemplates = c(a, !1)
            }),
            n.getClosureDate({}, function(t) {
                e.closureDate = t;
                var n = new Date;
                if (e.forceToday && (n = e.forceToday),
                    e.closureDate && e.closureDate.from && e.closureDate.to) {
                    var a = new Date(e.closureDate.from)
                        , i = new Date(e.closureDate.to);
                    a.setDate(a.getDate() - r.CLOSURE_NUMBER_OF_DAYS_BEFORE),
                        i.setDate(i.getDate() + r.CLOSURE_NUMBER_OF_DAYS_AFTER),
                        e.closedForHolidays = n.getTime() > a.getTime() && n.getTime() < i.getTime()
                } else
                    e.closedForHolidays = !1
            }, function(n) {
                t.error(n),
                    e.closureDate = !1
            })
    }()
}
]),
angular.module("acornApp").directive("utValidatePostalZipCode", ["feePaymentConstants", function(e) {
    return {
        require: "ngModel",
        link: function(t, n, r, a) {
            function i(t, n) {
                return !t || !n || (n === e.COUNTRY.USA ? /^([0-9]{5})(?:[-\s]*([0-9]{4}))?$/.test(t) : n !== e.COUNTRY.CANADA || (t = t.trim().toLowerCase(),
                        /^([a-z][0-9][a-z][ ]{0,}[0-9][a-z][0-9])$/.test(t)))
            }
            a.$parsers.push(function(e) {
                var n = t.payment.billCountry
                    , r = i(e, n);
                return a.$setValidity("postalCode", r),
                    r ? e : void 0
            })
        }
    }
}
]),
angular.module("acornApp").service("feePaymentResourcesService", ["strformat", "feePaymentConstants", function(e, t) {
    this.getPaymentAmountValidationMsg = function(n) {
        return e(t.VALIDATION_PAYMENT_AMOUNT_MSG, n)
    }
        ,
        this.getPaymentMinAmountValidationMsg = function(n) {
            return e(t.VALIDATION_PAYMENT_MIN_AMOUNT_MSG, n)
        }
        ,
        this.getPaymentMaxAmountValidationMsg = function(n) {
            return e(t.VALIDATION_PAYMENT_MAX_AMOUNT_MSG, n)
        }
        ,
        this.getPostalZipCodeValidationMsg = function(n) {
            return e(t.VALIDATION_POSTAL_ZIP_CODE_MSG, n)
        }
        ,
        this.getFillInRequiredMsg = function(n) {
            return e(t.VALIDATION_REQUIRED_MSG, n)
        }
        ,
        this.getPaymentSuccessToast = function(n) {
            return e(t.TOAST_PAYMENT_SUCCESS, n)
        }
        ,
        this.getPaymentFailureToast = function(n) {
            return e(t.TOAST_PAYMENT_FAILURE, n)
        }
}
]),
function() {
    "use strict";
    angular.module("acornApp").factory("feePaymentServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/fee-payment/:action", {}, {
            getFeePaymentAmounts: {
                method: "GET",
                params: {
                    action: "feePaymentAmounts"
                },
                isArray: !1
            },
            getPaymentInfo: {
                method: "GET",
                params: {
                    action: "paymentInfo"
                },
                isArray: !1
            },
            checkMonerisResponse: {
                method: "GET",
                params: {
                    action: "monerisResponseStatus"
                },
                isArray: !1
            },
            getCountries: {
                method: "GET",
                params: {
                    action: "countries"
                },
                isArray: !0
            },
            getProvinces: {
                method: "GET",
                params: {
                    action: "provinces"
                },
                isArray: !1
            },
            isStudentDomestic: {
                method: "GET",
                params: {
                    action: "isStudentDomestic"
                },
                isArray: !1
            },
            getClosureDate: {
                method: "GET",
                params: {
                    action: "closure"
                },
                isArray: !1
            },
            storeInfoAndGetMonerisParams: {
                method: "POST",
                params: {
                    action: "monerisParams"
                },
                isArray: !1
            }
        })
    }
    ])
}(),
angular.module("acornApp").controller("AccountDetailsCtrl", ["$scope", "$uibModal", "$log", "utToast", "financialAccountServerResources", "feePaymentServerResources", "feePaymentConstants", function(e, t, n, r, a, i, o) {
    !function() {
        i.getFeePaymentAmounts({}, function(t) {
            e.feePaymentAmounts = t
        }, function(e) {
            n.warn(e),
                r.show({
                    text: o.TOAST_GENERAL_ERROR,
                    errorState: !0
                })
        }),
            a.getAccountDetails({}, function(t) {
                e.accountDetails = t.value
            }, function(e) {
                n.warn(e),
                    r.show({
                        text: o.TOAST_GENERAL_ERROR,
                        errorState: !0
                    })
            })
    }(),
        e.showGuideToReport = function() {
            t.open({
                animation: !0,
                templateUrl: "partials/financial/accountDetailsModal.html",
                windowClass: "modal-md-acorn"
            })
        }
}
]),
function() {
    "use strict";
    angular.module("acornApp").controller("FinancialAccountCtrl", ["$scope", "$log", "studentBasicInfoSvc", "utToast", "feePaymentConstants", "feePaymentServerResources", function(e, t, n, r, a, i) {
        e.user = {},
            e.invoicePrintDate = new Date,
            function() {
                n.getStudentBasicInfo().then(function(t) {
                    e.user = t
                }),
                    e.feePaymentInfoNotification = a.NOTIFICATION_INFO,
                    i.getFeePaymentAmounts({}, function(t) {
                        e.feePaymentAmounts = t
                    }, function(e) {
                        t.warn(e),
                            r.show({
                                text: a.TOAST_GENERAL_ERROR,
                                errorState: !0
                            })
                    })
            }()
    }
    ])
}(),
angular.module("acornApp").controller("PaymentHistoryCtrl", ["$scope", "$uibModal", "$log", "utToast", "financialAccountServerResources", "feePaymentConstants", function(e, t, n, r, a, i) {
    !function() {
        a.getTransactionHistory({}, function(t) {
            e.feePaymentHistoryObj = t,
                e.feePaymentAmounts = e.feePaymentHistoryObj.paymentAmounts,
                e.isAnyDeclinedPayment = function() {
                    return 0 != t.declinedFeePayments.length
                }
                ,
                e.isReconciledCreditCardFeePayment = function(e) {
                    return e.transactionCode === i.CC_FEE_PAYMENT_TRANSACTION_CODE
                }
        }, function(e) {
            n.error(e),
                r.show({
                    text: i.TOAST_GENERAL_ERROR,
                    errorState: !0
                })
        }),
            e.merchantName = i.MERCHANT_NAME
    }(),
        e.printPaymentHistory = function() {
            window.print()
        }
    ;
    var o = function() {
        t.open({
            animation: !0,
            templateUrl: "partials/feePayment/feePaymentModal.html",
            scope: e,
            windowClass: "modal-lg-acorn"
        })
    };
    e.reconciledTranReceipt = function(t) {
        a.getFeePaymentByTranSeq({
            id: t
        }, function(t) {
            e.feePayment = t,
                t.personId ? o() : r.show({
                    text: i.TOAST_NO_RECEIPT_DATA,
                    errorState: !0
                })
        }, function(e) {
            n.error(e),
                r.show({
                    text: i.TOAST_GENERAL_ERROR,
                    errorState: !0
                })
        })
    }
        ,
        e.nonReconciledTranReceipt = function(t) {
            a.getFeePayment({
                id: t
            }, function(t) {
                e.feePayment = t,
                    t.personId ? o() : r.show({
                        text: i.TOAST_NO_RECEIPT_DATA,
                        errorState: !0
                    })
            }, function(e) {
                n.error(e),
                    r.show({
                        text: i.TOAST_GENERAL_ERROR,
                        errorState: !0
                    })
            })
        }
        ,
        e.isApprovedPayment = function() {
            return "1" === e.feePayment.result
        }
    ;
    e.downloadPdf = function(e) {
        a.prepareForDownloadPDF({
            id: e
        }, {}, function(e) {
            angular.element(document.body).append('<iframe style="display:none" src="/sws/rest/financial-account/downloadPDF/' + e.value + '">')
        }, function(e) {
            n.error(e),
                r.show({
                    text: i.TOAST_GENERAL_ERROR,
                    errorState: !0
                })
        })
    }
}
]),
function() {
    "use strict";
    angular.module("acornApp").factory("financialAccountServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/financial-account/:action/:id", {}, {
            getAccountDetails: {
                method: "GET",
                params: {
                    action: "accountDetails"
                },
                isArray: !1
            },
            getTransactionHistory: {
                method: "GET",
                params: {
                    action: "transactionHistory"
                },
                isArray: !1
            },
            prepareForDownloadPDF: {
                method: "POST",
                params: {
                    action: "prepareForDownloadPDF",
                    id: "@id"
                },
                isArray: !1
            },
            getFeePayment: {
                method: "GET",
                params: {
                    action: "feePayment",
                    id: "@id"
                },
                isArray: !1
            },
            getFeePaymentByTranSeq: {
                method: "GET",
                params: {
                    action: "feePaymentByTranSeq",
                    id: "@id"
                },
                isArray: !1
            },
            getFeePaymentData: {
                method: "GET",
                params: {
                    action: "feePaymentData",
                    id: "@processDate"
                },
                isArray: !1
            }
        })
    }
    ])
}(),
function() {
    "use strict";
    angular.module("acornApp").controller("GraduationCtrl", ["$scope", "$parse", "$filter", "$log", "graduationManager", "graduationUtil", "graduationConstants", "acornToast", "acornToastConstants", "utMoment", "acornCoreLib", function(e, t, n, r, a, i, o, s, c, l, u) {
        function d(t) {
            t ? (e.data.sqpda = t.graduationInfo.sqpda,
                e.data.convocations = t.convocations,
                e.data.graduations = a.removeNonApplicableGraduations(t.graduationInfo.graduations),
                e.data.ticketingStartDate = t.ticketingStartDate,
                e.data.ticketingEndDate = t.ticketingEndDate,
                e.data.ticketsAvailableDate = t.ticketsAvailableDate,
                e.data.email = t.email,
                e.data.phoneList = t.phoneList,
                e.data.studentBasicInfo = t.studentBasicInfo,
                e.ticketsSelected = !1,
                p()) : e.data = {}
        }
        function p() {
            for (var t = 0; t < e.data.convocations.length; t++)
                if ("" === e.data.convocations[t].email && e.data.email && (e.data.convocations[t].email = e.data.email.email),
                    e.isEmailValid(e.data.convocations[t].email) || (e.data.convocations[t].email = ""),
                        e.data.convocations[t].studentConfirmedEmail = e.data.convocations[t].email,
                    "" === e.data.convocations[t].phone && e.data.phoneList && e.data.phoneList.list)
                    for (var n = 0; n < e.data.phoneList.list.length; n++)
                        if (e.isDateWithin(e.data.phoneList.list[n].efectiveDate, e.data.phoneList.list[n].terminationDate)) {
                            e.data.convocations[t].phone = e.data.phoneList.list[n].number;
                            break
                        }
        }
        function f(t) {
            if ("Y" !== t.studentAttendingIndicator) {
                var n = i.findObjectFromArray(t, e.data.convocations);
                t.extraGuestAccessNumber = "",
                    t.guestAttendingIndicator = "",
                    t.studentAccessRequiredIndicator = "",
                    t.email = n ? n.email : "",
                    t.phone = n ? n.phone : "",
                    t.gownInfo = "",
                    t.graduationPhotoReceivingIndicator = ""
            } else
                t.extraGuestAccessNumber = e.extraGuestAccessNumberDropdown.selected,
                    t.extraGuestNumber = e.extraGuestNumberDropdown.selected,
                    t.guestNumber = e.guestNumberDropdown.selected;
            "Y" !== t.studentAccessRequiredIndicator && (t.studentWheelchairRequestIndicator = "",
                t.studentOtherAccessRequestIndicator = ""),
            "Y" !== t.studentOtherAccessRequestIndicator && (t.studentOtherAccessRequestComment = ""),
            "Y" !== t.guestAttendingIndicator && (t.guestNumber = 0,
                t.extraGuestNumber = 0),
            t.guestNumber && 0 !== t.guestNumber || (t.guestAccessRequiredIndicator = ""),
            t.guestNumber < 2 && (t.extraGuestNumber = 0),
            "Y" !== t.guestAccessRequiredIndicator && (t.guestOtherAccessRequestIndicator = "",
                t.guestWheelchairRequestIndicator = ""),
            "Y" !== t.guestOtherAccessRequestIndicator && (t.guestOtherAccessRequestComment = ""),
            t.extraGuestNumber && 0 !== t.extraGuestNumber || (t.extraGuestAccessRequestIndicator = ""),
            "Y" !== t.extraGuestAccessRequestIndicator && (t.extraGuestAccessNumber = 0)
        }
        function g(t, n, r) {
            e.graduationView = t,
                e.selectedConvocation = angular.copy(n),
                e.selectedGraduation = angular.copy(r),
                e.guestExtraTickets(),
                e.guestExtraAccessTickets(e.selectedConvocation.extraGuestNumber),
                e.editableRSVPForm = "Y" !== n.studentAttendingIndicator,
                e.guestNumberDropdown.selected = e.selectedConvocation.guestNumber > 0 ? e.selectedConvocation.guestNumber : 1,
                e.isEmailInitiallyValid = e.isEmailValid(n.email),
                e.rsvpFormSubmitted = !1,
                e.getTickets()
        }
        e.graduationConstants = o,
            e.ticketsSelected = !1,
            e.currentSessionCode = i.getCurrentSessionCode();
        var m = "undefined" == typeof testBaseUrlForHttp ? location.protocol + "//" + window.location.host + "/" : testBaseUrlForHttp;
        e.validPhoneRexEx = /^\b\d{3}\b-\d{3}-\d{4}$/,
            e.guestNumberDropdown = {
                selected: 1,
                values: [1, 2]
            },
            e.data = {},
            e.isSmallScreenSize = a.isSmallScreenSize,
            e.sessionCodeToString = i.sessionCodeToString,
            e.isDateAfter = a.isDateAfter,
            e.isEmailValid = a.isEmailValid,
            e.isDateWithin = a.isDateWithin,
            e.isDateBefore = a.isDateBefore,
            e.getPostTicketingButtonName = a.getPostTicketingButtonName,
            e.shouldConvocationShow = a.shouldConvocationShow,
            e.shouldConvocationInfoPaneShow = a.shouldConvocationInfoPaneShow,
            e.attendigCeremonyToString = a.attendigCeremonyToString,
            e.shouldConvocationTableShow = a.shouldConvocationTableShow,
            e.ticketTypeToString = a.ticketTypeToString,
            e.yesNoToString = a.yesNoToString,
            e.guestExtraAccessTickets = function(t) {
                for (var n = [], r = 1; r <= t; r++)
                    n.push(r);
                var a = e.selectedConvocation.extraGuestAccessNumber;
                e.extraGuestAccessNumberDropdown = {
                    selected: a > 0 ? a : 1,
                    values: n
                }
            }
            ,
            e.guestExtraTickets = function() {
                for (var t = e.selectedConvocation.ceremony.maxExtraTicketsPerStudent, n = [], r = 0; r <= t; r++)
                    n.push(r);
                e.extraGuestNumberDropdown = {
                    selected: 0,
                    values: n
                },
                e.selectedConvocation && (e.extraGuestNumberDropdown.selected = e.selectedConvocation.extraGuestNumber)
            }
            ,
            e.getGraduationAndTicketingInfo = function() {
                a.getGraduationAndTicketingInfo({
                    sessionCode: i.getCurrentSessionCode()
                }).then(function(e) {
                    d(e)
                }, function() {})
            }
            ,
            e.updateGraduationRequest = function(t) {
                e.graduationIntendYes = "You have successfully indicated that you intend to graduate at the " + t.convocation + " convocation ceremony.",
                    e.graduationIntendNo = "You have successfully indicated that you do not intend to graduate for the " + t.convocation + " convocation ceremony.",
                    e.selectedGraduation = t,
                    a.updateGraduationRequest(t).then(function() {
                        "Y" === t.reqRecvdInd ? s.showToast({
                            message: e.graduationIntendYes,
                            type: c.TYPE_SUCCESS,
                            vPos: c.POSITION_TOP,
                            hPos: c.POSITION_RIGHT
                        }) : s.showToast({
                            message: e.graduationIntendNo,
                            type: c.TYPE_SUCCESS,
                            vPos: c.POSITION_TOP,
                            hPos: c.POSITION_RIGHT
                        })
                    }, function() {})
            }
            ,
            e.cancelGraduationRequest = function(e) {
                "Y" === e.reqRecvdInd ? e.reqRecvdInd = "N" : "N" === e.reqRecvdInd && (e.reqRecvdInd = "Y")
            }
            ,
            e.downloadTickets = function() {
                var t = []
                    , n = e.data.tickets
                    , r = {}
                    , i = [];
                angular.forEach(n, function(e) {
                    if (e.toBeDownloaded) {
                        var n = angular.copy(e);
                        i.push(n.id),
                            delete n.toBeDownloaded,
                            t.push(n)
                    }
                }),
                t.length > 0 && a.downloadTickets(t).then(function(t) {
                    var n = new Blob([t.data],{
                        type: "application/pdf"
                    });
                    u.saveBlobAsFile(n, "Tickest.pdf") && (r.studentId = e.data.studentBasicInfo.studentNo,
                        r.ticketIds = i,
                        a.updateTicketViewedInd(r))
                })
            }
            ,
            e.getGraduationFor = function(t) {
                return e.data.graduations.find(function(e) {
                    return e.postTitle === t.graduationTitle
                })
            }
            ,
            e.saveRSVP = function(t) {
                if (!t)
                    return e.rsvpFormSubmitted = !0,
                        !1;
                e.rsvpFormSubmitted = !1,
                    f(e.selectedConvocation),
                    a.updateConvocation(e.selectedConvocation).then(function(t) {
                        var n = t.errors;
                        if (n) {
                            e.rsvpFormSubmitted = !0;
                            var r = "The following errors were encountered";
                            return Object.keys(n).forEach(function(e) {
                                r += "<br>" + n[e]
                            }),
                                s.showToast({
                                    message: r,
                                    type: c.TYPE_DANGER
                                }),
                                !1
                        }
                        if (e.data.convocations = angular.copy(t.convocations),
                                p(),
                            "Y" === e.selectedConvocation.studentAttendingIndicator) {
                            var a = "You have successfully updated your ticket order and indicated that you will be attending the " + l(new Date(e.selectedConvocation.ceremonyDate)).format("MMMM YYYY") + " convocation.";
                            s.showToast({
                                message: a,
                                type: c.TYPE_SUCCESS
                            })
                        } else {
                            var i = "You have successfully indicated that you will not be attending the " + l(new Date(e.selectedConvocation.ceremonyDate)).format("MMMM YYYY") + " convocation ceremony.";
                            s.showToast({
                                message: i,
                                type: c.TYPE_SUCCESS
                            })
                        }
                        return e.setEditableRSVPForm(!1),
                            $(document).scrollTop(0),
                            !0
                    }, function() {
                        return !1
                    })
            }
            ,
            e.postTicketingMessage = "",
            e.getPostTicketingMessage = function() {
                for (var t = "", n = "", r = 0; r < e.data.convocations.length; r++) {
                    var a = e.data.convocations[r].studentAttendingIndicator;
                    if ("" === n)
                        t = a,
                            "Y" === a ? n = e.isDateWithin(e.data.ticketingEndDate.timestamp, e.data.ticketsAvailableDate.timestamp) ? "Congratulations, you're invited to convocation! Your tickets will be available to download on " + e.data.ticketsAvailableDate.timestampStr + ". Until then, you may review your submitted RSVP and guest ticket information, if applicable." : "Congratulations on graduating! You can now view your RSVP and download your guest tickets, if applicable." : (n = "N" === a ? "Congratulations on graduating! You indicated earlier that you will not be attending the convocation ceremony." : "Congratulations on graduating! You have not indicated whether you will be attending the convocation ceremony.",
                                n += '<br>You will be able to pickup your diploma or have it couriered to you after the convocation perioed. Visit the <a href="http://www.convocation.utoronto.ca/preparing-to-graduate/graduation-timeline-and-checklist" target="_blank">Office of Convocation website<data-icon-ext-link></data-icon-ext-link></a>for more infomation');
                    else if (a !== t) {
                        n = 'Congratulations on graduating! You can now view your RSVP and download your guest tickets, if applicable, for the ceremony you will be attending.<br>For the ceremony you will not be attending, you will be able to pick up your diploma or have it couriered to you after the convocation period. Visit the <a href="http://www.convocation.utoronto.ca/preparing-to-graduate/graduation-timeline-and-checklist" target="_blank">Office of Convocation website<data-icon-ext-link></data-icon-ext-link></a> for more information.';
                        break
                    }
                }
                e.postTicketingMessage = n
            }
            ,
            e.gitCurrentTicketingMessage = function() {
                var t = 0;
                return e.data.convocations && (t = e.data.convocations.length),
                    1 === t ? ("N" === e.data.convocations[0].studentAttendingIndicator ? "Congratulations on graduating! You indicated earlier that you will not be attending the convocation ceremony." : "Congratulations on graduating! You have not indicated whether you will be attending the convocation ceremony.") + '<p>You will be able to pick up your diploma or have it couriered (for a fee) to you after the convocation period. Visit the <a href="http://www.convocation.utoronto.ca/preparing-to-graduate/graduation-timeline-and-checklist" target="_blank">Office of Convocation website<data-icon-ext-link></data-icon-ext-link></a> for more information.</p>' : 'Congratulations on graduating! You can now view your RSVP and download your guest tickets, if applicable, for the ceremony you will be attending.<br>For the ceremony you will not be attending, you will be able to pick up your diploma or have it couriered to you after the convocation period.<p>Visit the <a href="http://www.convocation.utoronto.ca/preparing-to-graduate/graduation-timeline-and-checklist" target="_blank">Office of Convocation website<data-icon-ext-link></data-icon-ext-link></a> for more information.</p>'
            }
            ,
            e.changeView = function(t, n, r) {
                t || (e.graduationView = "default"),
                    "ticketingForm" === t ? a.getConvocations(n.sessionCode).then(function(a) {
                        e.data.convocations = a,
                            p(),
                            n = i.findObjectFromArray(n, e.data.convocations),
                            g(t, n, r)
                    }, function() {}) : g(t, n, r)
            }
            ,
            e.isStudentAttendingAnyCeremony = function() {
                var t = [];
                return e.data.convocations && angular.forEach(e.data.convocations, function(e) {
                    "Y" === e.studentAttendingIndicator && t.push(e)
                }),
                t.length > 0
            }
            ,
            e.setEditableRSVPForm = function(t) {
                e.editableRSVPForm = t
            }
            ,
            e.getTickets = function() {
                a.getTickets().then(function(t) {
                    e.data.tickets = t.ticketInfoList,
                        e.data.numberOfReservedTickets = i.getNumberOfTicketsForType(e.data.tickets, o.TICKET_RESERVED_SEATING),
                        e.data.numberOfRegularTickets = i.getNumberOfTicketsForType(e.data.tickets, o.TICKET_GALLERIE_SEATING)
                }, function() {})
            }
            ,
            e.isAnyTicketSelected = function() {
                return e.ticketsSelected
            }
            ,
            e.toggleForDownload = function(t, n) {
                var r = t.target.checked;
                e.ticketsSelected = !1;
                for (var a = e.data.tickets, i = 0; i < a.length; i++)
                    a[i].id === n && (a[i].toBeDownloaded = r),
                    a[i].toBeDownloaded && (e.ticketsSelected = !0)
            }
            ,
            this.init = function() {
                e.getGraduationAndTicketingInfo()
            }
            ,
            this.getTickets = function() {
                e.getTickets()
            }
            ,
            e.gownRentalTemplate = {
                messages: 'After ordering  a gown through <a href="https://www.buildagrad.ca/utoronto" target="_blank">The Gaspard gown rental page<data-icon-ext-link></data-icon-ext-link></a>, a confirmation code will be provided to you for use during the convocation ceremony RSVP process.'
            },
            e.photoReceivingIndicatorTempalte = {
                messages: "Your convocation photo will be emailed to you at the email address you've provided as well as physically mailed to you. Please confirm that <a href=\"" + m + 'sws/person/addressView.do?view.dispatch" target="_blank">your current mailing address</a> information is accurate.'
            },
            e.uOfTEmailTemplate = {
                messages: 'Please enter an official <abbr title="University of Toronto">U of T</abbr> email address to receive graduation and convocation ceremony communications. This address will likely end in @mail.utoronto.ca, @utoronto.ca or @toronto.edu'
            },
            e.otherAccessComment = {
                messages: "We will do our best to accommodate your needs, and if for any reason we anticipate we will be unable to fully do so, we will contact you with more information before the convocation ceremony."
            },
            this.init()
    }
    ])
}(),
angular.module("acornApp").directive("acornAlert", ["$timeout", function(e) {
    return {
        transclude: !0,
        restrict: "E",
        template: '<div class="acorn-alert alert alert-{{type}}" data-ng-show="{{dismissFlagValue}}" data-ng-transclude=""></div>',
        scope: {
            type: "@",
            dismissOnTimeout: "=?",
            dismissFlag: "&",
            dismissFlagValue: "@dismissFlag"
        },
        link: function(t, n) {
            function r() {
                s = !1
            }
            function a() {
                s = !0,
                t.dismissFlagValue || i()
            }
            function i() {
                s && n.find("div.acorn-alert").fadeOut("slow")
            }
            var o, s = !0;
            t.dismissOnTimeout = t.dismissOnTimeout || 5e3,
                t.$watch(t.dismissFlag, function(r) {
                    r && (t.dismissFlagValue = !0,
                        n.find("div.acorn-alert").removeClass("ng-hide"),
                        n.find("div.acorn-alert").show(),
                        t.dismissFlagValue = !0,
                        o = e(function() {
                            t.dismissFlagValue = !1,
                                i()
                        }, t.dismissOnTimeout))
                }, !0),
                angular.element(n).on("mouseover", r),
                angular.element(n).on("mouseleave", a),
                t.$on("$destroy", function() {
                    e.cancel(o),
                        angular.element(n).off("mouseover", r),
                        angular.element(n).off("mouseleave", a)
                })
        }
    }
}
]),
function() {
    "use strict";
    var e = angular.module("acornApp");
    e.directive("acornModal", ["$uibModal", function(e) {
        return {
            restrict: "EA",
            template: '<a class="{{linkClass}}" ng-click="open()">{{name}}</a>',
            link: function(t, n, r) {
                t.name = t.$eval(r.name),
                    t.linkClass = r.linkClass,
                    t.model = t.$eval(r.model),
                    t.open = function() {
                        e.open({
                            templateUrl: r.instanceTemplate,
                            controller: r.useCtrl,
                            animation: !0,
                            windowClass: "modal-lg-acorn",
                            backdrop: !0,
                            resolve: {
                                modelObject: function() {
                                    return t.model
                                }
                            }
                        }).result.then(function() {
                            t.$eval(r.onOk)
                        }, function() {
                            t.$eval(r.onCancel)
                        })
                    }
            }
        }
    }
    ]),
        e.controller("defaultModalController", ["$scope", "$uibModalInstance", "modelObject", function(e, t, n) {
            e.model = n,
                e.ok = function() {
                    t.close(e.model)
                }
                ,
                e.cancel = function() {
                    t.dismiss("cancel")
                }
        }
        ]),
        e.controller("gradRequestModalController", ["$scope", "$uibModalInstance", "modelObject", function(e, t, n) {
            e.model = n,
                e.answer = {
                    value: n.reqRecvdInd
                },
                e.ok = function() {
                    e.model.reqRecvdInd = e.answer.value,
                        t.close(e.model)
                }
                ,
                e.cancel = function() {
                    t.dismiss("cancel")
                }
        }
        ])
}(),
function() {
    "use strict";
    angular.module("acornApp").directive("equalTo", function() {
        return {
            require: "ngModel",
            restrict: "A",
            link: function(e, t, n, r) {
                var a = function() {
                    return e.$eval(n.ngModel) == e.$eval(n.equalTo)
                };
                e.$watch(a, function(e) {
                    r.$setValidity("equalTo", e)
                })
            }
        }
    })
}(),
function() {
    "use strict";
    angular.module("acornApp").service("graduationManager", ["$q", "$log", "graduationServerResources", "screenSizeQuery", "graduationConstants", function(e, t, n, r, a) {
        function i(e, t, n) {
            var r = [];
            return angular.forEach(e, function(e) {
                e.postTitle !== t.graduationTitle || n !== a.GRADUATION_REQUEST_REQUIRED || "N" !== e.reqRecvdInd && "" !== e.reqRecvdInd || r.push(e)
            }),
                r
        }
        function o(e, t) {
            if (t) {
                for (var n = 0; n < e.length; n++)
                    if (e[n][t.key] === t.value)
                        return e[n];
                return null
            }
        }
        var s = /.*?\b(utoronto\.ca|toronto\.edu)$/;
        this.getGraduationAndTicketingInfo = function(t) {
            var r = e.defer();
            return n.getGraduationAndTicketingInfo(t, function(e) {
                r.resolve(e)
            }, function() {
                r.reject(!1)
            }),
                r.promise
        }
            ,
            this.updateGraduationRequest = function(t) {
                var r = e.defer();
                return n.updateGraduationRequest(t, function(e) {
                    r.resolve(e)
                }, function() {
                    r.reject(!1)
                }),
                    r.promise
            }
            ,
            this.updateConvocation = function(t) {
                var r = e.defer();
                return n.updateConvocation(t, function(e) {
                    r.resolve(e)
                }, function(e) {
                    r.reject(e)
                }),
                    r.promise
            }
            ,
            this.getConvocations = function(t) {
                var r = e.defer();
                return n.getConvocations({
                    sessionCode: t
                }, function(e) {
                    r.resolve(e)
                }, function() {
                    r.reject(!1)
                }),
                    r.promise
            }
            ,
            this.getGraduations = function(t) {
                var r = e.defer();
                return n.getGraduations({
                    sessionCode: t
                }, function(e) {
                    r.resolve(e)
                }, function() {
                    r.reject(!1)
                }),
                    r.promise
            }
            ,
            this.downloadTickets = function(t) {
                var r = e.defer();
                return n.downloadTickets(t, function(e) {
                    r.resolve(e)
                }, function() {
                    r.reject(!1)
                }),
                    r.promise
            }
            ,
            this.updateTicketViewedInd = function(t) {
                var r = e.defer();
                return n.updateTicketViewedInd(angular.toJson(t), function() {
                    r.resolve("Update ticket viewed indicator succeeded.")
                }, function() {
                    r.reject("Update ticket viewed indicator failed.")
                }),
                    r.promise
            }
            ,
            this.getTickets = function() {
                var t = e.defer();
                return n.getTickets(null, function(e) {
                    t.resolve(e)
                }, function() {
                    t.reject(!1)
                }),
                    t.promise
            }
        ;
        var c = function(e, t) {
            var n = Date.now();
            return n <= new Date(t).getTime() && n >= new Date(e).getTime()
        }
            , l = function(e) {
            return e < new Date
        }
            , u = function(e) {
            return e > new Date
        }
            , d = function(e) {
            return s.test(e)
        };
        this.ticketTypeToString = function(e) {
            switch (e) {
                case a.TICKET_GALLERIE_SEATING:
                    return a.TICKET_GALLERIE_SEATING_STR;
                case a.TICKET_RESERVED_SEATING:
                    return a.TICKET_RESERVED_SEATING_STR;
                default:
                    return "Not Available"
            }
        }
            ,
            this.yesNoToString = function(e) {
                switch (e) {
                    case "Y":
                        return "Yes";
                    case "N":
                        return "No";
                    default:
                        return "N/A"
                }
            }
            ,
            this.shouldConvocationShow = function(e, t, n) {
                return !(i(e, t, n).length > 0)
            }
            ,
            this.shouldConvocationTableShow = function(e, t, n) {
                var r = [];
                if (!t || 0 === t.length)
                    return !1;
                if (t)
                    for (var a = 0; a < t.length; a++) {
                        var o = t[a];
                        r = r.concat(i(e, o, n))
                    }
                return r.length !== t.length
            }
            ,
            this.getPostTicketingButtonName = function(e, t) {
                return c(e, t) ? "View RSVP & Ticket Information" : "View RSVP & Download Tickets"
            }
            ,
            this.shouldConvocationInfoPaneShow = function(e, t) {
                var n = ""
                    , r = 0
                    , i = ""
                    , o = 0;
                return t && (r = t.messageNo),
                    e && e.length ? (angular.forEach(e, function(e) {
                        n = e.n10Allow,
                            i = e.reqRecvdInd,
                        (r !== a.GRADUATION_REQUEST_REQUIRED || "Y" !== i || n !== a.GRADUATION_DATE_CURRENT && n !== a.GRADUATION_DATE_PASSED) && r !== a.GRADUATION_REQUEST_NOT_REQUIRED || o++
                    }),
                    o > 0) : r === a.GRADUATION_REQUEST_NOT_REQUIRED
            }
            ,
            this.attendigCeremonyToString = function(e) {
                switch (e) {
                    case "Y":
                        return r.isSmall() ? "Attending" : "Yes";
                    case "N":
                        return r.isSmall() ? "Not Attending" : "No";
                    default:
                        return r.isSmall() ? "Attendance TBD" : "To be determined"
                }
            }
            ,
            this.isSmallScreenSize = r.isSmall,
            this.removeNonApplicableGraduations = function(e) {
                var t = {};
                if (e.forEach(function(e) {
                        var n = t[e.postCd];
                        n ? n.push(e) : (n = [],
                            n.push(e),
                            t[e.postCd] = n)
                    }),
                        Object.keys(t).length) {
                    e = [];
                    for (var n in t)
                        if (t.hasOwnProperty(n)) {
                            var r = t[n]
                                , a = o(r, {
                                key: "n10Allow",
                                value: "C"
                            });
                            a ? e.push(a) : (a = o(r, {
                                key: "n10Allow",
                                value: "F"
                            }),
                                a ? e.push(a) : (a = o(r, {
                                    key: "n10Allow",
                                    value: "P"
                                })) && e.push(a))
                        }
                }
                return e
            }
            ,
            this.isDateWithin = c,
            this.isDateAfter = l,
            this.isDateBefore = u,
            this.isEmailValid = d
    }
    ])
}(),
function() {
    "use strict";
    angular.module("acornApp").factory("graduationServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
            getGraduationAndTicketingInfo: {
                method: "GET",
                params: {
                    kind: "graduation",
                    type: "graduationAndTicketingInfo",
                    sessionCode: "@sessionCode"
                }
            },
            getGraduations: {
                method: "GET",
                params: {
                    kind: "graduation",
                    type: "graduations",
                    sessionCode: "@sessionCode"
                }
            },
            getConvocations: {
                method: "GET",
                params: {
                    kind: "graduation",
                    type: "convocations",
                    sessionCode: "@sessionCode"
                },
                isArray: !0
            },
            getTickets: {
                method: "GET",
                params: {
                    kind: "graduation",
                    type: "ticketing"
                }
            },
            updateGraduationRequest: {
                method: "POST",
                params: {
                    kind: "graduation",
                    type: "updateGraduationRequest",
                    sessionCode: "@sessionCode",
                    rsvpIndicator: "@rsvpIndicator"
                }
            },
            downloadTickets: {
                method: "POST",
                params: {
                    kind: "graduation",
                    type: "downloadTickets"
                },
                responseType: "arraybuffer",
                isArray: !1,
                transformResponse: function(e) {
                    return {
                        data: e
                    }
                }
            },
            updateConvocation: {
                method: "POST",
                params: {
                    kind: "graduation",
                    type: "saveRSVP"
                }
            },
            updateTicketViewedInd: {
                method: "POST",
                params: {
                    kind: "graduation",
                    type: "updateTicketViewedInd"
                }
            }
        })
    }
    ])
}(),
function() {
    "use strict";
    angular.module("acornApp").service("graduationUtil", [function() {
        this.getGraduationForSession = function(e, t) {
            if (t.length)
                for (var n = 0; n < t.length; n++)
                    if (t[n].sessionCd === e)
                        return t[n]
        }
            ,
            this.getNumberOfTicketsForType = function(e, t) {
                var n = [];
                return angular.forEach(e, function(e) {
                    e.ticketType === t && n.push(e)
                }),
                    n.length
            }
            ,
            this.getCurrentSessionCode = function() {
                var e, t = new Date, n = t.getFullYear(), r = t.getMonth() + 1;
                switch (r) {
                    case 1:
                    case 2:
                    case 3:
                    case 4:
                        e = "1";
                        break;
                    case 5:
                    case 6:
                    case 7:
                    case 8:
                        e = "5";
                        break;
                    case 9:
                    case 10:
                    case 11:
                    case 12:
                        e = "9"
                }
                return n + e
            }
            ,
            this.sessionCodeToString = function(e) {
                if (e && e.length > 4) {
                    var t = e.substring(0, 4)
                        , n = e.substring(4, 5)
                        , r = "";
                    switch (n) {
                        case "9":
                            r = "November";
                            break;
                        case "5":
                            r = "June"
                    }
                    return r + " " + t
                }
                return ""
            }
            ,
            this.findObjectFromArray = function(e, t) {
                var n;
                return angular.forEach(t, function(t) {
                    t.id === e.id && (n = t)
                }),
                    n
            }
    }
    ])
}(),
angular.module("acornApp").controller("GrantAppAwardsCtrl", ["$scope", "$log", "awardsManager", function(e, t, n) {
    !function() {
        e.getAmount = n.getAmount,
            e.getAwardsPayTime = n.getAwardsPayTime
    }()
}
]),
angular.module("acornApp").controller("GrantAppCacheCtrl", ["$scope", "grantAppCache", "awardsManager", function(e, t, n) {
    e.grantRequestAmount = t.getGrantRequestAmount(),
        e.organizationName = t.getOrgName(),
        e.organizationLink = n.getFinancialCounsellingLink(t.getOrgCode())
}
]),
angular.module("acornApp").controller("GrantAppCtrl", ["$scope", "$log", "$window", "$uibModal", "$q", "acornCoreLib", "grantAppServerResources", "grantAppOtherResources", "userService", "grantAppConstants", "awardsManager", "awardsConstants", "grantAppCache", "rounding", function(e, t, n, r, a, i, o, s, c, l, u, d, p, f) {
    function g(e) {
        return Number(e) === e && e % 1 != 0
    }
    function m(e) {
        return e && (e.studentAge < l.PARENTAL_AGE_LIMIT || e.marriedOrCommonLaw)
    }
    function h(e) {
        return e && e.familyIncome2
    }
    function v(e, t, n, r) {
        var a = "";
        return t.$setValidity("number", !0),
            t.$setValidity("min", !0),
        e.submitted && n && (t.$error.required ? a = "Please enter a number." : void 0 !== r && t.$modelValue < r ? (t.$setValidity("min", !1),
            a = "Please enter a valid number.") : g(t.$modelValue) && (a = "Please enter a valid number with no decimal.",
            t.$setValidity("number", !1))),
            a
    }
    var C = function(e) {
        for (var t = 0, n = 0; n < e.length; n++) {
            var r = e[n];
            "D" == r.debitCredit ? t += r.fee : "C" == r.debitCredit && (t -= r.fee)
        }
        return t
    }
        , y = function(e) {
        var t = null != e && 1 === e.length
            , n = null != e && e.length > 1
            , r = function() {
            return e.some(function(e) {
                return e.hasEmailAddress
            })
        }();
        this.hasOneOrgAndEmail = t && r,
            this.hasOneOrgButNoEmail = t && !r,
            this.hasMultipleOrgsButNoEmails = n && !r,
            this.hasMultipleOrgsAndEmails = n && r,
            this.appendTextToOrgsWithoutEmail = function() {
                null != e && 0 !== e.length && e.forEach(function(e) {
                    e.hasEmailAddress || (e.orgName = e.orgName + " " + l.ORG_NO_ONLINE_SUBMISSION)
                })
            }
    };
    e.beginApplication = function() {
        e.started = !0,
            s.moveStepToPosition("#step-0")
    }
        ,
        e.resumeApplication = function() {
            e.started = !0,
                e.resumeAtFurthestStep = !0
        }
        ,
        e.submitApplication = function() {
            e.finished = !0
        }
        ,
        e.hasSGSRegistration = function() {
            return e.formData.registrationList && e.formData.registrationList.find(function(e) {
                    return e.orgCode === l.SGS_ORG
                })
        }
        ,
        e.formData = {
            tooltipsData: {
                marriedOrCommonLaw: l.TOOLTIP_MARRIED_OR_COMMON_LAW,
                dependants: l.TOOLTIP_DEPENDANTS,
                firstInFamilyToAttendUniversity: {
                    ontarioResidents: l.TOOLTIP_FIRST_IN_FAMILY_ONT_RESIDENTS,
                    firstInFamily: l.TOOLTIP_FIRST_IN_FAMILY
                },
                familyIncome: l.TOOLTIP_FAMILY_INCOME,
                otherDependants: l.TOOLTIP_OTHER_DEPENDANTS,
                financialAssistance: l.TOOLTIP_GOVERNMENT_FIN_ASSISTANCE,
                netMonthlyIncome: l.TOOLTIP_NET_MONTHLY_INCOME,
                awards: l.TOOLTIP_AWARDS,
                familyFinancialSupport: l.TOOLTIP_FAMILY_FINANCIAL_SUPPORT,
                otherIncome: l.TOOLTIP_OTHER_INCOME,
                textbooks: l.TOOLTIP_TEXTBOOKS,
                courseSupplies: l.TOOLTIP_COURSE_SUPPLIES,
                diningOut: l.TOOLTIP_DINING_OUT,
                otherTranspAssociatedFees: l.TOOLTIP_OTHER_TRANSP_ASSOCIATED_FEES
            },
            optionsData: {
                housingOptions: s.getHousingOptions(),
                transportationOptions: s.getTransportationOptions(),
                familyIncomeTypeOptions: function(t) {
                    var n = s.getFamilyIncomeTypeOptions();
                    return e.formData.tools.isMarriedOrCommonLaw(t) ? e.grantApp.studentAge >= l.PARENTAL_AGE_LIMIT ? (t.familyIncomeType = 3,
                        n.filter(function(e) {
                            if (3 === e.id)
                                return e
                        })) : n : n.filter(function(e) {
                        if (3 != e.id)
                            return e
                    })
                },
                familyIncomeType2Options: s.getFamilyIncomeType2Options(),
                getHousingOption: function(e) {
                    return s.getHousingOptions().find(function(t) {
                        return t.id === e
                    })
                },
                getTranspOption: function(e) {
                    return s.getTransportationOptions().find(function(t) {
                        return t.id === e
                    })
                },
                getFamilyIncomeTypeOptions: function(e) {
                    return s.getFamilyIncomeTypeOptions().find(function(t) {
                        return t.id === e
                    })
                },
                getFamilyIncomeType2Options: function(e) {
                    return s.getFamilyIncomeType2Options().find(function(t) {
                        return t.id === e
                    })
                }
            },
            tools: {
                totalIncome: function(e) {
                    var t = 0;
                    return e ? (1 == e.governFinAssistance && e.governFinAssistanceAmt && (t += e.governFinAssistanceAmt),
                    e.workOutOfSchool && e.savings && (t += e.savings),
                    e.workTaRa && e.taOrRaNetMonthlyIncome && (t += 8 * e.taOrRaNetMonthlyIncome),
                    e.workPartTime && e.partTimeNetMonthlyIncome && (t += 8 * e.partTimeNetMonthlyIncome),
                    e.receivedAwards && e.awardsTotalAmt && (t += e.awardsTotalAmt),
                    e.parentalSupport && e.parentalSupportAmt && (t += e.parentalSupportAmt),
                    e.otherIncome && e.otherIncomeAmt && (t += e.otherIncomeAmt),
                    t && (t = f.round(t, 2)),
                        e.totalIncome = t,
                        t) : t
                },
                totalExpenses: function(e) {
                    var t = 0;
                    return e ? (e.tuition && (t += e.tuition),
                    e.textbooks && (t += e.textbooks),
                        e.residenceFee ? t += e.residenceFee : e.rentUtilities && (t += 8 * e.rentUtilities),
                    e.mealPlanFee && (t += e.mealPlanFee),
                    e.expensesFood && (t += 8 * e.expensesFood),
                    e.expensesTransportation && (t += 8 * e.expensesTransportation),
                    e.dependants && e.expensesChildcare && (t += 8 * e.expensesChildcare),
                    e.expensesOthers && (t += 8 * e.expensesOthers),
                    t && (t = f.round(t, 2)),
                        e.totalExpenses = t,
                        t) : t
                },
                assessmentSummary: function(e) {
                    var t;
                    return t = e.totalIncome >= e.totalExpenses ? 0 : f.round(Math.abs(e.totalIncome - e.totalExpenses), 2),
                        e.assessmentSummary = f.round(e.totalIncome - e.totalExpenses, 2),
                        t
                },
                totalSessionTuitionFees: function(n) {
                    var r = 0;
                    if (e.formData.fees.tuition)
                        if (n in e.formData.fees.tuition.feesBySession) {
                            var a = e.formData.fees.tuition.feesBySession[n];
                            r = f.round(C(a), 2)
                        } else
                            t.error("no tuition fees for sessionCode: " + n);
                    return r
                },
                totalSessionResidenceFees: function(n) {
                    var r = 0;
                    if (e.formData.fees.residence)
                        if (n in e.formData.fees.residence.sessionToFeeListMap)
                            for (var a = e.formData.fees.residence.sessionToFeeListMap[n], i = 0; i < a.length; i++) {
                                var o = a[i];
                                r += o.fee
                            }
                        else
                            t.error("no residence fees for sessionCode: " + n);
                    return f.round(r, 2)
                },
                totalSessionMealPlanFees: function(n) {
                    var r = 0;
                    if (e.formData.fees.mealPlan)
                        if (n in e.formData.fees.mealPlan.sessionToFeeListMap)
                            for (var a = e.formData.fees.mealPlan.sessionToFeeListMap[n], i = 0; i < a.length; i++) {
                                var o = a[i];
                                r += o.fee
                            }
                        else
                            t.error("no meal plan fees for sessionCode: " + n);
                    return f.round(r, 2)
                },
                isMarriedOrCommonLaw: function(e) {
                    return e && e.marriedOrCommonLaw
                },
                shouldIncomeSectionShow: m,
                netAmount2Entered: h,
                validateParent2Guardian2Selected: function(e, t) {
                    if (h(t) && e.submitted && !t.familyIncomeType2)
                        return l.SELECT_AN_OPTION
                },
                validateDependantAge: v,
                validateOtherDependants: v,
                validateParentalSpousalIncome: function(e, t, n) {
                    if (e.submitted && m(t) && n.$error.required)
                        return l.SELECT_AN_OPTION
                },
                validateRadio: function(e, t) {
                    if (t && e.submitted && t.$error.required)
                        return l.SELECT_AN_OPTION
                },
                validateAmount: function(e, t, n, r) {
                    if (t && (t.$setValidity("min", !0),
                        e.submitted && n)) {
                        var a = "";
                        return t.$error.required ? a = l.SELECT_AMOUNT : void 0 !== r ? t.$modelValue < r && (t.$setValidity("min", !1),
                            a = "Please enter a dollar amount more than " + r + ".") : t.$modelValue <= 0 && (a = "Please enter a dollar amount more than 0.",
                            t.$setValidity("min", !1)),
                            a
                    }
                },
                isMarriedAnd22OrOlder: function(e) {
                    return e && this.isMarriedOrCommonLaw(e) && e.studentAge && e.studentAge >= l.PARENTAL_AGE_LIMIT
                },
                isMarriedAndYoungerThan22: function(e) {
                    return e && this.isMarriedOrCommonLaw(e) && e.studentAge && e.studentAge < l.PARENTAL_AGE_LIMIT
                },
                isNotMarriedAndYoungerThan22: function(e) {
                    return e && !this.isMarriedOrCommonLaw(e) && e.studentAge && e.studentAge < l.PARENTAL_AGE_LIMIT
                },
                isStudentExamptFromSummerWork: function(e) {
                    return e.registeredInPreviousSummer && e.emailOrganizationCode === l.SGS_ORG
                }
            },
            modals: {
                transportationModal: function(e) {
                    e.governFinAssistance && !e.appealedGovernFinAssistance && e.transportationOptionIndex && e.transportationOptionIndex === l.TRANSIT_OPTION_INDEX && e.expensesTransportation && e.expensesTransportation > l.TRANSIT_EXPENSES && r.open({
                        animation: !0,
                        templateUrl: "partials/grantApp/transportationModal.html",
                        windowClass: "modal-md-acorn"
                    })
                },
                respectPrivacyModal: function() {
                    r.open({
                        animation: !0,
                        templateUrl: "partials/grantApp/respectPrivacyModal.html",
                        windowClass: "modal-md-acorn"
                    })
                }
            }
        },
        e.isFloat = g,
        function() {
            e.started = !1,
                e.finished = !1,
                e.resumeAtFurthestStep = !1,
                e.netIncomeTooltip = "Income after taxes and deductions",
                e.$watch("grantApp.dependants", function(t) {
                    1 == t && 0 == e.grantApp.dependantAges.length && e.grantApp.dependantAges.push(0)
                });
            var n = function() {
                var e = function(e) {
                    if (!e || 10 != e.length)
                        return "";
                    var t = e.split("-")
                        , n = t[0]
                        , r = t[1] - 1
                        , a = t[2];
                    return new Date(n,r,a)
                };
                this.checkSessionalEvents = function(t) {
                    var n = {
                        isGrantAppOpenForSubmissions: !0,
                        startDate: ""
                    };
                    if (t.sessionalEventExists) {
                        var r = new Date
                            , a = new Date(r.getFullYear(),r.getMonth(),r.getDate());
                        if (t.sessionalEventExists)
                            var i = e(t.ga1StartDate)
                                , o = e(t.ga1EndDate);
                        i && o ? a < i ? (n.isGrantAppOpenForSubmissions = !1,
                            n.startDate = t.ga1StartDate) : a > o && (n.isGrantAppOpenForSubmissions = !1,
                            n.startDate = "the next academic year") : (n.isGrantAppOpenForSubmissions = !1,
                            n.startDate = "the next academic year")
                    } else
                        n.isGrantAppOpenForSubmissions = !1,
                            n.startDate = "the next academic year";
                    return n
                }
            }
                , r = a.defer()
                , s = new n;
            o.getGrantApplication(function(t) {
                r.resolve(t),
                    e.grantApp = t,
                e.grantApp.emailOrganizationCode || p.getRegistrations().then(function(t) {
                    t.forEach(function(t) {
                        if (t.orgCode === l.SGS_ORG) {
                            e.grantApp.emailOrganizationCode = t.orgCode;
                            var n = s.checkSessionalEvents(t);
                            e.isGrantAppOpenForSubmissions = n.isGrantAppOpenForSubmissions,
                                e.startDate = n.startDate
                        }
                    })
                }),
                null == e.grantApp.dependantAges && (e.grantApp.dependantAges = []),
                    e.formData.tools.totalExpenses(e.grantApp),
                    e.formData.tools.totalIncome(e.grantApp)
            }, function(e) {
                r.reject(e),
                    t.error(e)
            }),
                o.getTuitionFees(function(t) {
                    e.formData.fees ? e.formData.fees.tuition = t : e.formData.fees = {
                        tuition: t
                    },
                        r.promise.then(function() {
                            p.updateFees(e.grantApp.originalTuition, e.grantApp.tuition, t, function(t) {
                                e.grantApp.originalTuition = t,
                                    e.grantApp.tuition = t
                            })
                        })
                }, function(e) {
                    t.error(e)
                }),
                o.getResidenceFees(function(t) {
                    e.formData.fees ? e.formData.fees.residence = t : e.formData.fees = {
                        residence: t
                    },
                        r.promise.then(function() {
                            p.updateFees(e.grantApp.originalResidenceFee, e.grantApp.residenceFee, t, function(t) {
                                e.grantApp.originalResidenceFee = t,
                                    e.grantApp.residenceFee = t
                            })
                        })
                }, function(e) {
                    t.error(e)
                }),
                o.getMealPlanFees(function(t) {
                    e.formData.fees ? e.formData.fees.mealPlan = t : e.formData.fees = {
                        mealPlan: t
                    },
                        r.promise.then(function() {
                            p.updateFees(e.grantApp.originalMealPlanFee, e.grantApp.mealPlanFee, t, function(t) {
                                e.grantApp.originalMealPlanFee = t,
                                    e.grantApp.mealPlanFee = t
                            })
                        })
                }, function(e) {
                    t.error(e)
                });
            var c = i.getUtilityLib().getCurrentSession().getSessionCode()
                , f = (new Date).getFullYear();
            u.getStudentAwards(c).then(function(t) {
                e.formData.studentAwards = {
                    installments: t.awards
                },
                    u.calculateAndSetRefundAmount(!1, e.formData.studentAwards.installments);
                var n = u.processAwards(e.formData.studentAwards.installments);
                e.formData.studentAwards.upcoming = n.upcoming,
                    e.formData.studentAwards.received = n.received,
                    e.formData.studentAwards.rescinded = n.rescinded;
                var a = i.getUtilityLib().getFallWinterSessionCodes(f);
                e.formData.studentAwards.fallSessionCode = a.fallSessionCode,
                    e.formData.studentAwards.winterSessionCode = a.winterSessionCode,
                    e.formData.studentAwards.totalReceived = u.getTotalAmount(e.formData.studentAwards.upcoming, e.formData.studentAwards.received, d.AWARD_TYPE_RECEIVED, a.fallSessionCode, a.winterSessionCode),
                    e.formData.studentAwards.totalUpcoming = u.getTotalAmount(e.formData.studentAwards.upcoming, e.formData.studentAwards.received, d.AWARD_TYPE_UPCOMING, a.fallSessionCode, a.winterSessionCode);
                var o = e.formData.studentAwards.totalReceived + e.formData.studentAwards.totalUpcoming;
                r.promise.then(function() {
                    p.updateFees(e.grantApp.originalAwardsTotalAmt, e.grantApp.awardsTotalAmt, {
                        totalFees: o
                    }, function(t) {
                        e.grantApp.originalAwardsTotalAmt = t,
                            e.grantApp.awardsTotalAmt = t,
                        o > 0 && (e.grantApp.receivedAwards = !0)
                    })
                })
            }, function(e) {
                t.log("failed to resolve student awards" + e)
            }),
                p.getRegistrations().then(function(n) {
                    e.formData.registrationList = n;
                    var r = e.formData.registrationList
                        , a = new y(r);
                    if (a.appendTextToOrgsWithoutEmail(),
                            e.hasOneOrgButNoEmail = a.hasOneOrgButNoEmail,
                            a.hasOneOrgButNoEmail) {
                        var i = r[0].orgCode;
                        u.getFinancialCounsellingLink(i) ? e.formData.oneOrgButNoEmailsUrl = u.getFinancialCounsellingLink(i) : (e.formData.oneOrgButNoEmailsUrl = l.GENERAL_FINANCAIL_COUNSELLING_LINK,
                            t.error("*** No financial counselling link was fond for organization with code " + i))
                    }
                    if (e.hasOneOrgAndEmail = a.hasOneOrgAndEmail,
                        a.hasOneOrgAndEmail && e.$watch("grantApp.emailOrganizationCode", function() {
                            e.grantApp && (e.grantApp.emailOrganizationCode = r[0].orgCode)
                        }),
                            e.hasMultipleOrgsButNoEmails = a.hasMultipleOrgsButNoEmails,
                        a.hasMultipleOrgsButNoEmails && (e.formData.multipleOrgsButNoEmailsUrl = l.GENERAL_FINANCAIL_COUNSELLING_LINK),
                            e.hasMultipleOrgsAndEmails = a.hasMultipleOrgsAndEmails,
                        a.hasMultipleOrgsAndEmails && (e.isGrantAppOpenForSubmissions = !0),
                            e.hasOneOrgAndEmail) {
                        var o = r[0]
                            , c = s.checkSessionalEvents(o);
                        e.isGrantAppOpenForSubmissions = c.isGrantAppOpenForSubmissions,
                            e.startDate = c.startDate
                    }
                    e.orgChanged = function() {
                        var t = r.find(function(t) {
                            var n = e.grantApp.emailOrganizationCode;
                            if (n && n == t.orgCode)
                                return t
                        });
                        if (t) {
                            var n = s.checkSessionalEvents(t);
                            e.isGrantAppOpenForSubmissions = n.isGrantAppOpenForSubmissions,
                                e.startDate = n.startDate
                        }
                    }
                }, function(e) {
                    t.error(e)
                })
        }()
}
]),
angular.module("acornApp").controller("GrantAppDependantAgeCtrl", ["$scope", function(e) {
    function t() {
        e.grantApp && e.grantApp.dependantAges && (n = e.grantApp.dependantAges.length)
    }
    var n = 1;
    e.$watch("grantApp.dependantAges.length", function(e, n) {
        e !== n && t()
    }),
        e.dependantAgeIndices = function() {
            for (var e = [], t = 0; t < n; t++)
                e.push(t);
            return e
        }
        ,
        e.addDependant = function() {
            n++
        }
        ,
        e.removeDependant = function(t) {
            1 != n && (n--,
                e.grantApp.dependantAges.splice(t, 1))
        }
        ,
        t()
}
]),
angular.module("acornApp").controller("GrantAppMailingAddressCtrl", ["$scope", "$log", "$window", "userService", function(e, t, n, r) {
    e.modifyContactInfo = function() {
        n.location.href = "/sws/person/main.do"
    }
        ,
        function() {
            r.getMailingAddress(function(t) {
                e.mailingAddress = t
            }, function(e) {
                t.error(e)
            }),
                r.getEmailAddress(function(t) {
                    e.emailAddress = t
                }, function(e) {
                    t.error(e)
                })
        }()
}
]),
angular.module("acornApp").controller("GrantAppMealPlanFeesCtrl", ["$scope", function(e) {
    function t() {
        if (e.formData.fees && e.formData.fees.mealPlan && e.formData.fees.mealPlan.sessionToFeeListMap) {
            e.mealPlanFeeSessions = Object.keys(e.formData.fees.mealPlan.sessionToFeeListMap);
            for (var t = 0, n = 0; n < e.mealPlanFeeSessions.length; n++) {
                var r = e.mealPlanFeeSessions[n];
                t += e.formData.tools.totalSessionMealPlanFees(r)
            }
            e.totalMealPlanFees = t
        }
    }
    e.$watch("formData.fees.mealPlan", function() {
        t()
    }),
        t()
}
]),
angular.module("acornApp").controller("GrantAppResidenceFeesCtrl", ["$scope", function(e) {
    function t() {
        if (e.formData.fees && e.formData.fees.residence && e.formData.fees.residence.sessionToFeeListMap) {
            e.residenceFeeSessions = Object.keys(e.formData.fees.residence.sessionToFeeListMap);
            for (var t = 0, n = 0; n < e.residenceFeeSessions.length; n++) {
                var r = e.residenceFeeSessions[n];
                t += e.formData.tools.totalSessionResidenceFees(r)
            }
            e.totalResidenceFees = t
        }
    }
    e.$watch("formData.fees.residence", function() {
        t()
    }),
        t()
}
]),
angular.module("acornApp").controller("GrantAppTotalExpensesCtrl", ["$scope", function(e) {
    function t(t, n) {
        null != t && t === n || e.formData.tools.totalExpenses(e.grantApp)
    }
    e.$watch("grantApp.tuition", t),
        e.$watch("grantApp.textbooks", t),
        e.$watch("grantApp.residenceFee", t),
        e.$watch("grantApp.rentUtilities", t),
        e.$watch("grantApp.mealPlanFee", t),
        e.$watch("grantApp.expensesFood", t),
        e.$watch("grantApp.expensesTransportation", t),
        e.$watch("grantApp.expensesChildcare", t),
        e.$watch("grantApp.expensesOthers", t)
}
]),
angular.module("acornApp").controller("GrantAppTotalIncomeCtrl", ["$scope", function(e) {
    function t(t, n) {
        null != t && t === n || e.formData.tools.totalIncome(e.grantApp)
    }
    e.$watch("grantApp.governFinAssistanceAmt", t),
        e.$watch("grantApp.savings", t),
        e.$watch("grantApp.taOrRaNetMonthlyIncome", t),
        e.$watch("grantApp.partTimeNetMonthlyIncome", t),
        e.$watch("grantApp.awardsTotalAmt", t),
        e.$watch("grantApp.parentalSupportAmt", t),
        e.$watch("grantApp.otherIncomeAmt", t)
}
]),
angular.module("acornApp").controller("GrantAppTuitionFeesCtrl", ["$scope", function(e) {
    function t() {
        if (e.formData.fees && e.formData.fees.tuition && e.formData.fees.tuition.feesBySession) {
            e.tuitionFeeSessions = Object.keys(e.formData.fees.tuition.feesBySession);
            for (var t = 0, n = 0; n < e.tuitionFeeSessions.length; n++) {
                var r = e.tuitionFeeSessions[n];
                t += e.formData.tools.totalSessionTuitionFees(r)
            }
            e.totalTuitionFees = t
        }
    }
    e.$watch("formData.fees.tuition", function() {
        t()
    }),
        t()
}
]),
angular.module("acornApp").directive("grantAppAwardsDetails", ["DevConfig", function(e) {
    return {
        restrict: "A",
        replace: !0,
        template: function() {
            return e.isDevelopmentMode() ? '<div class="row acorn-info" data-ng-controller="GrantAppAwardsCtrl" data-ng-show="formData.studentAwards.totalReceived > 0 || formData.studentAwards.totalUpcoming > 0" >   <div class="col-md-12">       <b>Note</b> This detailed Awards block is only for testing and will be removed from the final application.       <p></p>       The target data range is: {{formData.studentAwards.fallSessionCode}} to {{formData.studentAwards.winterSessionCode}}   </div>   <div class="col-md-10">       <table class="table">           <tr><th>Name</th><th>Amount</th><th>Pay Date</th></tr>           <tr data-ng-repeat="installment in formData.studentAwards.installments">               <td>{{installment.longName}}</td>               <td>{{getAmount(installment) | acornCurrency}}</td>               <td>{{getAwardsPayTime(installment)}}</td>           </tr>       </table>       <p></p>   </div>   <div class="clearfix"></div>   Total Upcoming Awards: {{formData.studentAwards.totalUpcoming | acornCurrency}}   <br/>   Total Received Awards: {{formData.studentAwards.totalReceived | acornCurrency}}</div>' : ""
        }()
    }
}
]),
angular.module("acornApp").directive("grantAppMealPlanDetails", ["DevConfig", function(e) {
    return {
        restrict: "A",
        replace: !0,
        template: function() {
            return e.isDevelopmentMode() ? '<div class="row acorn-info" data-ng-show="formData.fees.mealPlan" data-ng-controller="GrantAppMealPlanFeesCtrl">   <div class="col-md-12">       <b>Note</b> This detailed fees block is only for testing and will be removed from the final application.       <p></p>   </div>   <div class="col-md-6" data-ng-repeat="sessionCode in mealPlanFeeSessions">       <table class="table">           <tr><th>Session</th><th>Residence</th><th>Description</th><th>Fee</th></tr>           <tr data-ng-repeat="fees in formData.fees.mealPlan.sessionToFeeListMap[sessionCode]">               <td>{{fees.sessionCode}}</td>               <td>{{fees.residenceName}}</td>               <td>{{fees.description}}</td>               <td>{{fees.fee | acornCurrency}}</td>           </tr>           <tr>               <td></td>               <td>Session Total</td>               <td>{{formData.tools.totalSessionMealPlanFees(sessionCode) | acornCurrency}}</td>           </tr>       </table>       <p></p>   </div>   <div class="clearfix"></div>   Total ROSI Meal Plan Fees: {{totalMealPlanFees | acornCurrency}}</div>' : ""
        }()
    }
}
]),
angular.module("acornApp").directive("grantAppResidenceDetails", ["DevConfig", function(e) {
    return {
        restrict: "A",
        replace: !0,
        template: function() {
            return e.isDevelopmentMode() ? '<div class="row acorn-info" data-ng-show="formData.fees.residence" data-ng-controller="GrantAppResidenceFeesCtrl">   <div class="col-md-12">       <b>Note</b> This detailed fees block is only for testing and will be removed from the final application.       <p></p>   </div>   <div class="col-md-6" data-ng-repeat="sessionCode in residenceFeeSessions">       <table class="table">           <tr><th>Session</th><th>Residence</th><th>Description</th><th>Fee</th></tr>           <tr data-ng-repeat="fees in formData.fees.residence.sessionToFeeListMap[sessionCode]">               <td>{{fees.sessionCode}}</td>               <td>{{fees.residenceName}}</td>               <td>{{fees.description}}</td>               <td>{{fees.fee | acornCurrency}}</td>           </tr>           <tr>               <td></td>               <td>Session Total</td>               <td>{{formData.tools.totalSessionResidenceFees(sessionCode) | acornCurrency}}</td>           </tr>       </table>       <p></p>   </div>   <div class="clearfix"></div>   Total ROSI Residence Fees: {{totalResidenceFees | acornCurrency}}</div>' : ""
        }()
    }
}
]),
angular.module("acornApp").directive("grantAppTuitionDetails", ["DevConfig", function(e) {
    return {
        restrict: "A",
        replace: !0,
        template: function() {
            return e.isDevelopmentMode() ? '<div class="row acorn-info" data-ng-show="formData.fees.tuition" data-ng-controller="GrantAppTuitionFeesCtrl">   <div class="col-md-12">       <b>Note</b> This detailed fees block is only for testing and will be removed from the final application.       <p></p>   </div>   <div class="col-md-6" data-ng-repeat="sessionCode in tuitionFeeSessions">       <table class="table">           <tr><th>Session</th><th>DebitCredit</th></th><th>Fee</th></tr>           <tr data-ng-repeat="fees in formData.fees.tuition.feesBySession[sessionCode]">               <td>{{fees.sessionCode}}</td>               <td>{{fees.debitCredit}}</td>               <td>{{fees.fee | acornCurrency}}</td>           </tr>           <tr>               <td></td>               <td>Session Total</td>               <td>{{formData.tools.totalSessionTuitionFees(sessionCode) | acornCurrency}}</td>           </tr>       </table>       <p></p>   </div>   <div class="clearfix"></div>   Total Tuition Fees: {{totalTuitionFees | acornCurrency}}</div>' : ""
        }()
    }
}
]),
angular.module("acornApp").directive("requestAmountDir", ["rounding", function(e) {
    var t = function(t) {
        t.totalIncome >= t.totalExpenses ? t.requestAmount = 0 : t.requestAmount = e.round(Math.abs(t.totalIncome - t.totalExpenses), 2)
    };
    return {
        restrict: "A",
        link: function(e) {
            e.$watch("grantApp.totalIncome", function(n, r) {
                n === r && null != e.grantApp.requestAmount || t(e.grantApp)
            }),
                e.$watch("grantApp.totalExpenses", function(n, r) {
                    n === r && null != e.grantApp.requestAmount || t(e.grantApp)
                })
        }
    }
}
]),
angular.module("acornApp").directive("tuitionFeesDir", ["rounding", function(e) {
    return {
        restrict: "A",
        link: function(t) {
            t.grantApp.tuition = e.round(t.totalTuitionFees, 2)
        }
    }
}
]),
angular.module("acornApp").directive("utCgaStepMenu", ["$anchorScroll", "$location", "$timeout", "$log", "$window", "utToast", "grantAppServerResources", "grantAppOtherResources", "grantAppCache", "awardsManager", "grantAppConstants", function(e, t, n, r, a, i, o, s, c, l, u) {
    var d = [{
        id: 1,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Personal & Family Info",
        headingName: "Personal & Family Information",
        submitButtonText: "Save and Continue",
        url: "partials/grantApp/personalInfo.html"
    }, {
        id: 2,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Government Info",
        headingName: "Government Information",
        submitButtonText: "Save and Continue",
        url: "partials/grantApp/governmentInfo.html"
    }, {
        id: 3,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Incoming Funds",
        headingName: "Employment, Awards & Other Incoming Funds",
        submitButtonText: "Save and Continue",
        url: "partials/grantApp/incomingFunds.html"
    }, {
        id: 4,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Expenses",
        headingName: "Estimated Expenses",
        submitButtonText: "Save and Continue",
        url: "partials/grantApp/estimatedExpenses.html"
    }, {
        id: 5,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Need Assessment",
        headingName: "Summary of Need Assessment",
        submitButtonText: "Continue",
        url: "partials/grantApp/needAssessment.html"
    }, {
        id: 6,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Personal Statement",
        headingName: "Personal Statement",
        submitButtonText: "Save and Continue",
        url: "partials/grantApp/personalStatement.html"
    }, {
        id: 7,
        submitted: !1,
        grantAppConstants: u,
        menuName: "Declaration & Submit",
        headingName: "Declaration & Submit",
        submitButtonText: "Submit Application",
        url: "partials/grantApp/declaration.html"
    }];
    return {
        template: '<div>   <div id="step-menu-container" class="step-menu-container">       <div class="step-menu">           <div class="btn-group btn-group-justified application-form-progress hidden-sm hidden-xs visible-md visible-lg" role="group">               <a data-ng-repeat="step in availableSteps" data-ng-click="selectStep(step)" href="" role="button" data-ng-class="{active: isSelectedStep(step.id), furthest: step.id == grantApp.furthestStep, navigable: step.id <= grantApp.furthestStep}" class="btn btn-default text-left">{{step.id}}. {{step.menuName}} </a>           </div>           <div class="visible-xs visible-sm hidden-md hidden-lg">               <div class="dropdown">                   <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">                       <span data-ng-bind="getSelectedStepName()"></span>                       <span class="dropdown-toggle-icon">                           <i class="fa fa-caret-up fa"></i>                           <i class="fa fa-caret-down fa"></i>                       </span>                   </button>                  <ul class="dropdown-menu">                       <li data-ng-repeat="step in availableSteps"><a data-ng-click="selectStep(step)" href="" data-ng-class="{active: isSelectedStep(step.id), furthest: step.id == grantApp.furthestStep, navigable: step.id <= grantApp.furthestStep}">{{step.id}}. {{step.menuName}} </a></li>                   </ul>               </div>           </div>       </div>   </div>   <div class="grant-app-menu-spacer"></div>   <div class="active-step-container">      <div id="step-0"></div>      <form novalidate role="form" name="mainForm">       <div class="step-data" data-ng-repeat="step in activeSteps" >           <h2>{{step.id}}. {{step.headingName}}</h2>           <ng-form novalidate role="form" name="form" ng-class="{submitted: step.submitted}">               <div data-ng-include="step.url" data-onload="onLoad(step)"></div>               <br/>               <button data-ng-click="submitStep(step, mainForm)"                        class="btn btn-primary btn-bottom-space" data-ng-disabled="submittingApp">                      <i data-ng-show="submittingApp" class="fa fa-spinner fa-pulse fa-fw"></i>                      {{step.submitButtonText}}</button>           </ng-form>           <div id="step-{{step.id}}"></div>       </div>       </form>   </div></div>',
        scope: {
            applicationCompleteFn: "&",
            grantApp: "=",
            resumeAtFurthestStep: "=",
            formData: "=formData"
        },
        link: function(e) {
            function p(t) {
                for (var n = e.activeSteps.length; n < t; n++) {
                    var r = d[n];
                    e.activeSteps.push(r)
                }
                e.activeStep = e.activeSteps[e.activeSteps.length - 1],
                1 == e.resumeAtFurthestStep && (e.resumeAtFurthestStep = !1,
                    f(e.activeStep))
            }
            function f(e) {
                s.moveStepToPosition("#step-" + (e.id - 1))
            }
            function g() {
                d.forEach(function(e) {
                    e.submitted = !1
                })
            }
            function m(e) {
                e.studentAge >= u.PARENTAL_AGE_LIMIT && !e.marriedOrCommonLaw && (e.familyIncome = null,
                    e.familyIncomeType = "",
                    e.familyIncome2 = null,
                    e.familyIncomeType2 = ""),
                e.dependants || e.dependantAges && e.dependantAges.length > 0 && e.dependantAges.splice(0, e.dependantAges.length),
                e.otherDependants || (e.otherDependantsAttendingUniversity = null)
            }
            function h(e) {
                e.governFinAssistance || (e.governFinAssistanceAmt = null)
            }
            function v(e) {
                e.workOutOfSchool || (e.earnings = null,
                    e.savings = null),
                e.workTaRa || (e.taOrRaNetMonthlyIncome = null),
                e.workPartTime || (e.partTimeNetMonthlyIncome = null),
                e.receivedAwards || (e.awardsTotalAmt = null),
                e.parentalSupport || (e.parentalSupportAmt = null),
                e.otherIncome || (e.otherIncomeAmt = null)
            }
            function C(e) {
                for (var t = 0; t < e; t++)
                    d[t].submitted = !0
            }
            var y = function() {
                if (e.formData.fees && e.formData.fees.tuition && e.formData.fees.tuition.feesBySession) {
                    e.tuitionFeeSessions = Object.keys(e.formData.fees.tuition.feesBySession);
                    for (var t = 0, n = 0; n < e.tuitionFeeSessions.length; n++) {
                        var r = e.tuitionFeeSessions[n];
                        t += e.formData.tools.totalSessionTuitionFees(r)
                    }
                    return t
                }
            }
                , A = function(t) {
                var n = e.grantApp;
                switch (t) {
                    case u.STEP_1:
                        m(n);
                        break;
                    case u.STEP_2:
                        m(n),
                            h(n);
                        break;
                    default:
                        m(n),
                            h(n),
                            v(n)
                }
            }
                , E = function() {
                var t = e.grantApp.housingOptionIndex;
                if (t) {
                    var n = e.formData.optionsData.getHousingOption(t);
                    e.grantApp.housingOptionText = n.option
                }
                var r = e.grantApp.transportationOptionIndex;
                if (r) {
                    var a = e.formData.optionsData.getTranspOption(r);
                    e.grantApp.transportationOptionText = a.option
                }
                var i = e.grantApp.familyIncomeType;
                if (i) {
                    var o = e.formData.optionsData.getFamilyIncomeTypeOptions(i);
                    e.grantApp.familyIncomeTypeText = o.option
                }
                var s = e.grantApp.familyIncomeType2;
                if (s) {
                    var c = e.formData.optionsData.getFamilyIncomeType2Options(s);
                    e.grantApp.familyIncomeType2Text = c.option
                }
            };
            e.submitStep = function(t, n) {
                switch (C(t.id),
                    A(t.id),
                    t.id) {
                    case u.STEP_4:
                        e.formData.modals.transportationModal(e.grantApp);
                        break;
                    case u.STEP_7:
                        E(),
                            e.grantApp.emailOrganizationName = c.getOrgName(e.grantApp.emailOrganizationCode),
                            e.grantApp.originalTuition = y(),
                            c.setGrantRequestAmount(e.grantApp.requestAmount),
                            c.setOrgCode(e.grantApp.emailOrganizationCode)
                }
                if (n.$invalid) {
                    var a = angular.element(angular.element("select.ng-invalid, input.ng-invalid, textarea.ng-invalid")[0])
                        , l = a.closest(".form-group").length ? a.closest(".form-group") : a;
                    return void s.moveElementToPosition(l)
                }
                if (t.id === u.STEP_7)
                    return void e.submitApp();
                o.saveGrantApplication(angular.toJson(e.grantApp), function(n) {
                    r.log("success: " + n);
                    var a = n.responseObject
                        , i = a.applicationId;
                    e.grantApp.id = i;
                    var o = parseInt(a.furthestStep);
                    if (e.grantApp.furthestStep = o,
                            r.log("furthest step = " + o),
                        o > d.length)
                        return void e.applicationCompleteFn();
                    p(o);
                    var s = d[t.id];
                    t.id + 1 == o ? (e.activeStep = s,
                        f(e.activeStep)) : t.id == o || (e.activeStep = s,
                        f(s))
                }, function(e) {
                    r.info(e),
                        i.show({
                            text: u.TOAST_SAVE_AND_CONTINUE_MSG,
                            errorState: !0
                        })
                })
            }
                ,
                e.submitApp = function() {
                    e.submittingApp = !0,
                        o.submitGrantApplication(e.grantApp, function(n) {
                            r.info(n),
                                g(),
                                e.submittingApp = !1,
                                t.path("/grants_next_steps")
                        }, function(t) {
                            r.error(t),
                                e.formData.submissionFailed = !0,
                                e.submittingApp = !1,
                                e.registrarUrl = l.getFinancialCounsellingLink(e.grantApp.emailOrganizationCode),
                            e.registrarUrl || (e.registrarUrl = u.GENERAL_REGISTRARS_LINK)
                        })
                }
                ,
                e.getStepDescription = function(e) {
                    return e.id + ". " + e.menuName
                }
                ,
                e.getSelectedStepName = function() {
                    return e.activeStep ? e.activeStep.menuName : d[0].menuName
                }
                ,
                e.selectStep = function(t) {
                    "string" == typeof t && (t = JSON.parse(t)),
                    t.id <= e.grantApp.furthestStep && (e.activeStep = t,
                        f(e.activeStep))
                }
                ,
                e.getStepPartial = function(e) {
                    return e ? e.url : void 0
                }
                ,
                e.isSelectedStep = function(t) {
                    return !!e.activeStep && e.activeStep.id == t
                }
                ,
                function() {
                    function t() {
                        if (o.is(":visible")) {
                            var e = angular.element(".grant-app").outerWidth(!0);
                            o.width(e);
                            var t = o.offset().top - a.pageYOffset
                                , r = a.pageYOffset;
                            n(function() {
                                if (t <= u && !l) {
                                    var e = o.outerHeight(!1);
                                    h = o.position().top,
                                        o.addClass("sticky"),
                                        o.css({
                                            top: u + "px"
                                        }),
                                        s.css({
                                            "margin-top": e + 10 + "px"
                                        }),
                                        l = !0
                                } else
                                    l && h - u > r && (o.removeClass("sticky"),
                                        s.css({
                                            "margin-top": m + "px"
                                        }),
                                        l = !1)
                            }, 0)
                        }
                    }
                    function i() {
                        var e = angular.element(".grant-app").outerWidth(!0);
                        o.width(e)
                    }
                    e.activeStep = d[0],
                        e.availableSteps = d,
                        e.activeSteps = [e.activeStep],
                        e.$watch("resumeAtFurthestStep", function() {
                            1 == e.resumeAtFurthestStep && e.grantApp && e.grantApp.furthestStep && p(e.grantApp.furthestStep)
                        });
                    var o = angular.element("#step-menu-container")
                        , s = angular.element(".active-step-container")
                        , c = angular.element("#acorn-nav-top")
                        , l = !1
                        , u = 50;
                    if (c) {
                        var g = c.position();
                        u = g ? g.top + c.outerHeight(!1) : c.outerHeight(!1)
                    }
                    var m = parseInt(s.css("margin-top").replace("px", ""))
                        , h = o.offset().top;
                    angular.element(a).on("scroll", t),
                        e.$on("$destroy", function() {
                            angular.element(a).off("scroll", t)
                        }),
                        angular.element(a).on("resize", i),
                        e.$on("$destroy", function() {
                            angular.element(a).off("resize", i)
                        }),
                    e.grantApp && e.grantApp.furthestStep && p(e.grantApp.furthestStep),
                        e.onLoad = function(t) {
                            r.log("onLoad for step = " + t.id),
                                f(e.activeStep)
                        }
                }()
        }
    }
}
]),
angular.module("acornApp").service("grantAppCache", ["$q", "$filter", "grantAppServerResources", function(e, t, n) {
    var r, a, i, o;
    this.getRegistrations = function() {
        return r && e.resolve(r),
            o ? o.promise : (o = e.defer(),
                n.getRegistrations(function(e) {
                    r = t("unique")(e, "orgCode"),
                        o.resolve(r)
                }, function(e) {
                    o.reject(e)
                }),
                o.promise)
    }
        ,
        this.setGrantRequestAmount = function(e) {
            a = e
        }
        ,
        this.getGrantRequestAmount = function() {
            return a
        }
        ,
        this.setOrgCode = function(e) {
            i = e
        }
        ,
        this.getOrgCode = function() {
            return i
        }
        ,
        this.getOrgName = function() {
            if (!r)
                return "";
            var e = r.find(function(e) {
                return e.orgCode == i
            })
                , t = "";
            return e && (t = e.orgName),
                t
        }
        ,
        this.updateFees = function(e, t, n, r) {
            var a = 0;
            n && n.totalFees && (a = parseFloat(n.totalFees, 10));
            var i = !1;
            null == e ? i = !0 : null == t ? i = !0 : e === t && (i = !0),
            i && r(a)
        }
}
]),
angular.module("acornApp").factory("grantAppOtherResources", ["$timeout", function(e) {
    function t(t) {
        t.length && e(function() {
            var e = t.offset().top
                , n = angular.element(".navbar-collapse")
                , r = angular.element("#step-menu-container")
                , a = n.outerHeight(!0)
                , i = r.outerHeight(!0);
            angular.element("html, body").animate({
                scrollTop: e - (a + i + 10)
            }, 500)
        }, 0)
    }
    var n = [{
        id: 1,
        option: "Off-campus with parent(s)/guardian(s)"
    }, {
        id: 2,
        option: "Off-campus with other(s)"
    }, {
        id: 3,
        option: "Off-campus solo"
    }]
        , r = [{
        id: 1,
        option: "Bicycle"
    }, {
        id: 2,
        option: "Car or Motorcycle"
    }, {
        id: 3,
        option: "Transit"
    }, {
        id: 4,
        option: "Walk"
    }]
        , a = [{
        id: 1,
        option: "Parent 1"
    }, {
        id: 2,
        option: "Guardian 1"
    }, {
        id: 3,
        option: "Spouse"
    }]
        , i = [{
        id: 1,
        option: "Parent 2"
    }, {
        id: 2,
        option: "Guardian 2"
    }];
    return {
        getHousingOptions: function() {
            return n
        },
        getTransportationOptions: function() {
            return r
        },
        getFamilyIncomeTypeOptions: function() {
            return a
        },
        getFamilyIncomeType2Options: function() {
            return i
        },
        moveStepToPosition: function(e) {
            t(angular.element(e))
        },
        moveElementToPosition: function(e) {
            t(e)
        }
    }
}
]),
angular.module("acornApp").factory("grantAppServerResources", ["$resource", function(e) {
    return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/grant-application/:type", {}, {
        getGrantApplication: {
            method: "GET",
            params: {
                type: "create-or-load"
            }
        },
        getTuitionFees: {
            method: "GET",
            params: {
                type: "tuition-fees"
            }
        },
        getResidenceFees: {
            method: "GET",
            params: {
                type: "residence-fees"
            }
        },
        getMealPlanFees: {
            method: "GET",
            params: {
                type: "mealplan-fees"
            }
        },
        getRegistrations: {
            method: "GET",
            params: {
                type: "registrations"
            },
            isArray: !0
        },
        saveGrantApplication: {
            method: "POST",
            params: {
                type: "save"
            }
        },
        submitGrantApplication: {
            method: "POST",
            params: {
                type: "submit"
            }
        }
    })
}
]),
angular.module("acornApp").component("helpAndFeedback", {
    templateUrl: "partials/helpAndFeedback/helpAndFeedback.html",
    controller: HelpAndFeedbackCtrl
}),
angular.module("acornApp").factory("helpAndFeedbackServerResources", ["$resource", function(e) {
    return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:kind/:type/:type2/:param", {}, {
        load: {
            method: "GET",
            params: {
                kind: "help-and-feedback",
                type: "load"
            }
        },
        submit: {
            method: "POST",
            transformRequest: angular.identity,
            headers: {
                "Content-Type": void 0
            },
            params: {
                kind: "help-and-feedback",
                type: "submit",
                bust: (new Date).getTime()
            }
        }
    })
}
]),
angular.module("acornApp").service("helpAndFeedbackService", ["$q", "$log", "helpAndFeedbackServerResources", function(e, t, n) {
    this.submit = function(t) {
        var r = e.defer();
        return n.submit(t, function(e) {
            r.resolve(e)
        }, function(e) {
            r.reject(e)
        }),
            r.promise
    }
        ,
        this.load = function() {
            var t = e.defer();
            return n.load(function(e) {
                t.resolve(e)
            }, function(e) {
                t.reject(e)
            }),
                t.promise
        }
}
]),
angular.module("acornApp").controller("SideNavCtrl", ["$scope", "courseTabService", "DevConfig", "utPeakLoadModeConstants", function(e, t, n, r) {
    e.utPeakLoadModeConstants = r,
        e.currentCoursesTabUrl = function() {
            var e = t.getCurrentTabIndex() || 0;
            return n.translateSPAViewUrl("#/courses/" + e)
        }
}
]),
function() {
    "use strict";
    angular.module("acornApp").controller("TopNavCtrl", ["$scope", "$rootScope", "$timeout", "$window", "$uibModal", "NavigationResources", "Accessibility", "acornSettings", "DevConfig", "eventConstants", "utPeakLoadModeConstants", "peakLoadModeService", function(e, t, n, r, a, i, o, s, c, l, u, d) {
        var p = s;
        e.utPeakLoadModeConstants = u,
            e.message = "test message",
            e.peakLoadHeaderData = '<div class="flex-item load-mode-notification alert alert-warning" role="alert"><span class="visible-lg">    <i class="fa fa-lg fa-exclamation-triangle" aria-hidden="true"></i>    Do not refresh your browser unnecessarily. Some ACORN services are temporarily unavailable.     <a data-ng-click="openLoadModeModal()">Learn More</a></span><span class="hidden-lg">    <i class="fa fa-lg fa-exclamation-triangle" aria-hidden="true"></i>    <a data-ng-click="openLoadModeModal()">Important Notice</a></span></div>',
            e.switchToNotificationsAndActivityView = function() {
                var e = c.getNotificationsAndActivityUrl();
                r.location.href = e
            }
            ,
            e.toggleMenu = function() {
                e.$emit(l.TOGGLE_NAVIGATION)
            }
            ,
            e.user = {},
            e.checked = !1,
            function() {
                p.initialize().then(function() {
                    var e = p.getSetting("campus");
                    if (e) {
                        var t = angular.element(".ipf-sectionmenu");
                        "ERIN" === e && t.children().length > 3 && t.prepend('<li><div><a href="/sws/p/absence/browse.action" class="absence">Absence Declaration</a></div></li>')
                    }
                })
            }(),
            function() {
                i.getStudentBasicInfo("", function(t) {
                    e.user.firstName = t.firstName,
                        e.user.lastName = t.lastName
                }, function() {
                    e.user.firstName = "N/A",
                        e.user.lastName = "N/A"
                })
            }(),
            t.$on("$viewContentLoaded", function() {
                n(o.focusOnTopNavigation, 0)
            }),
            n(function() {
                o.focusOnTopNavigation()
            }, 0),
            e.openLoadModeModal = function() {
                a.open({
                    animation: !0,
                    templateUrl: "/sws/partials/navigation/peakLoadModeModal.html",
                    windowClass: "modal-md-acorn"
                })
            }
            ,
            e.inPeakLoadMode = d.getPeakLoadMode().then(function(t) {
                t.peakMode ? e.inPeakMode = !0 : e.inPeakMode = !1
            }, function() {})
    }
    ])
}(),
angular.module("acornApp").directive("accessOnKeyUp", ["$parse", "$timeout", function(e, t) {
    return {
        restrict: "A",
        scope: !0,
        link: function(n, r, a) {
            var i = a.accessOnKeyUpAction
                , o = n.$eval(a.accessOnKeyUpEnableSpacebar) || !1;
            r.is("a") && void 0 === a.href && void 0 === a.ngHref && r.attr("href", "javascript:void(0)"),
                r.keyup(function(r) {
                    switch (r.which) {
                        case 13:
                            r.preventDefault(),
                                r.stopPropagation(),
                                t(function() {
                                    e(i)(n)
                                }, 0);
                            break;
                        case 32:
                            r.preventDefault(),
                                r.stopPropagation(),
                            o && t(function() {
                                e(i)(n)
                            }, 0)
                    }
                }),
                r.keydown(function(e) {
                    switch (e.which) {
                        case 13:
                        case 32:
                            e.preventDefault(),
                                e.stopPropagation()
                    }
                })
        }
    }
}
]),
angular.module("acornApp").directive("inactivityTimerRedirect", ["acornInterceptorConstants", function(e) {
    return {
        restrict: "C",
        link: function(t) {
            t.$on(e.EVENT_INACTIVITY_TIMEOUT, function() {
                window.location.href = document.location.protocol + "//" + document.location.hostname + ("" == document.location.port ? "" : ":" + document.location.port) + "/sws/auth/logout.do?logout.dispatch&timeout=1"
            })
        }
    }
}
]),
angular.module("acornApp").directive("pageslideNotification", ["$rootScope", "$timeout", "PageSlideConstants", "DateUtil", function(e, t, n, r) {
    return {
        restrict: "A",
        scope: {
            notification: "=pageslideNotification"
        },
        require: "^pageslideNotificationContainer",
        link: function(a, i, o, s) {
            var c = a.notification
                , l = i.find(".side-notification-body")
                , u = c.read;
            i.attr("id", "ps_notification_" + c.id),
                i.click(function(e) {
                    e.stopPropagation()
                }),
                s.addSidePanelNotification(i, c),
                e.$on(n.NOTIFICATION_READ_STATUS_WILL_UPDATE_EVENT, function(e, n) {
                    if (null !== n && !u)
                        for (var r in n) {
                            var a = n[r];
                            a.id === c.id && (u = !0,
                                l.animate({
                                    backgroundColor: "#d9e5ef"
                                }, 1e3, function() {
                                    l.animate({
                                        backgroundColor: "#FFFFFF"
                                    }, 1e3, function() {
                                        t(function() {
                                            c.read = !0
                                        }, 0)
                                    })
                                }))
                        }
                }),
                a.isLessThanDayOld = r.isLessThanDayOld
        }
    }
}
]);
angular.module("acornApp").directive("pageslideNotificationContainer", ["$rootScope", "$timeout", "$log", "$location", "NavigationResources", "PageSlideConstants", "acornCoreProperties", "DevConfig", "viewport", "viewportConstants", function(e, t, n, r, a, i, o, s, c, l) {
    return {
        restrict: "A",
        replace: !1,
        controller: ["$scope", function(t) {
            function o(t, r) {
                a.batchMarkNotificationsAsRead({
                    ids: r
                }, function() {
                    e.$broadcast(i.NOTIFICATION_READ_STATUS_WILL_UPDATE_EVENT, t),
                        e.$broadcast(i.NOTIFICATION_READ_STATUS_UPDATED_EVENT, d.length - f)
                }, function() {
                    n.warn("Notifications could not be set to read :", t)
                })
            }
            function u() {
                if (null !== p && 0 !== d.length) {
                    for (var e = [], t = {}, n = 0; n < d.length; n++) {
                        var r = d[n]
                            , a = r.notificationEl
                            , i = r.notificationData;
                        if (1 != i.read) {
                            c.isElementVisible(p, a[0]) == l.VISIBLE && (e.push(i.id),
                                t[i.id] = i,
                                i.read = !0,
                                f++)
                        }
                    }
                    e.length > 0 && o(t, e)
                }
            }
            var d = []
                , p = null
                , f = 0;
            this.addSidePanelNotification = function(e, t) {
                d.push({
                    notificationEl: e,
                    notificationData: t
                }),
                t.read && f++
            }
                ,
                t._initPageSlidePanel = function(e) {
                    null === p && (p = e)
                }
                ,
                t._scanForUnreadNotifications = u,
                t.notificationsAndActivityUrl = s.getNotificationsAndActivityUrl(),
                t.toggleMenu = function(e) {
                    "/notifications_and_activity" === r.path() && t.toggleSideMenu(e, !0)
                }
        }
        ],
        template: '<div id="notification-body">   <div class="notification-header">       <span>Notifications &amp; Activity</span>       <a data-ng-click="toggleMenu($event)" ng-href="{{notificationsAndActivityUrl}}" class="view-all-notification-link pull-right btn-link">View Log</a>   </div>   <div data-ng-transclude></div></div>',
        transclude: !0,
        scope: !1,
        link: function(n, r, a) {
            function o() {
                var e = $("#acorn-nav-top").outerHeight();
                u.style.top = e + "px"
            }
            function s(e, t) {
                if (0 !== e.style.width)
                    switch (t.side) {
                        case "right":
                            e.style.width = "0";
                            break;
                        case "left":
                            e.style.width = "0px";
                            break;
                        case "top":
                            e.style.height = "0px";
                            break;
                        case "bottom":
                            e.style.height = "0px"
                    }
                setTimeout(function() {
                    if (0 !== e.style.width)
                        switch (t.side) {
                            case "right":
                                e.style.right = "300px",
                                    e.style["margin-right"] = "0";
                                break;
                            case "left":
                                break;
                            case "top":
                                break;
                            case "bottom":
                        }
                    r.attr("aria-hidden", "true").css("visibility", "hidden")
                }, 1e3 * t.speed)
            }
            function c(e, t) {
                if (o(),
                    0 !== e.style.width) {
                    switch (t.side) {
                        case "right":
                            e.style.width = "300px",
                                e.style.right = "-300px",
                                e.style["margin-right"] = "300px";
                            break;
                        case "left":
                            e.style.width = t.size;
                            break;
                        case "top":
                            e.style.height = t.size;
                            break;
                        case "bottom":
                            e.style.height = t.size
                    }
                    r.attr("aria-hidden", "false").css("visibility", "visible")
                }
            }
            var l = {}
                , u = r[0]
                , d = $("#notification-body");
            !function() {
                r.attr("aria-hidden", "false").css("visibility", "hidden"),
                    l.side = a.pageslide || "right",
                    l.speed = a.psSpeed || "0.5",
                    l.size = a.psSize || "300px",
                    n._initPageSlidePanel(d),
                    d.scroll(function() {
                        n._scanForUnreadNotifications()
                    }),
                    u.style.transitionDuration = l.speed + "s",
                    u.style.webkitTransitionDuration = l.speed + "s",
                    u.style.zIndex = 1e3,
                    u.style.position = "fixed",
                    u.style.width = 0,
                    u.style["margin-right"] = 0,
                    u.style.transitionProperty = "width",
                    u.style.bottom = a.psCustomBottom || "0px",
                    u.style.right = a.psCustomRight || "0px",
                    e.$watch(function() {
                        return n.showNotificationSlideOut
                    }, function(e, r) {
                        e != r && (1 == e ? (c(u, l),
                            t(function() {
                                1 == n.showNotificationSlideOut && n._scanForUnreadNotifications()
                            }, i.NOTIFICATION_DELAY_TO_IGNORE_NOTIFICATION_READ_STATUS_UPDATE)) : s(u, l))
                    }, !0),
                    e.$on("$viewContentLoaded", function() {
                        n.$parent.showNotificationSlideOut = !1
                    }),
                    angular.element(window).resize(o)
            }()
        }
    }
}
]),
    angular.module("acornApp").directive("sideNavHeight", function() {
        return {
            link: function(e, t, n) {
                function r() {
                    return c.innerHeight()
                }
                function a() {
                    return t.innerHeight()
                }
                function i() {
                    l.height("auto"),
                        t.height("auto")
                }
                var o, s, c = angular.element(n.sideNavHeight), l = angular.element("#body-container");
                e.$watch(function() {
                    return {
                        height: r()
                    }
                }, function(e, n) {
                    e.height != n.height && i(),
                        o = a(),
                        s = r(),
                        s >= o ? t.height(s) : o >= s && l.height(o)
                }, !0)
            }
        }
    }),
    angular.module("acornApp").directive("skipOverNav", ["scrollToConstants", "Accessibility", function(e, t) {
        return {
            scope: {
                toggleMenu: "&skipOverNavSideNavToggle"
            },
            template: '<ul id="scrollMain" aria-label="Skip to content">   <li><div id="navigationTop" tabindex="-1"></div></li>   <li><a data-ut-scroll-to ut-scroll-to-type="' + e.MAIN + '" class="scroll-content sr-only sr-only-focusable" href="" >Skip to main content</a></li>   <li><a data-ut-scroll-to ut-scroll-to-type="' + e.SIDE_NAVIGATION + '" class="hidden-xs scroll-content sr-only sr-only-focusable" href="" >Skip to navigation</a></li>   <li><a data-ut-scroll-to ut-scroll-to-type="' + e.CUSTOM + '" click-handler="skipToNavigationXS" keypress-handler="skipToNavigationXSPRess" class="visible-xs scroll-content sr-only sr-only-focusable" href="" >Skip to navigation</a></li></ul>',
            link: function(e) {
                e.skipToNavigationXS = function(n) {
                    $("#body-container").hasClass("toggled") || e.toggleMenu(n),
                        t.scrollToNavigationContent(n)
                }
                    ,
                    e.skipToNavigationXSPress = function(n) {
                        $("#body-container").hasClass("toggled") || e.toggleMenu(n),
                            t.scrollToNavigationContentPress(n)
                    }
            },
            replace: !0
        }
    }
    ]),
    angular.module("acornApp").directive("userNameDisplay", ["$timeout", "screenSizeQuery", "eventConstants", function(e, t, n) {
        function r(e, t, n) {
            if (e && t && n) {
                for (var r = e.split(" "), a = r[0], i = 1; i < r.length; i++)
                    a = a + " " + r[i].charAt(0) + ".";
                return {
                    firstName: a,
                    lastName: t
                }
            }
            return {
                firstName: e,
                lastName: t
            }
        }
        function a(e) {
            var t = e.replace(/[^0-9.]/g, "")
                , n = Number(t);
            return (e.indexOf("rem") > -1 || e.indexOf("REM") > -1) && (n *= 10),
                Number(n)
        }
        function i(e) {
            var t = e.find("#last-name-caret");
            t.css("white-space", ""),
                e.css("padding-top", ""),
                e.css("padding-bottom", ""),
                t.css("word-break", "")
        }
        function o(e) {
            var t = e.find("#last-name-caret");
            i(e),
            t.width() > e.width() && t.css("white-space", "normal");
            var n = e.css("line-height");
            n = Math.round(a(n));
            var r = Math.round(e.height() / n);
            if (r > 2) {
                var o = Math.round(a(e.css("padding-top")))
                    , s = Math.round(a(e.css("padding-bottom")))
                    , c = Math.ceil(n / 2);
                e.css("padding-top", o - c + "px"),
                    e.css("padding-bottom", s - c + "px")
            }
            r > 3 && t.css("word-break", "break-all")
        }
        return {
            restrict: "A",
            template: '{{studentDisplayName.firstName}} <span id="last-name-caret">{{studentDisplayName.lastName}}</span><span class="caret"></span>',
            link: function(a, s, c) {
                a.$watch(function() {
                    return c.userNameDisplayFirstName + c.userNameDisplayLastName
                }, function(n, i) {
                    n === i && a.studentDisplayName && (a.studentDisplayName.firstName || a.studentDisplayName.lastName) || (a.studentDisplayName = r(c.userNameDisplayFirstName, c.userNameDisplayLastName, t.isSmall()),
                    t.isSmall() && e(function() {
                        o(s)
                    }, 0))
                }),
                (c.userNameDisplayFirstName || c.userNameDisplayLastName) && (a.studentDisplayName = r(c.userNameDisplayFirstName, c.userNameDisplayLastName, t.isSmall()),
                t.isSmall() && o(s)),
                    a.$on(n.RESPONSIVE_RESIZE_EVENT, function(e, t) {
                        t.viewTypeChange && !t.isResponsiveMode ? (a.studentDisplayName = r(c.userNameDisplayFirstName, c.userNameDisplayLastName, !1),
                            i(s)) : t.viewTypeChange && t.isResponsiveMode && (a.studentDisplayName = r(c.userNameDisplayFirstName, c.userNameDisplayLastName, !0),
                            o(s))
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utCurrentNav", ["$location", function(e) {
        function t() {
            for (var t = ["tax", "invoice", "osap", "person", "absence", "timetable"], n = e.absUrl(), r = 0; r < t.length; r++)
                if (n.indexOf(t[r]) > -1)
                    return t[r];
            return null
        }
        function n(t) {
            t.match(/#\/courses\/\d/) && (t = "#/courses");
            var n = e.absUrl();
            return t.match(/#\/?$/) ? n.match(/#\/?$/) : n.indexOf(t) !== -1
        }
        function r(e) {
            var t = e.find(".nav-body li a");
            angular.element(t[0]).parent().addClass("currentPage")
        }
        function a(a) {
            var i = t();
            if (null != i)
                angular.element("#acorn-nav-side li ." + i).parent().addClass("currentPage");
            else {
                angular.element("#acorn-nav-side").find(".currentPage").removeClass("currentPage");
                var o = a.find(".nav-body li a")
                    , s = o.length;
                if (e.absUrl())
                    for (var c = 0; c < s; c++) {
                        var l = angular.element(o[c])
                            , u = l.attr("href") ? l.attr("href") : l.attr("ng-href");
                        if (u) {
                            if (n(u)) {
                                l.parent().addClass("currentPage");
                                break
                            }
                        } else
                            r(a)
                    }
                else
                    r(a)
            }
        }
        return {
            restrict: "A",
            link: function(t, n) {
                t.location = e,
                    t.$watch("location.absUrl()", function() {
                        a(n)
                    }),
                    a(n)
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utNavOrientation", ["$timeout", "$window", "navClassConstants", "screenSizeQuery", function(e, t, n, r) {
        function a(e) {
            for (var t = e.hasClass(n.NAV_TABS) ? e : angular.element("." + n.NAV_TABS), r = t.children(), a = 0, i = 0; i < r.length; i++) {
                var o = angular.element(r[i]).children("a").length > 0 ? angular.element(r[i]).children("a") : angular.element(r[i])
                    , s = o.outerWidth(!0);
                o.html().trim() && (a += s)
            }
            var c = t.hasClass(n.NAV_VERTICAL) ? 5 : 0;
            return 0 !== a && (a + c > t.width() ? (t.removeClass(n.NAV_HORIZONTAL),
                t.addClass(n.NAV_VERTICAL)) : (t.removeClass(n.NAV_VERTICAL),
                t.addClass(n.NAV_HORIZONTAL))),
                a
        }
        return {
            link: function(n, i) {
                !function() {
                    r.isSmall() && e(function() {
                        if (0 === a(i))
                            var e = n.$watch(function() {
                                return a(i) > 0 && e(),
                                    !0
                            })
                    }, 0),
                        angular.element(t).on("resize.utNavOrientation", function() {
                            r.isSmall() && a(i)
                        }),
                        i.on("$destroy", function() {
                            angular.element(t).off("resize.utNavOrientation")
                        })
                }()
            }
        }
    }
    ]),
    angular.module("acornApp").directive("utOpenMenu", ["$location", function(e) {
        function t(e) {
            return "/enrol_and_manage" === e || 0 === e.indexOf("/courses") || "/programs" === e
        }
        function n(t) {
            return ("/financial_account" === t || r("financial") || "/account_details" === t || "/transaction_history" === t) && e.absUrl().indexOf("/osap") === -1
        }
        function r(t) {
            return e.absUrl().indexOf(t) > -1
        }
        function a() {
            angular.element("#acorn-nav-side").find(".active").removeClass("active")
        }
        function i(e) {
            a(),
                e.addClass("active")
        }
        function o(r, o) {
            var s = o.utOpenMenu
                , c = e.path()
                , l = n(c)
                , u = t(c);
            u || l ? "enrol" === s && u ? i(r) : "financial" === s && l && i(r) : a()
        }
        return {
            restrict: "A",
            link: function(t, n, r) {
                t.location = e,
                    t.$watch("location.absUrl()", function(e, t) {
                        e && e !== t && o(n, r)
                    }),
                    o(n, r)
            }
        }
    }
    ]),
    angular.module("acornApp").service("courseTabService", function() {
        var e = 0;
        return {
            setCurrentTabIndex: function(t) {
                e = parseInt(t)
            },
            getCurrentTabIndex: function() {
                return e
            }
        }
    }),
    angular.module("acornApp").factory("httpTimeoutResponseInterceptor", ["$rootScope", "$q", "$log", "$timeout", "$window", "acornInterceptorConstants", "inactivityTimer", function(e, t, n, r, a, i, o) {
        function s(t) {
            if (!angular.isObject(t))
                return t;
            var n = new Date
                , s = Number(n.getTime()) + Number(i.INACTIVITY_TIMEOUT_INTERVAL) - Number(i.INACTIVITY_DELTA);
            n.setTime(s),
                a.sessionExpireTime = n;
            var c = function() {
                var t = (new Date).getTime()
                    , n = a.sessionExpireTime.getTime();
                t >= n ? e.$broadcast(i.EVENT_INACTIVITY_TIMEOUT) : r(function() {
                    c()
                }, n - t + Number(i.INACTIVITY_DELTA))
            }
                , l = r(c, i.INACTIVITY_TIMEOUT_INTERVAL);
            return o.cancelAll(),
                o.append(l),
            angular.isObject(t) && (t.status === i.API_LIMIT_REACHED_STATUS ? window.location.href = document.location.protocol + "//" + document.location.hostname + "/sws/welcome.do?welcome.dispatch#/captcha" : (t.status === i.UNAUTHORIZED_HTTP_STATUS || "string" == typeof t.data && i.IDP_REDIRECT_REG_EX.test(t.data)) && (window.location.href = document.location.protocol + "//" + document.location.hostname + document.location.pathname,
                t.data = "")),
                t
        }
        function c(e) {
            return s(e),
                t.reject(e)
        }
        return {
            response: s,
            responseError: c
        }
    }
    ]),
    angular.module("acornApp").factory("inactivityTimer", ["$timeout", function(e) {
        var t = [];
        return {
            append: function(e) {
                t.push(e)
            },
            cancelAll: function() {
                for (var n = 0; n < t.length; n++)
                    e.cancel(t[n]);
                t = []
            }
        }
    }
    ]),
    function() {
        "use strict";
        angular.module("acornApp").factory("NavigationResources", ["$resource", function(e) {
            return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:dataType/:dataSubType", {}, {
                batchMarkNotificationsAsRead: {
                    method: "POST",
                    params: {
                        dataType: "notification",
                        dataSubType: "batch-read"
                    }
                },
                batchRemoveFromDashboard: {
                    method: "POST",
                    params: {
                        dataType: "notification",
                        dataSubType: "batch-remove-from-dashboard"
                    }
                },
                markNotificationsAsRead: {
                    method: "DELETE",
                    params: {
                        dataType: "notification",
                        dataSubType: "@dataSubType"
                    }
                },
                getCart: {
                    method: "GET",
                    params: {
                        dataType: "getCart"
                    }
                },
                getStudentBasicInfo: {
                    method: "GET",
                    params: {
                        dataType: "profile",
                        dataSubType: "studentBasicInfo"
                    }
                }
            })
        }
        ])
    }(),
    angular.module("acornApp").controller("NotificationCtrl", ["$scope", "$http", "$timeout", "$rootScope", "$log", "$location", "NavigationResources", "acornCoreLib", "notificationConstants", "PageSlideConstants", "Notifications", function(e, t, n, r, a, i, o, s, c, l, u) {
        r.$on(l.NOTIFICATION_READ_STATUS_UPDATED_EVENT, function(t, r) {
            n(function() {
                e.mediumNotificationCount = Math.max(0, r)
            }, 1500)
        }),
            e.highAlerts = [],
            e.calendarEventCount = 0,
            e.showNotificationSlideOut = !1,
            e.findMediumNotification = function(e) {
                return "MEDIUM" === e.priority.toUpperCase()
            }
            ,
            e.markNotificationAsRead = function(e) {
                var t = {
                    ids: e
                };
                o.batchMarkNotificationsAsRead(t, function() {
                    u.batchMarkAsRead(e)
                }, function() {})
            }
            ,
            r.$on(c.HIGH_PRIORITY_NOTIFICATIONS_READ_EVENT, function(t, n) {
                e.markNotificationAsRead(n)
            }),
            u.load().then(function() {
                e.notifications = u.getNotifications(),
                    e.mediumNotificationCount = u.getMediumNotificationsCount()
            }),
            r.$watch(function() {
                return i.absUrl()
            }, function(t, n) {
                t && t !== n && u.reload().then(function() {
                    e.notifications = u.getNotifications(),
                        e.mediumNotificationCount = u.getMediumNotificationsCount()
                })
            }),
            e.closeNotificationsTray = function() {
                1 == e.showNotificationSlideOut && (e.showNotificationSlideOut = !1)
            }
            ,
            e.changeWidth = function() {
                document.getElementById("ng-pageslide").style.width = "0px"
            }
            ,
            e.getNotificationCountByPriority = u.getNotificationsCountByPriority,
            e.isRead = function(e) {
                return "true" == e
            }
            ,
            e.toggleSideMenu = function(t, n) {
                void 0 !== n && 0 != n || t.preventDefault(),
                    e.showNotificationSlideOut = !e.showNotificationSlideOut
            }
    }
    ]),
    angular.module("acornApp").directive("highPriorityNotificationContainer", ["$timeout", "$q", "$rootScope", "$log", "NavigationResources", "Accessibility", "notificationConstants", "Notifications", "screenSizeConstants", "screenSizeQuery", function(e, t, n, r, a, i, o, s, c, l) {
        return {
            restrict: "A",
            template: '<div class="notification-container acorn-toast-container">   <div class="notifications-listing-container" data-ng-class="{collapsed: isContainerCollapsed}">       <div ng-repeat="notification in notifications | filter: isHighPriorityNotification | limitTo: collapseLimit()" data-notification="notification" data-notification-index="$index" class="container-fluid"></div>   </div>   <div class="text-center notification-expand-all-toggle" data-ng-show="hiddenHighPriorityNotifications > 0">       <span data-ng-show="isContainerCollapsed"><a ng-href="javascript:void(0)" data-access-on-key-up="" data-access-on-key-up-action="setContainerCollapsed(false)" data-ng-click="setContainerCollapsed(false)" data-ng-bind="\'View \' + hiddenHighPriorityNotifications + \'  More Notifications\'"></a></span>       <span data-ng-hide="isContainerCollapsed"><a ng-href="javascript:void(0)" data-access-on-key-up="" data-access-on-key-up-action="setContainerCollapsed(true)" data-ng-click="setContainerCollapsed(true)">View Less Notifications</a></span>   </div></div>',
            scope: {
                notifications: "=highPriorityNotificationContainer"
            },
            controller: ["$scope", function(c) {
                function u() {
                    var e = 0
                        , t = 0
                        , r = 0
                        , a = []
                        , i = !1;
                    if (c.notifications) {
                        var u = angular.element(".notifications-listing-container")
                            , p = 20;
                        l.isSmall().matches && (p = 10);
                        for (var m = 0; m < c.notifications.length; m++) {
                            var h = c.notifications[m];
                            if (s.isHighPriorityNotification(h)) {
                                var v = c._notificationContainers[h.id];
                                if (void 0 !== v) {
                                    var C = $(v[0]).outerHeight() + p;
                                    (e + C >= f || t >= g) && (i = !h.expanded || !c.isContainerCollapsed),
                                    0 == h.read && a.push(h.id),
                                    0 == i && (e += C,
                                        r = e,
                                        ++t)
                                }
                            }
                        }
                        c.hiddenHighPriorityNotifications = d() - t,
                            c.isContainerCollapsed ? (u[0].style.height = r + "px",
                            a.length > 0 && a.splice(t, c.hiddenHighPriorityNotifications)) : u[0].style.height = "auto",
                        a.length > 0 && n.$broadcast(o.HIGH_PRIORITY_NOTIFICATIONS_READ_EVENT, a)
                    }
                }
                function d() {
                    if (0 == c.notifications.length)
                        return 0;
                    for (var e = 0, t = 0; t < c.notifications.length; t++) {
                        var n = c.notifications[t];
                        s.isHighPriorityNotification(n) && e++
                    }
                    return e
                }
                function p() {
                    n.$apply(u)
                }
                this.name = "highPriorityNotificationContainer",
                    c._notificationContainers = {},
                    this.updateHeightForNotification = function(t, n) {
                        if (!angular.isObject(t) || !angular.isDefined(t.id))
                            return void r.warn("Expected notification object but got: ", t, n);
                        c._notificationContainers[t.id] = n,
                        Object.keys(c._notificationContainers).length == d() && e(u, 0)
                    }
                    ,
                    this.markNotificationsAsRead = function(e) {
                        var n = t.defer()
                            , r = e.id;
                        return a.markNotificationsAsRead({
                            dataSubType: r
                        }, function(t) {
                            e.read = !0,
                                n.resolve(t)
                        }, function(e) {
                            n.reject(e)
                        }),
                            n.promise
                    }
                    ,
                    this.recalculateContainerHeight = u,
                    this.removeFromDashboard = function(e) {
                        var n = t.defer()
                            , i = e.id;
                        return a.batchRemoveFromDashboard({
                            ids: [i]
                        }, function(e) {
                            for (var t = 0; t < c.notifications.length; t++) {
                                if (c.notifications[t].id == i) {
                                    var a = c.notifications.splice(t, 1);
                                    c._notificationContainers[i] && delete c._notificationContainers[i],
                                        r.log("removed = " + a),
                                        u();
                                    break
                                }
                            }
                            n.resolve(e)
                        }, function(e) {
                            n.reject(e)
                        }),
                            n.promise.then(function() {
                                e.showOnDash = !1
                            }),
                            n.promise
                    }
                ;
                var f = 500
                    , g = 5;
                c.isHighPriorityNotification = s.isHighPriorityNotification,
                    c.isContainerCollapsed = !!l.isSmall(),
                    c.collapseLimit = function() {
                        var e = o.COLLAPSE_MINIMUM_NOTIFICATIONS;
                        return c.isContainerCollapsed && d() - c.hiddenHighPriorityNotifications != 0 ? e = d() - c.hiddenHighPriorityNotifications : c.isContainerCollapsed || (e = c.notifications.length),
                            e
                    }
                    ,
                    c.setContainerCollapsed = function(t) {
                        if (t)
                            for (var n = 0; n < c.notifications.length; n++)
                                s.isHighPriorityNotification(c.notifications[n]) && (c.notifications[n].expanded = !1);
                        c.isContainerCollapsed = t,
                            e(function() {
                                u(),
                                    i.scrollToMainContent()
                            }, 0)
                    }
                    ,
                    c.$watch("notifications", u),
                    e(u, 0),
                    angular.element(window).resize(p),
                    c.$on("$destroy", function() {
                        angular.element(window).off("resize", p)
                    })
            }
            ]
        }
    }
    ]),
    angular.module("acornApp").directive("notification", ["$log", "$timeout", "screenSizeQuery", "notificationConstants", "DevConfig", function(e, t, n, r, a) {
        return {
            restrict: "A",
            template: function() {
                return '<div data-template-url="' + a.translateSPAResourceUrl("partials/notification/notification.html") + '" class="row">       <div class="col-lg-12 flex-display acorn-toast alert dashboard-notice" tabindex="-1" role="alert" data-ng-class="getAlertLevelClass().alertClass">           <div class="flex-item toast-icon">               <span class="fa-stack" aria-hidden="true">                   <i class="fa-bg fa fa-stack-1x" data-ng-class="getAlertLevelClass().alertIconBG"></i>                   <i class="fg-icon fa fa-stack-1x" data-ng-class="getAlertLevelClass().alertIcon"></i>               </span>           </div>           <div ng-bind-html="truncate(notification.message)" ng-click="toggleExpand()" class="flex-item toast-body"></div>           <div ng-show="notification.priority !== \'SEVERE\'" ng-click="closeNotification()" class="flex-item toast-exit">               <span aria-label="Dismiss this notification" tabindex="0">               <i class="fa fa-close fa-lg"></i>               </span>           </div>       </div>   </div>'
            }(),
            scope: {
                notification: "="
            },
            require: "^highPriorityNotificationContainer",
            link: function(a, i, o, s) {
                function c(e) {
                    var t = e
                        , n = e.lastIndexOf("<");
                    e.lastIndexOf(">") < n && (t = e.slice(0, n));
                    for (var r, a = /<[^>]+>/gm, i = [], o = []; r = a.exec(t); )
                        for (var s = 0; s < r.length; s++)
                            if (!/<[^>]+\/>/gm.test(r[s])) {
                                var c = r[s].replace("<", "").replace(">", "").split(" ")[0].trim();
                                "p" !== c && "br" !== c && (c.indexOf("/") === -1 ? i.push(c) : o.push(c))
                            }
                    if (i.length !== o.length) {
                        for (var l = [], u = 0; u < i.length; u++) {
                            for (var d = i[u], p = "/" + d, f = !1, g = 0; g < o.length; g++)
                                if (o[g] === p) {
                                    f = !0,
                                        o.splice(g, 1);
                                    break
                                }
                            f || l.push(p)
                        }
                        for (var m = 0; m < l.length; m++)
                            t = t + "<" + l[m] + ">"
                    }
                    return t
                }
                var l = a.notification;
                l.expanded = !1;
                var u = {};
                a.getAlertLevelClass = function() {
                    return "FUTURE_START_TIME" === a.notification.type ? u = {
                        alertClass: "alert-info",
                        alertIcon: "fa-info",
                        alertIconBG: "fa-circle"
                    } : "SEVERE" === a.notification.priority ? u = {
                        alertClass: "alert-danger",
                        alertIcon: "fa-exclamation",
                        alertIconBG: "fa-exclamation-triangle"
                    } : "HIGH" !== a.notification.priority && a.notification.type || (u = {
                        alertClass: "alert-warning",
                        alertIcon: "fa-exclamation",
                        alertIconBG: "fa-circle"
                    }),
                        u
                }
                    ,
                    a.closeNotification = function() {
                        i.find(".acorn-toast").removeClass("toast-animate"),
                            t(function() {
                                s.removeFromDashboard(l).then(function() {
                                    l.read = !0,
                                        l.showOnDash = !1,
                                        s.recalculateContainerHeight()
                                }, function(t) {
                                    e.error("failed to remove notification(" + l.id + ") from the dashboard. " + t)
                                })
                            }, 300)
                    }
                    ,
                    a.truncate = function(e) {
                        var t = String(e).replace(/<[^>]+>/gm, "");
                        if (n.isSmall() && t.length > r.TRUNCATE_CHARACTER_LENGTH && !l.expanded) {
                            var a = e.slice(0, r.TRUNCATE_CHARACTER_LENGTH);
                            return (a = c(a)) + "... <b><i>Tap to show more</i></b>"
                        }
                        return e
                    }
                    ,
                    a.toggleExpand = function() {
                        n.isSmall() && (l.expanded = !l.expanded,
                            t(function() {
                                s.recalculateContainerHeight()
                            }, 0))
                    }
                    ,
                    function() {
                        i.find(".acorn-toast").addClass("toast-animate"),
                            s.updateHeightForNotification(l, i)
                    }()
            }
        }
    }
    ]),
    angular.module("acornApp").directive("notificationHeight", ["$window", function(e) {
        return {
            restrict: "A",
            link: function(t, n) {
                function r() {
                    return e.innerHeight
                }
                function a(e) {
                    n.css("height", e + "px")
                }
                function i() {
                    a(r() - o - s)
                }
                var o = angular.element(document.querySelector("#acorn-nav-top"))[0].offsetHeight
                    , s = angular.element(document.querySelector(".notification-header"))[0].offsetHeight;
                i(),
                    window.onresize = i
            }
        }
    }
    ]),
    angular.module("acornApp").directive("showNotifications", ["$location", "$rootScope", function(e, t) {
        return {
            restrict: "A",
            link: function(n) {
                n.location = e,
                    t.$broadcast("NOTIFICATION_DIRECTIVE_URL_CHANGE", "URL changed"),
                    n.$watch("location.absUrl()", function(e, n) {
                        e && e !== n && t.$broadcast("NOTIFICATION_DIRECTIVE_URL_CHANGE", "URL changed")
                    })
            }
        }
    }
    ]),
    angular.module("acornApp").factory("DateUtil", ["timeConstants", function(e) {
        function t(t, n) {
            return void 0 === n && (n = (new Date).getTime()),
            Math.floor((n - t) / e.MS_IN_A_DAY) < 1
        }
        return {
            isLessThanDayOld: t
        }
    }
    ]),
    angular.module("acornApp").factory("Notifications", ["$q", "$log", "$http", "acornCoreLib", function(e, t, n, r) {
        function a(e) {
            var t = 0;
            if (angular.isArray(f)) {
                e = e.toUpperCase();
                for (var n = 0; n != f.length; n++) {
                    var r = f[n];
                    r.read || r.priority !== e || t++
                }
            }
            return t
        }
        function i(e) {
            var t = 0
                , n = 0;
            e = e.toUpperCase(),
            angular.isArray(f) && (n = f.length);
            for (var r = 0; r != n; r++) {
                f[r].priority == e && t++
            }
            return t
        }
        function o() {
            return g
        }
        function s() {
            return f
        }
        function c() {
            if (m)
                return m.promise;
            m = e.defer();
            var i = "undefined" == typeof testBaseUrlForHttp ? location.protocol + "//" + window.location.host + "/" : testBaseUrlForHttp;
            return n({
                url: i + "sws/rest/notification?priority=HIGH&priority=SEVERE&priority=MEDIUM",
                method: "GET"
            }).then(function(e) {
                var t = e.data
                    , n = r.getUtilityLib().getSortAlgorithms().mergeSortForKeyDESC;
                t.notifications && (f = n(t.notifications, "date")),
                    g = a("MEDIUM"),
                    h = !0,
                    m.resolve("notifications are now available")
            }, function(e) {
                t.error("failed to load notifications", e.statusText),
                    m.reject(e.data)
            }),
                m.promise
        }
        function l() {
            return h && (m = null),
                c()
        }
        function u(e) {
            for (var t = 0; t < f.length; t++)
                for (var n = f[t], r = 0; r < e.length; r++) {
                    var a = e[r];
                    if (a === n.id) {
                        n.read = !0;
                        break
                    }
                }
        }
        function d(e) {
            var t = e.priority.toUpperCase();
            return ("SEVERE" === t || "HIGH" === t) && 1 == e.showOnDash
        }
        function p() {
            var t = e.defer();
            return c().then(function() {
                var e = [];
                if (f && angular.isArray(f))
                    for (var n = 0; n < f.length; n++) {
                        var r = f[n];
                        "SEVERE" === r.priority && "ADDRESS_EXPIRY" === r.type && e.push(r)
                    }
                t.resolve(e)
            }, function(e) {
                t.reject(e)
            }),
                t.promise
        }
        var f = []
            , g = 0
            , m = null
            , h = !1;
        return {
            load: c,
            reload: l,
            getMediumNotificationsCount: o,
            getNotificationsCountByPriority: i,
            getNotifications: s,
            getProfileNotifications: p,
            batchMarkAsRead: u,
            isHighPriorityNotification: d
        }
    }
    ]),
    angular.module("acornApp").controller("planningToolsCtrl", ["$q", "$log", "$scope", "acornCoreProperties", "dashboardServerResources", "dashboardManager", "dashboardAppConstants", "planningToolsService", function(e, t, n, r, a, i, o, s) {
        function c() {
            function t() {
                var t = e.defer();
                return E = !0,
                    a.getDeData(null, function(e) {
                        y = e,
                            T = e.date,
                            "false" === e.isADayOld ? A = !1 : "true" === e.isADayOld && (A = !0),
                            E = !1,
                            S = e.knownFaculty,
                            i.setWidgetToLoaded(u.PLAN_AND_EXPLORE),
                            t.resolve(e)
                    }, function() {
                        y = !1,
                            i.setWidgetToLoaded(u.PLAN_AND_EXPLORE),
                            E = !1,
                            t.reject(null)
                    }),
                    t.promise
            }
            function n() {
                var t = e.defer();
                return A = !1,
                    E = !0,
                    w = y,
                    a.getRefreshedDeData({
                        refresh: !0
                    }, function(e) {
                        y = e,
                            T = e.date,
                            E = !1,
                            S = e.knownFaculty,
                            w = null,
                            i.setWidgetToLoaded(u.PLAN_AND_EXPLORE),
                            t.resolve(e)
                    }, function(e) {
                        e.status === o.UNAUTHORIZED_HTTP_STATUS && (alert(o.TIMEOUT_MSG),
                            window.location = o.REDIRECT),
                            E = !1,
                            y = w,
                            i.setWidgetToLoaded(u.PLAN_AND_EXPLORE),
                            t.reject(null)
                    }),
                    t.promise
            }
            function r() {
                return null !== w
            }
            function s() {
                return null !== y ? y : y = t()
            }
            function c() {
                return A ? y = n() : y
            }
            function p() {
                return A
            }
            function f() {
                return E
            }
            function g() {
                return T
            }
            function m() {
                return S
            }
            function h() {
                return v() ? y.postAssessments : []
            }
            function v() {
                return angular.isObject(y) && angular.isArray(y.postAssessments) && y.postAssessments.length > 0
            }
            function C() {
                var e = null
                    , t = l.messages.widgets.PLAN_AND_EXPLORE.NO_CONTENT;
                return null !== d && (e = t[d],
                angular.isDefined(e) || (e = t.DEFAULT)),
                    e
            }
            var y = null
                , A = !0
                , E = !1
                , T = null
                , S = !0
                , w = null;
            return this.getDegreeExplorerData = s,
                this.hasBackupExplorerData = r,
                this.refreshDegreeExplorerData = c,
                this.refreshIsEnabled = p,
                this.isRefreshing = f,
                this.getKnownFacultyFlag = m,
                this.getLastAccessedDate = g,
                this.getDegreeExplorerPostAssessmentData = h,
                this.hasDegreeExplorerData = v,
                this.getNoContentMessaging = C,
                this
        }
        n.numberOfCardsPerDeck = 2;
        var l = r.getDashboardProperties()
            , u = o.WIDGETS.IDS
            , d = null;
        !function() {
            n.degreeExplorerManager = new c,
                n.degreeExplorerManager.getDegreeExplorerData(),
                n.isPlanAndExploreDashboardLoaded = function() {
                    return i.isWidgetLoaded(i.getWidgetIDConstants().PLAN_AND_EXPLORE)
                }
                ,
                n.cardTemplates = s.getCardTemplates()
        }()
    }
    ]),
    angular.module("acornApp").service("planningToolsService", ["campusService", function(e) {
        var t = [0, 1, 2, 3, 4, 5, 6]
            , n = {};
        n[0] = "partials/planningTools/planAndExplore.html",
            n[1] = "partials/planningTools/courseFinder.html",
            n[2] = "partials/planningTools/transferExplorer.html",
            n[3] = "partials/planningTools/programFinder.html",
            n[4] = "partials/planningTools/timetableBuilder.html",
            n[5] = "partials/planningTools/gpaCalculator.html",
            n[6] = "partials/planningTools/financialPlanningCalculator.html";
        var r = e.getCampus();
        this.getCardTemplates = function() {
            var e = angular.copy(n);
            "SCAR" !== r && delete e[4];
            var a = [];
            return t.forEach(function(t) {
                var n = e[t];
                n && a.push(n)
            }),
                a
        }
    }
    ]),
    angular.module("acornApp").controller("BankEditCtrl", ["Accessibility", function(e) {
        this.scrollTo = e.scrollToContent
    }
    ]),
    angular.module("acornApp").directive("profileNotifications", ["$log", "$rootScope", "$location", "Notifications", function(e, t, n, r) {
        return {
            template: '<div class="container-fluid acorn">   <div class="row">       <div data-high-priority-notification-container="notifications"            data-ng-show="notifications.length > 0" tabindex="-1">       </div>   </div></div>',
            scope: {},
            link: function(t) {
                !function() {
                    var a = n.absUrl();
                    t.notifications = [],
                    (/\/sws\/person\//.test(a) || /\/sws\/p\/absence\/browse.action/.test(a)) && r.getProfileNotifications().then(function(e) {
                        t.notifications = e
                    }, function(t) {
                        e.log("failed to get profile notifications: " + t)
                    })
                }()
            }
        }
    }
    ]),
    angular.module("acornApp").constant("ProgramModalConstants", {
        STATE: {
            ACTIVE: 0,
            LOADING: 1
        }
    }).controller("ProgramEnrolmentCtrl", ["$scope", "$timeout", "$uibModal", "$uibModalStack", "ProgramManager", "NotificationManager", "notificationConstants", "ProgramModalConstants", "acornCoreProperties", "postControls", "utTypeaheadState", "programTooltipConstants", function(e, t, n, r, a, i, o, s, c, l, u, d) {
        function p() {
            function e() {
                p = null
            }
            function t(e) {
                return l = e,
                    this
            }
            function n() {
                return r() === s.STATE.LOADING
            }
            function r() {
                return l
            }
            function a() {
                return u
            }
            function i(t) {
                e();
                var n = t.length
                    , r = [];
                if (angular.isObject(c) && angular.isDefined(c.getPostCode))
                    for (var a = c.getPostCode().toUpperCase(), i = 0; i < n; i++) {
                        var o = t[i];
                        o.getPostCode().toUpperCase() !== a && (null === d && (d = o.getPostChangeGroupDesc()),
                            r.push(o))
                    }
                else
                    r = t;
                return u = r,
                    this
            }
            var o = []
                , c = {}
                , l = s.STATE.ACTIVE
                , u = []
                , d = null
                , p = null
                , f = !1
                , g = "";
            return this.setModalState = t,
                this.isModalLoading = n,
                this.getGroupChangePosts = a,
                this.setGroupChangePosts = i,
                this.setModalStateLoading = function() {
                    return t(s.STATE.LOADING),
                        this
                }
                ,
                this.getModalState = function() {
                    return l
                }
                ,
                this.hasNotifications = function() {
                    return o.length > 0
                }
                ,
                this.getNotifications = function() {
                    return o
                }
                ,
                this.setCurrentPOST = function(e) {
                    return c = e,
                        t(s.STATE.ACTIVE),
                        this
                }
                ,
                this.getCurrentPOST = function() {
                    return c
                }
                ,
                this.currentlySelectedChangeGroup = p,
                this.setCurrentlySelectedChangeGroup = function(e) {
                    return p = e,
                        this
                }
                ,
                this.getCurrentlySelectedChangeGroup = function() {
                    return p
                }
                ,
                this.getGroupChangePostDescription = function() {
                    return d
                }
                ,
                this.setFailing = function(e) {
                    return f = e,
                        this
                }
                ,
                this.isFailing = function() {
                    return f
                }
                ,
                this.setFailingReason = function(e) {
                    return g = e,
                        this
                }
                ,
                this.getFailingReason = function() {
                    return g
                }
                ,
                this
        }
        function f() {
            g.getUserSubjectPosts(!0).then(function(t) {
                e.subjectPosts = t.getSubjectPosts(),
                    e.childSubjectPosts = t.getChildSubjectPosts()
            }, function(t) {
                e.subjectPosts = {},
                    e.childSubjectPosts = {},
                    i.addNotification("Retrieval of programs failed: " + t.data, o.TYPE.ERROR)
            })
        }
        e.configureProgramStatusTooltip = function(e) {
            return d[e] ? {
                tooltip: {
                    messages: d[e]
                },
                highlight: "highlight"
            } : {}
        }
        ;
        var g = a.getSubjectPostManager()
            , m = {}
            , h = new p;
        !function() {
            function t() {
                function e(e) {
                    var t = a.maps.programStatusType
                        , n = {};
                    return n[t.ACTIVE] = "active",
                        n[t.INVITED] = "invited",
                        n[t.REFUSED] = "refused",
                        n[t.REQUESTED] = "requested",
                        n[t.COMPLETED] = "completed",
                        n[e]
                }
                return this.getHeaderClassForProgramStatus = e,
                    this
            }
            var a = c.getProgramEnrolmentProperties();
            e.programLib = m,
                e.subjectPostManager = g,
                e.acornCoreProperties = c,
                e.programModalManager = h;
            var s = {
                isUpdateInProgress: !1
            };
            e.programControls = s,
                e.isReapplyAvailable = function(e) {
                    return !!e && (e.isStatusInvited() && e.getStatusModifierA() || e.isStatusRefused() && e.getStatusModifierA())
                }
                ,
                e.isAcceptAvailable = function(e) {
                    return !!e && e.isStatusInvited() && e.getStatusModifierB()
                }
                ,
                e.isAwaitingAcceptance = function(t) {
                    return !!t && t.isStatusInvited() && !e.isReapplyAvailable(t)
                }
                ,
                e.canSwitchWithin = l.canSwitchWithinProgram,
                e.canRemove = l.canRemoveProgram,
                e.canDrop = l.canDropProgram;
            var d = {};
            d.addSubjectPost = function(e) {
                h.setModalStateLoading(),
                    s.isUpdateInProgress = !0,
                    g.addSubjectPost(e).then(function() {
                        s.isUpdateInProgress = !1,
                            f();
                        var t = r.getTop();
                        r.close(t.key, "Program Added Successfully");
                        var n = "";
                        switch (e.getPostType().typeCode) {
                            case 2:
                                n = "You have requested enrolment in the program";
                                break;
                            default:
                                n = "You have successfully added the program"
                        }
                        u.setState({
                            term: ""
                        }),
                            i.addNotification(n + " " + e.getPostCode() + " " + e.getPostTitle(), o.TYPE.SUCCESS)
                    }, function(e) {
                        i.addNotification(e.data, o.TYPE.ERROR),
                            s.isUpdateInProgress = !1;
                        var t = r.getTop();
                        r.dismiss(t.key, "Failed to Add Program")
                    })
            }
                ,
                d.reapplyToSubjectPost = function(t) {
                    h.setCurrentPOST(t),
                        n.open({
                            animation: !0,
                            templateUrl: "partials/program/modal/reapply.html",
                            scope: e,
                            windowClass: "modal-lg-acorn"
                        })
                }
                ,
                d.commitProgramReapply = function(e) {
                    h.setModalStateLoading(),
                        s.isUpdateInProgress = !0,
                        g.reapplyToSubjectPost(e).then(function() {
                            s.isUpdateInProgress = !1,
                                f();
                            var t = r.getTop();
                            r.close(t.key, "Successfully reapplied to the Program"),
                                i.addNotification("You have successfully re-applied to the program " + e.getPostCode() + " " + e.getPostTitle(), o.TYPE.SUCCESS)
                        }, function(e) {
                            i.addNotification(e.data, o.TYPE.ERROR),
                                s.isUpdateInProgress = !1;
                            var t = r.getTop();
                            r.dismiss(t.key, "Failed to Reapply to Program")
                        })
                }
                ,
                d.acceptSubjectPost = function(t) {
                    h.setCurrentPOST(t),
                        n.open({
                            animation: !0,
                            templateUrl: "partials/program/modal/accept.html",
                            scope: e,
                            windowClass: "modal-lg-acorn"
                        })
                }
                ,
                d.commitProgramAccept = function(e) {
                    h.setModalStateLoading(),
                        s.isUpdateInProgress = !0,
                        g.acceptSubjectPost(e).then(function() {
                            s.isUpdateInProgress = !1,
                                f();
                            var t = r.getTop();
                            r.close(t.key, "Successfully Accepted the invitation to the Program"),
                                i.addNotification("You have accepted the invitation and enrolled in program " + e.getPostCode() + " " + e.getPostTitle(), o.TYPE.SUCCESS)
                        }, function(e) {
                            i.addNotification(e.data, o.TYPE.ERROR),
                                s.isUpdateInProgress = !1;
                            var t = r.getTop();
                            r.dismiss(t.key, "Failed to Accept the invitiation to the Program")
                        })
                }
                ,
                d.dropSubjectPost = function(t) {
                    h.setCurrentPOST(t),
                        n.open({
                            animation: !0,
                            templateUrl: "partials/program/modal/drop.html",
                            scope: e,
                            windowClass: "modal-lg-acorn"
                        })
                }
                ,
                d.commitProgramDrop = function(e) {
                    s.isUpdateInProgress = !0,
                        h.setModalStateLoading();
                    var t = g.dropSubjectPost
                        , n = e.getChildPosts()
                        , a = n.length;
                    a > 0 && (t = g.dropAllSubjectPosts),
                        t(e).then(function() {
                            f(),
                                s.isUpdateInProgress = !1;
                            var t = r.getTop();
                            r.close(t.key, "Program dropped successfully");
                            var c = "";
                            if (0 === a)
                                c = "You have dropped the program " + e.getPostCode() + " " + e.getPostTitle();
                            else {
                                c = "You have dropped the program " + e.getPostCode() + " " + e.getPostTitle() + " and all associated programs focuses. <br />Including: <ul>";
                                for (var l = 0; l < a; l++) {
                                    var u = n[l];
                                    c += "<li>" + u.getPostCode() + " " + u.getPostTitle() + "</li>"
                                }
                                c += "</ul>"
                            }
                            i.addNotification(c, o.TYPE.INFO)
                        }, function(e) {
                            s.isUpdateInProgress = !1;
                            var t = r.getTop();
                            r.dismiss(t.key, "Failed to drop program"),
                                i.addNotification(e.data, o.TYPE.ERROR)
                        })
                }
                ,
                d.commitProgramChangeGroup = function(e, t) {
                    angular.isObject(e) && angular.isObject(t) && (s.isUpdateInProgress = !0,
                        h.setModalStateLoading(),
                        g.changeSubjectPostToPostInGroup(e, t).then(function() {
                            f(),
                                s.isUpdateInProgress = !1;
                            var e = r.getTop();
                            r.close(e.key, "Program Switched Successfully"),
                                i.addNotification("You have switched to the program " + t.getPostCode() + " " + t.getPostTitle(), o.TYPE.SUCCESS)
                        }, function(e) {
                            s.isUpdateInProgress = !1;
                            var t = r.getTop();
                            r.dismiss(t.key, "Failed to Switch Program"),
                                i.addNotification(e.data, o.TYPE.ERROR)
                        }))
                }
                ,
                d.getChangeGroupForPost = function(t) {
                    s.isUpdateInProgress = !0,
                        g.getSubjectPostChangeGroupFromCode(t.getChangeGroupID()).then(function(r) {
                            s.isUpdateInProgress = !1,
                                h.setCurrentPOST(t).setGroupChangePosts(r),
                                n.open({
                                    animation: !0,
                                    templateUrl: "partials/program/modal/changeGroup.html",
                                    scope: e,
                                    windowClass: "modal-lg-acorn"
                                })
                        }, function(e) {
                            s.isUpdateInProgress = !1,
                                i.addNotification(e.data, o.TYPE.ERROR)
                        })
                }
                ,
                d.getDetailedProgramStatus = g.getDetailedProgramStatus,
                d.UIManager = new t,
                e.programManager = d,
                e.notificationManager = i,
                document.title = "Programs",
                f()
        }()
    }
    ]),
    angular.module("acornApp").controller("ProgramTypeaheadSearchCtrl", ["$scope", "$log", "$uibModal", "$filter", "acornCoreProperties", "programResources", "utTypeaheadState", "postFactory", function(e, t, n, r, a, i, o, s) {
        function c(e) {
            var t = a.getOrgInfoByOrgCode(e);
            return t ? t.getURIForType("alias") : ""
        }
        e.getAliasForOrgCode = function(e) {
            return c(e)
        }
            ,
            e.searchLoading = !1,
            e.searchError = !1,
            e.searchPrograms = function(t) {
                e.searchLoading = !0,
                    e.searchError = !1,
                    i.matchingSubjectPOSTS({
                        subjectPostPrefix: t
                    }).then(function(t) {
                        t = t.map(function(e, t) {
                            return e._position = t,
                                e
                        }),
                            e.searchResultsFromProgramCtrl = r("orderBy")(t, ["primaryOrgCode", "_position"]),
                            e.searchLoading = !1,
                            e.searchError = !1
                    }, function() {
                        e.searchResultsFromProgramCtrl = [],
                            e.searchLoading = !1,
                            e.searchError = !0
                    })
            }
            ,
            e.selectProgram = function(r) {
                var a = n.open({
                    animation: !0,
                    templateUrl: "partials/program/modal/add.html",
                    scope: e,
                    windowClass: "modal-lg-acorn",
                    controller: ["$scope", "$window", function(e, t) {
                        e.dismissAndOpenType3RegUrl = function() {
                            t.open(e.programModalManager.getCurrentPOST().getRegURLPost(), "_blank"),
                                e.$dismiss()
                        }
                    }
                    ]
                })
                    , i = function() {
                    $("#typeaheadInput").focus()
                };
                a.result.then(i, i),
                    e.subjectPostManager.getSubjectPostDetailsFromCode(r.postCode).then(function(t) {
                        angular.isObject(t) && e.programModalManager.setCurrentPOST(t).setFailing(!1)
                    }, function(n) {
                        t.log("Reason for failure: " + n.data.value);
                        var a = s.constructProgramFromData(r);
                        e.programModalManager.setCurrentPOST(a),
                            e.programModalManager.setFailing(!0).setFailingReason(n.data.value)
                    })
            }
            ,
            e.ariaDescForProgramItem = function(e) {
                return "Highlighted " + e.postCode + ", " + e.postTitle + ", at " + c(e.primaryOrgCode).replace(/&amp;/g, "&")
            }
            ,
            e.$watch(function() {
                return o.getState()
            }, function(t) {
                t && (e.term = t.term,
                "" === t.term && (e.searchResultsFromProgramCtrl = void 0))
            })
    }
    ]),
    angular.module("acornApp").directive("utToastNotification", ["$timeout", "acornToast", "acornToastConstants", "notificationConstants", function(e, t, n, r) {
        return {
            restrict: "A",
            scope: {
                toastID: "=toastId",
                notification: "=utToastNotification",
                toastSettings: "="
            },
            link: function(e) {
                var a = n.TYPE_INFO;
                switch (e.notification.type) {
                    case r.TYPE.SUCCESS:
                        a = n.TYPE_SUCCESS;
                        break;
                    case r.TYPE.ERROR:
                        a = n.TYPE_DANGER;
                        break;
                    default:
                        a = n.TYPE_INFO
                }
                e.toastNotification = t.showToast({
                    message: e.notification.message,
                    type: a
                })
            }
        }
    }
    ]),
    angular.module("acornApp").service("NotificationManager", ["$timeout", "notificationConstants", function(e, t) {
        function n(n, r) {
            r = r || t.TYPE.INFO,
                e(function() {
                    i.messages.unshift({
                        message: n,
                        type: r
                    })
                }, 0)
        }
        function r() {
            return i.messages
        }
        function a() {
            return i.settings
        }
        var i = {
            settings: {
                onDismiss: function(t) {
                    angular.isObject(t) && e(function() {
                        var e = i.messages.length
                            , n = t.getID();
                        1 === e ? i.messages.length = 0 : i.messages = i.messages.slice(n, Math.min(e, n + 1))
                    }, 0)
                }
            },
            messages: []
        };
        return this.addNotification = n,
            this.getNotifications = r,
            this.getToastSettings = a,
            this
    }
    ]),
    angular.module("acornApp").service("postControls", function() {
        function e(e) {
            return !!angular.isDefined(e) && (!!angular.isObject(e) && !(!e.isStatusActive() || !e.getChangeGroupID()))
        }
        function t(e) {
            return !!angular.isDefined(e) && (!!angular.isObject(e) && !!e.isStatusActive())
        }
        function n(e) {
            return !!angular.isDefined(e) && (!!angular.isObject(e) && !!(e.isStatusRequested() || e.isStatusInvited() || e.isStatusRefused() && e.getStatusModifierA()))
        }
        return {
            canSwitchWithinProgram: e,
            canRemoveProgram: n,
            canDropProgram: t
        }
    }),
    angular.module("acornApp").service("postFactory", ["$log", "acornCoreProperties", function(e, t) {
        function n(e) {
            return o[e] || !1
        }
        function r(a) {
            var i, o, l, u, d, p, f, g, m, h, v, C, y, A, E = !1, T = !1, S = !1, w = null, b = [];
            return function() {
                i = a.postCode,
                    o = a.postTitle,
                    p = a.sessionDescription,
                    m = n(angular.isString(a.status) ? a.status.toUpperCase() : ""),
                    g = a.status,
                    h = a.designationDescription,
                    E = a.statusModifierA,
                    T = a.statusModifierB,
                    S = a.completed,
                    u = a.requirementsSessionCode,
                    C = a.organizationName,
                    y = a.primaryOrgCode,
                    p = a.startSessionDescription,
                    f = a.requirementsSessionDescription,
                    v = a.postChangeGroupNumber || null,
                    A = a.postChangeGroupDesc || null;
                var e = "DEFAULT";
                void 0 !== c[y] && (e = y),
                    l = angular.isString(a.ivrWebInd) && "N" === a.ivrWebInd ? c[e].SPECIAL_APPROVAL_REQUIRED : angular.isString(a.subjectPostAprvInd) && "Y" === a.subjectPostAprvInd.toUpperCase() ? c[e].APPROVAL_REQUIRED : angular.isString(a.subjectPostAprvInd) ? c[e].PRE_APPROVED : null,
                angular.isString(a.subjectPostCharge) && (d = "N" !== a.subjectPostCharge.toUpperCase() ? "Deregulated" : "Regulated")
            }(),
                this.UI = {
                    expanded: !0
                },
                this.setPostParent = function(e) {
                    w = e
                }
                ,
                this.getPostParent = function() {
                    return w
                }
                ,
                this.getPostCode = function() {
                    return i
                }
                ,
                this.getPostTitle = function() {
                    return o
                }
                ,
                this.getPostType = function() {
                    return l
                }
                ,
                this.getSessionCode = function() {
                    return u
                }
                ,
                this.getPostDesignationDescription = function() {
                    return h
                }
                ,
                this.getProgramFees = function() {
                    return d
                }
                ,
                this.getStartSession = function() {
                    return p
                }
                ,
                this.getRequirementsSession = function() {
                    return f
                }
                ,
                this.getStatus = function() {
                    return g
                }
                ,
                this.isStatusInvited = function() {
                    return g === s.INVITED
                }
                ,
                this.isStatusRefused = function() {
                    return g === s.REFUSED
                }
                ,
                this.isStatusActive = function() {
                    return g === s.ACTIVE
                }
                ,
                this.isStatusRequested = function() {
                    return g === s.REQUESTED
                }
                ,
                this.getPrimaryOrgCode = function() {
                    return y
                }
                ,
                this.getRegURLPost = function() {
                    var e = null;
                    if (angular.isString(y)) {
                        var n = t.getOrgInfoByOrgCode(y);
                        angular.isObject(n) && (e = n.getURIForType("postInfo"))
                    }
                    return e || null
                }
                ,
                this.getStatusModifierA = function() {
                    return E
                }
                ,
                this.getStatusModifierB = function() {
                    return T
                }
                ,
                this.isPostCompleted = function() {
                    return S
                }
                ,
                this.getDetailedStatus = function() {
                    return m
                }
                ,
                this.getChildPosts = function() {
                    return b
                }
                ,
                this.hasChildren = function() {
                    return b.length > 0
                }
                ,
                this.addChildPost = function(t) {
                    if (!(t instanceof r))
                        return void e.warn("Expected _PoST object to be added as child but got: ", t);
                    t.setPostParent(this),
                        b.push(t)
                }
                ,
                this.getChangeGroupID = function() {
                    return v
                }
                ,
                this.getOrganizationName = function() {
                    return C
                }
                ,
                this.getPostChangeGroupDesc = function() {
                    return A
                }
                ,
                this
        }
        function a(t) {
            return angular.isObject(t) ? new r(t) : (e.warn("Expected POST resource object but got: ", t),
                null)
        }
        var i = t.getProgramEnrolmentProperties()
            , o = i.maps.programStatusMap
            , s = i.maps.programStatusType
            , c = i.maps.programApprovalTypeSpecifier;
        return this.constructProgramFromData = a,
            this.getDetailedProgramStatus = n,
            this
    }
    ]),
    angular.module("acornApp").service("ProgramManager", ["$q", "$log", "postFactory", "programResources", "acornCoreProperties", function(e, t, n, r, a) {
        function i() {
            function a(e) {
                var t = {};
                return angular.copy(e, t),
                    t.postCode = e.code,
                    t.postTitle = e.description,
                    t
            }
            function i(a) {
                var i = e.defer();
                return angular.isDefined(a) ? (r.getSubjectPostChangeGroup({
                    subjectPostGroup: a
                }, function(e) {
                    var t = [];
                    if (angular.isArray(e))
                        for (var r = e.length, a = 0; a < r; a++)
                            t.push(new n.constructProgramFromData(e[a]));
                    i.resolve(t)
                }, function(e) {
                    t.warn(e),
                        i.reject(e)
                }),
                    i.promise) : (t.warn("Expected a change group id argument but got an undefined id"),
                    null)
            }
            function o(n, a) {
                var i = e.defer();
                return angular.isObject(n) && angular.isObject(a) ? (r.changeSubjectPOSTGroup({
                    oldSubjectPost: {
                        code: n.getPostCode(),
                        sessionCode: n.getSessionCode(),
                        status: n.getStatus()
                    },
                    newSubjectPost: {
                        code: a.getPostCode()
                    }
                }, function(e) {
                    i.resolve(e)
                }, function(e) {
                    t.warn(e),
                        i.reject(e)
                }),
                    i.promise) : void t.warn("Expected POST argument to be a POST object but got: ", n, a)
            }
            function c(n) {
                var a = e.defer();
                return angular.isObject(n) ? (r.acceptSubjectPost({
                    code: n.getPostCode(),
                    sessionCode: n.getSessionCode(),
                    status: n.getStatus()
                }, function(e) {
                    a.resolve(e)
                }, function(e) {
                    t.warn(e),
                        a.reject(e)
                }),
                    a.promise) : void t.warn("Expected POST argument to be a POST object but got: ", n)
            }
            function l(n) {
                var a = e.defer();
                return angular.isObject(n) ? (r.reapplyToSubjectPOST({
                    code: n.getPostCode(),
                    sessionCode: n.getSessionCode(),
                    status: n.getStatus()
                }, function(e) {
                    a.resolve(e)
                }, function(e) {
                    t.warn(e),
                        a.reject(e)
                }),
                    a.promise) : void t.warn("Expected POST argument to be a POST object but got: ", n)
            }
            function u(i) {
                var o = e.defer();
                return r.getSubjectPOSTByPOSTCode({
                    subjectPostCode: i
                }, function(e) {
                    var r = {};
                    if (!angular.isObject(e))
                        return t.warn("Expected object or array but got: ", e),
                            r;
                    r = e,
                    s.maps.programStatusMap[r.status] || (r.status = null);
                    var i = a(r)
                        , c = n.constructProgramFromData(i);
                    o.resolve(c)
                }, function(e) {
                    t.warn(e),
                        o.reject(e)
                }),
                    o.promise
            }
            function d(i) {
                var o = !!i;
                if (null !== v && !o)
                    return v;
                var s = e.defer();
                return r.getMySubjectPOSTS(null, function(e) {
                    var r, i = {}, o = {};
                    if (v = {},
                            C = !1,
                            y = !1,
                            !angular.isObject(e))
                        return t.warn("Expected object or array but got: ", e),
                            i;
                    r = e;
                    var c = 0;
                    for (var l in r) {
                        var u = r[l];
                        if (angular.isArray(u)) {
                            C = !0;
                            var d = u.length;
                            c += d;
                            for (var p = 0; p < d; p++) {
                                var f = u[p]
                                    , g = a(f)
                                    , m = "NA";
                                f.status && "" !== f.status && (m = f.status),
                                angular.isArray(i[m]) || (i[m] = []);
                                var h = n.constructProgramFromData(g);
                                if (i[m].push(h),
                                        angular.isArray(f.children)) {
                                    var A = f.children.length;
                                    c += A,
                                    A && (y = !0);
                                    for (var E = 0; E < A; E++) {
                                        var T = a(f.children[E])
                                            , S = n.constructProgramFromData(T);
                                        angular.isArray(o[m]) || (o[m] = []),
                                            o[m].push(S),
                                            h.addChildPost(S)
                                    }
                                }
                            }
                        }
                    }
                    v.getSubjectPosts = function() {
                        return i
                    }
                        ,
                        v.getLength = function() {
                            return c
                        }
                        ,
                        v.getChildSubjectPosts = function() {
                            return o
                        }
                        ,
                        s.resolve(v)
                }, function(e) {
                    t.warn(e),
                        s.reject(e)
                }),
                    s.promise
            }
            function p(n) {
                var a = e.defer();
                return angular.isObject(n) ? (r.addSubjectPOST({
                    code: n.getPostCode()
                }, function(e) {
                    a.resolve(e)
                }, function(e) {
                    t.warn(e),
                        a.reject(e)
                }),
                    a.promise) : void t.warn("Expected POST argument to be a POST object but got: ", n)
            }
            function f(n) {
                var a = e.defer();
                return angular.isObject(n) ? (r.dropSubjectPOST({
                    code: n.getPostCode(),
                    sessionCode: n.getSessionCode(),
                    status: n.getStatus()
                }, function(e) {
                    a.resolve(e)
                }, function(e) {
                    t.warn(e),
                        a.reject(e)
                }),
                    a.promise) : void t.warn("Expected POST argument to be a POST object but got: ", n)
            }
            function g(n) {
                var a = e.defer();
                if (!angular.isObject(n))
                    return void t.warn("Expected POST argument to be a POST object but got: ", n);
                var i = n.getChildPosts()
                    , o = i.length;
                if (0 === o)
                    return f(n);
                for (var s = {
                    parent: {
                        code: n.getPostCode(),
                        sessionCode: n.getSessionCode(),
                        status: n.getStatus()
                    },
                    children: []
                }, c = 0; c < o; c++) {
                    var l = i[c];
                    s.children.push({
                        code: l.getPostCode(),
                        sessionCode: l.getSessionCode(),
                        status: l.getStatus()
                    })
                }
                return r.dropAllSubjectPOST(s, function(e) {
                    a.resolve(e)
                }, function(e) {
                    t.warn(e),
                        a.reject(e)
                }),
                    a.promise
            }
            function m() {
                return C
            }
            function h() {
                return y
            }
            var v = null
                , C = !1
                , y = !1;
            return this.getUserSubjectPosts = d,
                this.getSubjectPostDetailsFromCode = u,
                this.getDetailedProgramStatus = n.getDetailedProgramStatus,
                this.addSubjectPost = p,
                this.dropSubjectPost = f,
                this.dropAllSubjectPosts = g,
                this.acceptSubjectPost = c,
                this.reapplyToSubjectPost = l,
                this.getSubjectPostChangeGroupFromCode = i,
                this.changeSubjectPostToPostInGroup = o,
                this.hasPosts = m,
                this.hasPostChildren = h,
                this
        }
        function o() {
            function a(e) {
                function t(e) {
                    return e.replace(/\s+/g, "").toUpperCase()
                }
                var n = !1;
                if (!angular.isObject(e))
                    return n;
                var r = e.getPostCode() + " " + e.getPostTitle();
                r = t(r);
                var a = t(s.searchTerm);
                return r.search(a) >= 0 && (n = !0),
                    n
            }
            function i(e) {
                s.filteredSearchResults.length = 0;
                var t = s.searchResults
                    , n = s.filteredSearchResults
                    , r = angular.isArray(t) ? t.length : 0;
                if (0 === r || !angular.isString(e) || 0 == e.length)
                    return n;
                for (var a = 0; a < r; a++) {
                    var i = t[a];
                    n.push(i)
                }
                return n
            }
            function o(a) {
                var i = e.defer()
                    , o = {
                    subjectPostPrefix: a
                };
                return r.matchingSubjectPOSTS(o, function(e) {
                    s.searchResults = function(e) {
                        var t = [];
                        if (!angular.isArray(e))
                            return t;
                        for (var r = e.length, a = 0; a < r; a++) {
                            var i = n.constructProgramFromData(e[a]);
                            i.getInsertionID = function(e) {
                                return function() {
                                    return e
                                }
                            }(a),
                                t.push(i)
                        }
                        return t
                    }(e),
                        i.resolve(s.searchResults)
                }, function(e) {
                    t.warn(e),
                        i.reject(e)
                }),
                    i.promise
            }
            var s = {
                searchResults: {},
                waitingForResults: !1,
                oldSearchTerm: "",
                searchTerm: "",
                currentlySelectedProgramIndex: -1,
                searchLimit: 25,
                shouldHideMoreResultsCaption: !1,
                filteredSearchResults: []
            };
            return s.getSearchFilter = a,
                s.getSearchResults = o,
                s.getFilteredSearchResults = i,
                s
        }
        var s = a.getProgramEnrolmentProperties()
            , c = new o
            , l = new i;
        return this.getSubjectPostSearchManager = function() {
            return c
        }
            ,
            this.getSubjectPostManager = function() {
                return l
            }
            ,
            this
    }
    ]),
    angular.module("acornApp").service("programResources", ["$resource", "$q", "$log", function(e, t, n) {
        function r(e, r, a, i) {
            angular.isObject(r) || (r = {});
            var o = t.defer()
                , s = angular.isFunction(a) ? function(e) {
                    a.call(this, e),
                        o.resolve(e)
                }
                    : function(e) {
                    o.resolve(e)
                }
                , c = angular.isFunction(i) ? function(e) {
                    n.log("Program Resource Error: " + e),
                        i.call(this, e),
                        o.reject(e)
                }
                    : function(e) {
                    n.log("Program Resource Error: No fail function provided " + e),
                        o.reject(e)
                }
                ;
            return e.call(this, r, s, c),
                o.promise
        }
        function a(e) {
            return angular.isObject(e) || (e = {}),
                angular.isDefined(e.__ts) ? n.warn("Attempted to add timestamp cache buster failed due to timestamp property being previously used.") : e.__ts = (new Date).getTime(),
                e
        }
        var i = null;
        return function() {
            var t = "undefined" == typeof testBaseUrl ? "" : testBaseUrl;
            i = e(t + "/sws/rest/subjectpost/:command", {}, {
                getMySubjectPOSTS: {
                    method: "GET",
                    params: {
                        command: "subjectposts"
                    },
                    isArray: !1
                },
                getSubjectPOSTByPOSTCode: {
                    method: "GET",
                    params: {
                        command: "subjectpost"
                    },
                    isArray: !1
                },
                addSubjectPOST: {
                    method: "POST",
                    params: {
                        command: "add"
                    },
                    isArray: !1
                },
                dropSubjectPOST: {
                    method: "POST",
                    params: {
                        command: "delete"
                    },
                    isArray: !1
                },
                dropAllSubjectPOST: {
                    method: "POST",
                    params: {
                        command: "delete-all"
                    },
                    isArray: !1
                },
                getSubjectPOSTChangeGroup: {
                    method: "GET",
                    params: {
                        command: "group-subjectposts"
                    },
                    isArray: !0
                },
                acceptSubjectPOST: {
                    method: "POST",
                    params: {
                        command: "accept"
                    },
                    isArray: !0
                },
                reapplyToSubjectPOST: {
                    method: "POST",
                    params: {
                        command: "reapply"
                    },
                    isArray: !0
                },
                changeSubjectPOSTGroup: {
                    method: "POST",
                    params: {
                        command: "change"
                    },
                    isArray: !1
                },
                matchingSubjectPOSTS: {
                    method: "GET",
                    params: {
                        command: "matching-subjectposts"
                    },
                    isArray: !0
                }
            })
        }(),
            this.matchingSubjectPOSTS = function(e, t, n) {
                return e = a(e),
                    r(i.matchingSubjectPOSTS, e, t, n)
            }
            ,
            this.getMySubjectPOSTS = function(e, t, n) {
                return e = a(e),
                    r(i.getMySubjectPOSTS, e, t, n)
            }
            ,
            this.getSubjectPOSTByPOSTCode = function(e, t, n) {
                return e = a(e),
                    r(i.getSubjectPOSTByPOSTCode, e, t, n)
            }
            ,
            this.addSubjectPOST = function(e, t, n) {
                return r(i.addSubjectPOST, e, t, n)
            }
            ,
            this.dropSubjectPOST = function(e, t, n) {
                return r(i.dropSubjectPOST, e, t, n)
            }
            ,
            this.dropAllSubjectPOST = function(e, t, n) {
                return r(i.dropAllSubjectPOST, e, t, n)
            }
            ,
            this.getSubjectPostChangeGroup = function(e, t, n) {
                return e = a(e),
                    r(i.getSubjectPOSTChangeGroup, e, t, n)
            }
            ,
            this.changeSubjectPOSTGroup = function(e, t, n) {
                return r(i.changeSubjectPOSTGroup, e, t, n)
            }
            ,
            this.acceptSubjectPost = function(e, t, n) {
                return r(i.acceptSubjectPOST, e, t, n)
            }
            ,
            this.reapplyToSubjectPOST = function(e, t, n) {
                return r(i.reapplyToSubjectPOST, e, t, n)
            }
            ,
            this
    }
    ]),
    angular.module("acornApp").directive("t2202aHelpModal", function() {
        return {
            restrict: "E",
            template: '<ut-help-modal data-template-url="partials/taxes/t2202aHelpModal.html"   data-link-text="Frequently Asked Questions (FAQs) about T2202A"></ut-help-modal>'
        }
    }),
    angular.module("acornApp").directive("t4aHelpModal", function() {
        return {
            restrict: "E",
            template: '<ut-help-modal data-template-url="partials/taxes/t4aHelpModal.html"   data-link-text="Frequently Asked Questions (FAQs) about T4A"></ut-help-modal>'
        }
    }),
    angular.module("acornApp").controller("StudentBasicInfoCtrl", ["$scope", "studentBasicInfoSvc", function(e, t) {
        !function() {
            t.getStudentBasicInfo().then(function(t) {
                e.user = t
            })
        }()
    }
    ]),
    angular.module("acornApp").controller("TimeTableCtrl", ["$scope", "$log", "timetableService", "eligibleRegistrationManager", function(e, t, n, r) {
        e.studentExams = null,
            e.eligibleRegistrations = [],
            e.getStudentExams = function() {
                n.getStudentExams().then(function(t) {
                    e.studentExams = t
                }, function(e) {
                    t.error("Failed to retrieve data: " + e)
                })
            }
            ,
            e.isExamPeriod = function() {
                return e.studentExams && e.studentExams.isInExamPeriod === !0
            }
            ,
            e.doesStudentHaveExams = function() {
                return e.studentExams && e.studentExams.exams && e.studentExams.exams.length > 0
            }
            ,
            function() {
                e.getStudentExams(),
                    r.initManager(function(t) {
                        e.eligibleRegistrations = t
                    })
            }()
    }
    ]),
    angular.module("acornApp").directive("copyContentForPrinting", function() {
        return {
            restrict: "A",
            link: function(e, t, n) {
                var r = n.copyToId;
                angular.element(document.querySelector("#" + r)).append(t.html())
            }
        }
    }),
    angular.module("acornApp").directive("examAccessibility", ["$compile", "$log", "campusService", function(e, t, n) {
        return {
            restrict: "E",
            scope: {},
            template: '<p>   Any exam accommodations you have received are not reflected in this schedule.    Please confirm exam locations and details with <a href="{{accessibilityWrapper.link}}" target="_blank">   {{accessibilityWrapper.text}}<i data-ng-if="accessibilityWrapper.italicText">{{accessibilityWrapper.italicText}}</i>    Services<data-icon-ext-link></data-icon-ext-link></a>.</p>',
            controller: ["$scope", function(e) {
                e.accessibilityWrapper = {},
                    e.getAccessibilityLink = function() {
                        switch (n.getCampus()) {
                            case "STG":
                                e.accessibilityWrapper.link = "http://www.studentlife.utoronto.ca/as/contact-us",
                                    e.accessibilityWrapper.text = "Accessibility";
                                break;
                            case "SCAR":
                                e.accessibilityWrapper.link = "http://www.utsc.utoronto.ca/~ability/index.html",
                                    e.accessibilityWrapper.text = "Access",
                                    e.accessibilityWrapper.italicText = "Ability";
                                break;
                            case "ERIN":
                                e.accessibilityWrapper.link = "https://www.utm.utoronto.ca/accessability/",
                                    e.accessibilityWrapper.text = "Access",
                                    e.accessibilityWrapper.italicText = "Ability";
                                break;
                            default:
                                e.accessibilityWrapper.link = "http://www.future.utoronto.ca/newly-admitted-students/a-z-list-links-students#accessibility-services",
                                    e.accessibilityWrapper.text = "Accessibility"
                        }
                    }
                    ,
                    e.getAccessibilityLink()
            }
            ]
        }
    }
    ]),
    angular.module("acornApp").directive("examInfo", function() {
        return {
            restrict: "A",
            scope: {
                exams: "=examInfo",
                examDate: "=",
                timezone: "="
            },
            template: '<div class="exam-info"><br/>   <div class="acorn-table-title">{{examDate}}</div>   <div class="acorn-table-padding">       <table class="table acorn-table xs-block-table">           <thead>               <tr>                   <th>Time</th>                    <th>Course</th>                   <th>Location</th>               </tr>           </thead>           <tbody>               <tr data-ng-repeat="exam in exams | filter:filterByExamDate(examDate) | orderBy:\'examStartTimestamp\'">                   <td>{{exam.examTimeWithZone}}</td>                   <td>{{exam.academicActivityCode}}-{{exam.sectionCode}}</td>                   <td>                       <span data-ng-show="locationUnavailable(exam)">Please refer to your offering division&apos;s exam schedule.</span>                       <span data-ng-show="exam.examLocationUrl && !locationUnavailable(exam)">                           <a data-ng-href="{{exam.examLocationUrl}}" target="_blank">                               {{exam.examRoom}} <span data-ng-show="exam.buildingName">                               <span class="hidden-xs">({{exam.buildingName}}</span>                               <data-icon-ext-link></data-icon-ext-link></span>                           </a>                       </span>                       <span data-ng-show="!exam.examLocationUrl && !locationUnavailable(exam)">                           <span>{{exam.examRoom}} <span class="hidden-xs" data-ng-show="exam.buildingName">({{exam.buildingName}})</span></span>                       </span>                   </td>               </tr>           </tbody>       </table>   </div></div>',
            link: function(e) {
                e.filterByExamDate = function(e) {
                    return function(t) {
                        return t.examDateStr === e
                    }
                }
                    ,
                    e.locationUnavailable = function(e) {
                        return !e || !e.examBuildingCode || "ZZ" === e.examBuildingCode
                    }
                    ,
                    e.hasMultipleRooms = function(e) {
                        return e && e.examRoom.indexOf(",") > -1
                    }
            }
        }
    }),
    angular.module("acornApp").directive("examOfferingDivisionsUrl", ["orgKeyDatesSvc", function(e) {
        return {
            restrict: "A",
            scope: {
                registrations: "=registrations"
            },
            template: '<div class="acorn-icon-info">You don\'t have any exams scheduled yet.<span data-ng-hide="studentHasMultipleOrgs" data-ng-repeat="(key, keyDateOrg) in keyDateOrgs">   <a href="{{keyDateOrg.url}}" target="_blank">See your offering division\'s website for expected exam schedule release dates<data-icon-ext-link></data-icon-ext-link></a></span><span data-ng-show="studentHasMultipleOrgs">   See your offering divisions\' websites for expected exam schedule release dates:   <ul class="key-dates">       <li data-ng-repeat="(key, keyDateOrg) in keyDateOrgs">           <a href="{{keyDateOrg.url}}" target="_blank">{{keyDateOrg.name}}<data-icon-ext-link></data-icon-ext-link></a>    </li>   </ul></span></div>',
            link: function(t) {
                t.$watch("registrations", function(n) {
                    if (n) {
                        var r = e.getKeyDateOrgs(n);
                        t.keyDateOrgs = r;
                        var a = null !== r && angular.isDefined(r) ? Object.keys(r) : null;
                        t.studentHasMultipleOrgs = null != a && angular.isArray(a) && a.length > 1
                    }
                })
            }
        }
    }
    ]),
    angular.module("acornApp").factory("timetableServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/:path/:action", {}, {
            getStudentExams: {
                method: "GET",
                params: {
                    path: "calendar",
                    action: "exams"
                }
            }
        })
    }
    ]),
    angular.module("acornApp").service("timetableService", ["$q", "timetableServerResources", function(e, t) {
        this.getStudentExams = function() {
            var n = e.defer();
            return t.getStudentExams(function(e) {
                n.resolve(e)
            }, function(e) {
                n.reject(e)
            }),
                n.promise
        }
    }
    ]),
    angular.module("acornApp").controller("HistoryCtrl", ["$scope", "$routeParams", "$location", "transcriptServerResources", "HistoryHelper", "TranscriptOrder", "utCacheBreaker", "utBlockNav", function(e, t, n, r, a, i, o, s) {
        s.remove(),
            e.getPrice = i.getPrice,
            e.financialHold = !0,
            r.transcriptHold(o.ieCB(), function(t) {
                e.transcriptHolds = t,
                    e.financialHold = !!e.transcriptHolds.hasAnyHold
            }, function() {
                alert("Unable to determine financial hold status.")
            }),
            i.clear(),
            i.orderStarted(),
            e.showOrder = t.orderId,
            e.headerTemplate = "partials/transcript/header.html",
            e.title = "Order History",
            e.navDashboard = !0,
            e.historyPage = !0,
            e.loading = "Loading ...",
            e.hasPendingPayment = !1,
            e.viewLimit = 10,
            e.increaseView = function() {
                e.viewLimit + 10 <= e.orders.length ? e.viewLimit += 10 : e.viewLimit = e.orders.length
            }
            ,
            e.paymentMatrix = {
                A: "Cash",
                B: "Debit card",
                C: "Student account",
                D: "Credit card",
                E: "Cheque",
                F: "Billing",
                G: "Electronic payment",
                O: "Through OUAC for EDI",
                9: "No charge"
            },
            e.getPaymentMethodStatus = function(t) {
                e.paymentMatrix[t.paymentMethod] && (t.paymentMethodStatus = "Paid")
            }
        ;
        var c = function(t) {
            for (var n = !1, r = t.length, a = 0; a < r; a++)
                if (null === t[a].paymentMethod) {
                    n = !0;
                    break
                }
            e.hasPendingPayment = n
        };
        e.orders = [],
            r.transcriptHistoryFull(o.ieCB(), function(t) {
                0 == t.length ? e.loading = "No orders found." : (e.loading = !1,
                    e.orders = t,
                    c(t),
                    a.cacheHistory(t),
                    a.processTextForDisplay(t))
            }, function(t) {
                403 == t.status ? e.loading = "Session timeout, please login again." : e.loading = "Error loading history"
            }),
            e.deliveryMethodMatrix = {
                UTTC1: 1,
                UTTC3: 2,
                UTM2: 2,
                UTS2: 2,
                COUR: 3,
                UTTC5: 4
            },
            e.pickupMethodMatrix = {
                UTTC3: 0,
                UTM2: 1,
                UTS2: 2
            },
            e.showReceipt = function(t) {
                e.transcriptOrders = i.get(),
                    e.transcriptOrders.historyReceipt = !0,
                    e.transcriptOrders.paymentReceiptText = e.paymentMatrix[t.paymentMethod],
                    "G" == t.paymentMethod ? (e.transcriptOrders.paymentType = 0,
                        e.transcriptOrders.completeInfo = t.invoices[0]) : e.transcriptOrders.paymentType = 3,
                    t.deliveryMethod = e.deliveryMethodMatrix[t.location],
                    2 == t.deliveryMethod ? (t.pickupMethod = e.pickupMethodMatrix[t.location],
                        t.delivery = "pickup") : void 0 == t.deliveryMethod && (t.deliveryMethod = 4),
                    e.transcriptOrders.recipients[0] = t,
                    n.path("transcript/receipt")
            }
    }
    ]),
    angular.module("acornApp").controller("ManageOrdersCtrl", ["$scope", "$location", "$routeParams", "$log", "transcriptServerResources", "HistoryHelper", "TranscriptOrder", "utCacheBreaker", function(e, t, n, r, a, i, o, s) {
        e.getPrice = o.getPrice,
            o.orderStarted(),
            e.showOrder = void 0 == n.orderId ? "" : n.orderId,
            e.headerTemplate = "partials/transcript/header.html",
            e.title = "Manage Pending Payment Orders",
            e.navDashboard = !0,
            e.orderLoading = !0,
            e.orders = [],
            e.financialHold = !0,
            a.transcriptHold(s.ieCB(), function(n) {
                e.transcriptHolds = n,
                    e.transcriptHolds.hasAnyHold ? (e.financialHold = !0,
                        alert("Sorry, you will not be able to order or pay for previously requested transcripts until all holds have been removed from your record."),
                        t.path("#/transcript")) : e.financialHold = !1
            }, function() {
                alert("Unable to determine financial hold status.")
            });
        var c = function(t) {
            e.orderLoading = !1;
            for (var n = t.length, r = 0; r < n; r++)
                null === t[r].paymentMethod && e.orders.push(t[r]);
            i.processTextForDisplay(e.orders)
        }
            , l = i.getHistory();
        l ? c(l) : a.transcriptHistoryFull(s.ieCB(), c, function(t) {
            403 == t.status ? e.errorText = "Session timeout, please login again." : e.errorText = "There was an error try refreshing the page."
        }),
            e.totalChecked = 0,
            e.totalDollars = 0,
            e.updateChecked = function() {
                for (var t = 0, n = 0, r = e.orders.length, a = 0; a < r; a++)
                    1 == e.orders[a].checked && (t++,
                        n += parseInt(e.orders[a].grandTotal, 10));
                e.totalChecked = t,
                    e.totalDollars = n
            }
            ,
            e.checkAll = function(t) {
                for (var n = e.orders.length, r = 0; r < n; r++)
                    e.showOrder ? e.orders[r].sequenceNo == e.showOrder && (e.orders[r].checked = t,
                        e.orders[r].checkedByDiv = t) : (e.orders[r].checked = t,
                        e.orders[r].checkedByDiv = t)
            }
            ,
            e.deleteOrder = function() {
                if (0 === e.totalChecked)
                    return void alert("No orders selected.");
                var t = e.totalChecked > 1 ? e.totalChecked + " selected orders?" : "selected order?";
                if (confirm("Delete the " + t) === !0) {
                    for (var n = [], i = [], o = e.orders.length, s = 0; s < o; s++)
                        e.orders[s].checked === !0 && (n.push(e.orders[s].sequenceNo),
                            i.push(s));
                    a.deleteTranscript({
                        value: n
                    }, function() {
                        var t = i.length;
                        alert("Delete successful.");
                        for (var n = t - 1; n >= 0; n--)
                            e.orders.splice(i[n], 1);
                        e.updateChecked()
                    }, function(e) {
                        alert("There was an error deleting, please try again."),
                            r.error(e)
                    })
                }
            }
            ,
            e.payForSelected = function() {
                if (e.totalChecked > 30)
                    return void alert("Sorry, you can only pay for a maximum of 30 orders at once.");
                if (0 === e.totalChecked)
                    return void alert("No orders selected.");
                for (var n = [], r = e.orders.length, a = 0; a < r; a++)
                    e.orders[a].checked === !0 && n.push(e.orders[a]);
                o.clear(),
                    e.checkAll(!1),
                    e.transcriptOrder = o.get(),
                    e.transcriptOrder.recipients = n,
                    e.transcriptOrder.manageOrdersFlow = "#/transcript/manage_orders";
                for (var s = e.transcriptOrder.recipients, c = {
                    deliveryMethod: {
                        "Mail to Recipient": 1,
                        "Pick up at UTTC": 2,
                        "Pick up at UTM": 2,
                        "Pick up at Scarborough": 2,
                        Courier: 3
                    },
                    pickupMethod: {
                        UTTC3: 0,
                        UTM2: 1,
                        UTS2: 2
                    }
                }, l = {
                    1: "mail",
                    2: "pickup",
                    3: "courier"
                }, u = s.length, d = 0; d < u; d++)
                    s[d].deliveryMethod = c.deliveryMethod[s[d].locationDescription],
                        s[d].delivery = l[s[d].deliveryMethod],
                        s[d].pickupMethod = c.pickupMethod[s[d].location],
                    "mail" == l[s[d].deliveryMethod] && (s[d].mailOption = s[d].location),
                    "After my graduation ceremony" !== s[d].printEvent && (s[d].printDateOption = "3",
                        s[d].printEvent = "Future date"),
                        s[d].recipientType = null == s[d].recipientId ? 2 : 1,
                        s[d].file = s[d].trackingFormName,
                        s[d].fileUpload = null != s[d].trackingFormName,
                        s[d].fileUUID = "",
                        s[d].disabled = !0;
                i.clearCacheHistory(),
                    t.path("transcript/review_order_and_payment")
            }
    }
    ]),
    angular.module("acornApp").controller("ReceiptCtrl", ["$scope", "TranscriptOrder", "utBlockNav", "$location", "transcriptServerResources", "utCacheBreaker", "FormHelper", function(e, t, n, r, a, i, o) {
        e.getPrice = t.getPrice,
            n.remove(),
            n.generalBlock('Warning:\nReloading this page will bring you back to the dashboard.\n\nTo view this receipt again click "Transcript order history" from the top navigation.'),
            e.headerTemplate = "partials/transcript/header.html" + i.get(),
            e.stepsNavTemplate = "partials/transcript/stepsNav.html" + i.get(),
            e.orderSummaryTemplate = "partials/transcript/orderSummary.html" + i.get(),
            e.pickupInfoTemplate = "partials/transcript/pickupInfo.html" + i.get(),
            e.activatePrint = function() {
                window.print()
            }
            ,
            e.activeStep = "step3",
            e.title = "Receipt",
            e.hasDate = function() {
                return void 0 === e.recipients[0].dateEntered ? e.todayDate() : e.todayDate(e.recipients[0].dateEntered)
            }
            ,
            e.todayDate = function(e) {
                if (e) {
                    var t = e.split("-")
                        , n = t[0]
                        , r = t[1]
                        , a = t[2];
                    return r + "/" + a + "/" + n
                }
                return e = new Date,
                    r = e.getMonth() + 1,
                    a = e.getDate(),
                (r < 10 ? "0" : "") + r + "/" + (a < 10 ? "0" : "") + a + "/" + e.getFullYear()
            }
            ,
            e.status = "complete",
            e.receiptColSpan = 8,
            e.immediately = !1,
            e.detectImmediately = function() {
                for (var t = e.transcriptOrder.recipients.length, n = 0; n < t; n++)
                    if (1 == e.transcriptOrder.recipients[n].printDateOption)
                        return e.immediately = !0,
                            !0;
                return !1
            }
            ,
            t.orderStarted(),
            e.shipmentDetails = {};
        e.transcriptOrder = t.get(),
            e.transcriptOrder.studentNumber ? e.studentNumber = e.transcriptOrder.studentNumber : a.studentInfo({}, function(t) {
                e.emailLoading = !1,
                    e.email = t.email,
                    e.studentNumber = t.studentNumber
            }, function() {
                e.emailLoading = !1
            }),
        e.transcriptOrder.historyReceipt && (e.historyReceipt = !0,
            e.paymentReceiptText = e.transcriptOrder.paymentReceiptText),
            e.paymentType = e.transcriptOrder.paymentType,
        0 === e.transcriptOrder.paymentType && (e.orderNumber = e.transcriptOrder.completeInfo.invoiceNo,
            e.responseCode = "Response code:" + e.transcriptOrder.completeInfo.responseCode,
            function() {
                if (void 0 != e.transcriptOrder.completeInfo) {
                    var t = e.transcriptOrder.completeInfo.shipmentDetails;
                    for (var n in t)
                        e.shipmentDetails[t[n].sequenceNo] = {
                            trackingId: t[n].trackingId,
                            deliveryDate: t[n].deliveryDate,
                            message: t[n].message
                        };
                    for (var r in e.recipients)
                        e.recipients[r].shipmentDetails = e.shipmentDetails[e.recipients[r].sequenceNo]
                }
            }()),
            e.userAgent = "User-agent: " + navigator.userAgent,
            e.recipients = e.transcriptOrder.recipients;
        var s = $("#receipt-box");
        s.show(),
        void 0 == e.recipients[0].sequenceNo && (s.hide(),
            alert("No order information found. Redirecting back to dashboard."),
            r.path("/transcript")),
            e.totalOrderValue = function() {
                for (var t = 0, n = 0, r = 0; r < e.recipients.length; r++)
                    t += parseInt(e.recipients[r].numCopies, 10) * e.getPrice(e.recipients[r]),
                        n += parseInt(e.recipients[r].courierCost, 10);
                return e.noCourier = 0 == n,
                t + n
            }
            ,
            e.subTotal = function(t) {
                var n = void 0 == t.courierCost ? 0 : t.courierCost;
                return parseInt(t.numCopies * e.getPrice(t), 10) + parseInt(n, 10)
            }
            ,
            e.clearOrders = function() {
                t.clear()
            }
            ,
            e.clearOrders(),
            e.dom = {
                loaded: !1
            },
            e.transcriptOrder.email = void 0 == e.transcriptOrder.email ? "" : e.transcriptOrder.email,
            e.emailReceipt = function(t) {
                e.receiptHTML = t;
                for (var n = [], r = 0; r < e.transcriptOrder.recipients.length; r++) {
                    var i = {};
                    i.sequenceNo = e.transcriptOrder.recipients[r].sequenceNo,
                        i.printEvent = e.transcriptOrder.recipients[r].printEvent,
                        n.push(i)
                }
                t.length > 0 && e.transcriptOrder.email.length > 0 && a.emailReceipt({
                    email: e.transcriptOrder.email,
                    paymentType: e.transcriptOrder.paymentType
                }, {
                    value: n
                })
            }
            ,
            e.loadComplete = function() {
                e.dom.loaded || (e.dom.loaded = !0)
            }
            ,
            e.downloadPdf = function() {
                a.downloadPDF({
                    value: e.receiptHTML
                }, function(t) {
                    var n = new Blob([t.data],{
                        type: "application/pdf"
                    })
                        , r = URL.createObjectURL(n)
                        , a = document.createElement("a");
                    a.download = "recipient-" + e.orderNumber + ".pdf",
                        a.href = r,
                        a.click()
                })
            }
            ,
            e.dateFormatter = o.dateFormatter
    }
    ]),
    angular.module("acornApp").controller("ReviewOrderAndPaymentCtrl", ["$scope", "$location", "$timeout", "$log", "TranscriptOrder", "transcriptServerResources", "utBlockNav", "FormHelper", function(e, t, n, r, a, i, o, s) {
        function c() {
            var a = "There is a server issue.  Please check your history to determine if order has gone through.";
            if (e.receiptFoundTries < 60) {
                e.receiptFoundTries++;
                var o = Math.random();
                i.receipt({
                    cb: o
                }, function(i) {
                    void 0 === i.status ? alert("Server has encountered issue, please try again.") : "PENDING" === i.status ? (r.info("nothing found yet"),
                        n(c, 1e3)) : "CANCELED" === i.status ? e.paymentGatewayUrl = "" : "DECLINED" === i.status ? (alert("Credit card declined, please try again."),
                        e.paymentGatewayUrl = "") : "INTERNAL_ERROR" === i.status ? (alert(a),
                        e.paymentGatewayUrl = "",
                        t.path("transcript/history")) : "APPROVED" === i.status ? function(n) {
                        e.paymentGatewayUrl = "",
                            e.transcriptOrder.completeInfo = n,
                            t.path("transcript/receipt")
                    }(i) : void 0 === i.status && (alert("Credit card declined, please try again."),
                        e.paymentGatewayUrl = "")
                }, function(i) {
                    r.error(i),
                        503 == i.status || 504 == i.status || 598 == i.status || 599 == i.status ? n(c, 1e3) : (alert(a),
                            e.paymentGatewayUrl = "",
                            t.path("transcript/history"))
                })
            } else
                alert(a),
                    e.paymentGatewayUrl = "",
                    t.path("transcript/history")
        }
        e.getPrice = a.getPrice,
            o.generalBlock(),
            e.headerTemplate = "partials/transcript/header.html",
            e.stepsNavTemplate = "partials/transcript/stepsNav.html",
            e.recipientTemplate = "partials/transcript/recipient.html",
            e.popupFormTemplate = "partials/transcript/popupForm.html",
            e.orderSummaryTemplate = "partials/transcript/orderSummary.html",
            e.pickupInfoTemplate = "partials/transcript/pickupInfo.html",
            e.orderControls = !0,
            e.stepsNavLink = "#/transcript/select_recipients",
            e.recipients = [{}],
            e.title = "Review & Payment",
            e.activeStep = "step2",
            e.paymentGatewayUrl = "",
            a.orderStarted(),
            e.transcriptOrder = a.get(),
            e.manageOrderFlow = e.transcriptOrder.manageOrdersFlow,
            e.recipients = e.transcriptOrder.recipients;
        var l = $("#review_order_and_payment");
        l.show(),
        void 0 == e.recipients[0].sequenceNo && (l.hide(),
            alert("No order information found. Redirecting back to dashboard."),
            t.path("/transcript")),
            e.totalOrderValue = function() {
                for (var t = 0, n = 0, r = 0; r < e.recipients.length; r++)
                    t += parseInt(e.recipients[r].numCopies, 10) * e.getPrice(e.recipients[r]),
                        n += parseInt(e.recipients[r].courierCost, 10);
                return e.noCourier = 0 == n,
                t + n
            }
            ,
            e.saveCurrentState = function() {
                e.transcriptOrder.orderStarted = !0,
                    a.saveCurrentState()
            }
            ,
            e.saveChanges = function() {
                a.saveCurrentState()
            }
            ,
            e.removeOrder = function(t) {
                var n = confirm("Are you sure you want to remove this order?");
                e.recipients.length > 1 && n && (e.recipients.splice(t, 1),
                    e.removeDisableOnLastElement(),
                    e.saveChanges())
            }
            ,
            i.studentInfo({}, function(t) {
                e.emailLoading = !1,
                    e.email = t.email,
                    e.transcriptOrder.studentNumber = t.studentNumber
            }, function() {
                e.emailLoading = !1
            }),
            i.canPayWithStudentAccount({}, function(t) {
                1 == t.value && (e.canPayWithStudentAccount = !0)
            }, function(e) {
                r.error("Error: canPayWithStudentAccount : " + e)
            }),
            s.initialize(e, "transcriptOrderForm"),
            e.subTotal = function(t) {
                var n = void 0 == t.courierCost ? 0 : t.courierCost;
                return parseInt(t.numCopies * e.getPrice(t), 10) + parseInt(n, 10)
            }
            ,
            e.noCourier = !0,
            e.checkPayment = function(a) {
                e.$broadcast("AUTO_FILL_FIX", "Start"),
                    n(function() {
                        function n() {
                            for (var t = [], n = 0; n < e.transcriptOrder.recipients.length; n++)
                                t.push(s.prepareRequest(e.transcriptOrder.recipients[n]));
                            return t
                        }
                        if (e.transcriptOrder.recipients.length > 30)
                            return void alert("Sorry, maximum of 30 orders can be paid at once.");
                        if (e.transcriptOrder.paymentType = e.paymentType,
                            0 == e.paymentType) {
                            if (e.paymentInfo.submit = !0,
                                e.paymentInfo.email.$error.required || e.paymentInfo.email.$error.email)
                                return;
                            var o = {
                                value: n()
                            };
                            e.transcriptOrder.email = e.paymentInfo.email.$viewValue,
                                i.monerisPayPostParams({
                                    email: e.paymentInfo.email.$viewValue
                                }, o, function(t) {
                                    var n = {};
                                    for (var r in t)
                                        if ("url" == r)
                                            var a = t[r];
                                        else
                                            "$" == r[0] || (n[r] = t[r]);
                                    a = a + "?" + $.param(n),
                                        e.paymentGatewayUrl = a,
                                        c(),
                                        e.cancelInvoiceData = {
                                            invoiceNo: t.rvar_invoiceNo
                                        }
                                }, function(t) {
                                    r.error(t),
                                        e.serverTimeOutError(t)
                                })
                        } else
                            3 == e.paymentType ? i.payWithStudentAccount({
                                value: n()
                            }, function(n) {
                                n.value && (e.transcriptOrder.email = e.paymentInfo.email.$viewValue,
                                    t.path(a))
                            }, function(t) {
                                "string" == typeof t ? alert("Error found while paying." + t) : 403 == t.status ? e.serverTimeOutError(t) : alert("Error found while paying." + t.value)
                            }) : alert("Payment type not selected.")
                    }, 100)
            }
            ,
            e.receiptFoundTries = 0,
            e.cancelInvoice = function() {
                i.cancelInvoice(e.cancelInvoiceData, function(t) {
                    t.value === !0 ? e.paymentGatewayUrl = "" : (alert("Unable to reach server. Please try again."),
                        e.paymentGatewayUrl = "",
                        r.error(t))
                }, function(e) {
                    r.error(e)
                })
            }
            ,
            e.getCountryName = function(t) {
                var n = $.grep(e.countries, function(e) {
                    return e.code == t
                });
                return n.length > 0 ? n[0].description : ""
            }
    }
    ]),
    angular.module("acornApp").controller("SelectRecipientsCtrl", ["$scope", "$location", "$window", "$timeout", "TranscriptOrder", "transcriptServerResources", "utBlockNav", "FormHelper", function(e, t, n, r, a, i, o, s) {
        function c(e) {
            setTimeout(function() {
                0 == $(".recipient_area").length ? c(e) : void 0 == e.institutions ? c(e) : (e.loading = !1,
                    e.$apply())
            }, 100)
        }
        o.formBased(e, "transcriptOrderForm", "transcriptOrder"),
            e.headerTemplate = "partials/transcript/header.html",
            e.stepsNavTemplate = "partials/transcript/stepsNav.html",
            e.recipientTemplate = "partials/transcript/recipient.html",
            e.pickupInfoTemplate = "partials/transcript/pickupInfo.html",
            e.popupFormTemplate = "partials/transcript/popupForm.html",
            e.title = "Select Recipients",
            e.activeStep = "step1",
            e.loading = "Loading ...",
            a.orderStarted(),
            s.initialize(e, "editFormPopup", "transcriptOrderForm"),
            i.transcriptHold({}, function(n) {
                e.transcriptHolds = n,
                e.transcriptHolds.hasAnyHold && t.path("#/transcript")
            }, function() {
                t.path("#/transcript")
            }),
            e.transcriptOrder = a.get(),
            e.transcriptOrder.manageOrdersFlow = !1,
            e.saveCurrentState = function() {
                e.transcriptOrder.orderStarted = !0,
                    a.saveCurrentState()
            }
            ,
            e.validateAndGo = function(t) {
                e.$broadcast("AUTO_FILL_FIX", "Start"),
                    r(function() {
                        if (e.saveCurrentState(),
                                !s.validateForm("transcriptOrderForm", "transcriptOrder"))
                            return !1;
                        var n = e.transcriptOrder.recipients
                            , r = n.length - 1;
                        s.saveToServer(n, r, t)
                    }, 100)
            }
            ,
            e.clearOrders = function() {
                a.clear(),
                    e.transcriptOrder = a.get(),
                    e.setCustomRecipient(e.transcriptOrder.recipients[0])
            }
            ,
            e.setCustomRecipient = function(e) {
                e.recipientType = 1
            }
            ,
            e.addRecipient = function() {
                e.transcriptOrder.recipients.length < 30 ? e.transcriptOrder.recipients.push({}) : alert("Can not add any more recipients. Max 30 per transaction.")
            }
            ,
            e.removeOrder = function(t) {
                var r = n.confirm("Are you sure you want to remove this order?");
                return !!(e.transcriptOrder.recipients.length > 1 && r) && (e.transcriptOrder.recipients.splice(t, 1),
                        !0)
            }
            ,
            i.takesLonger({}, function(t) {
                e.takesLonger = t.value
            }, function() {}),
            c(e)
    }
    ]),
    angular.module("acornApp").controller("TranscriptCtrl", ["$scope", "transcriptServerResources", "TranscriptOrder", "FormHelper", "utCacheBreaker", "utBlockNav", "strformat", "eligibleRegistrationManager", "confirmationOfEnrolmentConstants", "registrarLinkConstants", function(e, t, n, r, a, i, o, s, c, l) {
        var u, d;
        e.eligibleRegistrations = [],
            e.headerTemplate = "partials/transcript/header.html",
            e.transcriptMainTitle = " and Academic History",
            e.title = "Dashboard",
            e.loading = "Loading ...",
            e.serverTime = !1,
            e.$on("DASHBOARD_SERVERTIME_READY", function(t, r) {
                e.serverTime = r,
                    e.currentPrice = n.getPrice()
            }),
            i.remove(),
            e.orders = t.transcriptHistory(a.ieCB(), function(t) {
                return 0 === t.length ? e.loading = "No orders found." : e.loading = !1,
                    t
            }, function() {
                e.loading = "Error loading history."
            }),
            n.fixStyles(),
            e.transcriptHold = 0,
            t.transcriptHold(a.ieCB(), function(t) {
                e.transcriptHolds = t,
                    e.transcriptHolds.hasAnyHold ? e.transcriptHold = 1 : e.transcriptHold = 2
            }, function() {
                e.transcriptHold = 1
            }),
            e.almostHolidaysWarning = !1,
            r.checkHolidaySoon(e),
            e.dateFormatter = r.dateFormatter,
            e.getRegistrarLink = function() {
                var t = []
                    , n = [];
                e.eligibleRegistrations.length ? (e.eligibleRegistrations.forEach(function(e) {
                        t.push(e.primaryOrgCode)
                    }),
                        t.forEach(function(t) {
                            "ARTSC" === t ? e.isARTSC = !0 : (n.push(l[t]),
                                n.length > 1 ? e.registrarLink = l.GENERIC : e.registrarLink = l[t])
                        }),
                        e.getCOEContent = function() {
                            return e.isARTSC ? u : d
                        }
                ) : e.registrarLink = void 0,
                    u = o(c.ARTSC_CONTENT, e.registrarLink),
                    d = o(c.NON_ARTSC_CONTENT, e.registrarLink)
            }
            ,
            function() {
                s.initManager(function(t) {
                    e.eligibleRegistrations = t,
                        e.getRegistrarLink()
                })
            }()
    }
    ]),
    angular.module("acornApp").directive("transcriptHold", function() {
        return {
            restrict: "A",
            template: '<div class="acorn-icon-info overall-padding" data-ng-hide="hasAcademicHistory()">   <p>You cannot order a transcript because you are not currently registered in at least one academic    session. Once you have registered by paying the Minimum Payment to Register Amount on your    <a href="/sws/financial/account/invoice.do?viewInvoice.dispatch">Invoice</a>    or by <a href="/sws/p/financial/osap/view.action">deferring your fees</a>,    you will be able to order a transcript.</p></div><div class="acorn-icon-warn overall-padding" data-ng-show="hasAcademicHistory() && hasAnyHold()">   <p data-ng-show="hasHolds() || hasAdminHolds()">       Your transcript order button is disabled because:   </p>   <div data-ng-show="hasHolds()">      <div class="hold_header">          <p><strong>{{transcriptHolds.message}}</strong></p>      </div>      <p data-ng-show="transcriptHolds.resAndFin || transcriptHolds.resOnly">          <strong>You have restricted holds on your account.</strong>      </p>      <ul class="holds" data-ng-repeat="hold in transcriptHolds.holds">          <li>              <span data-ng-show="hold.resHold">Restricted Hold</span>              <span data-ng-hide="hold.resHold">Financial Hold: {{hold.description}}</span>          </li>      </ul>   </div>   <div data-ng-show="hasAdminHolds()">       <p><strong>{{transcriptHolds.administrativeMessage}}</strong></p>       <ul class="holds" data-ng-repeat="hold in transcriptHolds.administrativeHolds">           <li>Administrative Hold: {{hold.description}}</li>       </ul>   </div>   <div data-ng-show="hasHolds() || hasAdminHolds()">       <p>You will not be able to order or pay for previously requested transcripts until all holds            have been removed from your record.       </p>       <p>Should you have any questions about these hold(s), please contact the following office(s):</p>   </div>   <div class="hold_info" data-ng-show="hasHolds()">       <div data-ng-repeat="hold in transcriptHolds.holds">           <div data-ng-switch data-on="hold.description | lowercase">               <span data-ng-switch-when="university of toronto library">                   <p><strong>LIB - Library Financial Holds:</strong><a href="https://payfines.library.utoronto.ca/"                        target="_blank" title="Online payment for library fines (opens new window/tab)">pay online</a>;                        or call (416) 978-8450; or in person at Robarts Library                   </p>               </span>               <span data-ng-switch-when="utm health services">                   <p><strong>HLTH - Health Services Financial Holds:</strong> call UTM Health Services Office at 905.828.5255</p>               </span>               <span data-ng-switch-when="student accounts">                   <p><strong>FEES - Oustanding Fees Financial Holds:</strong> call student accounts at 416.978.2142</p>               </span>               <span data-ng-switch-when="faculty of arts and science">                   <p><strong>ARTSC - Faculty of Arts and Science:</strong> call the Arts and Science Registrars Office at 416.978.3384</p>               </span>               <span data-ng-switch-when="university of toronto mississauga">                   <p><strong>ERIN - University of Toronto Mississauga:</strong> call the UTM Registrars Office at 905.828.5399</p>               </span>               <span data-ng-switch-when="university of toronto scarborough">                   <p><strong>SCAR - University of Toronto Scarborough:</strong> call the UTSC Registrars Office at 416.287.7001</p>               </span>               <span data-ng-switch-when="st george hlth serv">                   <p><strong>SGHS - St. George Health Services Financial Holds:</strong> call 416.978.8030; or in person at the Health Service located at 214 College Street, 2nd Floor</p>               </span>               <span data-ng-switch-default>                   <p>For Administrative Holds and other Financial Holds: please contact your undergraduate registration office, college, or SGS student services</p>               </span>           </div>       </div>   </div>   <p data-ng-show="hasAdminHolds()">Administrative Hold: UTTC Information Center 416-978-3384.</p></div>',
            scope: {
                transcriptHolds: "=transcriptHold"
            },
            link: function(e) {
                e.hasData = function() {
                    return void 0 !== e.transcriptHolds
                }
                    ,
                    e.hasHolds = function() {
                        return e.hasData() && e.transcriptHolds.holds.length > 0
                    }
                    ,
                    e.hasAdminHolds = function() {
                        return e.hasData() && e.transcriptHolds.administrativeHolds.length > 0
                    }
                    ,
                    e.hasAnyHold = function() {
                        return e.hasData() && e.transcriptHolds.hasAnyHold
                    }
                    ,
                    e.hasAcademicHistory = function() {
                        return e.hasData() && e.transcriptHolds.hasOneActiveReg && !e.transcriptHolds.resOnly
                    }
            }
        }
    }),
    angular.module("acornApp").directive("utAutoFillFix", function() {
        return {
            require: "ngModel",
            link: function(e, t, n, r) {
                e.$on("AUTO_FILL_FIX", function() {
                    r.$setViewValue(t.val())
                })
            }
        }
    }),
    angular.module("acornApp").directive("utCheckForPobox", function() {
        return {
            require: "ngModel",
            link: function(e, t, n) {
                function r(e) {
                    var t = /(?:P\.O\.B\.|POB|POBox|P\.O\.Box|postofficebox|postoffice)(?:\d|#)/i
                        , n = void 0 == e ? e : e.replace(/ /g, "");
                    return t.exec(n)
                }
                e.$watch(n.ngModel, function(t) {
                    var a = n.ngModel;
                    e.recipient.poBoxFoundOn = void 0 === e.recipient.poBoxFoundOn ? {} : e.recipient.poBoxFoundOn,
                        e.recipient.poBoxFoundOn[a] = r(t);
                    var i = !1;
                    for (var o in e.recipient.poBoxFoundOn)
                        i = e.recipient.poBoxFoundOn[o] || i;
                    e.recipient.poBoxFound = i
                })
            }
        }
    }),
    angular.module("acornApp").directive("utCheckValidCharacters", function() {
        return {
            require: "ngModel",
            link: {
                pre: function(e, t, n, r) {
                    function a(e) {
                        var t, n;
                        return angular.isString(e) && (t = e.match(i),
                            n = e.match(o)),
                        !(t && t.length > 0 || n && n.length > 0) || (alert("Invalid character entered."),
                            !1)
                    }
                    var i = new RegExp("[^\\x00-\\x80]+","g")
                        , o = new RegExp("[\\{\\}\\[\\]]","g");
                    r.$validators.validSet = function(e, t) {
                        return a(e || t)
                    }
                }
            }
        }
    }),
    angular.module("acornApp").directive("utDatepicker", function() {
        return {
            require: "ngModel",
            link: function(e, t, n, r) {
                function a(e) {
                    var t = e.getDate()
                        , n = e.getMonth() + 1
                        , r = e.getFullYear();
                    return t < 10 && (t = "0" + t),
                    n < 10 && (n = "0" + n),
                    r + "-" + n + "-" + t
                }
                function i(t) {
                    var n = new Date(a(t))
                        , r = new Date(e.holidayClosure.currentDate.split("T")[0]);
                    if (n >= e.holidayClosure.newDateFrom && n <= e.holidayClosure.newDateTo || n < r)
                        return [!1];
                    if (e.courierOTWarning) {
                        if (r = a(r),
                            a(t) == e.holidayClosure.currentDate.split("T")[0])
                            return [!1];
                        if (a(t) == r)
                            return [!1]
                    }
                    return e.currentlyHoliday && n <= r ? [!1] : [!0]
                }
                function o(e) {
                    function t(e) {
                        return e < 10 ? "0" + e : e
                    }
                    var n = {
                        1: 31,
                        2: 28,
                        3: 31,
                        4: 30,
                        5: 31,
                        6: 30,
                        7: 31,
                        8: 31,
                        9: 30,
                        10: 31,
                        11: 30,
                        12: 31
                    }
                        , r = e.split("-")
                        , a = parseInt(r[0], 10)
                        , i = parseInt(r[1], 10)
                        , o = parseInt(r[2], 10);
                    return 1 == new Date(a,1,29).getMonth() && (n[2] = 29),
                        o + 1 > n[i] ? (i + 1 > 12 ? (r[1] = "01",
                            r[0] = a + 1) : r[1] = t(i + 1),
                            r[2] = "01") : r[2] = t(o + 1),
                        r.join("-")
                }
                function s(t) {
                    return t >= e.holidayClosure.newDateFrom && t <= e.holidayClosure.newDateTo || !!e.courierOTWarning
                }
                $("." + n.utDatepicker).on("click.datepicker", function() {
                    $(t).parent().find(".datepickerInput").focus()
                });
                var c = $(t).parent().find(".datepickerInput");
                c.datepicker({
                    dateFormat: "yy-mm-dd",
                    showButtonPanel: !0,
                    hideIfNoPrevNext: !0,
                    currentText: "Select Today",
                    minDate: 0,
                    beforeShow: function() {
                        return {
                            minDate: e.holidayClosure.currentDate.split("T")[0]
                        }
                    },
                    onSelect: function(t) {
                        c.data("datepicker").inline = !1,
                            e.$apply(function() {
                                r.$setViewValue(t)
                            })
                    },
                    onClose: function() {
                        var t = e.holidayClosure.currentDate.split("T")[0];
                        if (c.data("datepicker").inline = !1,
                            void 0 == r.$modelValue || "" == r.$modelValue) {
                            var n, a = new Date(t);
                            n = s(a) ? o(e.holidayClosure.to) : t,
                                function() {
                                    e.$apply(function() {
                                        r.$setViewValue(n)
                                    })
                                }()
                        }
                    },
                    beforeShowDay: i
                })
            }
        }
    }),
    angular.module("acornApp").directive("utExportDom", ["$parse", function(e) {
        function t(e) {
            if (null != e && 1 == e.nodeType) {
                if ("none" == e.style.display)
                    return void e.parentNode.removeChild(e);
                var n;
                for (n = 0; n < e.attributes.length; n++) {
                    var r = e.attributes[n];
                    r.specified && (r.name.indexOf("ng-") > -1 || r.name.indexOf("ut-") > -1) && e.removeAttribute(r.name)
                }
                for (n = 0; n < e.childNodes.length; n++)
                    t(e.childNodes[n]);
                t(e.nextElementSibling)
            }
        }
        return function(n, r, a) {
            var i = e(a.utExportDom)();
            n.$watch(i.domReadyWatch, function(a) {
                if (a) {
                    var o = e(i.done)
                        , s = r[0].cloneNode(!0);
                    t(s);
                    var c = s.outerHTML;
                    c || (c = angular.element("<div></div>").append(s).html()),
                        o(n, {
                            $html: c
                        })
                }
            })
        }
    }
    ]),
    angular.module("acornApp").directive("utFileSelect", ["$parse", "$http", function(e, t) {
        return void 0 === t.uploadFile && (t.uploadFile = function(e) {
                return t({
                    method: "POST",
                    url: e.url,
                    headers: {
                        "Content-Type": void 0
                    },
                    transformRequest: function() {
                        var t = new FormData;
                        if (null != e.files)
                            for (var n = 0; n < e.files.length; n++)
                                t.append("file" + n, e.files[n]);
                        else
                            t.append("file", e.file);
                        return t
                    }
                })
            }
        ),
            function(t, n, r) {
                "undefined" == typeof FormData && n.wrap('<div class="js-fileapi-wrapper" style="position:relative; overflow:hidden">');
                var a = e(r.utFileSelect);
                n.bind("change", function(e) {
                    var n = FileAPI.getFiles(e);
                    t.$apply(function() {
                        a(t, {
                            $files: n,
                            $event: e
                        })
                    })
                })
            }
    }
    ]),
    angular.module("acornApp").directive("utValidatePostalCode", function() {
        return {
            require: "ngModel",
            link: function(e, t, n, r) {
                function a(e, t) {
                    return "66721" == t ? /^([0-9]{5})(?:[-\s]*([0-9]{4}))?$/.test(e) : "80021" != t || (e = e.trim().toLowerCase(),
                        /^([a-z][0-9][a-z] ?[0-9][a-z][0-9])$/.test(e))
                }
                r.$parsers.unshift(function(t) {
                    var n = e.recipient.country
                        , i = a(t, n);
                    return r.$setValidity("postalCode", i),
                        i ? t : void 0
                }),
                    r.$formatters.unshift(function(e) {
                        if (e)
                            return e.toUpperCase()
                    })
            }
        }
    }),
    angular.module("acornApp").factory("FormHelper", ["$http", "$location", "$timeout", "$log", "TranscriptOrder", "transcriptServerResources", "utTranscriptModal", "utToast", "transcriptConstants", function(e, t, n, r, a, i, o, s, c) {
        function l(e) {
            var t = e.getDate()
                , n = e.getMonth() + 1
                , r = e.getFullYear();
            return t < 10 && (t = "0" + t),
            n < 10 && (n = "0" + n),
            r + "-" + n + "-" + t
        }
        function u(e) {
            return e < 10 ? "0" + e : e
        }
        function d(e) {
            var t = {
                1: 31,
                2: 28,
                3: 31,
                4: 30,
                5: 31,
                6: 30,
                7: 31,
                8: 31,
                9: 30,
                10: 31,
                11: 30,
                12: 31
            }
                , n = e.split("-")
                , r = parseInt(n[0], 10)
                , a = parseInt(n[1], 10)
                , i = parseInt(n[2], 10);
            return 1 == new Date(r,1,29).getMonth() && (t[2] = 29),
            {
                daysInMonth: t,
                day: i,
                month: a,
                year: r,
                dateSplit: n
            }
        }
        function p(e) {
            var t = d(e)
                , n = t.daysInMonth
                , r = t.day
                , a = t.month
                , i = t.year
                , o = t.dateSplit;
            return r - 1 < 1 ? (a - 1 < 1 ? (o[1] = "12",
                o[0] = i - 1) : o[1] = u(a - 1),
                o[2] = n[o[1]]) : o[2] = u(r - 1),
                o.join("-")
        }
        function f(e) {
            var t = d(e)
                , n = t.daysInMonth
                , r = t.day
                , a = t.month
                , i = t.year
                , o = t.dateSplit;
            return r + 1 > n[a] ? (a + 1 > 12 ? (o[1] = "01",
                o[0] = i + 1) : o[1] = u(a + 1),
                o[2] = "01") : o[2] = u(r + 1),
                o.join("-")
        }
        function g(e) {
            if (!e || !e.to || !e.from)
                return !1;
            var t = d(e.from)
                , n = t.daysInMonth
                , r = t.day
                , a = t.month
                , i = t.year
                , o = t.dateSplit;
            r - 7 < 1 ? (a - 1 < 1 ? (o[1] = "12",
                o[0] = i - 1) : o[1] = u(a - 1),
                o[2] = u(n[o[1]] - 7)) : o[2] = u(r - 7);
            var s = o.join("-")
                , c = new Date(e.currentDate.split("T")[0]);
            return c >= new Date(s) && c <= new Date(e.to)
        }
        function m(e) {
            if (e && e.to && e.from)
                return e.toPlusOne = f(e.to),
                    e.fromMinusOne = p(e.from),
                    e
        }
        function h(e) {
            403 == e.status && r.error("Something went wrong, please try again or reload the page")
        }
        function v(e) {
            e.wrap("<form>").closest("form").get(0).reset(),
                e.unwrap()
        }
        function C(e) {
            e.file = null,
                e.trackingFormName = null,
                e.fileUUID = null,
                e.invalidFile = null,
                v($(event.target).parent().parent().find("input"))
        }
        function y(e) {
            "number" != typeof e && alert("Number of copies invalid.")
        }
        function A() {
            T.transcriptOrder.recipients[T.transcriptOrder.recipients.length - 1].disabled = !1
        }
        function E(e) {
            i.gradPrintDates({}, function(t) {
                204 == t.status ? e.gradPrintDates = null : e.gradPrintDates = t.value,
                    e.loadingGradDates = !1
            }, function() {
                e.loadingGradDates = !1,
                    e.gradDateFailedToLoad = "Failed to load graduation dates."
            }),
                i.canRequestGraduateOnly({}, function(t) {
                    1 == t.value && (e.graduateOptions = !0)
                }, function() {})
        }
        var T, S = function(e) {
            i.provinces({}, function(t) {
                e.provinces = t
            }, function() {
                r.error("Provinces: failed to be retreived.")
            })
        }, w = function(e) {
            i.countries({}, function(t) {
                e.countries = t
            }, function() {
                r.error("Countries: failed to be retreived.")
            })
        }, b = function(e) {
            i.institutions({}, function(t) {
                e.institutions = t
            }, function() {
                r.error("Institutions: failed to be retreived.")
            })
        }, _ = function(e) {
            if (!e || !e.to || !e.from)
                return !1;
            var t = e.currentDate.split("T")[0]
                , n = new Date(t);
            return e.newDateFrom = new Date(e.from),
                e.newDateTo = new Date(e.to),
            n >= e.newDateFrom && n <= e.newDateTo
        }, D = function(e) {
            if (!e || !e.to || !e.from)
                return !1;
            var t = e.currentDate.split("T");
            if (p(e.from) == t[0]) {
                var n = t[1].split(".")
                    , r = n[0].split(":")
                    , a = parseInt(r[0], 10)
                    , i = parseInt(r[1], 10)
                    , o = parseInt(r[2], 10);
                if (a >= 15 && i >= 0 && o >= 0)
                    return !0
            }
            return !1
        }, I = function(e) {
            i.holidayClosure({}, function(t) {
                a.setServerTime(t.currentDate),
                t && t.to && t.from && (e.holidayClosure = t,
                    e.holidayClosure = m(e.holidayClosure),
                    e.currentlyHoliday = _(e.holidayClosure),
                    e.courierOTWarning = D(e.holidayClosure))
            }, function(e) {
                r.error(e)
            })
        }, N = function(e) {
            i.holidayClosure({}, function(t) {
                a.setServerTime(t.currentDate),
                t && t.to && t.from && (e.holidayClosure = t,
                    e.holidayClosure = m(e.holidayClosure),
                    e.almostHolidaysWarning = g(e.holidayClosure))
            }, function(e) {
                r.error(e)
            })
        }, O = function(e) {
            var t = {};
            for (var n in e)
                t[n] = e[n];
            return t
        }, R = function(e, t) {
            T[e].submit = !1;
            var n = T[t].recipients;
            void 0 === n && (n = T[t]);
            for (var r = !1, a = n.length, i = 0; i < a; i++)
                3 == n[i].deliveryMethod && (void 0 !== n[i].recipientName && n[i].recipientName.length > 35 || void 0 !== n[i].recipientInfo1 && n[i].recipientInfo1.length > 35 || void 0 !== n[i].recipientInfo2 && n[i].recipientInfo2.length > 35 || void 0 !== n[i].street && n[i].street.length > 26) && (r = !0);
            return !T[e].$invalid && !r || (T[e].submit = !0,
                    !1)
        }, P = function(e) {
            var t = {};
            for (var n in e)
                "$$hashKey" != n && "deliveryMethod" != n && "pickupMethod" != n && "printDateOption" != n && "courierStatus" != n && "recipientType" != n && "file" != n && "fileUpload" != n && "fileUUID" != n && "poBoxFound" != n && "poBoxFoundOn" != n && "disabled" != n && "recipientAddress" != n && "locationDescription" != n && "checkedByDiv" != n && "checked" != n && "grandTotal" != n && "printDateText" != n && "formattedAmount" != n && "dateProducedText" != n && "notifyChange" != n && "detailShow" != n && "institutionInfo" != n && "immediatelyTooLateToOrder" != n && "courierInvalidTime" != n && "errorMsg" != n && ("printEvent" === n && "Future date" === e[n] || "printEvent" === n && "After my graduation ceremony" === e[n] || ("province" !== n || null != e[n] && 0 != e[n].length ? null == e[n] || 0 == e[n].length || ("postalCode" === n ? e[n] && (t[n] = e[n].trim().toUpperCase()) : t[n] = e[n]) : t[n] = ""));
            return t
        }, L = function(e, n, a, l, u) {
            var d = e[n].fileUUID;
            o.show();
            var p = function(e, n) {
                o.hide();
                var r = T.transcriptOrder.recipients[n];
                r.sequenceNo = e.value,
                    null !== a ? t.path(a) : (r.disabled = !0,
                        T.addRecipient())
            }
                , f = function(e, t) {
                if (r.error(h),
                        r.error("Error was detected order #", t),
                        r.error(e),
                        o.hide(),
                    e && 400 === e.status) {
                    var n = e.data.value;
                    n === c.SERVER_POSTAL_ERROR && (n = c.POSTAL_ERROR_REVISED),
                        s.show({
                            text: n,
                            errorState: !0
                        })
                }
            }
                , g = void 0 == l ? p : l
                , m = void 0 == u ? f : u
                , h = P(e[n]);
            void 0 == d ? function(e) {
                i.saveOrUpdateTranscript(h, function(t) {
                    g(t, e)
                }, function(t) {
                    m(t, e)
                })
            }(n) : function(e) {
                i.saveOrUpdateTranscriptWithFile({
                    fileId: d,
                    isFileUpdated: !0
                }, h, function(t) {
                    g(t, e)
                }, function(t) {
                    m(t, e)
                })
            }(n)
        }, M = function(t, n) {
            if (null !== n && n.length > 0) {
                var a = n[0];
                if (t.fileUUID = null,
                        t.file = null,
                    a.type.indexOf("pdf") === -1 && a.type.indexOf("image") === -1)
                    return void (t.invalidFile = "Only pdf or image files are allowed.");
                if (a.size > 1048576)
                    return void (t.invalidFile = "File size should be less than 1 MB.");
                t.invalidFile = null;
                var i = "undefined" == typeof testBaseUrl ? "" : testBaseUrl;
                i = i.replace("\\:", ":"),
                    e.uploadFile({
                        url: i + "/sws/rest/tc/upload",
                        file: a
                    }).then(function(e) {
                        t.fileUUID = e.data,
                            t.file = a.name,
                        T.$$phase || T.$apply()
                    }, function(e) {
                        alert("File failed to upload. Please try again"),
                            r.error(e)
                    })
            }
        }, k = function(e) {
            e.notifyChange = !0
        }, F = function(e) {
            T.courierOTWarning && (U(e),
                e.immediatelyTooLateToOrder = !0)
        }, x = function(e) {
            T.courierOTWarning && (e.courierInvalidTime = !0)
        }, U = function(e) {
            return e.deliveryMethod = "",
                e.mailOption = "",
                e.location = "",
                e.delivery = void 0,
                e.phone = "",
                e.courierCost = 0,
                e
        }, G = function(e) {
            e = U(e);
            var t = e.institutionInfo;
            e.recipientId = T.institutions.indexOf(e.institutionInfo),
                e.recipientName = t.recipientInfo1,
                e.recipientInfo1 = t.recipientInfo2,
                e.recipientInfo2 = t.street,
                e.city = t.city,
                e.province = t.province,
                e.country = t.country,
                e.postalCode = t.postalCode,
                e.phone = null
        }, j = function(e, t) {
            e.institutionInfo = T.institutions[e.recipientId];
            var n = O(e);
            n.disabled = !1,
                T.currentEditTarget = t,
                T.transcriptToEdit = [n],
                $("#" + T.originalForm).hide()
        }, V = function(e) {
            T.$broadcast("AUTO_FILL_FIX", "Start"),
                n(function() {
                    T.saveCurrentState(),
                        R(T.popupForm, "transcriptToEdit") ? L(T.transcriptToEdit, 0, null, function(t) {
                            e.sequenceNo = t.value,
                                T.transcriptOrder.recipients[T.currentEditTarget] = e,
                                T.transcriptOrder.recipients[T.currentEditTarget].disabled = !0,
                                T.cancelEdit()
                        }, function(e) {
                            void 0 == e.data.value ? alert("Failed to save.  Please try again.") : alert("Failed to save. " + e.data.value),
                                r.error(e)
                        }) : void 0 == T.originalForm || "" == T.originalForm ? T[T.popupForm].submit = !0 : T[T.originalForm].submit = !0
                }, 100)
        }, H = function() {
            void 0 !== T.originalForm ? (T[T.originalForm].submit = !1,
                $("#" + T.originalForm).show()) : T[T.popupForm].submit = !1,
                T.transcriptToEdit = []
        }, W = function(e) {
            if (void 0 != e && "" != e) {
                var t = ["", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
                    , n = e.split("-");
                return t[parseInt(n[1], 10)] + " " + parseInt(n[2], 10) + ", " + n[0]
            }
        }, B = function(e, t) {
            if (3 == e.deliveryMethod && !t.country.$invalid && !t.province.$invalid) {
                var n = {
                    countryCode: e.country,
                    provinceCode: e.province
                };
                i.courierCost(n, function(t) {
                    e.courierCost = t.value
                }, function(t) {
                    r.log(t),
                        e.errorMsg = void 0 == e.errorMsg ? {} : e.errorMsg,
                        e.errorMsg.general = t.value,
                        h(t)
                })
            }
        };
        return {
            initialize: function(e, t, n) {
                T = e,
                    T.popupForm = t,
                    T.originalForm = n,
                    T.removeFile = C,
                    T.selectFile = M,
                    T.selectInst = G,
                    T.editTranscript = j,
                    T.saveEdit = V,
                    T.cancelEdit = H,
                    T.dateFormatter = W,
                    T.serverTimeOutError = h,
                    T.numberValid = y,
                    T.dateRepairForDisplay = l,
                    T.checkIfCourierSelected = F,
                    T.immediatelyNotAllowed = x,
                    T.notifyChanges = k,
                    T.removeDisableOnLastElement = A,
                    T.currentEditTarget = 0,
                    T.flashCount = 0,
                    T.currentlyHoliday = !1,
                    T.holidayClosure = !1,
                    T.graduateOptions = !1,
                    T.loadingGradDates = "Loading...",
                    T.provinces = {},
                    T.countries = {},
                    T.institutions = {},
                    T.courierOTWarning = !1,
                    T.getQuote = B,
                    I(T),
                    E(T),
                    S(T),
                    w(T),
                    b(T)
            },
            validateForm: function(e, t) {
                return R(e, t)
            },
            saveToServer: function(e, t, n) {
                L(e, t, n)
            },
            prepareRequest: function(e) {
                return P(e)
            },
            dateFormatter: W,
            checkHolidaySoon: N
        }
    }
    ]),
    angular.module("acornApp").factory("HistoryHelper", ["$q", "transcriptServerResources", function(e, t) {
        var n = !1
            , r = function() {
            var n = e.defer();
            return t.gradPrintDates({}, function(e) {
                n.resolve(e.value)
            }, function() {}),
                n.promise
        }
            , a = function(e, t) {
            var n = -1;
            for (var r in e)
                e[r].date === t.dateRequested && (n = r);
            n >= 0 ? (t.printEvent = "After my graduation ceremony",
                t.printDateOption = "2-" + n,
                t.printDateText = "Print after graduation <br>" + t.dateRequested) : t.printDateText = "Print on " + t.dateRequested
        }
            , i = function(e) {
            if (void 0 !== e.recipientAddress && e.recipientAddress.indexOf("\n") !== -1) {
                for (var t = e.recipientAddress.split("\n"), n = t.length, r = "", a = 0; a < n; a++)
                    0 == a && e.recipientName.length > 0 ? (r += "<b>",
                        r += t[a],
                        r += "</b><br>") : r += t[a] + "<br>";
                e.recipientAddress = r
            }
        };
        return {
            processTextForDisplay: function(e) {
                r().then(function(t) {
                    e.forEach(function(e) {
                        a(t, e),
                            i(e)
                    })
                })
            },
            getHistory: function() {
                return n
            },
            cacheHistory: function(e) {
                n = e
            },
            clearCacheHistory: function() {
                n = !1
            }
        }
    }
    ]),
    angular.module("acornApp").factory("TranscriptOrder", ["$rootScope", "transcriptConfig", function(e, t) {
        function n(e) {
            return {
                recipients: [{}]
            }
        }
        var r, a = "";
        return void 0 === r ? r = n(r) : void 0 == r.recipients && (r = n(r)),
        {
            get: function() {
                return r
            },
            clear: function() {
                r = n(r)
            },
            fixStyles: function() {},
            orderStarted: function() {},
            saveCurrentState: function() {},
            getPrice: function(e) {
                function n() {
                    return !(null == s || "" == s)
                }
                function r() {
                    return i < l && o < l || i < l && (null == e.dateUpdated || "" == e.dateUpdated)
                }
                angular.isDefined(e) && !function(e) {
                    if (e)
                        return "" == e.dateEntered || null == e.dateEntered
                }(e) || (e = {
                    dateEntered: a,
                    dateUpdated: a
                });
                var i = new Date(e.dateEntered)
                    , o = new Date(e.dateUpdated)
                    , s = e.paymentMethod
                    , c = t.priceBeforeMay1st2014
                    , l = new Date(t.dateFrom10to12);
                return r() && n() ? c : !r() || n() || function() {
                    return !(a < l)
                }() ? t.price : c
            },
            setServerTime: function(t) {
                a = new Date(t.split("T")[0]),
                    e.$broadcast("DASHBOARD_SERVERTIME_READY", a)
            }
        }
    }
    ]),
    angular.module("acornApp").factory("transcriptServerResources", ["$resource", function(e) {
        return e(("undefined" == typeof testBaseUrl ? "" : testBaseUrl) + "/sws/rest/tc/:dataType", {}, {
            validateAddressForCourier: {
                method: "POST",
                params: {
                    dataType: "validateAddressForCourier"
                }
            },
            saveOrUpdateTranscript: {
                method: "POST",
                params: {
                    dataType: "saveOrUpdateTranscript"
                }
            },
            saveOrUpdateTranscriptWithFile: {
                method: "POST",
                params: {
                    dataType: "saveOrUpdateTranscript",
                    fileId: "@Id",
                    isFileUpdated: "@isUpdated"
                }
            },
            monerisPayPostParams: {
                method: "POST",
                params: {
                    dataType: "monerisPayPostParams",
                    email: "@email"
                }
            },
            payWithStudentAccount: {
                method: "POST",
                params: {
                    dataType: "payWithStudentAccount"
                }
            },
            deleteTranscript: {
                method: "POST",
                params: {
                    dataType: "deleteTranscript"
                }
            },
            studentInfo: {
                method: "GET",
                params: {
                    dataType: "studentInfo"
                }
            },
            gradPrintDates: {
                method: "GET",
                params: {
                    dataType: "gradPrintDates"
                }
            },
            cancelInvoice: {
                method: "GET",
                params: {
                    dataType: "cancelInvoice"
                }
            },
            receipt: {
                method: "GET",
                params: {
                    dataType: "receipt"
                }
            },
            canRequestGraduateOnly: {
                method: "GET",
                params: {
                    dataType: "canRequestGraduateOnly"
                }
            },
            canPayWithStudentAccount: {
                method: "GET",
                params: {
                    dataType: "canPayWithStudentAccount"
                }
            },
            holidayClosure: {
                method: "GET",
                params: {
                    dataType: "holidayClosure"
                }
            },
            courierCost: {
                method: "GET",
                params: {
                    dataType: "courierCost"
                }
            },
            takesLonger: {
                method: "GET",
                params: {
                    dataType: "takesLonger"
                }
            },
            countries: {
                method: "GET",
                params: {
                    dataType: "countries"
                },
                isArray: !0
            },
            provinces: {
                method: "GET",
                params: {
                    dataType: "provinces"
                }
            },
            transcriptHold: {
                method: "GET",
                params: {
                    dataType: "transcriptHold"
                }
            },
            transcriptHistoryFull: {
                method: "GET",
                params: {
                    dataType: "transcriptHistory",
                    limit: 0
                },
                isArray: !0
            },
            transcriptHistory: {
                method: "GET",
                params: {
                    dataType: "transcriptHistory",
                    limit: 3
                },
                isArray: !0
            },
            institutions: {
                method: "GET",
                params: {
                    dataType: "institutions"
                },
                isArray: !0
            },
            emailReceipt: {
                method: "POST",
                params: {
                    dataType: "emailReceipt",
                    email: "@email",
                    paymentType: "@paymentType"
                }
            },
            downloadPDF: {
                method: "POST",
                params: {
                    dataType: "downloadPDF"
                },
                responseType: "arraybuffer",
                isArray: !1,
                transformResponse: function(e) {
                    return {
                        data: e
                    }
                }
            }
        })
    }
    ]),
    angular.module("acornApp").factory("utBlockNav", function() {
        var e = "WARNING: You have unsaved changes.  Those changes will be lost if you leave this page."
            , t = function(t, n, r) {
            return t[n].$dirty || t[r].orderStarted ? e : ""
        }
            , n = function(e, t) {
            if (e.length > 0) {
                if (!(/Firefox[\/\s](\d+)/.test(navigator.userAgent) && new Number(RegExp.$1) >= 4)) {
                    var n = t || window.event;
                    return n && (n.returnValue = e),
                        e
                }
                confirm(e + "\n\nAre you sure you want to reload this page.") ? window.history.go() : window.setTimeout(function() {
                    window.stop()
                }, 1)
            }
        }
            , r = function() {
            navigator.appName.indexOf("Internet Explorer") != -1 && $('a[href^="javascript:"]').hover(function() {
                $(window).data("beforeunload", window.onbeforeunload),
                    window.onbeforeunload = null
            }, function() {
                window.onbeforeunload = $(window).data("beforeunload")
            })
        };
        return {
            formBased: function(e, a, i) {
                window.onbeforeunload = function(r) {
                    var o = t(e, a, i);
                    return n(o, r)
                }
                    ,
                    r()
            },
            generalBlock: function(t) {
                t = void 0 === t ? e : t,
                    window.onbeforeunload = function(e) {
                        return n(t, e)
                    }
            },
            remove: function() {
                window.onbeforeunload = ""
            }
        }
    }),
    angular.module("acornApp").factory("utCacheBreaker", function() {
        var e = Math.round((new Date).getTime() / 1e3)
            , t = function() {
            var e = navigator.userAgent.toLowerCase();
            return e.indexOf("msie") != -1 && parseInt(e.split("msie")[1])
        }();
        return {
            get: function() {
                return "?cb=" + e
            },
            freshCall: function() {
                return Math.round((new Date).getTime() / 1e3)
            },
            ieCB: function() {
                return t ? {
                    cb: Math.round((new Date).getTime() / 1e3)
                } : {}
            }
        }
    }),
    angular.module("acornApp").factory("utTranscriptModal", ["$uibModal", function(e) {
        var t = null;
        return {
            show: function() {
                t = e.open({
                    animation: !0,
                    templateUrl: "partials/transcript/modal/loading.html",
                    backdrop: "static",
                    windowClass: "modal-lg-acorn"
                })
            },
            hide: function() {
                t && (t.dismiss(),
                    t = null)
            }
        }
    }
    ]),
    function(e) {
        var t, n = e.HTMLCanvasElement && e.HTMLCanvasElement.prototype;
        if (t = e.Blob)
            try {
                t = Boolean(new Blob)
            } catch (e) {
                t = !1
            }
        var r = t;
        if ((t = r) && (t = e.Uint8Array))
            try {
                t = 100 === new Blob([new Uint8Array(100)]).size
            } catch (e) {
                t = !1
            }
        var a = t
            , i = e.BlobBuilder || e.WebKitBlobBuilder || e.MozBlobBuilder || e.MSBlobBuilder
            , o = (r || i) && e.atob && e.ArrayBuffer && e.Uint8Array && function(e) {
                    var t, n, o, s;
                    for (t = 0 <= e.split(",")[0].indexOf("base64") ? atob(e.split(",")[1]) : decodeURIComponent(e.split(",")[1]),
                             n = new ArrayBuffer(t.length),
                             o = new Uint8Array(n),
                             s = 0; s < t.length; s += 1)
                        o[s] = t.charCodeAt(s);
                    return e = e.split(",")[0].split(":")[1].split(";")[0],
                        r ? new Blob([a ? o : n],{
                            type: e
                        }) : (o = new i,
                            o.append(n),
                            o.getBlob(e))
                }
            ;
        e.HTMLCanvasElement && !n.toBlob && (n.mozGetAsFile ? n.toBlob = function(e, t) {
            e(this.mozGetAsFile("blob", t))
        }
            : n.toDataURL && o && (n.toBlob = function(e, t) {
                e(o(this.toDataURL(t)))
            }
        )),
            "function" == typeof define && define.amd ? define(function() {
                return o
            }) : e.dataURLtoBlob = o
    }(this),
    function(e, t) {
        function n(e, t, n) {
            if (e)
                if (u(e))
                    for (var r = 0, a = e.length; r < a; r++)
                        r in e && t.call(n, e[r], r, e);
                else
                    for (r in e)
                        e.hasOwnProperty(r) && t.call(n, e[r], r, e)
        }
        function r(e, t, r) {
            if (e) {
                var a = $.uid(e);
                k[a] || (k[a] = {}),
                    n(t.split(/\s+/), function(t) {
                        E ? E.event.add(e, t, r) : (k[a][t] || (k[a][t] = []),
                            k[a][t].push(r),
                            e.addEventListener ? e.addEventListener(t, r, !1) : e.attachEvent ? e.attachEvent("on" + t, r) : e["on" + t] = r)
                    })
            }
        }
        function a(e, t, r) {
            if (e) {
                var a = $.uid(e)
                    , i = k[a] || {};
                n(t.split(/\s+/), function(t) {
                    if (E)
                        E.event.remove(e, t, r);
                    else {
                        for (var n = i[t] || [], a = n.length; a--; )
                            if (n[a] === r) {
                                n.splice(a, 1);
                                break
                            }
                        e.addEventListener ? e.removeEventListener(t, r, !1) : e.detachEvent ? e.detachEvent("on" + t, r) : e["on" + t] = null
                    }
                })
            }
        }
        function i(e, t, n) {
            r(e, t, function r(i) {
                a(e, t, r),
                    n(i)
            })
        }
        function o(e, t, n, r, a) {
            e = {
                type: n.type || n,
                target: e,
                result: r
            },
                $.extend(e, a),
                t(e)
        }
        function s(e, n, i, s) {
            if ($.isFile(e) && C && C.prototype["readAs" + i]) {
                var c = new C;
                r(c, x, function t(r) {
                    var i = r.type;
                    "progress" == i ? o(e, n, r, r.target.result, {
                        loaded: r.loaded,
                        total: r.total
                    }) : "loadend" == i ? (a(c, x, t),
                        c = null) : o(e, n, r, r.target.result)
                });
                try {
                    s ? c["readAs" + i](s, e) : c["readAs" + i](e)
                } catch (r) {
                    o(e, n, "error", t, {
                        error: r.toString()
                    })
                }
            } else
                o(e, n, "error", t, {
                    error: "filreader_not_support_" + i
                })
        }
        function c(e) {
            var t;
            return e.getAsEntry ? t = e.getAsEntry() : e.webkitGetAsEntry && (t = e.webkitGetAsEntry()),
                t
        }
        function l(e, t) {
            if (e)
                if (e.isFile)
                    e.file(function(e) {
                        t(!1, [e])
                    }, function() {
                        t("entry_file")
                    });
                else if (e.isDirectory) {
                    var n = [];
                    e.createReader().readEntries(function(e) {
                        $.afor(e, function(e, r) {
                            l(r, function(r, a) {
                                r || (n = n.concat(a)),
                                    e ? e() : t(!1, n)
                            })
                        })
                    }, function() {
                        t("directory_reader")
                    })
                } else
                    l(c(e), t);
            else
                t("empty_entry")
        }
        function u(e) {
            return "object" == typeof e && e && "length"in e
        }
        function d(t) {
            return t.target || (t.target = e.event && e.event.srcElement || S),
            3 === t.target.nodeType && (t.target = event.target.parentNode),
                t
        }
        var p = 1
            , f = function() {}
            , g = navigator.userAgent
            , m = e.createObjectURL && e || e.URL && URL.revokeObjectURL && URL || e.webkitURL && webkitURL
            , h = e.Blob
            , v = e.File
            , C = e.FileReader
            , y = e.FormData
            , A = e.XMLHttpRequest
            , E = e.jQuery
            , T = !(!v || !C || !e.Uint8Array && !y && !A.prototype.sendAsBinary || /safari\//i.test(g) && !/chrome\//i.test(g) && /windows/i.test(g))
            , g = T && "withCredentials"in new A
            , h = T && !!h && !(!h.prototype.webkitSlice && !h.prototype.mozSlice && !h.prototype.slice)
            , S = e.document
            , w = e.dataURLtoBlob
            , b = /img/i
            , _ = /canvas/i
            , D = /img|canvas/
            , I = /input/i
            , N = Math.pow
            , O = Math.round
            , R = Number
            , y = function(e) {
            return O(e * this)
        }
            , P = new R(1024)
            , L = new R(N(P, 2))
            , M = new R(N(P, 3))
            , N = new R(N(P, 4))
            , k = {}
            , F = []
            , x = "abort progress error load loadend"
            , U = "status statusText readyState response responseXML responseText responseBody".split(" ")
            , $ = {
            version: "1.2.5",
            cors: !1,
            html5: !0,
            debug: !1,
            pingUrl: !1,
            withCredentials: !0,
            staticPath: "./",
            flashUrl: 0,
            flashImageUrl: 0,
            accept: {
                "image/*": "art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd",
                "audio/*": "m4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs",
                "video/*": "m4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl"
            },
            chunkSize: 0,
            chunkUploadRetry: 0,
            chunkNetworkDownRetryTimeout: 2e3,
            KB: (P.from = y,
                P),
            MB: (L.from = y,
                L),
            GB: (M.from = y,
                M),
            TB: (N.from = y,
                N),
            expando: "fileapi" + (new Date).getTime(),
            uid: function(e) {
                return e ? e[$.expando] = e[$.expando] || $.uid() : (++p,
                $.expando + p)
            },
            log: function() {
                $.debug && e.console && console.log && (console.log.apply ? console.log.apply(console, arguments) : console.log([].join.call(arguments, " ")))
            },
            getXHR: function() {
                var t;
                if (A)
                    t = new A;
                else if (e.ActiveXObject)
                    try {
                        t = new ActiveXObject("MSXML2.XMLHttp.3.0")
                    } catch (e) {
                        t = new ActiveXObject("Microsoft.XMLHTTP")
                    }
                return t
            },
            isArray: u,
            support: {
                dnd: g && "ondrop"in S.createElement("div"),
                cors: g,
                html5: T,
                chunked: h,
                dataURI: !0
            },
            event: {
                on: r,
                off: a,
                one: i,
                fix: d
            },
            throttle: function(t, n) {
                var r, a;
                return function() {
                    a = arguments,
                    r || (t.apply(e, a),
                        r = setTimeout(function() {
                            r = 0,
                                t.apply(e, a)
                        }, n))
                }
            },
            F: function() {},
            parseJSON: function(t) {
                return e.JSON && JSON.parse ? JSON.parse(t) : new Function("return (" + t.replace(/([\r\n])/g, "\\$1") + ");")()
            },
            trim: function(e) {
                return e = String(e),
                    e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
            },
            defer: function() {
                var e, n, r = [], a = {
                    resolve: function(t, i) {
                        for (a.resolve = f,
                                 n = t || !1,
                                 e = i; i = r.shift(); )
                            i(n, e)
                    },
                    then: function(a) {
                        n !== t ? a(n, e) : r.push(a)
                    }
                };
                return a
            },
            queue: function(e) {
                var t = 0
                    , n = 0
                    , r = !1
                    , a = !1
                    , i = {
                    inc: function() {
                        n++
                    },
                    next: function() {
                        t++,
                            setTimeout(i.check, 0)
                    },
                    check: function() {
                        t >= n && !r && i.end()
                    },
                    isFail: function() {
                        return r
                    },
                    fail: function() {
                        !r && e(r = !0)
                    },
                    end: function() {
                        a || (a = !0,
                            e())
                    }
                };
                return i
            },
            each: n,
            afor: function(e, t) {
                var n = 0
                    , r = e.length;
                u(e) && r-- ? function a() {
                    t(r != n && a, e[n], n++)
                }() : t(!1)
            },
            extend: function(e) {
                return n(arguments, function(t) {
                    n(t, function(t, n) {
                        e[n] = t
                    })
                }),
                    e
            },
            isFile: function(e) {
                return T && e && e instanceof v
            },
            isCanvas: function(e) {
                return e && _.test(e.nodeName)
            },
            getFilesFilter: function(e) {
                return (e = "string" == typeof e ? e : e.getAttribute && e.getAttribute("accept") || "") ? RegExp("(" + e.replace(/\./g, "\\.").replace(/,/g, "|") + ")$", "i") : /./
            },
            readAsDataURL: function(e, t) {
                $.isCanvas(e) ? o(e, t, "load", $.toDataURL(e)) : s(e, t, "DataURL")
            },
            readAsBinaryString: function(e, t) {
                C && C.prototype.readAsBinaryString ? s(e, t, "BinaryString") : s(e, function(e) {
                    if ("load" == e.type)
                        try {
                            e.result = $.toBinaryString(e.result)
                        } catch (t) {
                            e.type = "error",
                                e.message = t.toString()
                        }
                    t(e)
                }, "DataURL")
            },
            readAsArrayBuffer: function(e, t) {
                s(e, t, "ArrayBuffer")
            },
            readAsText: function(e, t, n) {
                n || (n = t,
                    t = "utf-8"),
                    s(e, n, "Text", t)
            },
            toDataURL: function(e) {
                return "string" == typeof e ? e : e.toDataURL ? e.toDataURL("image/png") : void 0
            },
            toBinaryString: function(t) {
                return e.atob($.toDataURL(t).replace(/^data:[^,]+,/, ""))
            },
            readAsImage: function(e, n, r) {
                if ($.isFile(e))
                    if (m) {
                        var s = m.createObjectURL(e);
                        s === t ? o(e, n, "error") : $.readAsImage(s, n, r)
                    } else
                        $.readAsDataURL(e, function(t) {
                            "load" == t.type ? $.readAsImage(t.result, n, r) : (r || "error" == t.type) && o(e, n, t, null, {
                                loaded: t.loaded,
                                total: t.total
                            })
                        });
                else
                    $.isCanvas(e) ? o(e, n, "load", e) : b.test(e.nodeName) ? e.complete ? o(e, n, "load", e) : i(e, "error abort load", function t(r) {
                        "load" == r.type && m && m.revokeObjectURL(e.src),
                            a(e, "error abort load", t),
                            o(e, n, r, e)
                    }) : e.iframe ? o(e, n, {
                        type: "error"
                    }) : (s = new Image,
                        s.src = e.dataURL || e,
                        $.readAsImage(s, n, r))
            },
            checkFileObj: function(e) {
                var t = {}
                    , r = $.accept;
                return "object" == typeof e ? t = e : t.name = (e + "").split(/\\|\//g).pop(),
                null == t.type && (t.type = t.name.split(".").pop()),
                    n(r, function(e, n) {
                        e = RegExp(e.replace(/\s/g, "|"), "i"),
                        e.test(t.type) && (t.type = n.split("/")[0] + "/" + t.type)
                    }),
                    t
            },
            getDropFiles: function(e, t) {
                var r = []
                    , a = (e.originalEvent || e || "").dataTransfer || {}
                    , o = u(a.items) && a.items[0] && c(a.items[0])
                    , s = $.queue(function() {
                    t(r)
                });
                n((o ? a.items : a.files) || [], function(e) {
                    if (s.inc(),
                            o)
                        l(e, function(e, t) {
                            !e && r.push.apply(r, t),
                                s.next()
                        });
                    else {
                        var t = function(t) {
                            t && r.push(e),
                                s.next()
                        };
                        if (!e.type && 0 == e.size % 4096 && 102400 >= e.size)
                            if (C)
                                try {
                                    var n = new C;
                                    i(n, x, function(e) {
                                        e = "error" != e.type,
                                            t(e),
                                        e && n.abort()
                                    }),
                                        n.readAsDataURL(e)
                                } catch (e) {
                                    t(!1)
                                }
                            else
                                t(null);
                        else
                            t(!0)
                    }
                }),
                    s.check()
            },
            getFiles: function(e, t, n) {
                var r = [];
                return n ? ($.filterFiles($.getFiles(e), t, n),
                    null) : (e.jquery && (e.each(function() {
                    r = r.concat($.getFiles(this))
                }),
                    e = r,
                    r = []),
                "string" == typeof t && (t = $.getFilesFilter(t)),
                    e.originalEvent ? e = d(e.originalEvent) : e.srcElement && (e = d(e)),
                    e.dataTransfer ? e = e.dataTransfer : e.target && (e = e.target),
                    e.files ? r = e.files : !T && I.test(e && e.tagName) ? $.trim(e.value) && (r = [$.checkFileObj(e.value)],
                        r[0].blob = e,
                        r[0].iframe = !0) : u(e) && (r = e),
                    $.filter(r, function(e) {
                        return !t || t.test(e.name)
                    }))
            },
            getInfo: function(e, t) {
                var n = {}
                    , r = F.concat();
                $.isFile(e) ? function a() {
                    var i = r.shift();
                    i ? i.test(e.type) ? i(e, function(e, r) {
                        e ? t(e) : ($.extend(n, r),
                            a())
                    }) : a() : t(!1, n)
                }() : t("not_support", n)
            },
            addInfoReader: function(e, t) {
                t.test = function(t) {
                    return e.test(t)
                }
                    ,
                    F.push(t)
            },
            filter: function(e, t) {
                for (var n, r = [], a = 0, i = e.length; a < i; a++)
                    a in e && (n = e[a],
                    t.call(n, n, a, e) && r.push(n));
                return r
            },
            filterFiles: function(e, t, n) {
                if (e.length) {
                    var r, a = e.concat(), i = [], o = [];
                    !function e() {
                        a.length ? (r = a.shift(),
                            $.getInfo(r, function(n, a) {
                                (t(r, !n && a) ? i : o).push(r),
                                    e()
                            })) : n(i, o)
                    }()
                } else
                    n([], e)
            },
            upload: function(e) {
                e = $.extend({
                    prepare: $.F,
                    beforeupload: $.F,
                    upload: $.F,
                    fileupload: $.F,
                    fileprogress: $.F,
                    filecomplete: $.F,
                    progress: $.F,
                    complete: $.F,
                    pause: $.F,
                    chunkSize: $.chunkSize,
                    chunkUpoloadRetry: $.chunkUploadRetry
                }, e),
                e.imageAutoOrientation && !e.imageTransform && (e.imageTransform = {
                    rotate: "auto"
                });
                var t, r = new $.XHR(e), a = this._getFilesDataArray(e.files), i = 0, o = 0, s = this, c = !1;
                return n(a, function(e) {
                    i += e.size
                }),
                    r.files = [],
                    n(a, function(e) {
                        r.files.push(e.file)
                    }),
                    r.total = i,
                    r.loaded = 0,
                    e.beforeupload(r, e),
                    (t = function t() {
                            var l = a.shift()
                                , u = l && l.file
                                , d = !1
                                , p = {};
                            n(e, function(e, t) {
                                e && "object" == typeof e && (e = $.extend({}, e)),
                                    p[t] = e
                            }),
                            u && u.name === $.expando && (u = null,
                                $.log("[warn] FileAPI.upload()  called without files")),
                                ("abort" != r.statusText || r.current) && l ? (c = !1,
                                (r.currentFile = u) && e.prepare(u, p),
                                    this._getFormData(p, l, function(a) {
                                        o || e.upload(r, e);
                                        var c = new $.XHR($.extend({}, p, {
                                            upload: u ? function() {
                                                e.fileupload(u, c, p)
                                            }
                                                : f,
                                            progress: u ? function(t) {
                                                d || (e.fileprogress({
                                                    type: "progress",
                                                    total: l.total = t.total,
                                                    loaded: l.loaded = t.loaded
                                                }, u, c, p),
                                                    e.progress({
                                                        type: "progress",
                                                        total: i,
                                                        loaded: r.loaded = o + l.size * (t.loaded / t.total) | 0
                                                    }, u, c, p))
                                            }
                                                : f,
                                            complete: function(a) {
                                                d = !0,
                                                    n(U, function(e) {
                                                        r[e] = c[e]
                                                    }),
                                                u && (l.loaded = l.total,
                                                    this.progress(l),
                                                    o += l.size,
                                                    r.loaded = o,
                                                    e.filecomplete(a, c, u, p)),
                                                    t.call(s)
                                            }
                                        }));
                                        r.abort = function(e) {
                                            this.current = e,
                                                c.abort()
                                        }
                                            ,
                                            c.send(a)
                                    })) : (e.complete(200 != r.status && 201 != r.status && (r.statusText || "error"), r, e),
                                    c = !0)
                        }
                    ).call(this),
                    r.append = function(e, o) {
                        e = $._getFilesDataArray([].concat(e)),
                            n(e, function(e) {
                                i += e.size,
                                    r.files.push(e.file),
                                    o ? a.unshift(e) : a.push(e)
                            }),
                        c && t.call(s)
                    }
                    ,
                    r.remove = function(e) {
                        var t = -1;
                        n(a, function(n) {
                            if (t++,
                                n.file == e)
                                return a.splice(t, 1)
                        })
                    }
                    ,
                    r
            },
            _getFilesDataArray: function(e) {
                var t = []
                    , r = {};
                if (I.test(e && e.tagName)) {
                    var a = $.getFiles(e);
                    r[e.name || "file"] = null !== e.getAttribute("multiple") ? a : a[0]
                } else
                    u(e) && I.test(e[0] && e[0].tagName) ? n(e, function(e) {
                        r[e.name || "file"] = $.getFiles(e)
                    }) : r = e;
                return n(r, function e(r, a) {
                    u(r) ? n(r, function(t) {
                        e(t, a)
                    }) : r && r.name && t.push({
                        name: a,
                        file: r,
                        size: r.size,
                        total: r.size,
                        loaded: 0
                    })
                }),
                t.length || t.push({
                    file: {
                        name: $.expando
                    }
                }),
                    t
            },
            _getFormData: function(e, t, r) {
                var a = t.file
                    , i = t.name
                    , o = a.name
                    , s = a.type;
                t = $.support.transform && e.imageTransform;
                var c = new $.Form
                    , l = $.queue(function() {
                    r(c)
                })
                    , u = t && (0 < parseInt(t.maxWidth || t.minWidth || t.width, 10) || t.rotate);
                $.Image && t && (/image/.test(a.type) || D.test(a.nodeType)) ? (l.inc(),
                u && (t = [t]),
                    $.Image.transform(a, t, e.imageAutoOrientation, function(t, r) {
                        u && !t ? (!w && !$.flashEngine && (r[0] = $.toBinaryString(r[0]),
                            c.multipart = !0),
                            c.append(i, r[0], o, s)) : (t || (n(r, function(e, t) {
                            !w && !$.flashEngine && (e = $.toBinaryString(e),
                                c.multipart = !0),
                                c.append(i + "[" + t + "]", e, o, s)
                        }),
                            i += "[original]"),
                        (t || e.imageOriginal) && c.append(i, a, o, s)),
                            l.next()
                    })) : o !== $.expando && c.append(i, a, o),
                    n(e.data, function e(t, r) {
                        "object" == typeof t ? n(t, function(t, n) {
                            e(t, r + "[" + n + "]")
                        }) : c.append(r, t)
                    }),
                    l.check()
            },
            reset: function(e) {
                var t, i;
                return E ? (i = E(e).clone(!0).insertBefore(e).val("")[0],
                    E(e).remove()) : (t = e.parentNode,
                    i = t.insertBefore(e.cloneNode(!0), e),
                    i.value = "",
                    t.removeChild(e),
                    n(k[$.uid(e)], function(t, o) {
                        n(t, function(t) {
                            a(e, o, t),
                                r(i, o, t)
                        })
                    })),
                    i
            },
            load: function(e, t) {
                var n = $.getXHR();
                return n ? (n.open("GET", e, !0),
                n.overrideMimeType && n.overrideMimeType("text/plain; charset=x-user-defined"),
                    r(n, "progress", function(e) {
                        e.lengthComputable && t({
                            type: e.type,
                            loaded: e.loaded,
                            total: e.total
                        }, n)
                    }),
                    n.onreadystatechange = function() {
                        if (4 == n.readyState)
                            if (n.onreadystatechange = null,
                                200 == n.status) {
                                e = e.split("/");
                                var r = {
                                    name: e[e.length - 1],
                                    size: n.getResponseHeader("Content-Length"),
                                    type: n.getResponseHeader("Content-Type")
                                };
                                r.dataURL = "data:" + r.type + ";base64," + $.encode64(n.responseBody || n.responseText),
                                    t({
                                        type: "load",
                                        result: r
                                    })
                            } else
                                t({
                                    type: "error"
                                })
                    }
                    ,
                    n.send(null)) : t({
                    type: "error"
                }),
                    n
            },
            encode64: function(e) {
                var t = ""
                    , n = 0;
                for ("string" != typeof e && (e = String(e)); n < e.length; ) {
                    var r = 255 & e.charCodeAt(n++)
                        , a = 255 & e.charCodeAt(n++)
                        , i = 255 & e.charCodeAt(n++)
                        , o = r >> 2
                        , r = (3 & r) << 4 | a >> 4;
                    isNaN(a) ? a = i = 64 : (a = (15 & a) << 2 | i >> 6,
                        i = isNaN(i) ? 64 : 63 & i),
                        t += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i)
                }
                return t
            }
        };
        $.addInfoReader(/^image/, function(e, t) {
            if (!e.__dimensions) {
                var n = e.__dimensions = $.defer();
                $.readAsImage(e, function(e) {
                    var t = e.target;
                    n.resolve("load" != e.type && "error", {
                        width: t.width,
                        height: t.height
                    })
                })
            }
            e.__dimensions.then(t)
        }),
            $.event.dnd = function(e, t, n) {
                var a, i;
                n || (n = t,
                    t = $.F),
                    C ? (r(e, "dragenter dragleave dragover", function(e) {
                        for (var n = ((e.originalEvent || e || "").dataTransfer || {}).types, r = n && n.length; r--; )
                            ~n[r].indexOf("File") && (e.preventDefault(),
                            i !== e.type && (i = e.type,
                            "dragleave" != i && t.call(e.currentTarget, !0, e),
                                clearTimeout(a),
                                a = setTimeout(function() {
                                    t.call(e.currentTarget, "dragleave" != i, e)
                                }, 50)))
                    }),
                        r(e, "drop", function(e) {
                            e.preventDefault(),
                                i = 0,
                                t.call(e.currentTarget, !1, e),
                                $.getDropFiles(e, function(t) {
                                    n.call(e.currentTarget, t, e)
                                })
                        })) : $.log("Drag'n'Drop -- not supported")
            }
            ,
        E && !E.fn.dnd && (E.fn.dnd = function(e, t) {
                return this.each(function() {
                    $.event.dnd(this, e, t)
                })
            }
        ),
            e.FileAPI = $.extend($, e.FileAPI),
        $.flashUrl || ($.flashUrl = $.staticPath + "scripts/lib/FileAPI/FileAPI.flash.swf"),
        $.flashImageUrl || ($.flashImageUrl = $.staticPath + "scripts/lib/FileAPI/FileAPI.flash.image.swf")
    }(window),
    function(e, t, n) {
        function r(e, t) {
            if (!(this instanceof r))
                return new r(e);
            this.file = e,
                this.better = !t,
                this.matrix = {
                    sx: 0,
                    sy: 0,
                    sw: 0,
                    sh: 0,
                    dx: 0,
                    dy: 0,
                    dw: 0,
                    dh: 0,
                    resize: 0,
                    deg: 0
                }
        }
        var a = Math.min
            , i = Math.round
            , o = !1
            , s = {
            8: 270,
            3: 180,
            6: 90
        };
        try {
            o = -1 < t.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")
        } catch (e) {}
        r.prototype = {
            constructor: r,
            set: function(t) {
                return e.extend(this.matrix, t),
                    this
            },
            crop: function(e, t, r, a) {
                return r === n && (r = e,
                    a = t,
                    e = t = 0),
                    this.set({
                        sx: e,
                        sy: t,
                        sw: r,
                        sh: a || r
                    })
            },
            resize: function(e, t, n) {
                return "string" == typeof t && (n = t,
                    t = e),
                    this.set({
                        dw: e,
                        dh: t,
                        resize: n
                    })
            },
            preview: function(e, t) {
                return this.set({
                    dw: e,
                    dh: t || e,
                    resize: "preview"
                })
            },
            rotate: function(e) {
                return this.set({
                    deg: e
                })
            },
            _load: function(t, n) {
                var r = this;
                e.readAsImage(t, function(e) {
                    n.call(r, "load" != e.type, e.result)
                })
            },
            _apply: function(e, n) {
                var r, a = t.createElement("canvas"), i = this.getMatrix(e), o = a.getContext("2d"), s = i.deg, c = i.dw, l = i.dh, u = e.width, d = e.height, p = e;
                if (this.better)
                    for (; 2 < Math.min(u / c, d / l); )
                        u = ~~(u / 2 + .5),
                            d = ~~(d / 2 + .5),
                            r = t.createElement("canvas"),
                            r.width = u,
                            r.height = d,
                            p !== e ? (r.getContext("2d").drawImage(p, 0, 0, p.width, p.height, 0, 0, u, d),
                                p = r) : (p = r,
                                p.getContext("2d").drawImage(e, i.sx, i.sy, i.sw, i.sh, 0, 0, u, d),
                                i.sx = i.sy = i.sw = i.sh = 0);
                a.width = s % 180 ? l : c,
                    a.height = s % 180 ? c : l,
                    o.rotate(s * Math.PI / 180),
                    o.drawImage(p, i.sx, i.sy, i.sw || p.width, i.sh || p.height, 180 == s || 270 == s ? -c : 0, 90 == s || 180 == s ? -l : 0, c, l),
                    n.call(this, !1, a)
            },
            getMatrix: function(t) {
                var n = e.extend({}, this.matrix)
                    , r = n.sw = n.sw || t.width;
                t = n.sh = n.sh || t.height;
                var o = n.dw = n.dw || n.sw
                    , s = n.dh = n.dh || n.sh
                    , c = r / t
                    , l = o / s
                    , u = n.resize;
                return "preview" == u ? o == r && s == t || (l >= c ? (c = r,
                    u = c / l) : (u = t,
                    c = u * l),
                (c != r || u != t) && (n.sx = ~~((r - c) / 2),
                    n.sy = ~~((t - u) / 2),
                    r = c,
                    t = u)) : u && ("min" == u ? (o = i(c < l ? a(r, o) : s * c),
                    s = i(c < l ? o / c : a(t, s))) : (o = i(c >= l ? a(r, o) : s * c),
                    s = i(c >= l ? o / c : a(t, s)))),
                    n.sw = r,
                    n.sh = t,
                    n.dw = o,
                    n.dh = s,
                    n
            },
            _trans: function(e) {
                this._load(this.file, function(t, n) {
                    t ? e(t) : this._apply(n, e)
                })
            },
            get: function(t) {
                if (e.support.transform) {
                    var n = this;
                    "auto" == n.matrix.deg ? e.getInfo(this.file, function(e, r) {
                        n.matrix.deg = s[r && r.exif && r.exif.Orientation] || 0,
                            n._trans(t)
                    }) : n._trans(t)
                } else
                    t("not_support")
            },
            toData: function(e) {
                this.get(e)
            }
        },
            r.exifOrientation = s,
            r.transform = function(t, a, i, o) {
                e.getInfo(t, function(s, c) {
                    var l = {}
                        , u = e.queue(function(e) {
                        o(e, l)
                    });
                    s ? u.fail() : e.each(a, function(e, a) {
                        if (!u.isFail()) {
                            var o = r(c.nodeType ? c : t);
                            "function" == typeof e ? e(c, o) : e.width ? o[e.preview ? "preview" : "resize"](e.width, e.height, e.type) : e.maxWidth && (c.width > e.maxWidth || c.height > e.maxHeight) && o.resize(e.maxWidth, e.maxHeight, "max"),
                            e.rotate === n && i && (e.rotate = "auto"),
                                o.rotate(e.rotate),
                                u.inc(),
                                o.toData(function(e, t) {
                                    e ? u.fail() : (l[a] = t,
                                        u.next())
                                })
                        }
                    })
                })
            }
            ,
            e.support.canvas = e.support.transform = o,
            e.Image = r
    }(FileAPI, document),
    function(e, t, n) {
        var r = t.encodeURIComponent
            , a = t.FormData;
        t = function() {
            this.items = []
        }
            ,
            t.prototype = {
                append: function(e, t, n, r) {
                    this.items.push({
                        name: e,
                        blob: t && t.blob || (void 0 == t ? "" : t),
                        file: t && (n || t.name),
                        type: t && (r || t.type)
                    })
                },
                each: function(e) {
                    for (var t = 0, n = this.items.length; t < n; t++)
                        e.call(this, this.items[t])
                },
                toData: function(t, n) {
                    n._chunked = e.support.chunked && 0 < n.chunkSize && 1 == e.filter(this.items, function(e) {
                            return e.file
                        }).length,
                        e.support.html5 ? this.multipart || !a ? (e.log("FileAPI.Form.toMultipartData"),
                            this.toMultipartData(t)) : n._chunked ? (e.log("FileAPI.Form.toPlainData"),
                            this.toPlainData(t)) : (e.log("FileAPI.Form.toFormData"),
                            this.toFormData(t)) : (e.log("FileAPI.Form.toHtmlData"),
                            this.toHtmlData(t))
                },
                _to: function(t, n, r, a) {
                    var i = e.queue(function() {
                        n(t)
                    });
                    this.each(function(e) {
                        r(e, t, i, a)
                    }),
                        i.check()
                },
                toHtmlData: function(t) {
                    this._to(n.createDocumentFragment(), t, function(t, r) {
                        var a, i = t.blob;
                        t.file ? (e.reset(i),
                            i.name = t.name,
                            r.appendChild(i)) : (a = n.createElement("input"),
                            a.name = t.name,
                            a.type = "hidden",
                            a.value = i,
                            r.appendChild(a))
                    })
                },
                toPlainData: function(e) {
                    this._to({}, e, function(e, t, n) {
                        e.file && (t.type = e.file),
                            e.blob.toBlob ? (n.inc(),
                                e.blob.toBlob(function(r) {
                                    t.name = e.name,
                                        t.file = r,
                                        t.size = r.length,
                                        t.type = e.type,
                                        n.next()
                                }, "image/png")) : e.file ? (t.name = e.blob.name,
                                t.file = e.blob,
                                t.size = e.blob.size,
                                t.type = e.type) : (t.params || (t.params = []),
                                t.params.push(encodeURIComponent(e.name) + "=" + encodeURIComponent(e.blob))),
                            t.start = -1,
                            t.end = t.file.FileAPIReadPosition || -1,
                            t.retry = 0
                    })
                },
                toFormData: function(e) {
                    this._to(new a, e, function(e, t, n) {
                        e.file && t.append("_" + e.name, e.file),
                            e.blob && e.blob.toBlob ? (n.inc(),
                                e.blob.toBlob(function(r) {
                                    t.append(e.name, r, e.file),
                                        n.next()
                                }, "image/png")) : e.file ? t.append(e.name, e.blob, e.file) : t.append(e.name, e.blob)
                    })
                },
                toMultipartData: function(t) {
                    this._to([], t, function(t, n, a, i) {
                        var o = !!t.file
                            , s = t.blob
                            , c = function(e) {
                            n.push("--_" + i + '\r\nContent-Disposition: form-data; name="' + t.name + '"' + (o ? '; filename="' + r(t.file) + '"' : "") + (o ? "\r\nContent-Type: " + (t.type || "application/octet-stream") : "") + "\r\n\r\n" + (o ? e : r(e)) + "\r\n"),
                                a.next()
                        };
                        a.inc(),
                            e.isFile(s) ? e.readAsBinaryString(s, function(e) {
                                "load" == e.type && c(e.result)
                            }) : c(s)
                    }, e.expando)
                }
            },
            e.Form = t
    }(FileAPI, window, document),
    function(e, t) {
        var n = function() {}
            , r = function(e) {
            this.uid = t.uid(),
                this.xhr = {
                    abort: n,
                    getResponseHeader: n,
                    getAllResponseHeaders: n
                },
                this.options = e
        };
        r.prototype = {
            status: 0,
            statusText: "",
            getResponseHeader: function(e) {
                return this.xhr.getResponseHeader(e)
            },
            getAllResponseHeaders: function() {
                return this.xhr.getAllResponseHeaders() || {}
            },
            end: function(r, a) {
                var i = this
                    , o = i.options;
                i.end = i.abort = n,
                    i.status = r,
                a && (i.statusText = a),
                    t.log("xhr.end:", r, a),
                    o.complete(200 != r && 201 != r && (i.statusText || "unknown"), i),
                i.xhr && i.xhr.node && setTimeout(function() {
                    var t = i.xhr.node;
                    try {
                        t.parentNode.removeChild(t)
                    } catch (e) {}
                    try {
                        delete e[i.uid]
                    } catch (e) {}
                    e[i.uid] = i.xhr.node = null
                }, 9)
            },
            abort: function() {
                this.end(0, "abort"),
                this.xhr && (this.xhr.aborted = !0,
                    this.xhr.abort())
            },
            send: function(e) {
                var t = this
                    , n = this.options;
                e.toData(function(e) {
                    n.upload(n, t),
                        t._send.call(t, n, e)
                }, n)
            },
            _send: function(n, r) {
                var a, i = this, o = i.uid, s = n.url;
                t.log("XHR._send:", r),
                    s += (~s.indexOf("?") ? "&" : "?") + t.uid(),
                    r.nodeName ? (n.upload(n, i),
                        a = document.createElement("div"),
                        a.innerHTML = '<form target="' + o + '" action="' + s + '" method="POST" enctype="multipart/form-data" style="position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;"><iframe name="' + o + '" src="javascript:false;"></iframe><input value="' + o + '" name="callback" type="hidden"/></form>',
                        i.xhr.abort = function() {
                            var e = a.getElementsByName("iframe")[0];
                            if (e)
                                try {
                                    e.stop ? e.stop() : e.contentWindow.stop ? e.contentWindow.stop() : e.contentWindow.document.execCommand("Stop")
                                } catch (e) {}
                            a = null
                        }
                        ,
                        s = a.getElementsByTagName("form")[0],
                        s.appendChild(r),
                        t.log(s.parentNode.innerHTML),
                        document.body.appendChild(a),
                        i.xhr.node = a,
                        e[o] = function(e, t, n) {
                            i.readyState = 4,
                                i.responseText = n,
                                i.end(e, t),
                                a = null
                        }
                        ,
                        i.readyState = 2,
                        s.submit(),
                        s = null) : this.xhr && this.xhr.aborted ? t.log("Error: already aborted") : (a = i.xhr = t.getXHR(),
                    r.params && (s += (0 > s.indexOf("?") ? "?" : "&") + r.params.join("&")),
                        a.open("POST", s, !0),
                    t.withCredentials && (a.withCredentials = "true"),
                    (!n.headers || !n.headers["X-Requested-With"]) && a.setRequestHeader("X-Requested-With", "XMLHttpRequest"),
                        t.each(n.headers, function(e, t) {
                            a.setRequestHeader(t, e)
                        }),
                        n._chunked ? (a.upload && a.upload.addEventListener("progress", function(e) {
                            r.retry || n.progress({
                                type: e.type,
                                total: r.size,
                                loaded: r.start + e.loaded,
                                totalSize: r.size
                            }, i, n)
                        }, !1),
                            a.onreadystatechange = function() {
                                if (i.status = a.status,
                                        i.statusText = a.statusText,
                                        i.readyState = a.readyState,
                                    4 == a.readyState) {
                                    for (var e in {
                                        "": 1,
                                        XML: 1,
                                        Text: 1,
                                        Body: 1
                                    })
                                        i["response" + e] = a["response" + e];
                                    if (a.onreadystatechange = null,
                                        !a.status || 0 < a.status - 201)
                                        if (t.log("Error: " + a.status),
                                            (!a.status && !a.aborted || 500 == a.status || 416 == a.status) && ++r.retry <= n.chunkUploadRetry) {
                                            e = a.status ? 0 : t.chunkNetworkDownRetryTimeout,
                                                n.pause(r.file, n);
                                            var o = parseInt(a.getResponseHeader("X-Last-Known-Byte"), 10);
                                            t.log("X-Last-Known-Byte: " + o),
                                                r.end = o ? o : r.start - 1,
                                                setTimeout(function() {
                                                    i._send(n, r)
                                                }, e)
                                        } else
                                            i.end(a.status);
                                    else
                                        r.retry = 0,
                                            r.end == r.size - 1 ? i.end(a.status) : (o = parseInt(a.getResponseHeader("X-Last-Known-Byte"), 10),
                                                t.log("X-Last-Known-Byte: " + o),
                                            o && (r.end = o),
                                                r.file.FileAPIReadPosition = r.end,
                                                setTimeout(function() {
                                                    i._send(n, r)
                                                }, 0));
                                    a = null
                                }
                            }
                            ,
                            r.start = r.end + 1,
                            r.end = Math.max(Math.min(r.start + n.chunkSize, r.size) - 1, r.start),
                        (o = "slice")in r.file || (o = "mozSlice")in r.file || (o = "webkitSlice"),
                            a.setRequestHeader("Content-Range", "bytes " + r.start + "-" + r.end + "/" + r.size),
                            a.setRequestHeader("Content-Disposition", "attachment; filename=" + encodeURIComponent(r.name)),
                            a.setRequestHeader("Content-Type", r.type || "application/octet-stream"),
                            o = r.file[o](r.start, r.end + 1),
                            a.send(o),
                            o = null) : (a.upload && a.upload.addEventListener("progress", t.throttle(function(e) {
                            n.progress(e, i, n)
                        }, 100), !1),
                            a.onreadystatechange = function() {
                                if (i.status = a.status,
                                        i.statusText = a.statusText,
                                        i.readyState = a.readyState,
                                    4 == a.readyState) {
                                    for (var e in {
                                        "": 1,
                                        XML: 1,
                                        Text: 1,
                                        Body: 1
                                    })
                                        i["response" + e] = a["response" + e];
                                    a.onreadystatechange = null,
                                        i.end(a.status),
                                        a = null
                                }
                            }
                            ,
                            t.isArray(r) ? (a.setRequestHeader("Content-Type", "multipart/form-data; boundary=_" + t.expando),
                                r = r.join("") + "--_" + t.expando + "--",
                                a.sendAsBinary ? a.sendAsBinary(r) : (o = Array.prototype.map.call(r, function(e) {
                                    return 255 & e.charCodeAt(0)
                                }),
                                    a.send(new Uint8Array(o).buffer))) : a.send(r)))
            }
        },
            t.XHR = r
    }(window, FileAPI),
    function(e, t, n) {
        var r = e.support
            , a = t.navigator
            , i = a.mimeTypes
            , o = !1;
        if (a.plugins && "object" == typeof a.plugins["Shockwave Flash"])
            o = a.plugins["Shockwave Flash"].description && !(i && i["application/x-shockwave-flash"] && !i["application/x-shockwave-flash"].enabledPlugin);
        else
            try {
                o = !(!t.ActiveXObject || !new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))
            } catch (t) {
                e.log("ShockwaveFlash.ShockwaveFlash -- does not supported.")
            }
        if (r.flash = o,
            e.support.flash && (!e.html5 || !e.support.html5 || e.cors && !e.support.cors)) {
            var s = function(e) {
                return ('<object id="#id#" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + (e.width || "100%") + '" height="' + (e.height || "100%") + '"><param name="movie" value="#src#" /><param name="flashvars" value="#flashvars#" /><param name="swliveconnect" value="true" /><param name="allowscriptaccess" value="always" /><param name="allownetworking" value="all" /><param name="menu" value="false" /><param name="wmode" value="#wmode#" /><embed flashvars="#flashvars#" swliveconnect="true" allownetworking="all" allowscriptaccess="always" name="#id#" src="#src#" width="' + (e.width || "100%") + '" height="' + (e.height || "100%") + '" menu="false" wmode="transparent" type="application/x-shockwave-flash"></embed></object>').replace(/#(\w+)#/gi, function(t, n) {
                    return e[n]
                })
            }
                , c = function(e, t) {
                if (e && e.style) {
                    var n, r;
                    for (n in t) {
                        r = t[n],
                        "number" == typeof r && (r += "px");
                        try {
                            e.style[n] = r
                        } catch (e) {}
                    }
                }
            }
                , l = function(t, n) {
                e.each(n, function(e, n) {
                    var r = t[n];
                    t[n] = function() {
                        return this.parent = r,
                            e.apply(this, arguments)
                    }
                })
            }
                , u = function(t) {
                var n = t.wid = e.uid();
                return v._fn[n] = t,
                "FileAPI.Flash._fn." + n
            }
                , d = function(e) {
                try {
                    v._fn[e.wid] = null,
                        delete v._fn[e.wid]
                } catch (e) {}
            }
                , p = function(e, t) {
                if (!h.test(e)) {
                    if (/^\.\//.test(e) || "/" != e.charAt(0)) {
                        var n = location.pathname
                            , n = n.substr(0, n.lastIndexOf("/"));
                        e = (n + "/" + e).replace("/./", "/")
                    }
                    "//" != e.substr(0, 2) && (e = "//" + location.host + e),
                    h.test(e) || (e = location.protocol + e)
                }
                return t && (e += (/\?/.test(e) ? "&" : "?") + t),
                    e
            }
                , f = e.uid()
                , g = 0
                , m = {}
                , h = /^https?:/i
                , v = {
                _fn: {},
                init: function() {
                    var t = n.body && n.body.firstChild;
                    if (t)
                        do {
                            if (1 == t.nodeType) {
                                e.log("FlashAPI.Flash.init...");
                                var r = n.createElement("div");
                                return c(r, {
                                    top: 1,
                                    right: 1,
                                    width: 5,
                                    height: 5,
                                    position: "absolute"
                                }),
                                    t.parentNode.insertBefore(r, t),
                                    void v.publish(r, f)
                            }
                        } while (t = t.nextSibling);10 > g && setTimeout(v.init, 50 * ++g)
                },
                publish: function(t, n) {
                    t.innerHTML = s({
                        id: n,
                        src: p(e.flashUrl, "r=" + e.version),
                        wmode: "transparent",
                        flashvars: "callback=FileAPI.Flash.event&flashId=" + n + "&storeKey=" + navigator.userAgent.match(/\d/gi).join("") + "_" + e.version + (v.isReady || (e.pingUrl ? "&ping=" + e.pingUrl : ""))
                    })
                },
                ready: function() {
                    v.ready = e.F,
                        v.isReady = !0,
                        v.patch(),
                        e.event.on(n, "mouseover", v.mouseover),
                        e.event.on(n, "click", function(e) {
                            v.mouseover(e) && (e.preventDefault ? e.preventDefault() : e.returnValue = !0)
                        })
                },
                getWrapper: function(e) {
                    do {
                        if (/js-fileapi-wrapper/.test(e.className))
                            return e
                    } while ((e = e.parentNode) && e !== n.body)
                },
                mouseover: function(t) {
                    if (t = e.event.fix(t).target,
                        /input/i.test(t.nodeName) && "file" == t.type) {
                        var r = t.getAttribute(f);
                        if ("i" == r || "r" == r)
                            return !1;
                        if ("p" != r) {
                            t.setAttribute(f, "i");
                            var r = n.createElement("div")
                                , a = v.getWrapper(t);
                            if (!a)
                                return void e.log("flash.mouseover.error: js-fileapi-wrapper not found");
                            c(r, {
                                top: 0,
                                left: 0,
                                width: t.offsetWidth + 100,
                                height: t.offsetHeight + 100,
                                zIndex: "1000000",
                                position: "absolute"
                            }),
                                a.appendChild(r),
                                v.publish(r, e.uid()),
                                t.setAttribute(f, "p")
                        }
                        return !0
                    }
                },
                event: function(t) {
                    var n = t.type;
                    if ("ready" == n) {
                        try {
                            v.getInput(t.flashId).setAttribute(f, "r")
                        } catch (e) {}
                        return v.ready(),
                            setTimeout(function() {
                                v.mouseenter(t)
                            }, 50),
                            !0
                    }
                    "ping" === n ? e.log("(flash -> js).ping:", [t.status, t.savedStatus], t.error) : "log" === n ? e.log("(flash -> js).log:", t.target) : n in v && setTimeout(function() {
                        e.log("Flash.event." + t.type + ":", t),
                            v[n](t)
                    }, 1)
                },
                mouseenter: function(t) {
                    var n = v.getInput(t.flashId);
                    if (n) {
                        v.cmd(t, "multiple", null != n.getAttribute("multiple"));
                        var r = []
                            , a = {};
                        e.each((n.getAttribute("accept") || "").split(/,\s*/), function(t) {
                            e.accept[t] && e.each(e.accept[t].split(" "), function(e) {
                                a[e] = 1
                            })
                        }),
                            e.each(a, function(e, t) {
                                r.push(t)
                            }),
                            v.cmd(t, "accept", r.length ? r.join(",") + "," + r.join(",").toUpperCase() : "*")
                    }
                },
                get: function(e) {
                    return n[e] || t[e] || n.embeds[e]
                },
                getInput: function(t) {
                    try {
                        var n = v.getWrapper(v.get(t));
                        if (n)
                            return n.getElementsByTagName("input")[0]
                    } catch (n) {
                        e.log('Can not find "input" by flashId:', t, n)
                    }
                },
                select: function(t) {
                    var r = v.getInput(t.flashId)
                        , a = e.uid(r);
                    t = t.target.files,
                        e.each(t, function(t) {
                            e.checkFileObj(t)
                        }),
                        m[a] = t,
                        n.createEvent ? (a = n.createEvent("Event"),
                            a.initEvent("change", !0, !1),
                            r.dispatchEvent(a)) : n.createEventObject && (a = n.createEventObject(),
                            r.fireEvent("onchange", a))
                },
                cmd: function(t, n, r, a) {
                    try {
                        return e.log("(js -> flash)." + n + ":", r),
                            v.get(t.flashId || t).cmd(n, r)
                    } catch (i) {
                        e.log("(js -> flash).onError:", i),
                        a || setTimeout(function() {
                            v.cmd(t, n, r, !0)
                        }, 50)
                    }
                },
                patch: function() {
                    e.flashEngine = e.support.transform = !0,
                        l(e, {
                            getFiles: function(t, n, r) {
                                if (r)
                                    return e.filterFiles(e.getFiles(t), n, r),
                                        null;
                                var a = e.isArray(t) ? t : m[e.uid(t.target || t.srcElement || t)];
                                return a ? (n && (n = e.getFilesFilter(n),
                                    a = e.filter(a, function(e) {
                                        return n.test(e.name)
                                    })),
                                    a) : this.parent.apply(this, arguments)
                            },
                            getInfo: function(t, n) {
                                if (t && !t.flashId)
                                    this.parent.apply(this, arguments);
                                else {
                                    if (!t.__info) {
                                        var r = t.__info = e.defer();
                                        v.cmd(t, "getFileInfo", {
                                            id: t.id,
                                            callback: u(function e(n, a) {
                                                d(e),
                                                    r.resolve(n, t.info = a)
                                            })
                                        })
                                    }
                                    t.__info.then(n)
                                }
                            }
                        }),
                        e.support.transform = !0,
                    e.Image && l(e.Image.prototype, {
                        get: function(e, t) {
                            this.set({
                                scaleMode: t || "noScale"
                            }),
                                this.parent(e)
                        },
                        _load: function(t, n) {
                            if (e.log("FileAPI.Image._load:", t),
                                t && !t.flashId)
                                this.parent.apply(this, arguments);
                            else {
                                var r = this;
                                e.getInfo(t, function(e) {
                                    n.call(r, e, t)
                                })
                            }
                        },
                        _apply: function(t, r) {
                            if (e.log("FileAPI.Image._apply:", t),
                                t && !t.flashId)
                                this.parent.apply(this, arguments);
                            else {
                                var a = this.getMatrix(t.info);
                                v.cmd(t, "imageTransform", {
                                    id: t.id,
                                    matrix: a,
                                    callback: u(function i(o, l) {
                                        if (e.log("FileAPI.Image._apply.callback:", o),
                                                d(i),
                                                o)
                                            r(o);
                                        else if (!e.support.dataURI || 3e4 < l.length) {
                                            var f, g = {
                                                width: a.deg % 180 ? a.dh : a.dw,
                                                height: a.deg % 180 ? a.dw : a.dh,
                                                scale: a.scaleMode
                                            }, m = r, h = function() {
                                                try {
                                                    v.get(C).setImage(l)
                                                } catch (t) {
                                                    e.log('flash.setImage -- can not set "base64":', t)
                                                }
                                            }, C = e.uid(), y = n.createElement("div");
                                            for (f in g)
                                                y.setAttribute("data-img-" + f, g[f]);
                                            c(y, g),
                                                y.innerHTML = s(e.extend({
                                                    id: C,
                                                    src: p(e.flashImageUrl, "r=" + e.uid()),
                                                    wmode: "opaque",
                                                    flashvars: "scale=" + g.scale + "&callback=" + u(function e() {
                                                        return d(e),
                                                            setTimeout(h, 99),
                                                            !0
                                                    })
                                                }, g)),
                                                m(!1, y),
                                                y = null
                                        } else {
                                            var A = new Image;
                                            e.event.one(A, "error abort load", function(e) {
                                                r("load" != e.type && e.type, A),
                                                    A = null
                                            }),
                                                A.src = "data:" + t.type + ";base64," + l
                                        }
                                    })
                                })
                            }
                        },
                        toData: function(t) {
                            var n = this.file
                                , r = n.info
                                , a = this.getMatrix(r);
                            n && !n.flashId ? this.parent.apply(this, arguments) : ("auto" == a.deg && (a.deg = e.Image.exifOrientation[r && r.exif && r.exif.Orientation] || 0),
                                t.call(this, !n.info, {
                                    id: n.id,
                                    flashId: n.flashId,
                                    name: n.name,
                                    type: n.type,
                                    matrix: a
                                }))
                        }
                    }),
                        l(e.Form.prototype, {
                            toData: function(t) {
                                for (var n = this.items, r = n.length; r--; )
                                    if (n[r].file && n[r].blob && !n[r].blob.flashId)
                                        return this.parent.apply(this, arguments);
                                e.log("flash.Form.toData"),
                                    t(n)
                            }
                        }),
                        l(e.XHR.prototype, {
                            _send: function(t, n) {
                                if (n.nodeName || n.append && e.support.html5 || e.isArray(n) && "string" == typeof n[0])
                                    return this.parent.apply(this, arguments);
                                var r, a, i = {}, o = {}, s = this;
                                if (e.each(n, function(e) {
                                        e.file ? (o[e.name] = e = {
                                            id: e.blob.id,
                                            name: e.blob.name,
                                            matrix: e.blob.matrix,
                                            flashId: e.blob.flashId
                                        },
                                            a = e.id,
                                            r = e.flashId) : i[e.name] = e.blob
                                    }),
                                    !a && !r)
                                    return this.parent.apply(this, arguments);
                                e.log("flash.XHR._send:", r, a, o),
                                    s.xhr = {
                                        headers: {},
                                        abort: function() {
                                            v.cmd(r, "abort", {
                                                id: a
                                            })
                                        },
                                        getResponseHeader: function(e) {
                                            return this.headers[e]
                                        },
                                        getAllResponseHeaders: function() {
                                            return this.headers
                                        }
                                    };
                                var c = e.queue(function() {
                                    v.cmd(r, "upload", {
                                        url: p(t.url),
                                        data: i,
                                        files: o,
                                        headers: t.headers,
                                        callback: u(function n(r) {
                                            var a = r.type
                                                , i = r.result;
                                            e.log("flash.upload." + a + ":", r),
                                                "progress" == a ? (r.loaded = Math.min(r.loaded, r.total),
                                                    r.lengthComputable = !0,
                                                    t.progress(r)) : "complete" == a ? (d(n),
                                                "string" == typeof i && (s.responseText = i.replace(/%22/g, '"').replace(/%5c/g, "\\").replace(/%26/g, "&").replace(/%25/g, "%")),
                                                    s.end(r.status || 200)) : "abort" != a && "error" != a || (s.end(r.status || 0, r.message),
                                                    d(n))
                                        })
                                    })
                                });
                                e.each(o, function(t) {
                                    c.inc(),
                                        e.getInfo(t, c.next)
                                }),
                                    c.check()
                            }
                        })
                }
            };
            e.Flash = v;
            var C = new Image;
            e.event.one(C, "error load", function() {
                e.support.dataURI = !(1 != C.width || 1 != C.height),
                    C = null,
                    v.init()
            }),
                C.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
        }
    }(FileAPI, window, document),
"undefined" != typeof ajs && ajs.loaded && ajs.loaded("{fileapi}FileAPI.min"),
"function" == typeof define && define.amd && define("FileAPI", [], function() {
    return window.FileAPI || {}
});
